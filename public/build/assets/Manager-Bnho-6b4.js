import{c as ne,j as t,r as G,u as dt,R as ms,b as It,a as Ut,H as hs}from"./app-sj5sN_G8.js";import{b as W}from"./base44Client-DAEF8o8X.js";import{B as re}from"./badge-Cd49_hV0.js";import{b as Re,c as et}from"./card-5RzzKhYg.js";import{u as je,A as it,U as _t}from"./users-DerS2__8.js";import{h as Z}from"./moment-B-YVwB4U.js";import{T as us,f as ps,C as fs,R as gs,P as bs,g as js,O as vs,c as ss,d as Ns,b as as,e as ws,a as ls,D as is}from"./dialog-MtPf1lXG.js";import{c as pe,a as B,m as ye}from"./createLucideIcon-DgynkeM3.js";import{X as xt,U as nt,a as Et,S as Lt,b as Bt,A as ys}from"./app-main-Bt9MoLIe.js";import{C as Te}from"./clock-qRNAa-h9.js";import{T as Ee}from"./trending-up-DZV_E65W.js";import{H as ks}from"./history-CUb48qUf.js";import{C as Pt,T as Vt,A as rt}from"./trending-down-qqXFstJ6.js";import{T as lt,a as we,b as ns,c as ke,d as rs,e as cs}from"./table-n1kTGmhV.js";import{B as os}from"./banknote-ceFtgx3Y.js";import{t as V,B as P}from"./index-PZTgIcWY.js";import{L as de,I as ge}from"./label-D9tdbS9f.js";import{S as St,a as Ct,b as Dt,c as Mt,d as De}from"./select-DEiSCfUZ.js";import{c as st}from"./axios-BWKhhBfN.js";import{u as be}from"./useMutation-uOdm-zRO.js";import{L as ct,R as ot,A as _s}from"./refresh-cw-B2z2Akrr.js";import{B as Rt}from"./building-2-CXNefrAQ.js";import{C as Qt}from"./circle-check-ChbTJxBB.js";import{P as tt}from"./plus-DTH9be9K.js";import{T as Ft}from"./trash-2-Bx_you9t.js";import{G as Gt,C as Ss}from"./globe-DwW23ID4.js";import{S as Cs,a as At}from"./smartphone-B8PDcnvC.js";import{L as ds}from"./loader-circle-CH7iWCpR.js";import{T as Ds}from"./textarea-7lv0DuIx.js";import{D as Ms}from"./dollar-sign-DjuBl4Ga.js";import{L as Fs}from"./lock-open-TF6x8wY1.js";import{E as Ot}from"./eye-Chp3WHZM.js";import{C as As}from"./circle-alert-BWp5I0G5.js";import{S as qs,a as $s}from"./ShopManager-Bq_cSPIZ.js";/* empty css            */import"./index-BXnTyLYs.js";import"./check-DOrNNhu4.js";import"./ManagerModal-DNP_xS1x.js";const Us=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],zt=pe("Activity",Us);const Rs=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],Ht=pe("ArrowDownLeft",Rs);const Es=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Yt=pe("ArrowUpRight",Es);const Ts=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],qt=pe("Calendar",Ts);const Is=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Jt=pe("ChartPie",Is);const Ls=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],Kt=pe("CircleStop",Ls);const Ps=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Os=pe("Download",Ps);const zs=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Hs=pe("Filter",zs);const Ys=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Xt=pe("Hash",Ys);const Ks=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Bs=pe("LayoutGrid",Ks);const Vs=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Qs=pe("List",Vs);const Gs=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Js=pe("Pencil",Gs);const Xs=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],$t=pe("Play",Xs);const Ws=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],xs=pe("Save",Ws);const Zs=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Tt=pe("Settings",Zs);const ea=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ta=pe("Shield",ea);function sa(s){const e=ne.c(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=t.jsx(gs,{"data-slot":"sheet",...a}),e[2]=a,e[3]=i):i=e[3],i}function aa(s){const e=ne.c(4);let a;e[0]!==s?({...a}=s,e[0]=s,e[1]=a):a=e[1];let i;return e[2]!==a?(i=t.jsx(bs,{"data-slot":"sheet-portal",...a}),e[2]=a,e[3]=i):i=e[3],i}function la(s){const e=ne.c(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=B("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",a),e[3]=a,e[4]=r):r=e[4];let l;return e[5]!==i||e[6]!==r?(l=t.jsx(vs,{"data-slot":"sheet-overlay",className:r,...i}),e[5]=i,e[6]=r,e[7]=l):l=e[7],l}function ia(s){const e=ne.c(17);let a,i,r,l;e[0]!==s?({className:i,children:a,side:l,...r}=s,e[0]=s,e[1]=a,e[2]=i,e[3]=r,e[4]=l):(a=e[1],i=e[2],r=e[3],l=e[4]);const d=l===void 0?"right":l;let m;e[5]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx(la,{}),e[5]=m):m=e[5];const c=d==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",k=d==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",u=d==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",n=d==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t";let p;e[6]!==i||e[7]!==c||e[8]!==k||e[9]!==u||e[10]!==n?(p=B("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",c,k,u,n,i),e[6]=i,e[7]=c,e[8]=k,e[9]=u,e[10]=n,e[11]=p):p=e[11];let g;e[12]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsxs(js,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[t.jsx(xt,{className:"size-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]}),e[12]=g):g=e[12];let v;return e[13]!==a||e[14]!==r||e[15]!==p?(v=t.jsxs(aa,{children:[m,t.jsxs(fs,{"data-slot":"sheet-content",className:p,...r,children:[a,g]})]}),e[13]=a,e[14]=r,e[15]=p,e[16]=v):v=e[16],v}function na(s){const e=ne.c(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=B("flex flex-col gap-1.5 p-4",a),e[3]=a,e[4]=r):r=e[4];let l;return e[5]!==i||e[6]!==r?(l=t.jsx("div",{"data-slot":"sheet-header",className:r,...i}),e[5]=i,e[6]=r,e[7]=l):l=e[7],l}function ra(s){const e=ne.c(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=B("text-foreground font-semibold",a),e[3]=a,e[4]=r):r=e[4];let l;return e[5]!==i||e[6]!==r?(l=t.jsx(us,{"data-slot":"sheet-title",className:r,...i}),e[5]=i,e[6]=r,e[7]=l):l=e[7],l}function ca(s){const e=ne.c(8);let a,i;e[0]!==s?({className:a,...i}=s,e[0]=s,e[1]=a,e[2]=i):(a=e[1],i=e[2]);let r;e[3]!==a?(r=B("text-muted-foreground text-sm",a),e[3]=a,e[4]=r):r=e[4];let l;return e[5]!==i||e[6]!==r?(l=t.jsx(ps,{"data-slot":"sheet-description",className:r,...i}),e[5]=i,e[6]=r,e[7]=l):l=e[7],l}function oa(s){const e=ne.c(78),{user:a,isOpen:i,onClose:r}=s;if(!a)return null;const l=a.detailed_stats;let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx("div",{className:"h-2 w-full bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),e[0]=d):d=e[0];let m;e[1]!==a.cashier_name?(m=a.cashier_name.charAt(0),e[1]=a.cashier_name,e[2]=m):m=e[2];let c;e[3]!==m?(c=t.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-[2rem] bg-indigo-600 text-3xl font-black text-white shadow-xl shadow-indigo-200",children:m}),e[3]=m,e[4]=c):c=e[4];let k;e[5]!==a.cashier_name?(k=t.jsx(ra,{className:"mb-1 text-3xl leading-none font-black text-slate-900",children:a.cashier_name}),e[5]=a.cashier_name,e[6]=k):k=e[6];let u;e[7]!==a.cashier_email?(u=t.jsx(ca,{className:"text-xs font-bold tracking-widest text-indigo-500 uppercase",children:a.cashier_email}),e[7]=a.cashier_email,e[8]=u):u=e[8];let n;e[9]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(Te,{className:"mr-1.5 h-3 w-3"}),e[9]=n):n=e[9];const p=a.connection_time||"--:--";let g;e[10]!==p?(g=t.jsx("div",{className:"mt-4 flex items-center gap-2",children:t.jsxs(re,{variant:"outline",className:"rounded-xl border-emerald-100 bg-emerald-50 font-bold text-emerald-600",children:[n,"Connecté à"," ",p]})}),e[10]=p,e[11]=g):g=e[11];let v;e[12]!==k||e[13]!==u||e[14]!==g?(v=t.jsxs("div",{children:[k,u,g]}),e[12]=k,e[13]=u,e[14]=g,e[15]=v):v=e[15];let _;e[16]!==c||e[17]!==v?(_=t.jsx(na,{className:"mb-10",children:t.jsxs("div",{className:"mb-4 flex items-center gap-6",children:[c,v]})}),e[16]=c,e[17]=v,e[18]=_):_=e[18];let A;e[19]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsx("div",{className:"rounded-xl bg-emerald-50 p-2",children:t.jsx(Ht,{className:"h-5 w-5 text-emerald-600"})}),t.jsx("span",{className:"text-[10px] font-black tracking-wider text-emerald-600 uppercase",children:"Dépôts"})]}),e[19]=A):A=e[19];let x;e[20]!==l.deposits?(x=t.jsx("h4",{className:"text-2xl font-black text-slate-900",children:l.deposits}),e[20]=l.deposits,e[21]=x):x=e[21];let D;e[22]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx("p",{className:"mt-1 text-[10px] font-bold text-slate-400 uppercase",children:"Actions aujourd'hui"}),e[22]=D):D=e[22];let j;e[23]!==x?(j=t.jsx(Re,{className:"overflow-hidden rounded-3xl border-none bg-white shadow-sm",children:t.jsxs(et,{className:"p-6",children:[A,x,D]})}),e[23]=x,e[24]=j):j=e[24];let f;e[25]===Symbol.for("react.memo_cache_sentinel")?(f=t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsx("div",{className:"rounded-xl bg-rose-50 p-2",children:t.jsx(Yt,{className:"h-5 w-5 text-rose-600"})}),t.jsx("span",{className:"text-[10px] font-black tracking-wider text-rose-600 uppercase",children:"Retraits"})]}),e[25]=f):f=e[25];let y;e[26]!==l.withdrawals?(y=t.jsx("h4",{className:"text-2xl font-black text-slate-900",children:l.withdrawals}),e[26]=l.withdrawals,e[27]=y):y=e[27];let S;e[28]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx("p",{className:"mt-1 text-[10px] font-bold text-slate-400 uppercase",children:"Actions aujourd'hui"}),e[28]=S):S=e[28];let w;e[29]!==y?(w=t.jsx(Re,{className:"overflow-hidden rounded-3xl border-none bg-white shadow-sm",children:t.jsxs(et,{className:"p-6",children:[f,y,S]})}),e[29]=y,e[30]=w):w=e[30];let M;e[31]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsx("div",{className:"rounded-xl bg-amber-50 p-2",children:t.jsx(Ee,{className:"h-5 w-5 text-amber-600"})}),t.jsx("span",{className:"text-[10px] font-black tracking-wider text-amber-600 uppercase",children:"Changes"})]}),e[31]=M):M=e[31];let b;e[32]!==l.exchanges?(b=t.jsx("h4",{className:"text-2xl font-black text-slate-900",children:l.exchanges}),e[32]=l.exchanges,e[33]=b):b=e[33];let C;e[34]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx("p",{className:"mt-1 text-[10px] font-bold text-slate-400 uppercase",children:"Opérations"}),e[34]=C):C=e[34];let h;e[35]!==b?(h=t.jsx(Re,{className:"overflow-hidden rounded-3xl border-none bg-white shadow-sm",children:t.jsxs(et,{className:"p-6",children:[M,b,C]})}),e[35]=b,e[36]=h):h=e[36];let U;e[37]===Symbol.for("react.memo_cache_sentinel")?(U=t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsx("div",{className:"rounded-xl bg-indigo-50 p-2",children:t.jsx(ks,{className:"h-5 w-5 text-indigo-600"})}),t.jsx("span",{className:"text-[10px] font-black tracking-wider text-indigo-600 uppercase",children:"Mouvements"})]}),e[37]=U):U=e[37];const q=l.adjustments_in+l.adjustments_out;let F;e[38]!==q?(F=t.jsx("h4",{className:"text-2xl font-black text-slate-900",children:q}),e[38]=q,e[39]=F):F=e[39];let T;e[40]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx("p",{className:"mt-1 text-[10px] font-bold text-slate-400 uppercase",children:"Manuels (In/Out)"}),e[40]=T):T=e[40];let I;e[41]!==F?(I=t.jsx(Re,{className:"overflow-hidden rounded-3xl border-none bg-white shadow-sm",children:t.jsxs(et,{className:"p-6",children:[U,F,T]})}),e[41]=F,e[42]=I):I=e[42];let R;e[43]!==j||e[44]!==w||e[45]!==h||e[46]!==I?(R=t.jsxs("div",{className:"mb-10 grid grid-cols-2 gap-4",children:[j,w,h,I]}),e[43]=j,e[44]=w,e[45]=h,e[46]=I,e[47]=R):R=e[47];let K;e[48]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsx("p",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Volume Traité (USD)"}),e[48]=K):K=e[48];let O;e[49]!==l.total_amount_usd?(O=l.total_amount_usd.toLocaleString(),e[49]=l.total_amount_usd,e[50]=O):O=e[50];let z;e[51]!==O?(z=t.jsxs("div",{children:[K,t.jsxs("h3",{className:"text-2xl font-black",children:["$ ",O]})]}),e[51]=O,e[52]=z):z=e[52];let E,Y;e[53]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsx("div",{className:"h-10 w-[1px] bg-slate-800"}),Y=t.jsx("p",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Volume Traité (CDF)"}),e[53]=E,e[54]=Y):(E=e[53],Y=e[54]);let N;e[55]!==l.total_amount_cdf?(N=l.total_amount_cdf.toLocaleString(),e[55]=l.total_amount_cdf,e[56]=N):N=e[56];let L;e[57]!==N?(L=t.jsxs("div",{children:[Y,t.jsxs("h3",{className:"text-2xl font-black",children:[N," FC"]})]}),e[57]=N,e[58]=L):L=e[58];let H;e[59]!==z||e[60]!==L?(H=t.jsx("div",{className:"mb-10 space-y-4",children:t.jsxs("div",{className:"flex items-center justify-between rounded-2xl bg-slate-900 p-6 text-white shadow-xl",children:[z,E,L]})}),e[59]=z,e[60]=L,e[61]=H):H=e[61];let ae;e[62]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(zt,{className:"h-5 w-5 text-indigo-600"}),t.jsx("h4",{className:"text-lg font-black tracking-tight text-slate-800",children:"Dernières Activités"})]}),e[62]=ae):ae=e[62];let ee;if(e[63]!==a.recent_activities){let le;e[65]!==a.recent_activities.length?(le=(X,ce)=>t.jsxs("div",{className:"relative flex gap-4",children:[ce!==a.recent_activities.length-1&&t.jsx("div",{className:"absolute top-10 left-[19px] h-full w-[2px] bg-slate-100"}),t.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-xl border border-slate-100 bg-white text-[10px] font-black text-slate-400 shadow-sm",children:X.time}),t.jsxs("div",{className:"flex-1 rounded-2xl border border-slate-100 bg-white p-4 shadow-sm",children:[t.jsx("p",{className:"mb-1 text-xs font-bold tracking-wider text-indigo-500 uppercase",children:X.type}),t.jsx("p",{className:"text-sm leading-snug font-medium text-slate-600",children:X.description})]})]},X.id),e[65]=a.recent_activities.length,e[66]=le):le=e[66],ee=a.recent_activities.map(le),e[63]=a.recent_activities,e[64]=ee}else ee=e[64];let J;e[67]!==ee?(J=t.jsxs("div",{className:"space-y-6",children:[ae,t.jsx("div",{className:"space-y-4",children:ee})]}),e[67]=ee,e[68]=J):J=e[68];let te;e[69]!==_||e[70]!==R||e[71]!==H||e[72]!==J?(te=t.jsxs(ia,{className:"overflow-y-auto border-none bg-slate-50 p-0 sm:max-w-[600px]",children:[d,t.jsxs("div",{className:"px-8 py-10",children:[_,R,H,J]})]}),e[69]=_,e[70]=R,e[71]=H,e[72]=J,e[73]=te):te=e[73];let se;return e[74]!==i||e[75]!==r||e[76]!==te?(se=t.jsx(sa,{open:i,onOpenChange:r,children:te}),e[74]=i,e[75]=r,e[76]=te,e[77]=se):se=e[77],se}function da(s){const e=ne.c(30),{selectedDate:a}=s,[i,r]=G.useState(null);let l;e[0]!==a?(l={queryKey:["cashier-stats",a],queryFn:()=>W.entities.CashierActivity.stats({date:a})},e[0]=a,e[1]=l):l=e[1];const{data:d,isLoading:m}=je(l);let c;e[2]!==d?(c=d===void 0?[]:d,e[2]=d,e[3]=c):c=e[3];const k=c;let u;e[4]!==a?(u={queryKey:["cashier-activities",a],queryFn:()=>W.entities.CashierActivity.list({date:a})},e[4]=a,e[5]=u):u=e[5];const{data:n,isLoading:p}=je(u);let g;e[6]!==n?(g=n===void 0?[]:n,e[6]=n,e[7]=g):g=e[7];const v=g,_=xa;if(m||p){let h;return e[8]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[t.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-indigo-600 border-t-transparent"}),t.jsx("p",{className:"mt-4 text-xs font-black tracking-widest text-slate-400 uppercase",children:"Calcul des performances..."})]}),e[8]=h):h=e[8],h}let A;e[9]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx("h3",{className:"mb-2 text-2xl font-black tracking-tight text-slate-800",children:"Journal d'activité"}),e[9]=A):A=e[9];let x;e[10]!==a?(x=Z(a).format("DD/MM/YYYY"),e[10]=a,e[11]=x):x=e[11];let D;e[12]!==x?(D=t.jsxs("div",{children:[A,t.jsxs("p",{className:"text-sm font-medium text-slate-400",children:["Performance et mouvements des utilisateurs pour le"," ",x]})]}),e[12]=x,e[13]=D):D=e[13];let j;e[14]!==k?(j=k.length>0?k.map(h=>t.jsx(Re,{onClick:()=>r(h),className:"group cursor-pointer rounded-3xl border-slate-100 bg-white shadow-sm transition-all hover:border-indigo-500 hover:shadow-xl hover:shadow-indigo-500/10 active:scale-95",children:t.jsxs(et,{className:"p-6",children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-2xl bg-indigo-50 text-xl font-black text-indigo-600 transition-colors group-hover:bg-indigo-600 group-hover:text-white",children:h.cashier_name.charAt(0)}),t.jsx(Pt,{className:"h-5 w-5 text-slate-300 transition-all group-hover:translate-x-1 group-hover:text-indigo-600"})]}),t.jsx("h4",{className:"mb-1 text-lg font-black text-slate-900",children:h.cashier_name}),t.jsxs("div",{className:"mb-6 flex items-center gap-2",children:[t.jsx(re,{variant:"outline",className:"border-emerald-100 text-[10px] font-bold text-emerald-600",children:h.connection_time?`À ${h.connection_time}`:"Non connecté"}),t.jsxs(re,{variant:"outline",className:"text-[10px] font-bold",children:[h.transactions_completed," Opérations"]})]}),t.jsx("div",{className:"space-y-2 border-t border-slate-50 pt-4",children:t.jsxs("div",{className:"flex justify-between text-[10px] font-bold tracking-wider text-slate-400 uppercase",children:[t.jsx("span",{children:"Volume USD"}),t.jsxs("span",{className:"font-black text-slate-900",children:["$"," ",h.detailed_stats.total_amount_usd.toLocaleString()]})]})})]})},h.cashier_id)):t.jsxs("div",{className:"col-span-full rounded-[2.5rem] border-2 border-dashed border-slate-100 py-10 text-center",children:[t.jsx(nt,{className:"mx-auto mb-3 h-12 w-12 text-slate-200"}),t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-300 uppercase",children:"Aucun utilisateur actif ce jour"})]}),e[14]=k,e[15]=j):j=e[15];let f;e[16]!==j?(f=t.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:j}),e[16]=j,e[17]=f):f=e[17];let y;e[18]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsx("div",{className:"flex items-center justify-between",children:t.jsx("h4",{className:"text-xl font-black tracking-tight text-slate-800",children:"Derniers Événements"})}),e[18]=y):y=e[18];let S;e[19]!==v?(S=t.jsxs("div",{className:"space-y-6 border-t border-slate-100 pt-10",children:[y,v.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-40",children:[t.jsx(zt,{className:"mb-4 h-16 w-16 text-slate-200"}),t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-400 uppercase",children:"Aucun événement enregistré"})]}):t.jsx("div",{className:"relative space-y-4",children:v.map((h,U)=>t.jsxs("div",{className:"relative flex gap-4",children:[U!==v.length-1&&t.jsx("div",{className:"absolute top-10 left-[19px] h-full w-[2px] bg-slate-100"}),t.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full border-2 border-slate-100 bg-white",children:t.jsx(Te,{className:"h-4 w-4 text-slate-400"})}),t.jsxs("div",{className:"flex-1 rounded-2xl border border-slate-100 bg-white/50 p-5 shadow-sm transition-all hover:bg-white",children:[t.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-black text-slate-900",children:Z(h.created_at).format("HH:mm:ss")}),_(h.activity_type,h.description)]}),t.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-slate-400 uppercase",children:[t.jsx(nt,{className:"h-3 w-3"}),h.cashier?.name||h.cashier_name||"Système"]})]}),t.jsx("p",{className:"text-sm leading-relaxed font-medium text-slate-600",children:h.description})]})]},h.id))})]}),e[19]=v,e[20]=S):S=e[20];const w=!!i;let M;e[21]===Symbol.for("react.memo_cache_sentinel")?(M=()=>r(null),e[21]=M):M=e[21];let b;e[22]!==i||e[23]!==w?(b=t.jsx(oa,{user:i,isOpen:w,onClose:M}),e[22]=i,e[23]=w,e[24]=b):b=e[24];let C;return e[25]!==f||e[26]!==S||e[27]!==b||e[28]!==D?(C=t.jsxs("div",{className:"space-y-10",children:[D,f,S,b]}),e[25]=f,e[26]=S,e[27]=b,e[28]=D,e[29]=C):C=e[29],C}function xa(s,e){const a=e?.toLowerCase()||"";if(s==="complete_transaction")return a.includes("taux")?t.jsx(re,{className:"border-none bg-amber-100 text-amber-600",children:"TAUX"}):a.includes("boutique")?t.jsx(re,{className:"border-none bg-purple-100 text-purple-600",children:"BOUTIQUE"}):a.includes("utilisateur")?t.jsx(re,{className:"border-none bg-blue-100 text-blue-600",children:"USER"}):a.includes("partenaire")?t.jsx(re,{className:"border-none bg-pink-100 text-pink-600",children:"PARTENAIRE"}):a.includes("publicité")?t.jsx(re,{className:"border-none bg-rose-100 text-rose-600",children:"PUB"}):a.includes("guichet")?t.jsx(re,{className:"border-none bg-cyan-100 text-cyan-600",children:"GUICHET"}):t.jsx(re,{className:"border-none bg-indigo-100 text-indigo-600",children:"OPÉRATION"});switch(s){case"login":return t.jsx(re,{className:"border-none bg-emerald-100 text-emerald-600",children:"CONNEXION"});case"logout":return t.jsx(re,{className:"border-none bg-slate-100 text-slate-600",children:"DÉCONNEXION"});default:return t.jsx(re,{className:"border-none bg-slate-100 text-slate-500",children:s.toUpperCase()})}}function Wt(s){const e=ne.c(6),{movements:a}=s;if(a.length===0){let d;return e[0]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsxs("div",{className:"flex h-48 flex-col items-center justify-center rounded-3xl border-2 border-dashed border-slate-100 bg-slate-50/50",children:[t.jsx(os,{className:"mb-2 h-8 w-8 text-slate-200"}),t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-400 uppercase",children:"Aucun mouvement manuel aujourd'hui"})]}),e[0]=d):d=e[0],d}let i;e[1]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsx(ns,{children:t.jsxs(lt,{className:"border-b border-slate-50 bg-slate-50/50 hover:bg-slate-50/50",children:[t.jsx(ke,{className:"w-[120px] text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Heure"}),t.jsx(ke,{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Type"}),t.jsx(ke,{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Montant"}),t.jsx(ke,{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Motif / Description"}),t.jsx(ke,{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Caissier"}),t.jsx(ke,{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Boutique"})]})}),e[1]=i):i=e[1];let r;e[2]!==a?(r=a.map(ma),e[2]=a,e[3]=r):r=e[3];let l;return e[4]!==r?(l=t.jsx("div",{className:"overflow-hidden rounded-3xl border border-slate-100 bg-white shadow-sm",children:t.jsxs(rs,{children:[i,t.jsx(cs,{children:r})]})}),e[4]=r,e[5]=l):l=e[5],l}function ma(s,e){const a=s.amount>0;return t.jsxs(lt,{className:"group transition-colors hover:bg-slate-50/50",children:[t.jsx(we,{className:"py-4",children:t.jsxs("div",{className:"flex items-center gap-2 font-bold text-slate-400",children:[t.jsx(qt,{className:"h-3 w-3"}),Z(s.created_at).format("HH:mm")]})}),t.jsx(we,{children:t.jsxs("div",{className:`inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-[10px] font-black tracking-widest uppercase ${a?"bg-emerald-50 text-emerald-600":"bg-rose-50 text-rose-600"}`,children:[a?t.jsx(Yt,{className:"h-3 w-3"}):t.jsx(Ht,{className:"h-3 w-3"}),a?"Entrée":"Sortie"]})}),t.jsx(we,{children:t.jsxs("div",{className:`text-sm font-black ${a?"text-emerald-600":"text-rose-600"}`,children:[a?"+":"",parseFloat(s.amount).toLocaleString()," ",t.jsx("span",{className:"text-[10px] opacity-70",children:s.currency})]})}),t.jsx(we,{children:t.jsx("div",{className:"max-w-[200px] truncate text-xs font-bold text-slate-600",children:s.description})}),t.jsx(we,{children:t.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-500",children:[t.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-slate-100",children:t.jsx(nt,{className:"h-3 w-3 text-slate-400"})}),s.user?.name||"Inconnu"]})}),t.jsx(we,{children:t.jsx("div",{className:"text-[10px] font-black tracking-wider text-slate-400 uppercase",children:s.session?.register?.shop?.name||"-"})})]},s.id)}function ha(){const s=ne.c(50),e=dt(),[a,i]=G.useState(!1),[r,l]=G.useState(null),[d,m]=G.useState(null),[c,k]=G.useState("all");let u;s[0]===Symbol.for("react.memo_cache_sentinel")?(u={name:"",type:"bank",code:"",logo:null},s[0]=u):u=s[0];const[n,p]=G.useState(u),[g,v]=G.useState(""),[_,A]=G.useState("depot");let x;s[1]===Symbol.for("react.memo_cache_sentinel")?(x={queryKey:["institutions"],queryFn:Sa},s[1]=x):x=s[1];const{data:D,isLoading:j}=je(x),f=D===void 0?[]:D;let y;s[2]!==c?(y=o=>c==="all"?!0:o.type===c,s[2]=c,s[3]=y):y=s[3];const S=f.filter(y),w=be({mutationFn:_a,onSuccess:()=>{e.invalidateQueries({queryKey:["institutions"]}),h(),V.success("Institution ajoutée avec succès")},onError:ka}),M=be({mutationFn:ya,onSuccess:()=>{e.invalidateQueries({queryKey:["institutions"]}),h(),V.success("Institution mise à jour avec succès")},onError:wa});let b;s[4]!==e?(b={mutationFn:Na,onSuccess:()=>{e.invalidateQueries({queryKey:["institutions"]}),V.success("Configuration mise à jour")}},s[4]=e,s[5]=b):b=s[5];const C=be(b),h=()=>{p({name:"",type:"bank",code:"",logo:null}),l(null),i(!1)};let U;s[6]===Symbol.for("react.memo_cache_sentinel")?(U=o=>{p({name:o.name,type:o.type,code:o.code,logo:null}),l(o.id),i(!0)},s[6]=U):U=s[6];const q=U;let F;s[7]!==e?(F={mutationFn:va,onSuccess:()=>{e.invalidateQueries({queryKey:["institutions"]}),V.success("Institution supprimée")}},s[7]=e,s[8]=F):F=s[8];const T=be(F);let I;s[9]!==e?(I={mutationFn:ja,onSuccess:()=>{e.invalidateQueries({queryKey:["institutions"]}),V.success("Statut mis à jour")}},s[9]=e,s[10]=I):I=s[10];const R=be(I);let K;s[11]!==e?(K={mutationFn:ba,onSuccess:()=>{e.invalidateQueries({queryKey:["institutions"]}),v(""),A("depot"),V.success("Champ ajouté")},onError:ga},s[11]=e,s[12]=K):K=s[12];const O=be(K);let z;s[13]!==e?(z={mutationFn:fa,onSuccess:()=>{e.invalidateQueries({queryKey:["institutions"]}),V.success("Champ supprimé")}},s[13]=e,s[14]=z):z=s[14];const E=be(z);let Y;s[15]!==e?(Y={mutationFn:pa,onSuccess:()=>{e.invalidateQueries({queryKey:["institutions"]}),V.success("Infos agent mises à jour")}},s[15]=e,s[16]=Y):Y=s[16];const N=be(Y);let L,H;s[17]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-indigo-600 shadow-lg shadow-indigo-600/20",children:t.jsx(Rt,{className:"h-5 w-5 text-white"})}),H=t.jsx("h4",{className:"text-sm font-black tracking-tight text-slate-800 uppercase",children:"Partenaires & Institutions"}),s[17]=L,s[18]=H):(L=s[17],H=s[18]);let ae;s[19]!==a?(ae=()=>i(!a),s[19]=a,s[20]=ae):ae=s[20];const ee=a?"bg-slate-200 text-slate-600 hover:bg-slate-300":"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20 hover:bg-indigo-700";let J;s[21]!==ee?(J=B("h-11 rounded-xl px-6 text-xs font-black tracking-widest uppercase transition-all",ee),s[21]=ee,s[22]=J):J=s[22];let te;s[23]!==a?(te=a?t.jsx(xt,{className:"mr-2 h-4 w-4"}):t.jsx(tt,{className:"mr-2 h-4 w-4"}),s[23]=a,s[24]=te):te=s[24];const se=a?"Fermer":"Nouvelle Institution";let le;s[25]!==ae||s[26]!==J||s[27]!==te||s[28]!==se?(le=t.jsxs(P,{onClick:ae,className:J,children:[te,se]}),s[25]=ae,s[26]=J,s[27]=te,s[28]=se,s[29]=le):le=s[29];let X;s[30]!==w||s[31]!==r||s[32]!==n||s[33]!==h||s[34]!==a||s[35]!==M?(X=a&&t.jsx(ye.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:t.jsxs("div",{className:"relative rounded-[2rem] bg-slate-900 p-8 text-white shadow-2xl",children:[t.jsx("div",{className:"pointer-events-none absolute top-0 right-0 h-64 w-64 bg-indigo-500/10 blur-[100px]"}),t.jsxs("h5",{className:"mb-8 flex items-center gap-3 text-xl font-black tracking-tight",children:[t.jsx(ct,{className:"h-6 w-6 text-indigo-400"}),r?"Modifier l'institution":"Configurer un nouveau partenaire"]}),t.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-3",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(de,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Nom de l'institution"}),t.jsx(ge,{placeholder:"ex: Bank of Africa",value:n.name,onChange:o=>p({...n,name:o.target.value}),className:"h-12 rounded-xl border-white/10 bg-white/5 font-bold text-white outline-none focus:ring-2 focus:ring-indigo-500"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(de,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Type de service"}),t.jsxs(St,{value:n.type,onValueChange:o=>p({...n,type:o}),children:[t.jsx(Ct,{className:"h-12 rounded-xl border-white/10 bg-white/5 font-bold text-white outline-none focus:ring-2 focus:ring-indigo-500",children:t.jsx(Dt,{})}),t.jsxs(Mt,{className:"border-slate-800 bg-slate-900 text-white",children:[t.jsx(De,{value:"bank",className:"focus:bg-slate-800",children:"Banque Classique"}),t.jsx(De,{value:"mobile_money",className:"focus:bg-slate-800",children:"Mobile Money"}),t.jsx(De,{value:"payment",className:"focus:bg-slate-800",children:"Service de Paiement"}),t.jsx(De,{value:"other",className:"focus:bg-slate-800",children:"Autre Service (MoneyGram, etc.)"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(de,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Code Identifiant"}),t.jsx(ge,{placeholder:"ex: BOA-CD",value:n.code,onChange:o=>p({...n,code:o.target.value}),className:"h-12 rounded-xl border-white/10 bg-white/5 font-mono font-black text-white outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),t.jsxs("div",{className:"mt-6 space-y-2",children:[t.jsx(de,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Logo de l'institution (Optionnel)"}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"relative flex h-16 w-16 items-center justify-center overflow-hidden rounded-xl border border-white/10 bg-white/5",children:n.logo?t.jsx("img",{src:URL.createObjectURL(n.logo),alt:"Preview",className:"h-full w-full object-cover"}):t.jsx(Rt,{className:"h-6 w-6 text-white/20"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx(ge,{type:"file",accept:"image/*",onChange:o=>{o.target.files&&o.target.files[0]&&p({...n,logo:o.target.files[0]})},className:"h-12 w-full cursor-pointer rounded-xl border-white/10 bg-white/5 pt-2 text-sm font-bold text-white file:mr-4 file:rounded-lg file:border-0 file:bg-indigo-600 file:px-4 file:py-1 file:text-xs file:font-bold file:text-white hover:file:bg-indigo-700"}),t.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"Format recommandé: PNG ou JPG, fond transparent. Max 2MB."})]})]})]}),t.jsxs("div",{className:"mt-10 flex justify-end gap-3",children:[t.jsx(P,{variant:"ghost",onClick:h,className:"h-12 rounded-xl px-8 text-xs font-black tracking-widest text-slate-400 uppercase hover:bg-white/5 hover:text-white",children:"Annuler"}),t.jsx(P,{onClick:()=>{r?M.mutate({id:r,data:n}):w.mutate(n)},disabled:w.isPending||M.isPending||!n.name||!n.code,className:"h-12 rounded-xl bg-white px-10 text-xs font-black tracking-widest text-slate-900 uppercase transition-all hover:bg-slate-100",children:w.isPending?t.jsx(ot,{className:"h-4 w-4 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx(xs,{className:"mr-2 h-4 w-4"}),r?"Mettre à jour":"Enregistrer Partenaire"]})})]})]})}),s[30]=w,s[31]=r,s[32]=n,s[33]=h,s[34]=a,s[35]=M,s[36]=X):X=s[36];let ce;s[37]!==X?(ce=t.jsx(it,{children:X}),s[37]=X,s[38]=ce):ce=s[38];let xe;s[39]===Symbol.for("react.memo_cache_sentinel")?(xe=[{id:"all",label:"Tout"},{id:"bank",label:"Banques"},{id:"mobile_money",label:"Mobile Money"},{id:"payment",label:"Paiement"},{id:"other",label:"Autres"}],s[39]=xe):xe=s[39];let me;s[40]!==c?(me=t.jsx("div",{className:"flex gap-2",children:xe.map(o=>t.jsx("button",{onClick:()=>k(o.id),className:B("rounded-xl px-4 py-2 text-xs font-black tracking-widest uppercase transition-all",c===o.id?"bg-slate-900 text-white shadow-lg shadow-slate-900/10":"bg-white text-slate-400 hover:bg-slate-50 hover:text-slate-600"),children:o.label},o.id))}),s[40]=c,s[41]=me):me=s[41];let he;s[42]!==T||s[43]!==R?(he=o=>t.jsxs(ye.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"group relative overflow-hidden rounded-[2rem] border-2 border-slate-50 bg-white p-6 shadow-xl shadow-slate-200/50 transition-all duration-300 hover:border-indigo-100",children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsx("div",{className:B("flex h-14 w-14 items-center justify-center rounded-2xl shadow-lg transition-transform group-hover:rotate-6",o.type==="bank"?"bg-slate-900 text-white shadow-slate-900/10":o.type==="payment"?"bg-indigo-500 text-white shadow-indigo-500/10":o.type==="other"?"bg-amber-500 text-white shadow-amber-500/10":"bg-emerald-500 text-white shadow-emerald-500/10"),children:o.logo_url?t.jsx("img",{src:o.logo_url,alt:o.name,className:"h-9 w-9 object-contain"}):o.type==="bank"?t.jsx(Rt,{className:"h-7 w-7"}):o.type==="payment"?t.jsx(Gt,{className:"h-7 w-7"}):o.type==="other"?t.jsx(Gt,{className:"h-7 w-7"}):t.jsx(Cs,{className:"h-7 w-7"})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(P,{variant:"ghost",size:"icon",onClick:()=>R.mutate({id:o.id,is_active:!o.is_active}),className:B("h-10 w-10 rounded-xl transition-all",o.is_active?"bg-emerald-50 text-emerald-500":"bg-slate-50 text-slate-300"),children:t.jsx(Et,{className:"h-5 w-5"})}),t.jsx(P,{variant:"ghost",size:"icon",onClick:()=>T.mutate(o.id),className:"h-10 w-10 rounded-xl text-slate-300 opacity-0 transition-all group-hover:opacity-100 hover:bg-rose-50 hover:text-rose-500",children:t.jsx(Ft,{className:"h-5 w-5"})}),t.jsx(P,{variant:"ghost",size:"icon",onClick:()=>m(o.id),className:"h-10 w-10 rounded-xl bg-slate-50 text-slate-400 transition-all hover:bg-emerald-50 hover:text-emerald-600",children:t.jsx(Tt,{className:"h-5 w-5"})}),t.jsx(P,{variant:"ghost",size:"icon",onClick:()=>q(o),className:"h-10 w-10 rounded-xl bg-slate-50 text-slate-400 transition-all hover:bg-indigo-50 hover:text-indigo-600",children:t.jsx(Js,{className:"h-5 w-5"})})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h3",{className:"text-lg font-black tracking-tight text-slate-900",children:o.name}),!o.is_active&&t.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[8px] font-black tracking-widest text-slate-400 uppercase",children:"Inactif"}),o.settings?.required_fields&&o.settings.required_fields.length>0&&t.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-emerald-500/10 px-2 py-0.5 text-[8px] font-black tracking-widest text-emerald-600 uppercase",children:[t.jsx(Qt,{className:"h-2 w-2"}),"Configuré"]})]}),t.jsxs("div",{className:"mt-1 flex items-center gap-3",children:[t.jsx("span",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:o.code}),t.jsx("span",{className:"h-1 w-1 rounded-full bg-slate-200"}),t.jsx("span",{className:"text-[10px] font-bold text-indigo-500 uppercase",children:o.type==="bank"?"Banque":o.type==="payment"?"Service de Paiement":o.type==="other"?"Autre Service":"Mobile Money"})]})]}),t.jsx("div",{className:B("absolute -right-6 -bottom-6 h-24 w-24 rounded-full opacity-[0.03] transition-transform group-hover:scale-150",o.type==="bank"?"bg-slate-900":"bg-emerald-500")})]},o.id),s[42]=T,s[43]=R,s[44]=he):he=s[44];let ue;s[45]!==j?(ue=j&&t.jsx("div",{className:"flex justify-center p-20",children:t.jsx(ds,{className:"h-10 w-10 animate-spin text-indigo-600"})}),s[45]=j,s[46]=ue):ue=s[46];const ve=it,fe=d&&t.jsx(ye.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 p-4 backdrop-blur-sm",onClick:()=>m(null),children:t.jsxs(ye.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"w-full max-w-md overflow-hidden rounded-[2.5rem] bg-white shadow-2xl",onClick:ua,children:[t.jsxs("div",{className:"relative bg-slate-900 p-8 text-white",children:[t.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 bg-indigo-500/10 blur-3xl"}),t.jsxs("h3",{className:"flex items-center gap-3 text-xl font-black tracking-tight",children:[t.jsx(Tt,{className:"h-6 w-6 text-indigo-400"}),"Champs Requis"]}),t.jsxs("p",{className:"mt-2 text-xs font-medium text-slate-400",children:["Configurez les informations obligatoires pour"," ",t.jsx("span",{className:"text-white",children:f.find(o=>o.id===d)?.name})]})]}),t.jsxs("div",{className:"p-8",children:[t.jsx("div",{className:"space-y-3",children:[{id:"account_number",label:"Numéro de Compte"},{id:"beneficiary",label:"Nom du Bénéficiaire"},{id:"beneficiary_number",label:"Numéro du Bénéficiaire"},{id:"reason",label:"Motif / Raison"}].map(o=>{const Q=f.find(Ae=>Ae.id===d),ie=(Q?.settings?.required_fields||[]).includes(o.id);return t.jsxs("button",{onClick:()=>C.mutate({institution:Q,field:o.id}),className:B("flex w-full items-center justify-between rounded-2xl border-2 p-5 transition-all",ie?"border-indigo-100 bg-indigo-50/50 text-indigo-900 shadow-sm":"border-slate-100 bg-slate-50/50 text-slate-500 hover:border-slate-200"),children:[t.jsx("span",{className:"text-sm font-black tracking-tight",children:o.label}),ie?t.jsx(Qt,{className:"h-6 w-6 text-indigo-600"}):t.jsx("div",{className:"h-6 w-6 rounded-full border-2 border-slate-200 bg-white"})]},o.id)})}),t.jsxs("div",{className:"mt-8 space-y-4",children:[t.jsxs("h4",{className:"flex items-center gap-2 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[t.jsx(tt,{className:"h-3 w-3"}),"Ajouter un champ personnalisé"]}),t.jsx("div",{className:"flex flex-col gap-2",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ge,{placeholder:"ex: Code Agence...",value:g,onChange:o=>v(o.target.value),className:"h-12 rounded-xl border-slate-200"}),t.jsxs(St,{value:_,onValueChange:o=>A(o),children:[t.jsx(Ct,{className:"h-12 w-32 rounded-xl border-slate-200",children:t.jsx(Dt,{})}),t.jsxs(Mt,{className:"bg-white",children:[t.jsx(De,{value:"depot",children:"Dépôt"}),t.jsx(De,{value:"retrait",children:"Retrait"}),t.jsx(De,{value:"both",children:"Les deux"})]})]}),t.jsx(P,{onClick:()=>{if(g.trim()){const o=f.find(Q=>Q.id===d);O.mutate({institution:o,label:g,operation_type:_})}},disabled:!g.trim()||O.isPending,className:"h-12 rounded-xl bg-indigo-600 px-4 text-white hover:bg-indigo-700",children:O.isPending?t.jsx(ot,{className:"h-4 w-4 animate-spin"}):t.jsx(tt,{className:"h-4 w-4"})})]})}),t.jsx("div",{className:"space-y-2",children:(f.find(o=>o.id===d)?.settings?.custom_fields||[]).map(o=>t.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-100 bg-slate-50 p-3",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-bold text-slate-700",children:o.label}),t.jsx("span",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:o.operation_type==="depot"?"Dépôt":o.operation_type==="retrait"?"Retrait":"Les deux"})]}),t.jsx(P,{variant:"ghost",size:"icon",onClick:()=>{const Q=f.find(ie=>ie.id===d);E.mutate({institution:Q,fieldId:o.id})},className:"h-8 w-8 text-slate-400 hover:text-red-500",children:t.jsx(Ft,{className:"h-4 w-4"})})]},o.id))})]}),t.jsxs("div",{className:"mt-8 space-y-4 border-t border-slate-100 pt-6",children:[t.jsxs("h4",{className:"flex items-center gap-2 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[t.jsx(Et,{className:"h-3 w-3"}),"Infos Agent (Retrait)"]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(de,{className:"ml-1 text-[10px] font-bold text-slate-500",children:"Nom de l'Agent"}),t.jsx(ge,{placeholder:"ex: HAVIFIN BOUTIQUE",defaultValue:f.find(o=>o.id===d)?.settings?.withdrawal_agent_name||"",onBlur:o=>{const Q=f.find(ie=>ie.id===d);Q&&o.target.value!==(Q.settings?.withdrawal_agent_name||"")&&N.mutate({institution:Q,name:o.target.value,number:Q.settings?.withdrawal_agent_number||""})},className:"h-10 rounded-xl border-slate-200 text-sm"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(de,{className:"ml-1 text-[10px] font-bold text-slate-500",children:"Numéro de l'Agent"}),t.jsx(ge,{placeholder:"ex: 123456",defaultValue:f.find(o=>o.id===d)?.settings?.withdrawal_agent_number||"",onBlur:o=>{const Q=f.find(ie=>ie.id===d);Q&&o.target.value!==(Q.settings?.withdrawal_agent_number||"")&&N.mutate({institution:Q,name:Q.settings?.withdrawal_agent_name||"",number:o.target.value})},className:"h-10 rounded-xl border-slate-200 text-sm"})]})]})]}),t.jsx(P,{onClick:()=>m(null),className:"mt-8 h-14 w-full rounded-2xl bg-slate-900 text-sm font-black tracking-widest text-white uppercase transition-all hover:bg-slate-800",children:"Terminer"})]})]})});let oe;return s[47]!==ve||s[48]!==fe?(oe=t.jsx(ve,{children:fe}),s[47]=ve,s[48]=fe,s[49]=oe):oe=s[49],t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"flex items-center justify-between rounded-[1.5rem] border border-slate-100 bg-slate-100/50 p-4",children:[t.jsxs("div",{className:"ml-2 flex items-center gap-3",children:[L,t.jsxs("div",{children:[H,t.jsxs("p",{className:"text-[10px] font-bold tracking-widest text-slate-400 uppercase",children:[f.length," Entités Enregistrées"]})]})]}),le]}),ce,me,t.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:[S.map(he),f.length===0&&!j&&t.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center rounded-[3rem] border-2 border-dashed border-slate-200 bg-slate-50/50 py-20",children:[t.jsx(ct,{className:"mb-4 h-16 w-16 text-slate-200"}),t.jsx("p",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Aucune institution configurée"})]})]}),ue,oe]})}function ua(s){return s.stopPropagation()}function pa(s){const{institution:e,name:a,number:i}=s,r=e.settings||{required_fields:[]};return st.post(`/api/institutions/${e.id}`,{_method:"PUT",settings:{...r,withdrawal_agent_name:a,withdrawal_agent_number:i}})}function fa(s){const{institution:e,fieldId:a}=s,i=e.settings||{required_fields:[]},l=(i.custom_fields||[]).filter(d=>d.id!==a);return st.post(`/api/institutions/${e.id}`,{_method:"PUT",settings:{...i,custom_fields:l}})}function ga(s){return V.error(typeof s=="string"?s:"Erreur lors de l’ajout")}function ba(s){const{institution:e,label:a,operation_type:i}=s,r=e.settings||{required_fields:[]},l=r.custom_fields||[],d=a.toLowerCase().replace(/\s+/g,"_").replace(/[^\w]/g,"");if(l.find(c=>c.id===d))return Promise.reject("Ce champ existe déjà");const m=[...l,{id:d,label:a,type:"text",operation_type:i}];return st.post(`/api/institutions/${e.id}`,{_method:"PUT",settings:{...r,custom_fields:m}})}function ja(s){const{id:e,is_active:a}=s;return W.entities.Institution.update(e,{is_active:a})}function va(s){return W.entities.Institution.delete(s)}function Na(s){const{institution:e,field:a}=s,i=e.settings||{required_fields:[]},r=i.required_fields||[],l=r.includes(a)?r.filter(d=>d!==a):[...r,a];return st.post(`/api/institutions/${e.id}`,{_method:"PUT",settings:{...i,required_fields:l}})}function wa(){return V.error("Erreur lors de la mise à jour")}function ya(s){const{id:e,data:a}=s,i=new FormData;return i.append("_method","PUT"),i.append("name",a.name),i.append("type",a.type),i.append("code",a.code),a.logo&&i.append("logo",a.logo),st.post(`/api/institutions/${e}`,i,{headers:{"Content-Type":"multipart/form-data"}})}function ka(){return V.error("Erreur lors de l'ajout de l'institution")}function _a(s){const e=new FormData;return e.append("name",s.name),e.append("type",s.type),e.append("code",s.code),s.logo&&e.append("logo",s.logo),st.post("/api/institutions",e,{headers:{"Content-Type":"multipart/form-data"}})}function Sa(){return W.entities.Institution.list()}const Zt=[{id:"USD_CDF",label:"USD → CDF",from:"USD",to:"CDF"},{id:"EUR_CDF",label:"EUR → CDF",from:"EUR",to:"CDF"},{id:"EUR_USD",label:"EUR → USD",from:"EUR",to:"USD"},{id:"CDF_USD",label:"CDF → USD",from:"CDF",to:"USD"}];function Ca(){const s=ne.c(56),e=dt();let a;s[0]===Symbol.for("react.memo_cache_sentinel")?(a={currency_pair:"",buy_rate:"",sell_rate:""},s[0]=a):a=s[0];const[i,r]=G.useState(a),[l,d]=G.useState(!1);let m;s[1]===Symbol.for("react.memo_cache_sentinel")?(m={queryKey:["rates"],queryFn:$a},s[1]=m):m=s[1];const{data:c,isLoading:k}=je(m);let u;s[2]!==c?(u=c===void 0?[]:c,s[2]=c,s[3]=u):u=s[3];const n=u;let p;s[4]!==e?(p={mutationFn:qa,onSuccess:()=>{e.invalidateQueries({queryKey:["rates"]}),V.success("Taux mis à jour")}},s[4]=e,s[5]=p):p=s[5];const g=be(p);let v;s[6]!==e?(v={mutationFn:Aa,onSuccess:()=>{e.invalidateQueries({queryKey:["rates"]}),r({currency_pair:"",buy_rate:"",sell_rate:""}),d(!1),V.success("Nouveau taux de change configuré")},onError:Fa},s[6]=e,s[7]=v):v=s[7];const _=be(v);let A;s[8]!==e?(A={mutationFn:Ma,onSuccess:()=>{e.invalidateQueries({queryKey:["rates"]}),V.success("Configuration supprimée")}},s[8]=e,s[9]=A):A=s[9];const x=be(A);let D;s[10]!==g?(D=(E,Y,N)=>{N&&g.mutate({id:E.id,data:{[Y]:parseFloat(N)}})},s[10]=g,s[11]=D):D=s[11];const j=D;let f,y;s[12]===Symbol.for("react.memo_cache_sentinel")?(f=t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-indigo-600 shadow-lg shadow-indigo-600/20",children:t.jsx(rt,{className:"h-5 w-5 text-white"})}),y=t.jsx("h4",{className:"text-sm font-black tracking-tight text-slate-800 uppercase",children:"Marché des Devises"}),s[12]=f,s[13]=y):(f=s[12],y=s[13]);let S;s[14]!==n.length?(S=t.jsxs("div",{className:"ml-2 flex items-center gap-3",children:[f,t.jsxs("div",{children:[y,t.jsxs("p",{className:"text-[10px] font-bold tracking-widest text-slate-400 uppercase",children:[n.length," Paires Actives"]})]})]}),s[14]=n.length,s[15]=S):S=s[15];let w;s[16]!==l?(w=()=>d(!l),s[16]=l,s[17]=w):w=s[17];const M=l?"bg-slate-200 text-slate-600 hover:bg-slate-300":"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20 hover:bg-indigo-700";let b;s[18]!==M?(b=B("h-11 rounded-xl px-6 text-xs font-black tracking-widest uppercase transition-all",M),s[18]=M,s[19]=b):b=s[19];let C;s[20]!==l?(C=l?t.jsx(xt,{className:"mr-2 h-4 w-4"}):t.jsx(tt,{className:"mr-2 h-4 w-4"}),s[20]=l,s[21]=C):C=s[21];const h=l?"Fermer":"Ajouter une Paire";let U;s[22]!==w||s[23]!==b||s[24]!==C||s[25]!==h?(U=t.jsxs(P,{onClick:w,className:b,children:[C,h]}),s[22]=w,s[23]=b,s[24]=C,s[25]=h,s[26]=U):U=s[26];let q;s[27]!==S||s[28]!==U?(q=t.jsxs("div",{className:"flex items-center justify-between rounded-[1.5rem] border border-slate-100 bg-slate-100/50 p-4",children:[S,U]}),s[27]=S,s[28]=U,s[29]=q):q=s[29];let F;s[30]!==_||s[31]!==i||s[32]!==l?(F=l&&t.jsx(ye.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:t.jsxs("div",{className:"relative rounded-[2rem] bg-slate-900 p-8 text-white shadow-2xl",children:[t.jsx("div",{className:"pointer-events-none absolute top-0 right-0 h-64 w-64 bg-indigo-500/10 blur-[100px]"}),t.jsxs("h5",{className:"mb-8 flex items-center gap-3 text-xl font-black tracking-tight",children:[t.jsx(tt,{className:"h-6 w-6 text-indigo-400"}),"Nouvelle Configuration"]}),t.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-3",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(de,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Paire de devises"}),t.jsxs(St,{value:i.currency_pair,onValueChange:E=>r({...i,currency_pair:E}),children:[t.jsx(Ct,{className:"h-12 rounded-xl border-white/10 bg-white/5 font-bold text-white outline-none focus:ring-2 focus:ring-indigo-500",children:t.jsx(Dt,{placeholder:"Choisir une paire"})}),t.jsx(Mt,{className:"border-slate-800 bg-slate-900 text-white",children:Zt.map(Da)})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(de,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:["Taux d'Achat (Le client donne"," ",i.currency_pair==="CDF_USD"?"CDF":"USD",", 1"," ",i.currency_pair==="CDF_USD"?"USD":i.currency_pair.split("_")[0]||"Unité"," ","=)"]}),t.jsxs("div",{className:"relative",children:[t.jsx(Vt,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-emerald-400"}),t.jsx(ge,{type:"number",placeholder:"0.00",value:i.buy_rate,onChange:E=>r({...i,buy_rate:E.target.value}),className:"h-12 rounded-xl border-white/10 bg-white/5 pl-11 font-mono font-black text-white"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(de,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:["Taux de Vente (Le bureau donne"," ",i.currency_pair==="CDF_USD"?"CDF":"USD",", 1"," ",i.currency_pair==="CDF_USD"?"USD":i.currency_pair.split("_")[0]||"Unité"," ","=)"]}),t.jsxs("div",{className:"relative",children:[t.jsx(Ee,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-blue-400"}),t.jsx(ge,{type:"number",placeholder:"0.00",value:i.sell_rate,onChange:E=>r({...i,sell_rate:E.target.value}),className:"h-12 rounded-xl border-white/10 bg-white/5 pl-11 font-mono font-black text-white"})]})]})]}),t.jsxs("div",{className:"mt-10 flex justify-end gap-3",children:[t.jsx(P,{variant:"ghost",onClick:()=>d(!1),className:"h-12 rounded-xl px-8 text-xs font-black tracking-widest text-slate-400 uppercase hover:bg-white/5 hover:text-white",children:"Annuler"}),t.jsx(P,{onClick:()=>_.mutate(i),disabled:_.isPending||!i.currency_pair,className:"h-12 rounded-xl bg-white px-10 text-xs font-black tracking-widest text-slate-900 uppercase transition-all hover:bg-slate-100",children:_.isPending?t.jsx(ot,{className:"h-4 w-4 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Activer le Taux"]})})]})]})}),s[30]=_,s[31]=i,s[32]=l,s[33]=F):F=s[33];let T;s[34]!==F?(T=t.jsx(it,{children:F}),s[34]=F,s[35]=T):T=s[35];let I;if(s[36]!==x||s[37]!==j||s[38]!==n){let E;s[40]!==x||s[41]!==j?(E=Y=>{const N=Zt.find(L=>L.id===Y.currency_pair);return t.jsxs(ye.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"group rounded-[2rem] border-2 border-slate-50 bg-white p-8 shadow-xl shadow-slate-200/50 transition-all duration-300 hover:border-indigo-100",children:[t.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-slate-900 shadow-lg shadow-slate-900/10 transition-transform group-hover:rotate-6",children:t.jsx("span",{className:"text-sm font-black text-white",children:N?.from||Y.currency_pair.split("_")[0]})}),t.jsx(Ee,{className:"h-4 w-4 text-slate-300"}),t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl border border-indigo-100 bg-indigo-50",children:t.jsx("span",{className:"text-sm font-black text-indigo-600",children:N?.to||Y.currency_pair.split("_")[1]})})]}),t.jsx(P,{variant:"ghost",size:"icon",onClick:()=>x.mutate(Y.id),className:"h-10 w-10 rounded-xl text-slate-300 opacity-0 transition-all group-hover:opacity-100 hover:bg-rose-50 hover:text-rose-500",children:t.jsx(Ft,{className:"h-5 w-5"})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between px-1",children:[t.jsxs("span",{className:"text-[9px] font-black tracking-widest text-slate-400 uppercase",children:["Achat (1"," ",Y.currency_pair.split("_")[0]," ","=)"]}),t.jsx(Vt,{className:"h-3 w-3 text-emerald-500"})]}),t.jsx("div",{className:"relative",children:t.jsx(ge,{type:"number",value:Y.buy_rate,onChange:L=>j(Y,"buy_rate",L.target.value),className:"h-14 rounded-2xl border-transparent bg-slate-50 font-mono text-xl font-black text-slate-900 focus:border-indigo-500 focus:bg-white"})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between px-1",children:[t.jsxs("span",{className:"text-[9px] font-black tracking-widest text-slate-400 uppercase",children:["Vente (1"," ",Y.currency_pair.split("_")[0]," ","=)"]}),t.jsx(Ee,{className:"h-3 w-3 text-blue-500"})]}),t.jsx("div",{className:"relative",children:t.jsx(ge,{type:"number",value:Y.sell_rate,onChange:L=>j(Y,"sell_rate",L.target.value),className:"h-14 rounded-2xl border-transparent bg-slate-50 font-mono text-xl font-black text-slate-900 focus:border-indigo-500 focus:bg-white"})})]})]})]},Y.id)},s[40]=x,s[41]=j,s[42]=E):E=s[42],I=n.map(E),s[36]=x,s[37]=j,s[38]=n,s[39]=I}else I=s[39];let R;s[43]!==k||s[44]!==n.length?(R=n.length===0&&!k&&t.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center rounded-[3rem] border-2 border-dashed border-slate-200 bg-slate-50/50 py-20",children:[t.jsx(rt,{className:"mb-4 h-16 w-16 text-slate-200"}),t.jsx("p",{className:"text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:"Aucun taux configuré"})]}),s[43]=k,s[44]=n.length,s[45]=R):R=s[45];let K;s[46]!==I||s[47]!==R?(K=t.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-2",children:[I,R]}),s[46]=I,s[47]=R,s[48]=K):K=s[48];let O;s[49]!==k?(O=k&&t.jsx("div",{className:"flex justify-center p-20",children:t.jsx(ds,{className:"h-10 w-10 animate-spin text-indigo-600"})}),s[49]=k,s[50]=O):O=s[50];let z;return s[51]!==q||s[52]!==T||s[53]!==K||s[54]!==O?(z=t.jsxs("div",{className:"space-y-8",children:[q,T,K,O]}),s[51]=q,s[52]=T,s[53]=K,s[54]=O,s[55]=z):z=s[55],z}function Da(s){return t.jsx(De,{value:s.id,className:"hover:bg-slate-800 focus:bg-slate-800",children:s.label},s.id)}async function Ma(s){await W.entities.ExchangeRate.delete(s)}function Fa(){return V.error("Erreur lors de la création du taux")}async function Aa(s){await W.entities.ExchangeRate.create({...s,buy_rate:parseFloat(s.buy_rate),sell_rate:parseFloat(s.sell_rate),is_active:!0})}async function qa(s){const{id:e,data:a}=s;await W.entities.ExchangeRate.update(e,a)}function $a(){return W.entities.ExchangeRate.filter({is_active:!0})}const Ua=["USD","CDF","EUR"];function Ra(s){const e=ne.c(43),{isOpen:a,onClose:i,onConfirm:r,shopName:l,isLoading:d}=s;let m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m={USD:"0",CDF:"0",EUR:"0"},e[0]=m):m=e[0];const[c,k]=G.useState(m),[u,n]=G.useState("");let p;e[1]!==c||e[2]!==u||e[3]!==r?(p=R=>{R.preventDefault(),r({notes:u,globalAmounts:c})},e[1]=c,e[2]=u,e[3]=r,e[4]=p):p=e[4];const g=p;let v;e[5]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx(Lt,{className:"h-6 w-6 text-indigo-600"}),e[5]=v):v=e[5];let _;e[6]!==l?(_=t.jsxs(ss,{className:"flex items-center gap-2 text-2xl font-black",children:[v,"Ouvrir la Boutique : ",l]}),e[6]=l,e[7]=_):_=e[7];let A;e[8]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx(Ns,{children:"Initialisez la session de travail et le fond de caisse global."}),e[8]=A):A=e[8];let x;e[9]!==_?(x=t.jsxs(as,{children:[_,A]}),e[9]=_,e[10]=x):x=e[10];let D;e[11]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx(de,{htmlFor:"notes",className:"font-bold text-slate-700",children:"Note d'ouverture"}),e[11]=D):D=e[11];let j;e[12]===Symbol.for("react.memo_cache_sentinel")?(j=R=>n(R.target.value),e[12]=j):j=e[12];let f;e[13]!==u?(f=t.jsxs("div",{className:"space-y-2",children:[D,t.jsx(Ds,{id:"notes",value:u,onChange:j,placeholder:"Ex: Équipe du jour...",className:"rounded-xl bg-slate-50"})]}),e[13]=u,e[14]=f):f=e[14];let y;e[15]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsxs("h4",{className:"flex items-center gap-2 text-lg font-black text-slate-900",children:[t.jsx(Ms,{className:"h-5 w-5 text-emerald-600"}),"Fond de Caisse (Global)"]}),e[15]=y):y=e[15];let S;e[16]!==c?(S=Ua.map(R=>t.jsxs("div",{className:"space-y-1",children:[t.jsx(de,{className:"text-xs font-bold text-slate-400",children:R}),t.jsx(ge,{type:"number",min:"0",value:c[R],onChange:K=>k(O=>({...O,[R]:K.target.value})),className:"h-9 text-sm font-bold"})]},R)),e[16]=c,e[17]=S):S=e[17];let w;e[18]!==S?(w=t.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:t.jsx("div",{className:"grid grid-cols-3 gap-3",children:S})}),e[18]=S,e[19]=w):w=e[19];let M;e[20]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx("p",{className:"text-xs text-slate-500",children:"Ce montant sera disponible pour tous les guichets de la boutique."}),e[20]=M):M=e[20];let b;e[21]!==w?(b=t.jsxs("div",{className:"space-y-4",children:[y,w,M]}),e[21]=w,e[22]=b):b=e[22];let C;e[23]!==i?(C=t.jsx(P,{type:"button",variant:"outline",onClick:i,children:"Annuler"}),e[23]=i,e[24]=C):C=e[24];const h=d?"Ouverture...":"Ouvrir la Session";let U;e[25]!==d||e[26]!==h?(U=t.jsx(P,{type:"submit",disabled:d,className:"bg-indigo-600 font-bold hover:bg-indigo-700",children:h}),e[25]=d,e[26]=h,e[27]=U):U=e[27];let q;e[28]!==C||e[29]!==U?(q=t.jsxs(ws,{children:[C,U]}),e[28]=C,e[29]=U,e[30]=q):q=e[30];let F;e[31]!==g||e[32]!==b||e[33]!==q||e[34]!==f?(F=t.jsxs("form",{onSubmit:g,className:"space-y-6 py-4",children:[f,b,q]}),e[31]=g,e[32]=b,e[33]=q,e[34]=f,e[35]=F):F=e[35];let T;e[36]!==F||e[37]!==x?(T=t.jsxs(ls,{className:"sm:max-w-[500px]",children:[x,F]}),e[36]=F,e[37]=x,e[38]=T):T=e[38];let I;return e[39]!==a||e[40]!==i||e[41]!==T?(I=t.jsx(is,{open:a,onOpenChange:i,children:T}),e[39]=a,e[40]=i,e[41]=T,e[42]=I):I=e[42],I}function Ea(){const s=dt(),[e,a]=G.useState("grid"),[i,r]=G.useState(null),[l,d]=G.useState(!1),[m,c]=G.useState(!1),[k,u]=G.useState(!1),[n,p]=G.useState(1),[g,v]=G.useState("all"),[_,A]=G.useState(""),[x,D]=G.useState(null),[j,f]=G.useState(""),{data:y=[]}=je({queryKey:["manager-shops"],queryFn:()=>W.entities.Shop.list()});ms.useEffect(()=>{y.length>0&&!x&&D(y[0].id)},[y,x]);const{data:S,isLoading:w}=je({queryKey:["sessions",x,n,g,_],queryFn:()=>W.entities.Session.list({shop_id:x?.toString(),status:g==="all"?void 0:g,date:_||void 0,page:n.toString()}),enabled:!!x}),{data:M}=je({queryKey:["counters",x],queryFn:()=>W.entities.Counter.list(x),enabled:!!x}),b=S?.data||[],C=S,{data:h,isLoading:U}=je({queryKey:["session-report",i],queryFn:()=>W.entities.Session.report(i),enabled:!!i}),q=b.find(N=>N.status==="open"),[F,T]=G.useState(!1),{data:I}=je({queryKey:["registers",x],queryFn:()=>Ut.get(`/api/cash/registers?shop_id=${x}`).then(N=>N.data),enabled:!!x&&F}),R=async N=>{if(x){d(!0);try{await W.entities.Session.create({session_date:Z().format("YYYY-MM-DD"),shop_id:x,notes:N.notes});let L=I?.[0]?.id;if(!L)try{V.info("Configuration automatique de la caisse principale..."),L=(await Ut.post("/api/cash/registers",{shop_id:x,name:"Caisse Principale"})).data.id,V.success("Caisse principale créée avec succès"),s.invalidateQueries({queryKey:["registers",x]})}catch(H){console.error("Failed to auto-create register",H),V.error("Impossible de créer la caisse automatique.")}if(L)try{await Ut.post("/api/cash/sessions",{cash_register_id:L,opening_amounts:N.globalAmounts,notes:"Session Caisse Globale"}),V.success("Session ouverte avec succès (Globale)")}catch(H){console.error("Failed to open global cash session",H),V.error("Erreur ouverture caisse globale")}else V.warning("Attention: Aucune caisse n’a pu être configurée. Seule la session administrative est ouverte.");s.invalidateQueries({queryKey:["sessions"]}),T(!1),f("")}catch(L){const H=L.response?.data?.error||L.response?.data?.message||"Erreur lors de l’ouverture";V.error(H)}finally{d(!1)}}},K=async N=>{c(!0);try{await W.entities.Session.close(N),V.success("Session fermée avec succès"),s.invalidateQueries({queryKey:["sessions"]})}catch(L){const H=L.response?.data?.error||L.response?.data?.message||"Erreur lors de la fermeture";V.error(H)}finally{c(!1)}},O=async N=>{try{await W.entities.Session.reopen(N),V.success("Session réouverte avec succès"),s.invalidateQueries({queryKey:["sessions"]})}catch(L){const H=L.response?.data?.error||L.response?.data?.message||"Erreur lors de la réouverture de la session";V.error(H)}},z=y.find(N=>N.id===x),{auth:E}=It().props,Y=E.user;return t.jsxs("div",{className:"animate-in space-y-8 pb-10 font-sans duration-500 fade-in slide-in-from-bottom-4",children:[t.jsxs("div",{className:"flex flex-col justify-between gap-6 md:flex-row md:items-center",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-3xl font-black tracking-tighter text-slate-900 uppercase",children:["Console"," ",t.jsx("span",{className:"text-indigo-600",children:"Sessions"})]}),t.jsx("p",{className:"mt-1 text-sm font-medium text-slate-400",children:"Pilotez l'activité journalière de vos guichets."})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[y.length>1&&t.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border border-slate-200 bg-white p-1 shadow-sm",children:[t.jsx("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-2",children:t.jsx(Lt,{className:"h-4 w-4 text-slate-500"})}),t.jsx("select",{className:"cursor-pointer border-none bg-transparent pr-10 text-sm font-black text-slate-700 uppercase focus:ring-0",value:x||"",onChange:N=>D(Number(N.target.value)),children:y.map(N=>t.jsx("option",{value:N.id,children:N.name},N.id))})]}),t.jsxs("div",{className:"flex rounded-2xl border border-slate-200 bg-slate-100 p-1 shadow-inner",children:[t.jsxs("button",{onClick:()=>a("grid"),className:B("flex items-center gap-2 rounded-xl p-2 px-4 text-[10px] font-black tracking-widest uppercase transition-all duration-300",e==="grid"?"bg-white text-indigo-600 shadow-md":"text-slate-400 hover:text-slate-600"),children:[t.jsx(Bs,{className:"h-4 w-4"})," Grille"]}),t.jsxs("button",{onClick:()=>a("list"),className:B("flex items-center gap-2 rounded-xl p-2 px-4 text-[10px] font-black tracking-widest uppercase transition-all duration-300",e==="list"?"bg-white text-indigo-600 shadow-md":"text-slate-400 hover:text-slate-600"),children:[t.jsx(Qs,{className:"h-4 w-4"})," Liste"]})]})]})]}),t.jsxs(Re,{className:"relative overflow-hidden rounded-[3rem] border-none bg-white shadow-2xl",children:[t.jsx("div",{className:B("absolute inset-0 z-0 opacity-[0.04]",q?"bg-emerald-500":"bg-indigo-600")}),t.jsx(et,{className:"relative z-10 p-10",children:q?t.jsxs("div",{className:"flex flex-col items-center justify-between gap-12 lg:flex-row",children:[t.jsx("div",{className:"flex-1 space-y-8",children:t.jsxs("div",{className:"inline-flex items-center gap-6 rounded-[2.5rem] border border-slate-100 bg-slate-50 p-8 shadow-sm",children:[t.jsx("div",{className:"rounded-3xl bg-emerald-500 p-5 shadow-xl shadow-emerald-500/30",children:t.jsx(Fs,{className:"h-10 w-10 text-white"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[t.jsx("span",{className:"rounded-full bg-emerald-100 px-3 py-1 text-[9px] font-bold tracking-tighter text-emerald-600 uppercase",children:"Session Active"}),t.jsxs("span",{className:"text-[9px] font-bold tracking-widest text-slate-400 uppercase",children:["• ",z?.name]})]}),t.jsx("div",{className:"text-4xl font-black tracking-tighter text-slate-900",children:Z(q.session_date).format("DD MMMM YYYY")}),t.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm font-bold text-slate-400",children:[t.jsxs("span",{className:"flex items-center gap-1.5",children:[t.jsx(Te,{className:"h-4 w-4 text-indigo-500"})," ",Z(q.opened_at).format("HH:mm")]}),t.jsx("span",{className:"h-4 w-[1px] bg-slate-200"}),t.jsxs("span",{className:"flex items-center gap-1.5",children:[t.jsx(_t,{className:"h-4 w-4 text-indigo-500"})," ",q.opened_by," ","(Opérateur)"]})]})]})]})}),t.jsxs("div",{className:"flex w-full flex-col items-center gap-4 lg:w-96",children:[t.jsxs(P,{onClick:()=>K(q.id),disabled:m,className:"flex h-24 w-full flex-col items-center justify-center gap-2 rounded-[2.5rem] bg-slate-900 text-sm font-black tracking-widest text-white uppercase shadow-2xl transition-all hover:bg-black active:scale-95",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Kt,{className:B("h-7 w-7 text-red-500",m&&"animate-pulse")}),"Fermer la Boutique"]}),t.jsx("span",{className:"text-[9px] font-bold opacity-40",children:"Arrêter le flux de transactions"})]}),t.jsxs("div",{className:"flex w-full gap-4",children:[t.jsxs(P,{variant:"outline",onClick:()=>u(!0),className:"h-14 flex-1 rounded-2xl border-slate-200 bg-white font-black tracking-widest text-slate-900 uppercase shadow-sm transition-all hover:border-indigo-500 hover:text-indigo-600",children:[t.jsx(rt,{className:"mr-2 h-4 w-4 text-indigo-500"}),"Ajustement"]}),t.jsxs(P,{variant:"outline",onClick:()=>r(q.id),className:"h-14 flex-1 rounded-2xl border-slate-200 bg-white font-black tracking-widest text-slate-900 uppercase shadow-sm transition-all hover:border-indigo-500 hover:text-indigo-600",children:[t.jsx(Ot,{className:"mr-2 h-4 w-4 text-indigo-500"}),"Stats"]})]})]})]}):t.jsxs("div",{className:"flex flex-col items-center justify-between gap-12 lg:flex-row",children:[t.jsxs("div",{className:"flex-1 space-y-8",children:[t.jsxs("div",{className:"flex items-start gap-6",children:[t.jsx("div",{className:"rounded-[2rem] border border-slate-100 bg-slate-50 p-6",children:t.jsx(As,{className:"h-10 w-10 text-slate-300"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"mb-2 text-3xl font-black tracking-tight text-slate-900",children:"Prêt pour l'ouverture ?"}),t.jsxs("p",{className:"max-w-lg leading-relaxed font-medium text-slate-500",children:["Aucune session n'est ouverte pour"," ",t.jsx("span",{className:"font-bold text-indigo-600",children:z?.name})," ","aujourd'hui. Ouvrez une session pour autoriser les caissiers à traiter les tickets."]})]})]}),t.jsxs("div",{className:"max-w-xl space-y-4",children:[t.jsx(de,{className:"ml-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Commentaire d'ouverture"}),t.jsx(ge,{value:j,onChange:N=>f(N.target.value),placeholder:"Ex: Fond de caisse, équipe du jour...",className:"h-16 rounded-3xl border-slate-200 bg-slate-50 px-8 font-bold text-slate-700 transition-colors focus:bg-white"})]})]}),t.jsxs("div",{className:"group relative w-full overflow-hidden rounded-[3rem] bg-indigo-600 p-8 text-white shadow-2xl shadow-indigo-600/20 lg:w-96",children:[t.jsx("div",{className:"absolute top-0 right-0 h-40 w-40 translate-x-1/2 -translate-y-1/2 bg-white/10 blur-[60px]"}),t.jsxs("div",{className:"relative z-10 space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"rounded-2xl bg-white/20 p-4",children:t.jsx(qt,{className:"h-8 w-8 text-white"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-[10px] leading-none font-black tracking-widest uppercase opacity-60",children:"Session du"}),t.jsx("div",{className:"text-2xl font-black",children:Z().format("DD/MM/YYYY")})]})]}),t.jsxs(P,{onClick:()=>T(!0),disabled:l||!x,className:"flex h-20 w-full items-center justify-center gap-3 rounded-[2rem] bg-white text-xs font-black tracking-[0.2em] text-indigo-600 uppercase shadow-xl transition-all hover:bg-slate-50 active:scale-95",children:[l?t.jsx(Te,{className:"h-5 w-5 animate-spin"}):t.jsx($t,{className:"h-5 w-5 fill-indigo-600"}),"Ouvrir Session"]}),t.jsx("p",{className:"text-center text-[9px] font-black tracking-widest uppercase opacity-60",children:"Active le terminal client immédiatement"})]})]})]})}),t.jsx(Ra,{isOpen:F,onClose:()=>T(!1),onConfirm:R,shopName:z?.name||"Boutique",counters:M||[],isLoading:l})]}),t.jsxs("div",{className:"space-y-8 pt-10",children:[t.jsxs("div",{className:"flex flex-col items-end justify-between gap-6 border-b border-slate-100 pb-8 lg:flex-row",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-12 w-1.5 rounded-full bg-indigo-500 shadow-[0_0_15px_rgba(79,70,229,0.5)]"}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-2xl font-black tracking-tight text-slate-900 uppercase",children:"Registre Historique"}),t.jsxs("p",{className:"mt-0.5 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:[C?.total||0," sessions enregistrées au total"]})]})]}),t.jsxs("div",{className:"flex w-full flex-wrap items-center gap-4 lg:w-auto",children:[t.jsxs("div",{className:"flex h-14 flex-1 items-center gap-3 rounded-2xl border border-slate-200 bg-white px-4 shadow-sm transition-all focus-within:border-indigo-500 lg:min-w-[200px] lg:flex-none",children:[t.jsx(At,{className:"h-4 w-4 text-slate-400"}),t.jsx("input",{type:"date",value:_,onChange:N=>{A(N.target.value),p(1)},className:"w-full border-none bg-transparent text-xs font-bold text-slate-600 focus:ring-0"})]}),t.jsxs("div",{className:"flex h-14 flex-1 items-center gap-3 rounded-2xl border border-slate-200 bg-white px-4 shadow-sm transition-all focus-within:border-indigo-500 lg:min-w-[200px] lg:flex-none",children:[t.jsx(Hs,{className:"h-4 w-4 text-slate-400"}),t.jsxs("select",{value:g,onChange:N=>{v(N.target.value),p(1)},className:"w-full border-none bg-transparent text-xs font-bold text-slate-600 uppercase focus:ring-0",children:[t.jsx("option",{value:"all",children:"Tous les Statuts"}),t.jsx("option",{value:"open",children:"En Cours"}),t.jsx("option",{value:"closed",children:"Clôturées"})]})]}),(_||g!=="all")&&t.jsx(P,{variant:"ghost",size:"icon",onClick:()=>{A(""),v("all")},className:"h-14 w-14 rounded-2xl text-red-500 hover:bg-red-50 hover:text-red-600",children:t.jsx(xt,{className:"h-5 w-5"})})]})]}),t.jsx(it,{mode:"wait",children:w?t.jsxs(ye.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex h-96 flex-col items-center justify-center space-y-6",children:[t.jsx("div",{className:"h-16 w-16 animate-spin rounded-full border-4 border-indigo-100 border-t-indigo-600"}),t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-400 uppercase",children:"Chargement du registre..."})]},"loading"):b.length===0?t.jsxs(ye.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0},className:"flex h-96 flex-col items-center justify-center space-y-4 rounded-[3rem] border-2 border-dashed border-slate-100",children:[t.jsx("div",{className:"rounded-full bg-slate-50 p-6 text-slate-300",children:t.jsx(At,{className:"h-12 w-12"})}),t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-400 uppercase",children:"Aucune session trouvée"})]},"empty"):t.jsx(ye.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},children:e==="grid"?t.jsx("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3",children:b.map(N=>t.jsx(Ta,{session:N,userRole:Y?.role,onView:()=>r(N.id),onClose:()=>K(N.id),onReopen:()=>O(N.id)},N.id))}):t.jsx(Ia,{sessions:b,userRole:Y?.role,onView:N=>r(N),onClose:N=>K(N),onReopen:N=>O(N)})},e)}),C&&C.last_page>1&&t.jsxs("div",{className:"mt-12 flex items-center justify-center gap-4 self-center rounded-3xl border border-white bg-white/50 p-4 backdrop-blur-sm",children:[t.jsx(P,{variant:"ghost",disabled:n===1,onClick:()=>p(n-1),className:"h-12 w-12 rounded-2xl border border-slate-100 hover:bg-white",children:t.jsx(Ss,{className:"h-5 w-5"})}),t.jsxs("div",{className:"flex items-center gap-2",children:[Array.from({length:Math.min(C.last_page,5)}).map((N,L)=>{const H=L+1;return t.jsx("button",{onClick:()=>p(H),className:B("h-12 w-12 rounded-2xl text-xs font-black transition-all",n===H?"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20":"text-slate-400 hover:bg-white hover:text-slate-600"),children:H},H)}),C.last_page>5&&t.jsx("span",{className:"mx-2 text-slate-300",children:"•••"})]}),t.jsx(P,{variant:"ghost",disabled:n===C.last_page,onClick:()=>p(n+1),className:"h-12 w-12 rounded-2xl border border-slate-100 hover:bg-white",children:t.jsx(Pt,{className:"h-5 w-5"})})]})]}),t.jsx(it,{children:i&&h&&t.jsx(La,{session:h?.session,stats:h?.statistics,clients:h?.clients,transactions:h?.transactions,activities:h?.activities,loading:U,onClose:()=>r(null)})})]})}function Ta(s){const e=ne.c(61),{session:a,userRole:i,onView:r,onClose:l,onReopen:d}=s;let m;e[0]!==a.session_date?(m=Z(a.session_date).isSame(Z(),"day"),e[0]=a.session_date,e[1]=m):m=e[1];const c=m,k=a.status==="open"?"animate-pulse bg-emerald-500":"bg-slate-200";let u;e[2]!==k?(u=B("absolute top-0 right-0 h-2 w-full",k),e[2]=k,e[3]=u):u=e[3];let n;e[4]!==u?(n=t.jsx("div",{className:u}),e[4]=u,e[5]=n):n=e[5];let p;e[6]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsx("div",{className:"rounded-2xl bg-slate-50 p-4 transition-colors duration-500 group-hover:bg-indigo-50",children:t.jsx(qt,{className:"h-7 w-7 text-slate-400 group-hover:text-indigo-500"})}),e[6]=p):p=e[6];const g=a.status==="open"?"border border-emerald-500/20 bg-emerald-500/10 text-emerald-600":"border border-slate-200 bg-slate-100 text-slate-500";let v;e[7]!==g?(v=B("flex items-center gap-1.5 rounded-full px-4 py-1.5 text-[10px] font-black tracking-widest uppercase",g),e[7]=g,e[8]=v):v=e[8];let _;e[9]!==a.status?(_=a.status==="open"?t.jsx("div",{className:"h-1.5 w-1.5 animate-ping rounded-full bg-emerald-500"}):null,e[9]=a.status,e[10]=_):_=e[10];const A=a.status==="open"?"En cours":"Terminé";let x;e[11]!==v||e[12]!==_||e[13]!==A?(x=t.jsxs("div",{className:"mb-8 flex items-start justify-between",children:[p,t.jsxs("div",{className:v,children:[_,A]})]}),e[11]=v,e[12]=_,e[13]=A,e[14]=x):x=e[14];let D;e[15]!==a.session_date?(D=Z(a.session_date).format("DD MMMM YYYY"),e[15]=a.session_date,e[16]=D):D=e[16];let j;e[17]!==D?(j=t.jsx("div",{className:"mb-1 text-2xl font-black tracking-tight text-slate-900",children:D}),e[17]=D,e[18]=j):j=e[18];let f;e[19]!==c?(f=c&&t.jsx("p",{className:"text-[10px] leading-none font-black tracking-widest text-indigo-500 uppercase",children:"Aujourd'hui"}),e[19]=c,e[20]=f):f=e[20];let y;e[21]!==j||e[22]!==f?(y=t.jsxs("div",{children:[j,f]}),e[21]=j,e[22]=f,e[23]=y):y=e[23];let S;e[24]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx("span",{className:"text-[9px] font-black tracking-[0.2em] uppercase opacity-60",children:"Ouverture"}),e[24]=S):S=e[24];let w;e[25]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsx(Te,{className:"h-3 w-3"}),e[25]=w):w=e[25];let M;e[26]!==a.opened_at?(M=Z(a.opened_at).format("HH:mm"),e[26]=a.opened_at,e[27]=M):M=e[27];let b;e[28]!==M?(b=t.jsxs("div",{className:"flex flex-col gap-1",children:[S,t.jsxs("span",{className:"flex items-center gap-1.5 text-slate-700",children:[w,M]})]}),e[28]=M,e[29]=b):b=e[29];let C;e[30]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx("div",{className:"h-8 w-[1px] bg-slate-200"}),e[30]=C):C=e[30];let h;e[31]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx("span",{className:"text-[9px] font-black tracking-[0.2em] uppercase opacity-60",children:"Clôture"}),e[31]=h):h=e[31];let U;e[32]!==a.closed_at?(U=a.closed_at?t.jsxs(t.Fragment,{children:[t.jsx(Te,{className:"h-3 w-3"}),Z(a.closed_at).format("HH:mm")]}):"--:--",e[32]=a.closed_at,e[33]=U):U=e[33];let q;e[34]!==U?(q=t.jsxs("div",{className:"flex flex-col items-end gap-1",children:[h,t.jsx("span",{className:"flex items-center gap-1.5 text-slate-700",children:U})]}),e[34]=U,e[35]=q):q=e[35];let F;e[36]!==b||e[37]!==q?(F=t.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-50 bg-slate-50/50 p-4 text-xs font-bold text-slate-400",children:[b,C,q]}),e[36]=b,e[37]=q,e[38]=F):F=e[38];let T;e[39]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx(Ot,{className:"mr-2 h-4 w-4"}),e[39]=T):T=e[39];let I;e[40]!==r?(I=t.jsxs(P,{onClick:r,className:"h-14 flex-1 rounded-2xl bg-indigo-600 text-[10px] font-black tracking-widest text-white uppercase shadow-lg shadow-indigo-600/20 transition-all hover:scale-105 hover:bg-indigo-700 active:scale-95",children:[T," Rapport"]}),e[40]=r,e[41]=I):I=e[41];let R;e[42]!==l||e[43]!==a.status?(R=a.status==="open"&&t.jsx(P,{onClick:l,variant:"outline",className:"h-14 w-14 rounded-2xl border-slate-200 text-red-500 transition-all hover:border-red-100 hover:bg-red-50 active:scale-95",children:t.jsx(Kt,{className:"h-5 w-5"})}),e[42]=l,e[43]=a.status,e[44]=R):R=e[44];let K;e[45]!==d||e[46]!==a.status||e[47]!==i?(K=a.status==="closed"&&i==="super-admin"&&t.jsx(P,{onClick:d,variant:"outline",className:"h-14 w-14 rounded-2xl border-indigo-200 text-indigo-500 transition-all hover:bg-indigo-50 active:scale-95",title:"Réouvrir la session",children:t.jsx($t,{className:"h-5 w-5"})}),e[45]=d,e[46]=a.status,e[47]=i,e[48]=K):K=e[48];let O;e[49]!==I||e[50]!==R||e[51]!==K?(O=t.jsxs("div",{className:"flex gap-3 pt-4",children:[I,R,K]}),e[49]=I,e[50]=R,e[51]=K,e[52]=O):O=e[52];let z;e[53]!==y||e[54]!==F||e[55]!==O?(z=t.jsxs("div",{className:"space-y-6",children:[y,F,O]}),e[53]=y,e[54]=F,e[55]=O,e[56]=z):z=e[56];let E;return e[57]!==x||e[58]!==z||e[59]!==n?(E=t.jsxs(Re,{className:"group hover:shadow-3xl relative overflow-hidden rounded-[2.5rem] border border-none border-transparent bg-white p-8 shadow-xl shadow-slate-200/50 transition-all duration-500 hover:-translate-y-2 hover:border-indigo-100",children:[n,x,z]}),e[57]=x,e[58]=z,e[59]=n,e[60]=E):E=e[60],E}function Ia(s){const e=ne.c(14),{sessions:a,userRole:i,onView:r,onClose:l,onReopen:d}=s;let m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("thead",{children:t.jsxs("tr",{className:"bg-slate-50/80 backdrop-blur-md",children:[t.jsx("th",{className:"p-8 text-[11px] font-black tracking-widest text-slate-400 uppercase first:rounded-tl-[2.5rem]",children:"Date"}),t.jsx("th",{className:"p-8 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Boutique / Guichet"}),t.jsx("th",{className:"p-8 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Statut"}),t.jsx("th",{className:"p-8 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Horaire"}),t.jsx("th",{className:"p-8 text-right text-[11px] font-black tracking-widest text-slate-400 uppercase last:rounded-tr-[2.5rem]",children:"Actions"})]})}),e[0]=m):m=e[0];let c;if(e[1]!==l||e[2]!==d||e[3]!==r||e[4]!==a||e[5]!==i){let u;e[7]!==l||e[8]!==d||e[9]!==r||e[10]!==i?(u=n=>t.jsxs("tr",{className:"group transition-colors hover:bg-slate-50/50",children:[t.jsx("td",{className:"p-8 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-slate-100 text-slate-400 transition-colors group-hover:bg-indigo-100 group-hover:text-indigo-600",children:t.jsx(qt,{className:"h-5 w-5"})}),t.jsx("span",{className:"text-sm font-black tracking-tight text-slate-700",children:Z(n.session_date).format("DD/MM/YYYY")})]})}),t.jsx("td",{className:"p-8",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-xs font-bold text-slate-700",children:n.shop?.name||"Agence Centrale"}),t.jsxs("span",{className:"mt-0.5 text-[10px] font-bold tracking-widest text-slate-400 uppercase",children:["ID: ",n.shop_id]})]})}),t.jsx("td",{className:"p-8",children:t.jsx("span",{className:B("rounded-full px-4 py-1.5 text-[9px] font-black tracking-widest uppercase",n.status==="open"?"border border-emerald-100 bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-400"),children:n.status==="open"?"En Cours":"Clôturé"})}),t.jsx("td",{className:"p-8",children:t.jsxs("div",{className:"flex items-center gap-4 text-xs font-bold text-slate-400",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"mb-0.5 text-[9px] uppercase opacity-50",children:"Ouvert"}),t.jsx("span",{className:"text-slate-600",children:Z(n.opened_at).format("HH:mm")})]}),t.jsx(rt,{className:"h-3 w-3 opacity-20"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"mb-0.5 text-[9px] uppercase opacity-50",children:"Fermé"}),t.jsx("span",{className:"text-slate-600",children:n.closed_at?Z(n.closed_at).format("HH:mm"):"--:--"})]})]})}),t.jsx("td",{className:"p-8 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsxs(P,{onClick:()=>r(n.id),className:"h-10 rounded-xl bg-indigo-50 px-4 text-[10px] font-black tracking-widest text-indigo-600 uppercase shadow-none transition-all hover:bg-indigo-600 hover:text-white",children:[t.jsx(Ot,{className:"mr-2 h-3.5 w-3.5"})," ","Rapport"]}),n.status==="open"&&t.jsx(P,{onClick:()=>l(n.id),size:"icon",className:"h-10 w-10 rounded-xl bg-red-50 text-red-500 shadow-none transition-all hover:bg-red-500 hover:text-white",children:t.jsx(Kt,{className:"h-4 w-4"})}),n.status==="closed"&&i==="super-admin"&&t.jsx(P,{onClick:()=>d(n.id),size:"icon",className:"h-10 w-10 rounded-xl bg-indigo-50 text-indigo-500 shadow-none transition-all hover:bg-indigo-500 hover:text-white",title:"Réouvrir la session",children:t.jsx($t,{className:"h-4 w-4"})})]})})]},n.id),e[7]=l,e[8]=d,e[9]=r,e[10]=i,e[11]=u):u=e[11],c=a.map(u),e[1]=l,e[2]=d,e[3]=r,e[4]=a,e[5]=i,e[6]=c}else c=e[6];let k;return e[12]!==c?(k=t.jsx("div",{className:"w-full overflow-hidden rounded-[2.5rem] border border-slate-100 bg-white shadow-xl shadow-slate-200/30",children:t.jsxs("table",{className:"w-full border-collapse text-left",children:[m,t.jsx("tbody",{className:"divide-y divide-slate-100",children:c})]})}),e[12]=c,e[13]=k):k=e[13],k}function La(s){const e=ne.c(47),{session:a,stats:i,transactions:r,loading:l,onClose:d}=s;let m,c,k;e[0]===Symbol.for("react.memo_cache_sentinel")?(m={opacity:0},c={opacity:1},k={opacity:0},e[0]=m,e[1]=c,e[2]=k):(m=e[0],c=e[1],k=e[2]);let u;e[3]!==d?(u=t.jsx(ye.div,{initial:m,animate:c,exit:k,onClick:d,className:"absolute inset-0 bg-slate-900/60 backdrop-blur-xl"}),e[3]=d,e[4]=u):u=e[4];let n,p,g;e[5]===Symbol.for("react.memo_cache_sentinel")?(n={opacity:0,scale:.9,y:30},p={opacity:1,scale:1,y:0},g={opacity:0,scale:.9,y:30},e[5]=n,e[6]=p,e[7]=g):(n=e[5],p=e[6],g=e[7]);let v;e[8]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx("div",{className:"rounded-[2rem] bg-indigo-600 p-5 shadow-xl shadow-indigo-600/30",children:t.jsx(Ee,{className:"h-10 w-10 text-white"})}),e[8]=v):v=e[8];let _;e[9]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx("h3",{className:"text-3xl font-black tracking-tighter text-slate-900 uppercase",children:"Rapport de Session"}),e[9]=_):_=e[9];const A=a?.status==="open"?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500";let x;e[10]!==A?(x=B("rounded-full px-4 py-1.5 text-[10px] font-black tracking-widest uppercase",A),e[10]=A,e[11]=x):x=e[11];const D=a?.status==="open"?"Live":"Archivé";let j;e[12]!==x||e[13]!==D?(j=t.jsxs("div",{className:"mb-1 flex items-center gap-3",children:[_,t.jsx("span",{className:x,children:D})]}),e[12]=x,e[13]=D,e[14]=j):j=e[14];let f;e[15]!==a?(f=a?Z(a.session_date).format("dddd DD MMMM YYYY"):"Chargement...",e[15]=a,e[16]=f):f=e[16];const y=a?.shop?.name;let S;e[17]!==f||e[18]!==y?(S=t.jsxs("p",{className:"text-sm font-bold text-slate-400",children:[f," ","• Guichet ",y]}),e[17]=f,e[18]=y,e[19]=S):S=e[19];let w;e[20]!==j||e[21]!==S?(w=t.jsxs("div",{className:"flex items-center gap-6",children:[v,t.jsxs("div",{children:[j,S]})]}),e[20]=j,e[21]=S,e[22]=w):w=e[22];let M;e[23]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx(xt,{className:"h-8 w-8"}),e[23]=M):M=e[23];let b;e[24]!==d?(b=t.jsx(P,{onClick:d,variant:"ghost",className:"h-16 w-16 rounded-[2rem] bg-slate-50 text-slate-400 transition-all hover:bg-red-50 hover:text-red-500",children:M}),e[24]=d,e[25]=b):b=e[25];let C;e[26]!==w||e[27]!==b?(C=t.jsxs("div",{className:"flex shrink-0 items-center justify-between border-b border-slate-100 bg-white p-8 md:p-12",children:[w,b]}),e[26]=w,e[27]=b,e[28]=C):C=e[28];let h;e[29]!==l||e[30]!==i?.cashier_stats||e[31]!==i?.total_clients||e[32]!==i?.total_transactions||e[33]!==i?.volume_cdf||e[34]!==i?.volume_usd||e[35]!==r?(h=t.jsx("div",{className:"flex-1 space-y-12 overflow-y-auto p-8 md:p-12",children:l?t.jsxs("div",{className:"flex h-96 flex-col items-center justify-center space-y-6",children:[t.jsx("div",{className:"h-20 w-20 animate-spin rounded-full border-4 border-indigo-100 border-t-indigo-600"}),t.jsx("p",{className:"animate-pulse text-sm font-black tracking-widest text-slate-400 uppercase",children:"Synthèse des données..."})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-4",children:[t.jsx(yt,{title:"Clients",value:i?.total_clients,icon:_t,color:"blue"}),t.jsx(yt,{title:"Transactions",value:i?.total_transactions,icon:rt,color:"emerald"}),t.jsx(yt,{title:"Volume USD",value:`$ ${i?.volume_usd?.toLocaleString()}`,icon:Ee,color:"indigo"}),t.jsx(yt,{title:"Volume CDF",value:`${i?.volume_cdf?.toLocaleString()} FC`,icon:ct,color:"amber"})]}),t.jsxs("div",{className:"space-y-12",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-10 w-1 rounded-full bg-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.5)]"}),t.jsx("h5",{className:"text-xl font-black tracking-tight text-slate-900 uppercase",children:"Flux Financier"})]}),t.jsx("div",{className:"overflow-hidden rounded-[2.5rem] border border-slate-100 bg-white shadow-xl shadow-slate-200/20",children:t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-slate-50/50",children:[t.jsx("th",{className:"p-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Heure"}),t.jsx("th",{className:"p-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Opération"}),t.jsx("th",{className:"p-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Montant Envoyé"}),t.jsx("th",{className:"p-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Montant Reçu"}),t.jsx("th",{className:"p-6 text-right text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Commission"})]})}),t.jsxs("tbody",{className:"divide-y divide-slate-100",children:[r?.map(Oa),r?.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"p-12 text-center text-xs font-black tracking-widest text-slate-300 uppercase",children:"Aucune transaction"})})]})]})})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-10 w-1 rounded-full bg-indigo-500"}),t.jsx("h5",{className:"text-xl font-black tracking-tight text-slate-900 uppercase",children:"Performance Opérateurs"})]}),t.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:i?.cashier_stats?.map(Pa)})]})]})]})}),e[29]=l,e[30]=i?.cashier_stats,e[31]=i?.total_clients,e[32]=i?.total_transactions,e[33]=i?.volume_cdf,e[34]=i?.volume_usd,e[35]=r,e[36]=h):h=e[36];let U;e[37]===Symbol.for("react.memo_cache_sentinel")?(U=t.jsxs("div",{className:"text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:["Document généré le ",Z().format("DD/MM/YYYY HH:mm")]}),e[37]=U):U=e[37];let q;e[38]!==d?(q=t.jsxs("div",{className:"flex shrink-0 items-center justify-between border-t border-slate-100 bg-white p-8 md:p-12",children:[U,t.jsx(P,{onClick:d,className:"h-14 rounded-2xl bg-slate-900 px-10 text-xs font-black tracking-widest text-white uppercase",children:"Fermer le Rapport"})]}),e[38]=d,e[39]=q):q=e[39];let F;e[40]!==C||e[41]!==h||e[42]!==q?(F=t.jsxs(ye.div,{initial:n,animate:p,exit:g,className:"relative flex max-h-[90vh] w-full max-w-6xl flex-col overflow-hidden rounded-[3.5rem] border border-white/20 bg-[#f8fafc] shadow-[0_40px_100px_rgba(0,0,0,0.5)]",children:[C,h,q]}),e[40]=C,e[41]=h,e[42]=q,e[43]=F):F=e[43];let T;return e[44]!==F||e[45]!==u?(T=t.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-6 font-sans md:p-12",children:[u,F]}),e[44]=F,e[45]=u,e[46]=T):T=e[46],T}function Pa(s,e){return t.jsxs("div",{className:"group rounded-[2rem] border border-slate-100 bg-white p-8 shadow-lg shadow-slate-200/30 transition-all hover:border-indigo-200",children:[t.jsxs("div",{className:"mb-6 flex items-center gap-4",children:[t.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-2xl bg-indigo-50 text-xl font-black text-indigo-600 transition-all group-hover:bg-indigo-600 group-hover:text-white",children:s.cashier.charAt(0)}),t.jsxs("div",{children:[t.jsx("div",{className:"text-lg font-black tracking-tighter text-slate-800",children:s.cashier}),t.jsx("div",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Opérateur"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"rounded-xl bg-slate-50 p-4",children:[t.jsx("div",{className:"mb-1 text-[9px] font-black text-slate-400 uppercase",children:"Appels"}),t.jsx("div",{className:"text-xl font-black text-slate-700",children:s.clients_called})]}),t.jsxs("div",{className:"rounded-xl bg-slate-50 p-4",children:[t.jsx("div",{className:"mb-1 text-[9px] font-black text-slate-400 uppercase",children:"Succès"}),t.jsx("div",{className:"text-xl font-black text-emerald-600",children:s.transactions_completed})]})]})]},e)}function Oa(s){return t.jsxs("tr",{className:"transition-colors hover:bg-slate-50/30",children:[t.jsx("td",{className:"p-6 text-xs font-bold text-slate-500",children:Z(s.created_at).format("HH:mm:ss")}),t.jsx("td",{className:"p-6",children:t.jsx("span",{className:"text-xs font-black tracking-tighter text-slate-800 uppercase",children:s.operation_type})}),t.jsx("td",{className:"p-6",children:t.jsxs("span",{className:"text-sm font-black text-emerald-600",children:[s.amount_from?.toLocaleString()," ",s.currency_from]})}),t.jsx("td",{className:"p-6",children:t.jsxs("span",{className:"text-sm font-black text-slate-600",children:[s.amount_to?.toLocaleString()," ",s.currency_to]})}),t.jsx("td",{className:"p-6 text-right",children:t.jsxs("span",{className:"text-xs font-black text-indigo-600",children:["$"," ",s.commission]})})]},s.id)}function yt(s){const e=ne.c(21),{title:a,value:i,icon:r,color:l}=s;let d,m,c,k;if(e[0]!==r||e[1]!==l){const _={blue:"bg-blue-500 text-blue-500 border-blue-100 shadow-blue-500/20",emerald:"bg-emerald-500 text-emerald-500 border-emerald-100 shadow-emerald-500/20",indigo:"bg-indigo-500 text-indigo-500 border-indigo-100 shadow-indigo-500/20",amber:"bg-amber-500 text-amber-500 border-amber-100 shadow-amber-500/20"};k="flex flex-col items-center rounded-[2.5rem] border border-slate-100 bg-white p-8 text-center shadow-xl shadow-slate-200/30",c=B("mb-6 rounded-2xl p-5 shadow-xl",_[l].split(" ")[0],"bg-opacity-10"),d=r,m=B("h-8 w-8",_[l].split(" ")[1]),e[0]=r,e[1]=l,e[2]=d,e[3]=m,e[4]=c,e[5]=k}else d=e[2],m=e[3],c=e[4],k=e[5];let u;e[6]!==d||e[7]!==m?(u=t.jsx(d,{className:m}),e[6]=d,e[7]=m,e[8]=u):u=e[8];let n;e[9]!==c||e[10]!==u?(n=t.jsx("div",{className:c,children:u}),e[9]=c,e[10]=u,e[11]=n):n=e[11];let p;e[12]!==a?(p=t.jsx("div",{className:"mb-2 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:a}),e[12]=a,e[13]=p):p=e[13];let g;e[14]!==i?(g=t.jsx("div",{className:"text-3xl leading-none font-black tracking-tighter text-slate-900",children:i}),e[14]=i,e[15]=g):g=e[15];let v;return e[16]!==k||e[17]!==n||e[18]!==p||e[19]!==g?(v=t.jsxs("div",{className:k,children:[n,p,g]}),e[16]=k,e[17]=n,e[18]=p,e[19]=g,e[20]=v):v=e[20],v}const es={blue:{bg:"bg-blue-50",icon:"bg-blue-600 text-white shadow-blue-200",text:"text-blue-600",border:"border-blue-100",accent:"bg-blue-600/5",glow:"shadow-blue-500/10"},emerald:{bg:"bg-emerald-50",icon:"bg-emerald-600 text-white shadow-emerald-200",text:"text-emerald-600",border:"border-emerald-100",accent:"bg-emerald-600/5",glow:"shadow-emerald-500/10"},amber:{bg:"bg-amber-50",icon:"bg-amber-500 text-white shadow-amber-200",text:"text-amber-600",border:"border-amber-100",accent:"bg-amber-600/5",glow:"shadow-amber-500/10"},indigo:{bg:"bg-indigo-50",icon:"bg-indigo-600 text-white shadow-indigo-200",text:"text-indigo-600",border:"border-indigo-100",accent:"bg-indigo-600/5",glow:"shadow-indigo-500/10"},purple:{bg:"bg-purple-50",icon:"bg-purple-600 text-white shadow-purple-200",text:"text-purple-600",border:"border-purple-100",accent:"bg-purple-600/5",glow:"shadow-purple-500/10"},rose:{bg:"bg-rose-50",icon:"bg-rose-600 text-white shadow-rose-200",text:"text-rose-600",border:"border-rose-100",accent:"bg-rose-600/5",glow:"shadow-rose-500/10"}};function kt(s){const e=ne.c(43),{title:a,value:i,subtitle:r,icon:l,color:d,trend:m}=s,c=es[d]||es.blue;let k,u;e[0]===Symbol.for("react.memo_cache_sentinel")?(k={y:-5,scale:1.02},u={type:"spring",stiffness:400,damping:25},e[0]=k,e[1]=u):(k=e[0],u=e[1]);let n;e[2]!==c.glow?(n=B("group relative overflow-hidden rounded-[2.5rem] border border-white bg-white/70 p-8 shadow-xl backdrop-blur-xl transition-all",c.glow),e[2]=c.glow,e[3]=n):n=e[3];let p;e[4]!==c.bg?(p=B("absolute -top-12 -right-12 h-32 w-32 rounded-full opacity-20 blur-3xl",c.bg),e[4]=c.bg,e[5]=p):p=e[5];let g;e[6]!==p?(g=t.jsx("div",{className:p}),e[6]=p,e[7]=g):g=e[7];let v;e[8]!==c.icon?(v=B("flex h-14 w-14 items-center justify-center rounded-2xl shadow-lg transition-transform duration-500 group-hover:scale-110",c.icon),e[8]=c.icon,e[9]=v):v=e[9];let _;e[10]!==l?(_=t.jsx(l,{className:"h-8 w-8"}),e[10]=l,e[11]=_):_=e[11];let A;e[12]!==v||e[13]!==_?(A=t.jsx("div",{className:v,children:_}),e[12]=v,e[13]=_,e[14]=A):A=e[14];let x;e[15]!==m?(x=m&&t.jsxs("div",{className:B("flex items-center gap-1 rounded-full px-3 py-1 text-[10px] font-black tracking-widest uppercase",m.positive?"bg-emerald-100 text-emerald-600":"bg-rose-100 text-rose-600"),children:[m.positive?"↑":"↓"," ",m.value]}),e[15]=m,e[16]=x):x=e[16];let D;e[17]!==A||e[18]!==x?(D=t.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[A,x]}),e[17]=A,e[18]=x,e[19]=D):D=e[19];let j;e[20]!==a?(j=t.jsx("p",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:a}),e[20]=a,e[21]=j):j=e[21];let f;e[22]!==i?(f=t.jsx("h2",{className:"text-3xl leading-tight font-black tracking-tight text-slate-900",children:i}),e[22]=i,e[23]=f):f=e[23];let y;e[24]!==c.text||e[25]!==r?(y=r&&t.jsxs("p",{className:"mt-2 flex items-center gap-1.5 text-[11px] font-bold tracking-wide text-slate-400 uppercase",children:[t.jsx("span",{className:B("h-1.5 w-1.5 rounded-full",c.text.replace("text","bg"))}),r]}),e[24]=c.text,e[25]=r,e[26]=y):y=e[26];let S;e[27]!==j||e[28]!==f||e[29]!==y?(S=t.jsxs("div",{className:"space-y-1",children:[j,f,y]}),e[27]=j,e[28]=f,e[29]=y,e[30]=S):S=e[30];let w;e[31]!==D||e[32]!==S?(w=t.jsxs("div",{className:"relative z-10 flex h-full flex-col",children:[D,S]}),e[31]=D,e[32]=S,e[33]=w):w=e[33];let M;e[34]!==c.text?(M=B("absolute bottom-0 left-0 h-1.5 w-full opacity-30",c.text.replace("text","bg")),e[34]=c.text,e[35]=M):M=e[35];let b;e[36]!==M?(b=t.jsx("div",{className:M}),e[36]=M,e[37]=b):b=e[37];let C;return e[38]!==w||e[39]!==b||e[40]!==n||e[41]!==g?(C=t.jsxs(ye.div,{whileHover:k,transition:u,className:n,children:[g,w,b]}),e[38]=w,e[39]=b,e[40]=n,e[41]=g,e[42]=C):C=e[42],C}function ts({transactions:s}){return s.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center rounded-[2rem] border-2 border-dashed border-slate-200 bg-slate-50/50 p-20",children:[t.jsx("div",{className:"mb-4 flex h-16 w-16 items-center justify-center rounded-2xl border border-slate-100 bg-white shadow-sm",children:t.jsx(Xt,{className:"h-8 w-8 text-slate-300"})}),t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-400 uppercase",children:"Aucune transaction trouvée"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-separate border-spacing-y-3 text-left",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[t.jsx("th",{className:"px-6 py-4 font-black",children:"Transaction / Client"}),t.jsx("th",{className:"px-6 py-4 text-center font-black",children:"Type"}),t.jsx("th",{className:"px-6 py-4 text-right font-black",children:"Montant Entrée"}),t.jsx("th",{className:"px-6 py-4 text-right font-black",children:"Montant Sortie"}),t.jsx("th",{className:"px-6 py-4 text-right font-black",children:"Commission"}),t.jsx("th",{className:"px-6 py-4 text-right font-black",children:"Date / Heure"})]})}),t.jsx("tbody",{children:s.map(e=>t.jsxs("tr",{className:"group rounded-2xl border border-slate-100 bg-white transition-all duration-300 hover:bg-slate-50",children:[t.jsx("td",{className:"rounded-l-2xl border-y border-l border-slate-100 px-6 py-5 group-hover:border-indigo-100",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-xl bg-slate-900 shadow-lg shadow-slate-900/10 transition-transform group-hover:scale-110",children:t.jsx(nt,{className:"h-5 w-5 text-white"})}),t.jsxs("div",{className:"flex min-w-0 flex-col",children:[t.jsx("span",{className:"truncate text-sm font-black text-slate-900",children:e.client?`${e.client.first_name||""} ${e.client.last_name||""}`.trim()||"Client":e.client_name||"Utilisateur"}),t.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold tracking-tight text-slate-400 uppercase",children:[t.jsx(Xt,{className:"h-2.5 w-2.5"})," ID-",e.id.toString().slice(-4).toUpperCase()]})]})]})}),t.jsx("td",{className:"border-y border-slate-100 px-6 py-5 text-center group-hover:border-indigo-100",children:t.jsxs("div",{className:B("inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-[10px] font-black tracking-widest uppercase",e.operation_type==="change"?"bg-indigo-50 text-indigo-600":"bg-amber-50 text-amber-600"),children:[e.operation_type==="change"?t.jsx(Yt,{className:"h-3 w-3"}):t.jsx(Ht,{className:"h-3 w-3"}),e.operation_type]})}),t.jsx("td",{className:"border-y border-slate-100 px-6 py-5 text-right group-hover:border-indigo-100",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-black text-slate-900",children:e.amount_from?.toLocaleString()}),t.jsx("span",{className:"text-[10px] font-black tracking-tighter text-slate-400 uppercase",children:e.currency_from})]})}),t.jsx("td",{className:"border-y border-slate-100 px-6 py-5 text-right group-hover:border-indigo-100",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-black text-emerald-600",children:e.amount_to?.toLocaleString()}),t.jsx("span",{className:"text-[10px] font-black tracking-tighter text-emerald-600 uppercase opacity-60",children:e.currency_to})]})}),t.jsx("td",{className:"border-y border-slate-100 px-6 py-5 text-right group-hover:border-indigo-100",children:t.jsxs("span",{className:"rounded-lg bg-slate-900 px-3 py-1 font-mono text-xs font-black text-white shadow-lg shadow-slate-900/10",children:["$",parseFloat(e.commission).toLocaleString()]})}),t.jsx("td",{className:"rounded-r-2xl border-y border-r border-slate-100 px-6 py-5 text-right group-hover:border-indigo-100",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-black text-slate-700",children:Z(e.created_date).format("DD/MM/YYYY")}),t.jsxs("span",{className:"flex items-center justify-end gap-1 text-[10px] font-bold text-slate-400",children:[t.jsx(Te,{className:"h-2.5 w-2.5"})," ",Z(e.created_date).format("HH:mm")]})]})})]},e.id))})]})})}function za(){const s=ne.c(96),{auth:e}=It().props,a=e.user?.role==="super-admin",[i,r]=G.useState(!1),[l,d]=G.useState(null),m=dt(),c=a?"manager":"cashier";let k;s[0]===Symbol.for("react.memo_cache_sentinel")?(k=[],s[0]=k):k=s[0];let u;s[1]!==c?(u={name:"",email:"",password:"",role:c,is_active:!0,shop_ids:k},s[1]=c,s[2]=u):u=s[2];const[n,p]=G.useState(u);let g;s[3]===Symbol.for("react.memo_cache_sentinel")?(g=["shops"],s[3]=g):g=s[3];let v;s[4]!==a?(v={queryKey:g,queryFn:W.entities.Shop.list,enabled:a},s[4]=a,s[5]=v):v=s[5];const{data:_}=je(v);let A;s[6]===Symbol.for("react.memo_cache_sentinel")?(A={queryKey:["users"],queryFn:W.entities.User.list},s[6]=A):A=s[6];const{data:x,isLoading:D}=je(A);let j;s[7]!==m?(j={mutationFn:W.entities.User.create,onSuccess:()=>{m.invalidateQueries({queryKey:["users"]}),r(!1),p({name:"",email:"",password:"",role:"cashier",is_active:!0}),V.success("Utilisateur créé avec succès")},onError:Ga},s[7]=m,s[8]=j):j=s[8];const f=be(j);let y;s[9]!==m?(y={mutationFn:Qa,onSuccess:()=>{m.invalidateQueries({queryKey:["users"]}),d(null),p({name:"",email:"",password:"",role:"cashier",is_active:!0}),V.success("Utilisateur mis à jour avec succès")},onError:Va},s[9]=m,s[10]=y):y=s[10];const S=be(y);let w;s[11]!==m?(w={mutationFn:Ba,onSuccess:()=>{m.invalidateQueries({queryKey:["users"]}),V.success("Utilisateur supprimé avec succès")},onError:Ka},s[11]=m,s[12]=w):w=s[12];const M=be(w);let b;s[13]!==f||s[14]!==l||s[15]!==n||s[16]!==S?(b=$=>{$.preventDefault(),l?S.mutate({id:l.id,data:n}):f.mutate(n)},s[13]=f,s[14]=l,s[15]=n,s[16]=S,s[17]=b):b=s[17];const C=b;let h;s[18]===Symbol.for("react.memo_cache_sentinel")?(h=$=>{d($),p({name:$.name,email:$.email,role:$.role,is_active:$.is_active}),r(!0)},s[18]=h):h=s[18];const U=h;let q;s[19]!==M?(q=$=>{confirm("Êtes-vous sûr de vouloir supprimer cet utilisateur ?")&&M.mutate($)},s[19]=M,s[20]=q):q=s[20];const F=q,T=Ya;let I;s[21]===Symbol.for("react.memo_cache_sentinel")?(I=t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold tracking-tight text-slate-900",children:"Gestion des utilisateurs"}),t.jsx("p",{className:"text-slate-500",children:"Gérez les accès et les rôles des utilisateurs"})]}),s[21]=I):I=s[21];let R;s[22]!==a?(R=()=>{d(null),p({name:"",email:"",password:"",role:a?"manager":"cashier",is_active:!0}),r(!0)},s[22]=a,s[23]=R):R=s[23];let K;s[24]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsx(tt,{className:"mr-2 h-4 w-4"}),s[24]=K):K=s[24];const O=a?"Nouvel utilisateur":"Nouveau Caissier";let z;s[25]!==R||s[26]!==O?(z=t.jsxs("div",{className:"flex items-center justify-between",children:[I,t.jsxs(P,{onClick:R,className:"bg-[#1f61e4] hover:bg-[#1f61e4]/90",children:[K,O]})]}),s[25]=R,s[26]=O,s[27]=z):z=s[27];let E;s[28]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsx(ns,{children:t.jsxs(lt,{children:[t.jsx(ke,{children:"Nom"}),t.jsx(ke,{children:"Email"}),t.jsx(ke,{children:"Boutique"}),t.jsx(ke,{children:"Rôle"}),t.jsx(ke,{children:"Statut"}),t.jsx(ke,{className:"text-right",children:"Actions"})]})}),s[28]=E):E=s[28];let Y;s[29]!==F||s[30]!==D||s[31]!==x?(Y=D?t.jsx(lt,{children:t.jsx(we,{colSpan:5,className:"h-24 text-center",children:"Chargement..."})}):x?.map($=>t.jsxs(lt,{children:[t.jsx(we,{className:"font-medium",children:$.name}),t.jsx(we,{children:$.email}),t.jsx(we,{children:t.jsx("div",{className:"flex flex-wrap gap-1",children:$.shops&&$.shops.length>0?$.shops.map(Ha):t.jsx("span",{className:"text-[10px] text-slate-400 italic",children:"Aucune"})})}),t.jsx(we,{children:T($.role)}),t.jsx(we,{children:t.jsx(re,{variant:$.is_active?"default":"destructive",className:$.is_active?"bg-green-500 hover:bg-green-600":"",children:$.is_active?"Actif":"Inactif"})}),t.jsx(we,{className:"text-right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(P,{variant:"ghost",size:"icon",onClick:()=>U($),className:"h-8 w-8 text-slate-500 hover:text-[#1f61e4]",children:t.jsx(qs,{className:"h-4 w-4"})}),t.jsx(P,{variant:"ghost",size:"icon",onClick:()=>F($.id),className:"h-8 w-8 text-slate-500 hover:text-red-600",children:t.jsx(Ft,{className:"h-4 w-4"})})]})})]},$.id)),s[29]=F,s[30]=D,s[31]=x,s[32]=Y):Y=s[32];let N;s[33]!==Y?(N=t.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:t.jsxs(rs,{children:[E,t.jsx(cs,{children:Y})]})}),s[33]=Y,s[34]=N):N=s[34];const L=l?"Modifier l'utilisateur":"Nouvel utilisateur";let H;s[35]!==L?(H=t.jsx(as,{children:t.jsx(ss,{children:L})}),s[35]=L,s[36]=H):H=s[36];let ae;s[37]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx(de,{htmlFor:"name",children:"Nom complet"}),s[37]=ae):ae=s[37];let ee;s[38]!==n?(ee=$=>p({...n,name:$.target.value}),s[38]=n,s[39]=ee):ee=s[39];let J;s[40]!==n.name||s[41]!==ee?(J=t.jsxs("div",{className:"space-y-2",children:[ae,t.jsx(ge,{id:"name",value:n.name,onChange:ee,required:!0})]}),s[40]=n.name,s[41]=ee,s[42]=J):J=s[42];let te;s[43]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx(de,{htmlFor:"email",children:"Email"}),s[43]=te):te=s[43];let se;s[44]!==n?(se=$=>p({...n,email:$.target.value}),s[44]=n,s[45]=se):se=s[45];let le;s[46]!==n.email||s[47]!==se?(le=t.jsxs("div",{className:"space-y-2",children:[te,t.jsx(ge,{id:"email",type:"email",value:n.email,onChange:se,required:!0})]}),s[46]=n.email,s[47]=se,s[48]=le):le=s[48];let X;s[49]!==l||s[50]!==n?(X=!l&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(de,{htmlFor:"password",children:"Mot de passe"}),t.jsx(ge,{id:"password",type:"password",value:n.password,onChange:$=>p({...n,password:$.target.value}),required:!l})]}),s[49]=l,s[50]=n,s[51]=X):X=s[51];let ce;s[52]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(de,{htmlFor:"role",children:"Rôle"}),s[52]=ce):ce=s[52];let xe;s[53]!==n?(xe=$=>p({...n,role:$}),s[53]=n,s[54]=xe):xe=s[54];let me;s[55]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx(Ct,{children:t.jsx(Dt,{placeholder:"Sélectionner un rôle"})}),s[55]=me):me=s[55];let he;s[56]!==a?(he=a&&t.jsx(De,{value:"manager",children:"Manager"}),s[56]=a,s[57]=he):he=s[57];let ue,ve;s[58]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx(De,{value:"cashier",children:"Caissier"}),ve=t.jsx(De,{value:"client",children:"Client"}),s[58]=ue,s[59]=ve):(ue=s[58],ve=s[59]);let fe;s[60]!==he?(fe=t.jsxs(Mt,{children:[he,ue,ve]}),s[60]=he,s[61]=fe):fe=s[61];let oe;s[62]!==n.role||s[63]!==xe||s[64]!==fe?(oe=t.jsxs("div",{className:"space-y-2",children:[ce,t.jsxs(St,{value:n.role,onValueChange:xe,disabled:!1,children:[me,fe]})]}),s[62]=n.role,s[63]=xe,s[64]=fe,s[65]=oe):oe=s[65];let o;s[66]!==_||s[67]!==n||s[68]!==a?(o=a&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(de,{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Assigner aux Boutiques"}),t.jsx("div",{className:"grid max-h-32 grid-cols-2 gap-2 overflow-y-auto rounded-lg border p-1",children:_?.map($=>t.jsxs("div",{onClick:()=>{const $e=n.shop_ids||[],at=$e.includes($.id)?$e.filter(Ue=>Ue!==$.id):[...$e,$.id];p({...n,shop_ids:at})},className:`flex cursor-pointer items-center gap-2 rounded-md border p-2 transition-colors ${n.shop_ids?.includes($.id)?"border-indigo-200 bg-indigo-50":"bg-white hover:bg-slate-50"}`,children:[t.jsx("div",{className:`h-3 w-3 rounded-sm border ${n.shop_ids?.includes($.id)?"border-indigo-600 bg-indigo-600":"border-slate-300"}`}),t.jsx("span",{className:"text-xs font-bold",children:$.name})]},$.id))})]}),s[66]=_,s[67]=n,s[68]=a,s[69]=o):o=s[69];let Q;s[70]!==l||s[71]!==n?(Q=l&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"is_active",checked:n.is_active,onChange:$=>p({...n,is_active:$.target.checked}),className:"h-4 w-4 rounded border-gray-300"}),t.jsx(de,{htmlFor:"is_active",children:"Compte actif"})]}),s[70]=l,s[71]=n,s[72]=Q):Q=s[72];let ie;s[73]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx(P,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Annuler"}),s[73]=ie):ie=s[73];const Ae=f.isPending||S.isPending,Me=f.isPending||S.isPending?"Enregistrement...":"Enregistrer";let _e;s[74]!==Ae||s[75]!==Me?(_e=t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[ie,t.jsx(P,{type:"submit",className:"bg-[#1f61e4] hover:bg-[#1f61e4]/90",disabled:Ae,children:Me})]}),s[74]=Ae,s[75]=Me,s[76]=_e):_e=s[76];let Fe;s[77]!==C||s[78]!==J||s[79]!==le||s[80]!==X||s[81]!==oe||s[82]!==o||s[83]!==Q||s[84]!==_e?(Fe=t.jsxs("form",{onSubmit:C,className:"space-y-4",children:[J,le,X,oe,o,Q,_e]}),s[77]=C,s[78]=J,s[79]=le,s[80]=X,s[81]=oe,s[82]=o,s[83]=Q,s[84]=_e,s[85]=Fe):Fe=s[85];let Ne;s[86]!==H||s[87]!==Fe?(Ne=t.jsxs(ls,{children:[H,Fe]}),s[86]=H,s[87]=Fe,s[88]=Ne):Ne=s[88];let Se;s[89]!==i||s[90]!==Ne?(Se=t.jsx(is,{open:i,onOpenChange:r,children:Ne}),s[89]=i,s[90]=Ne,s[91]=Se):Se=s[91];let qe;return s[92]!==z||s[93]!==N||s[94]!==Se?(qe=t.jsxs("div",{className:"space-y-6",children:[z,N,Se]}),s[92]=z,s[93]=N,s[94]=Se,s[95]=qe):qe=s[95],qe}function Ha(s){return t.jsx(re,{variant:"outline",className:"py-0 text-[10px]",children:s.name},s.id)}function Ya(s){switch(s){case"manager":return t.jsxs(re,{className:"bg-purple-500 hover:bg-purple-600",children:[t.jsx(Et,{className:"mr-1 h-3 w-3"})," Manager"]});case"cashier":return t.jsxs(re,{className:"bg-pink-500 hover:bg-pink-600",children:[t.jsx(ta,{className:"mr-1 h-3 w-3"})," Caissier"]});case"client":return t.jsxs(re,{className:"bg-cyan-500 hover:bg-cyan-600",children:[t.jsx(nt,{className:"mr-1 h-3 w-3"})," Client"]});default:return t.jsx(re,{variant:"secondary",children:s})}}function Ka(s){V.error(s.message||"Erreur lors de la suppression")}function Ba(s){return W.entities.User.delete(s)}function Va(s){V.error(s.message||"Erreur lors de la mise à jour")}function Qa(s){const{id:e,data:a}=s;return W.entities.User.update(e,a)}function Ga(s){V.error(s.message||"Erreur lors de la création")}function Pl(){const s=ne.c(142),{auth:e}=It().props,i=e.user?.role==="super-admin",r=dt(),[l,d]=G.useState(i?"shops":"overview");let m;s[0]===Symbol.for("react.memo_cache_sentinel")?(m=Z().format("YYYY-MM-DD"),s[0]=m):m=s[0];const[c,k]=G.useState(m);let u;s[1]!==c?(u={queryKey:["all-clients",c],queryFn:()=>W.entities.Client.list({sort:"-created_at",limit:500,date:c}),refetchInterval:3e4},s[1]=c,s[2]=u):u=s[2];const{data:n,isLoading:p}=je(u);let g;s[3]!==n?(g=n===void 0?[]:n,s[3]=n,s[4]=g):g=s[4];const v=g;let _;s[5]!==c?(_={queryKey:["all-transactions",c],queryFn:()=>W.entities.Transaction.list({sort:"-created_at",limit:500,date:c}),refetchInterval:3e4},s[5]=c,s[6]=_):_=s[6];const{data:A,isLoading:x}=je(_);let D;s[7]!==A?(D=A===void 0?[]:A,s[7]=A,s[8]=D):D=s[8];const j=D;let f;s[9]!==c?(f={queryKey:["all-cash-movements",c],queryFn:async()=>(await W.entities.CashSession.listMovements({date:c})).data||[],refetchInterval:3e4},s[9]=c,s[10]=f):f=s[10];const{data:y}=je(f);let S;s[11]!==y?(S=y===void 0?[]:y,s[11]=y,s[12]=S):S=s[12];const w=S;let M;s[13]!==c?(M=Z(c).startOf("day").isSame(Z().startOf("day")),s[13]=c,s[14]=M):M=s[14];const b=M,C=v,h=j;let U;s[15]!==h?(U=h.filter(tl).reduce(el,0),s[15]=h,s[16]=U):U=s[16];const q=U;let F;s[17]!==h?(F=h.filter(Za).reduce(Wa,0),s[17]=h,s[18]=F):F=s[18];const T=F;let I;s[19]!==h?(I=h.reduce(Xa,0),s[19]=h,s[20]=I):I=s[20];const R=I,K=C.length;let O;s[21]!==C?(O=C.filter(Ja),s[21]=C,s[22]=O):O=s[22];let z;s[23]!==C.length||s[24]!==b||s[25]!==O.length||s[26]!==R||s[27]!==T||s[28]!==q?(z={todayClients:K,waiting:O.length,volumeUSD:q,volumeCDF:T,commissions:R,isCurrentDay:b},s[23]=C.length,s[24]=b,s[25]=O.length,s[26]=R,s[27]=T,s[28]=q,s[29]=z):z=s[29];const E=z;let Y;s[30]!==r?(Y=()=>{r.invalidateQueries({queryKey:["all-clients"]}),r.invalidateQueries({queryKey:["all-transactions"]}),r.invalidateQueries({queryKey:["all-cash-movements"]}),V.success("Tableau de bord actualisé")},s[30]=r,s[31]=Y):Y=s[31];const N=Y;let L;s[32]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx(hs,{title:"Manager"}),s[32]=L):L=s[32];let H;s[33]===Symbol.for("react.memo_cache_sentinel")?(H={scale:1.02},s[33]=H):H=s[33];let ae,ee;s[34]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx(ye.div,{whileHover:H,className:"relative flex h-16 w-38 items-center justify-center px-4",children:t.jsx("img",{src:"/logo-color.png",alt:"Havifin",className:"h-full w-full object-contain"})}),ee=t.jsx("div",{className:"h-10 w-[1px] bg-slate-100"}),s[34]=ae,s[35]=ee):(ae=s[34],ee=s[35]);let J;s[36]===Symbol.for("react.memo_cache_sentinel")?(J=t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("h1",{className:"text-2xl font-black tracking-tight text-slate-900 uppercase",children:["Console"," ",t.jsx("span",{className:"text-indigo-600",children:"Manager"})]}),t.jsx("span",{className:"rounded-full border border-emerald-500/20 bg-emerald-500/10 px-3 py-1 text-[10px] font-black tracking-widest text-emerald-600 uppercase",children:"Live"})]}),s[36]=J):J=s[36];const te=e.user.shop||"Supervision & Reporting";let se;s[37]!==e.user.role||s[38]!==te?(se=t.jsxs("div",{className:"flex items-center gap-6",children:[ae,ee,t.jsxs("div",{children:[J,t.jsxs("p",{className:"mt-1 flex items-center gap-2 text-[10px] font-black tracking-[0.15em] text-slate-400 uppercase",children:[e.user.role," •"," ",te]})]})]}),s[37]=e.user.role,s[38]=te,s[39]=se):se=s[39];const le=(p||x)&&"animate-spin";let X;s[40]!==le?(X=B("h-5 w-5",le),s[40]=le,s[41]=X):X=s[41];let ce;s[42]!==X?(ce=t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl border border-slate-100 bg-white text-slate-400 shadow-sm",children:t.jsx(ot,{className:X})}),s[42]=X,s[43]=ce):ce=s[43];let xe;s[44]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsxs("div",{children:[t.jsx("div",{className:"text-[10px] font-black tracking-wider text-slate-400 uppercase",children:"Dernier Sync"}),t.jsx("div",{className:"text-xs font-bold text-slate-600",children:"A l'instant"})]}),s[44]=xe):xe=s[44];let me;s[45]!==ce?(me=t.jsxs("div",{className:"hidden items-center gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-1.5 pr-5 xl:flex",children:[ce,xe]}),s[45]=ce,s[46]=me):me=s[46];let he;s[47]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(ot,{className:"mr-2 h-4 w-4"}),s[47]=he):he=s[47];let ue;s[48]!==N?(ue=t.jsxs(P,{variant:"outline",onClick:N,className:"h-12 rounded-2xl border-slate-200 bg-white px-6 text-xs font-black tracking-widest uppercase shadow-sm transition-all hover:border-indigo-500 hover:text-indigo-600",children:[he,"Actualiser"]}),s[48]=N,s[49]=ue):ue=s[49];let ve;s[50]===Symbol.for("react.memo_cache_sentinel")?(ve=t.jsx(At,{className:"h-4 w-4 text-slate-400"}),s[50]=ve):ve=s[50];let fe;s[51]===Symbol.for("react.memo_cache_sentinel")?(fe=Ce=>k(Ce.target.value),s[51]=fe):fe=s[51];let oe;s[52]!==c?(oe=t.jsxs("div",{className:"flex h-12 items-center gap-3 rounded-2xl border border-slate-200 bg-white px-4 shadow-sm transition-all focus-within:border-indigo-500",children:[ve,t.jsx("input",{type:"date",value:c,onChange:fe,className:"border-none bg-transparent text-xs font-black tracking-widest text-slate-600 uppercase focus:ring-0"})]}),s[52]=c,s[53]=oe):oe=s[53];let o;s[54]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsxs(P,{className:"h-12 rounded-2xl bg-slate-900 px-6 text-xs font-black tracking-widest text-white uppercase shadow-xl shadow-slate-900/10 transition-all hover:bg-black active:scale-95",children:[t.jsx(Os,{className:"mr-2 h-4 w-4 text-emerald-400"}),"Exporter Rapport"]}),s[54]=o):o=s[54];let Q;s[55]!==me||s[56]!==ue||s[57]!==oe?(Q=t.jsxs("div",{className:"flex items-center gap-4",children:[me,ue,oe,o]}),s[55]=me,s[56]=ue,s[57]=oe,s[58]=Q):Q=s[58];let ie;s[59]!==se||s[60]!==Q?(ie=t.jsxs("header",{className:"z-20 flex h-24 flex-shrink-0 items-center justify-between border-b border-slate-200 bg-white px-10 shadow-[0_1px_3px_rgba(0,0,0,0.02)]",children:[se,Q]}),s[59]=se,s[60]=Q,s[61]=ie):ie=s[61];const Ae=`${E.waiting} en attente`;let Me;s[62]!==E.todayClients||s[63]!==Ae?(Me=t.jsx(kt,{title:"Clients Aujourd'hui",value:E.todayClients,subtitle:Ae,icon:_t,color:"blue"}),s[62]=E.todayClients,s[63]=Ae,s[64]=Me):Me=s[64];let _e;s[65]!==E.volumeUSD?(_e=E.volumeUSD.toLocaleString(),s[65]=E.volumeUSD,s[66]=_e):_e=s[66];const Fe=`$ ${_e}`;let Ne;s[67]!==Fe?(Ne=t.jsx(kt,{title:"Volume USD",value:Fe,icon:Ee,color:"emerald"}),s[67]=Fe,s[68]=Ne):Ne=s[68];let Se;s[69]!==E.volumeCDF?(Se=E.volumeCDF.toLocaleString(),s[69]=E.volumeCDF,s[70]=Se):Se=s[70];const qe=`${Se} FC`;let $;s[71]!==qe?($=t.jsx(kt,{title:"Volume CDF",value:qe,icon:ct,color:"amber"}),s[71]=qe,s[72]=$):$=s[72];let $e;s[73]!==E.commissions?($e=E.commissions.toLocaleString(),s[73]=E.commissions,s[74]=$e):$e=s[74];const at=`$ ${$e}`;let Ue;s[75]!==at?(Ue=t.jsx(kt,{title:"Commissions Estimées",value:at,icon:Jt,color:"indigo"}),s[75]=at,s[76]=Ue):Ue=s[76];let Ie;s[77]!==Me||s[78]!==Ne||s[79]!==$||s[80]!==Ue?(Ie=t.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:[Me,Ne,$,Ue]}),s[77]=Me,s[78]=Ne,s[79]=$,s[80]=Ue,s[81]=Ie):Ie=s[81];let mt;s[82]===Symbol.for("react.memo_cache_sentinel")?(mt=t.jsx("h3",{className:"mb-6 px-2 text-[11px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Navigation"}),s[82]=mt):mt=s[82];let ht,ut,pt,ft,gt,bt,jt,vt;s[83]===Symbol.for("react.memo_cache_sentinel")?(ht={id:"overview",label:"Vue d'ensemble",icon:Bt},ut={id:"transactions",label:"Flux Transactions",icon:_s},pt={id:"movements",label:"Mouvements Manuels",icon:os},ft={id:"rates",label:"Gestion Taux",icon:Tt},gt={id:"users",label:"Utilisateurs",icon:_t},bt={id:"institutions",label:"Banques & Partenaires",icon:ct},jt={id:"logs",label:"Journal Activité",icon:zt},vt={id:"sessions",label:"Gestion Sessions",icon:$t},s[83]=ht,s[84]=ut,s[85]=pt,s[86]=ft,s[87]=gt,s[88]=bt,s[89]=jt,s[90]=vt):(ht=s[83],ut=s[84],pt=s[85],ft=s[86],gt=s[87],bt=s[88],jt=s[89],vt=s[90]);let Le;s[91]!==i?(Le=[ht,ut,pt,ft,gt,bt,jt,vt,...i?[{id:"shops",label:"Gestion Boutiques",icon:Lt}]:[]],s[91]=i,s[92]=Le):Le=s[92];let Pe;s[93]!==l||s[94]!==Le?(Pe=t.jsxs("div",{className:"rounded-[2rem] border border-white bg-white/50 p-6 shadow-sm backdrop-blur-xl",children:[mt,t.jsx("nav",{className:"space-y-2",children:Le.map(Ce=>t.jsxs("button",{onClick:()=>d(Ce.id),className:B("flex w-full items-center justify-between rounded-2xl border p-4 text-sm font-bold transition-all duration-300",l===Ce.id?"border-indigo-600 bg-indigo-600 text-white shadow-lg shadow-indigo-600/20":"border-slate-100 bg-white/40 text-slate-500 hover:border-slate-200 hover:bg-white"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ce.icon,{className:B("h-5 w-5",l===Ce.id?"text-white":"text-slate-400")}),Ce.label]}),t.jsx(Pt,{className:B("h-4 w-4 transition-transform",l===Ce.id?"translate-x-1":"opacity-0")})]},Ce.id))})]}),s[93]=l,s[94]=Le,s[95]=Pe):Pe=s[95];let Nt;s[96]===Symbol.for("react.memo_cache_sentinel")?(Nt=t.jsxs("div",{className:"group relative overflow-hidden rounded-[2rem] bg-slate-900 p-8 text-white shadow-2xl",children:[t.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-1/2 -translate-y-1/2 bg-indigo-500/20 blur-[80px]"}),t.jsx("h4",{className:"relative z-10 mb-2 text-xl font-black",children:"Besoin d'aide ?"}),t.jsx("p",{className:"relative z-10 mb-6 text-xs font-medium text-slate-400",children:"Consultez la documentation technique du bureau de change."}),t.jsx(P,{className:"relative z-10 w-full rounded-xl bg-white text-[10px] font-black tracking-widest text-slate-900 uppercase hover:bg-slate-100",children:"Guide Manager"})]}),s[96]=Nt):Nt=s[96];let Oe;s[97]!==Pe?(Oe=t.jsxs("div",{className:"col-span-12 space-y-4 lg:col-span-3",children:[Pe,Nt]}),s[97]=Pe,s[98]=Oe):Oe=s[98];let ze;s[99]!==l||s[100]!==w||s[101]!==c||s[102]!==j?(ze=l==="overview"&&t.jsxs("div",{className:"animate-in space-y-8 duration-500 fade-in slide-in-from-bottom-4",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsxs("h3",{className:"text-2xl font-black tracking-tight text-slate-800",children:["Performances du"," ",Z(c).format("DD/MM/YYYY")]}),t.jsx("p",{className:"text-sm font-medium text-slate-400",children:"Aperçu des flux financiers et des clients."})]})}),t.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[t.jsxs("div",{className:"flex h-64 flex-col items-center justify-center rounded-3xl border border-slate-100 bg-slate-50 p-8 opacity-50",children:[t.jsx(Jt,{className:"mb-4 h-16 w-16 text-slate-300"}),t.jsx("p",{className:"text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:"Graphique des Flux (Soon)"})]}),t.jsxs("div",{className:"flex h-64 flex-col items-center justify-center rounded-3xl border border-slate-100 bg-slate-50 p-8 opacity-50",children:[t.jsx(Bt,{className:"mb-4 h-16 w-16 text-slate-300"}),t.jsx("p",{className:"text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:"Volume par Guichet (Soon)"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsx("h4",{className:"text-lg font-black tracking-tight text-slate-800",children:"Activités Récentes"}),t.jsx(P,{variant:"ghost",className:"font-bold text-indigo-600 hover:bg-indigo-50",onClick:()=>d("transactions"),children:"Voir tout"})]}),t.jsx(ts,{transactions:j.slice(0,5)})]}),t.jsxs("div",{className:"border-t border-slate-100 pt-8",children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsx("h4",{className:"text-lg font-black tracking-tight text-slate-800",children:"Mouvements de Caisse Récents"}),t.jsx(P,{variant:"ghost",className:"font-bold text-indigo-600 hover:bg-indigo-50",onClick:()=>d("movements"),children:"Voir tout"})]}),t.jsx(Wt,{movements:w.slice(0,5)})]})]}),s[99]=l,s[100]=w,s[101]=c,s[102]=j,s[103]=ze):ze=s[103];let He;s[104]!==l||s[105]!==j?(He=l==="transactions"&&t.jsxs("div",{className:"animate-in space-y-6 duration-300 fade-in",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsx("h3",{className:"text-2xl font-black tracking-tight text-slate-800",children:"Journal Complet"}),t.jsxs("div",{className:"relative w-72",children:[t.jsx(At,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-slate-400"}),t.jsx("input",{placeholder:"Filtrer...",className:"h-10 w-full rounded-xl border-slate-200 pr-4 pl-10 text-sm focus:ring-indigo-500"})]})]}),t.jsx(ts,{transactions:j})]}),s[104]=l,s[105]=j,s[106]=He):He=s[106];let Ye;s[107]!==l||s[108]!==w?(Ye=l==="movements"&&t.jsxs("div",{className:"animate-in space-y-6 duration-300 fade-in",children:[t.jsx("div",{className:"mb-4 flex items-center justify-between",children:t.jsx("h3",{className:"text-2xl font-black tracking-tight text-slate-800",children:"Mouvements Manuels (Ajustements)"})}),t.jsx(Wt,{movements:w})]}),s[107]=l,s[108]=w,s[109]=Ye):Ye=s[109];let Ke;s[110]!==l?(Ke=l==="rates"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx(Ca,{})}),s[110]=l,s[111]=Ke):Ke=s[111];let Be;s[112]!==l?(Be=l==="institutions"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx(ha,{})}),s[112]=l,s[113]=Be):Be=s[113];let Ve;s[114]!==l?(Ve=l==="users"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx(za,{})}),s[114]=l,s[115]=Ve):Ve=s[115];let Qe;s[116]!==l?(Qe=l==="shops"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx($s,{})}),s[116]=l,s[117]=Qe):Qe=s[117];let Ge;s[118]!==l?(Ge=l==="sessions"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx(Ea,{})}),s[118]=l,s[119]=Ge):Ge=s[119];let Je;s[120]!==l||s[121]!==c?(Je=l==="logs"&&t.jsx(da,{selectedDate:c}),s[120]=l,s[121]=c,s[122]=Je):Je=s[122];let Xe;s[123]!==ze||s[124]!==He||s[125]!==Ye||s[126]!==Ke||s[127]!==Be||s[128]!==Ve||s[129]!==Qe||s[130]!==Ge||s[131]!==Je?(Xe=t.jsx("div",{className:"col-span-12 lg:col-span-9",children:t.jsx("div",{className:"min-h-[600px] overflow-hidden rounded-[2.5rem] border border-white bg-white/80 shadow-xl shadow-slate-200/50 backdrop-blur-xl",children:t.jsxs("div",{className:"p-10",children:[ze,He,Ye,Ke,Be,Ve,Qe,Ge,Je]})})}),s[123]=ze,s[124]=He,s[125]=Ye,s[126]=Ke,s[127]=Be,s[128]=Ve,s[129]=Qe,s[130]=Ge,s[131]=Je,s[132]=Xe):Xe=s[132];let We;s[133]!==Oe||s[134]!==Xe?(We=t.jsxs("div",{className:"grid grid-cols-12 gap-8",children:[Oe,Xe]}),s[133]=Oe,s[134]=Xe,s[135]=We):We=s[135];let Ze;s[136]!==Ie||s[137]!==We?(Ze=t.jsx("main",{className:"flex-1 overflow-y-auto bg-[url('/grid.svg')] bg-[length:40px_40px] px-10 py-10",children:t.jsxs("div",{className:"w-full max-w-none space-y-10",children:[Ie,We]})}),s[136]=Ie,s[137]=We,s[138]=Ze):Ze=s[138];let wt;return s[139]!==ie||s[140]!==Ze?(wt=t.jsxs(ys,{currentPageName:"Manager",children:[L,t.jsxs("div",{className:"flex flex-col overflow-hidden bg-[#f8fafc]",children:[ie,Ze]})]}),s[139]=ie,s[140]=Ze,s[141]=wt):wt=s[141],wt}function Ja(s){return s.status==="waiting"}function Xa(s,e){return s+(parseFloat(e.commission)||0)}function Wa(s,e){return s+(e.amount_from||0)}function Za(s){return s.currency_from==="CDF"}function el(s,e){return s+(e.amount_from||0)}function tl(s){return s.currency_from==="USD"}export{Pl as default};
