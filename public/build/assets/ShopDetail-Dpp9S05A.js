import{r as oe,j as s,c as Ce,a as Te,u as Ee,L as ve,H as Le}from"./app-DkFnKQqu.js";import{u as we,b as je}from"./base44Client-DAffFGfU.js";import{C as Oe,U as Re,M as $e}from"./ManagerModal-BDIWLYbV.js";import{B as qe}from"./badge-ClbS0mgP.js";import{B as p,t as Ae}from"./index-DgHTDt3N.js";import{C as ye,a as ke,b as He,c as Be}from"./card-ClVOptKc.js";import{P as Fe,I as Qe}from"./label-_YbXeZt4.js";import{b as De,m as _e}from"./createLucideIcon-CI6QMrH4.js";import{A as be,S as Ke}from"./app-main-CFwQ4KEa.js";import{u as Ge}from"./check-LQOZXpZ8.js";import{A as Ve}from"./arrow-left-Dfb7ckp4.js";import{T as Je}from"./trash-2-DMTitS91.js";import{M as We}from"./mail-DQp18WlG.js";import{S as Xe}from"./smartphone-BNoicElp.js";import{U as ge}from"./users-D1gVHlYe.js";import{S as Ye}from"./search-DcRWAGcZ.js";import{M as Ze}from"./map-pin-BtJZtqS2.js";/* empty css            */import"./index-BCYbKlc0.js";import"./loader-circle-D3PApFWE.js";var es="Separator",Se="horizontal",ss=["horizontal","vertical"],Me=oe.forwardRef((c,e)=>{const{decorative:d,orientation:r=Se,...t}=c,n=ts(r)?r:Se,m=d?{role:"none"}:{"aria-orientation":n==="vertical"?n:void 0,role:"separator"};return s.jsx(Fe.div,{"data-orientation":n,...m,...t,ref:e})});Me.displayName=es;function ts(c){return ss.includes(c)}var as=Me;function ls(c){const e=Ce.c(12);let d,r,t,n;e[0]!==c?({className:d,orientation:t,decorative:n,...r}=c,e[0]=c,e[1]=d,e[2]=r,e[3]=t,e[4]=n):(d=e[1],r=e[2],t=e[3],n=e[4]);const h=t===void 0?"horizontal":t,m=n===void 0?!0:n;let o;e[5]!==d?(o=De("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",d),e[5]=d,e[6]=o):o=e[6];let f;return e[7]!==m||e[8]!==h||e[9]!==r||e[10]!==o?(f=s.jsx(as,{"data-slot":"separator-root",decorative:m,orientation:h,className:o,...r}),e[7]=m,e[8]=h,e[9]=r,e[10]=o,e[11]=f):f=e[11],f}function As(c){const e=Ce.c(93),{id:d}=c,{auth:r}=Te().props,t=parseInt(d),n=Ee(),[h,m]=oe.useState(!1),[o,f]=oe.useState(!1),[I,Pe]=oe.useState("");let u;e[0]!==t?(u=["shop",t],e[0]=t,e[1]=u):u=e[1];let b;e[2]!==t?(b=i=>i.find(x=>x.id===t),e[2]=t,e[3]=b):b=e[3];let T;e[4]!==u||e[5]!==b?(T={queryKey:u,queryFn:ns,select:b},e[4]=u,e[5]=b,e[6]=T):T=e[6];const{data:l,isLoading:Ue}=we(T);let E;e[7]===Symbol.for("react.memo_cache_sentinel")?(E={queryKey:["users"],queryFn:je.entities.User.list},e[7]=E):E=e[7];const{data:ce}=we(E);let g;e[8]!==t?(g=i=>je.entities.Shop.update(t,{user_ids:i}),e[8]=t,e[9]=g):g=e[9];let j;e[10]!==n||e[11]!==t?(j=()=>{n.invalidateQueries({queryKey:["shop",t]}),Ae.success("Personnel mis à jour avec succès"),m(!1)},e[10]=n,e[11]=t,e[12]=j):j=e[12];let L;e[13]!==g||e[14]!==j?(L={mutationFn:g,onSuccess:j,onError:is},e[13]=g,e[14]=j,e[15]=L):L=e[15];const de=Ge(L);if(Ue){let i;return e[16]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx(be,{currentPageName:"Admin",children:s.jsx("div",{className:"flex h-screen items-center justify-center",children:s.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-indigo-600 border-t-transparent"})})}),e[16]=i):i=e[16],i}if(!l){let i;e[17]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx("h2",{className:"text-2xl font-black text-slate-900",children:"Boutique introuvable"}),e[17]=i):i=e[17];let x;return e[18]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx(be,{currentPageName:"Admin",children:s.jsxs("div",{className:"flex h-screen flex-col items-center justify-center space-y-4",children:[i,s.jsx(ve,{href:"/admin/shops",children:s.jsx(p,{variant:"outline",children:"Retour à la liste"})})]})}),e[18]=x):x=e[18],x}let O;if(e[19]!==ce||e[20]!==r.user.name||e[21]!==r.user.role||e[22]!==h||e[23]!==o||e[24]!==I||e[25]!==l.address||e[26]!==l.counter_count||e[27]!==l.name||e[28]!==l.users||e[29]!==t||e[30]!==de){const i=l.users?.map(rs)||[],x=a=>{const Ne=i.includes(a);if(Ne&&!confirm("Êtes-vous sûr de vouloir désassigner cet utilisateur ?"))return;const ze=Ne?i.filter(Ie=>Ie!==a):[...i,a];de.mutate(ze)},me=`Détails - ${l?.name||""}`;let R;e[32]!==me?(R=s.jsx(Le,{title:me}),e[32]=me,e[33]=R):R=e[33];let $;e[34]===Symbol.for("react.memo_cache_sentinel")?($={x:-4},e[34]=$):$=e[34];let q,H;e[35]===Symbol.for("react.memo_cache_sentinel")?(q=s.jsx(ve,{href:"/admin/shops",children:s.jsx(_e.div,{whileHover:$,children:s.jsx(p,{variant:"ghost",size:"icon",className:"h-12 w-12 rounded-2xl border border-white/40 bg-white/50 shadow-sm backdrop-blur-md hover:bg-white/80",children:s.jsx(Ve,{className:"h-5 w-5 text-indigo-600"})})})}),H=s.jsx("div",{className:"h-10 w-[1px] bg-slate-200"}),e[35]=q,e[36]=H):(q=e[35],H=e[36]);let B;e[37]===Symbol.for("react.memo_cache_sentinel")?(B={scale:1.02},e[37]=B):B=e[37];let F;e[38]===Symbol.for("react.memo_cache_sentinel")?(F=s.jsxs("div",{className:"flex items-center gap-4",children:[q,H,s.jsx(_e.div,{whileHover:B,className:"relative flex h-16 w-38 items-center justify-center p-2",children:s.jsx("img",{src:"/logo-color.png",alt:"Havifin",className:"h-full w-full object-contain"})})]}),e[38]=F):F=e[38];let Q;e[39]===Symbol.for("react.memo_cache_sentinel")?(Q=()=>f(!0),e[39]=Q):Q=e[39];let D;e[40]===Symbol.for("react.memo_cache_sentinel")?(D=s.jsxs(p,{onClick:Q,variant:"outline",className:"h-12 rounded-2xl border-white/40 bg-white/50 px-6 text-xs font-black tracking-widest text-slate-600 uppercase shadow-sm backdrop-blur-md transition-all hover:bg-slate-50",children:[s.jsx(Re,{className:"mr-2 h-4 w-4"}),"Nouveau Manager"]}),e[40]=D):D=e[40];let K;e[41]===Symbol.for("react.memo_cache_sentinel")?(K=()=>m(!0),e[41]=K):K=e[41];let G;e[42]===Symbol.for("react.memo_cache_sentinel")?(G=s.jsxs("div",{className:"flex gap-3",children:[D,s.jsxs(p,{onClick:K,className:"h-12 rounded-2xl bg-indigo-600 px-6 text-xs font-black tracking-widest text-white uppercase shadow-lg shadow-indigo-600/20 transition-all hover:bg-indigo-700 active:scale-95",children:[s.jsx(ge,{className:"mr-2 h-4 w-4"}),"Assigner Personnel"]})]}),e[42]=G):G=e[42];let N;e[43]!==r.user.name?(N=s.jsx("div",{className:"text-sm leading-none font-black text-slate-900",children:r.user.name}),e[43]=r.user.name,e[44]=N):N=e[44];let v;e[45]!==r.user.role?(v=s.jsx("div",{className:"mt-1 text-[9px] font-black tracking-widest text-slate-400 uppercase",children:r.user.role}),e[45]=r.user.role,e[46]=v):v=e[46];let w;e[47]!==N||e[48]!==v?(w=s.jsxs("header",{className:"sticky top-0 z-50 mb-10 flex h-24 w-full flex-col gap-6 border-b border-white/20 bg-white/70 px-6 py-4 shadow-sm backdrop-blur-xl md:flex-row md:items-center md:justify-between md:px-10",children:[F,s.jsxs("div",{className:"flex items-center gap-6",children:[G,s.jsx("div",{className:"flex items-center gap-4 border-l border-slate-200/50 pl-6",children:s.jsxs("div",{className:"flex flex-col items-end text-right",children:[N,v]})})]})]}),e[47]=N,e[48]=v,e[49]=w):w=e[49];let y;e[50]!==o||e[51]!==t?(y=s.jsx($e,{isOpen:o,onOpenChange:f,shopId:t}),e[50]=o,e[51]=t,e[52]=y):y=e[52];let V;e[53]===Symbol.for("react.memo_cache_sentinel")?(V=s.jsx(He,{className:"pb-4",children:s.jsx(Be,{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Informations Générales"})}),e[53]=V):V=e[53];let J,W;e[54]===Symbol.for("react.memo_cache_sentinel")?(J=s.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-slate-50 text-slate-400",children:s.jsx(Ze,{className:"h-5 w-5"})}),W=s.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Localisation"}),e[54]=J,e[55]=W):(J=e[54],W=e[55]);const xe=l.address||"Non spécifiée";let k;e[56]!==xe?(k=s.jsxs("div",{className:"flex items-start gap-4",children:[J,s.jsxs("div",{children:[W,s.jsx("p",{className:"font-bold text-slate-700",children:xe})]})]}),e[56]=xe,e[57]=k):k=e[57];let X,Y;e[58]===Symbol.for("react.memo_cache_sentinel")?(X=s.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-slate-50 text-slate-400",children:s.jsx(Ke,{className:"h-5 w-5"})}),Y=s.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Nombre de Guichets"}),e[58]=X,e[59]=Y):(X=e[58],Y=e[59]);let _;e[60]!==l.counter_count?(_=s.jsxs("div",{className:"flex items-start gap-4",children:[X,s.jsxs("div",{children:[Y,s.jsxs("p",{className:"font-bold text-slate-700",children:[l.counter_count," guichets configurés"]})]})]}),e[60]=l.counter_count,e[61]=_):_=e[61];let Z;e[62]===Symbol.for("react.memo_cache_sentinel")?(Z=s.jsx(ls,{className:"bg-slate-50"}),e[62]=Z):Z=e[62];let ee;e[63]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsx("h4",{className:"mb-2 text-[10px] font-black text-slate-500 uppercase",children:"Capacité Actuelle"}),e[63]=ee):ee=e[63];const he=`${Math.min((l.users?.length||0)/(l.counter_count*2)*100,100)}%`;let S;e[64]!==he?(S=s.jsx("div",{className:"flex-1 rounded-full bg-slate-200",children:s.jsx("div",{className:"h-2 rounded-full bg-indigo-500",style:{width:he}})}),e[64]=he,e[65]=S):S=e[65];const fe=l.users?.length||0;let C;e[66]!==fe?(C=s.jsxs("span",{className:"text-xs font-bold text-slate-600",children:[fe," agents"]}),e[66]=fe,e[67]=C):C=e[67];let A;e[68]!==S||e[69]!==C?(A=s.jsxs("div",{className:"rounded-2xl bg-slate-50 p-4",children:[ee,s.jsxs("div",{className:"flex items-center gap-2",children:[S,C]})]}),e[68]=S,e[69]=C,e[70]=A):A=e[70];let M;e[71]!==k||e[72]!==_||e[73]!==A?(M=s.jsxs(ye,{className:"rounded-[2.5rem] border-slate-100 bg-white shadow-sm",children:[V,s.jsxs(ke,{className:"space-y-6",children:[k,_,Z,A]})]}),e[71]=k,e[72]=_,e[73]=A,e[74]=M):M=e[74];let se,te;e[75]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-1/2 -translate-y-1/2 bg-indigo-500/20 blur-[80px]"}),te=s.jsx("h4",{className:"relative z-10 mb-4 text-xl font-black",children:"Aperçu Rapide"}),e[75]=se,e[76]=te):(se=e[75],te=e[76]);let ae;e[77]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsxs("div",{className:"rounded-2xl bg-white/5 p-4 backdrop-blur-sm",children:[s.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Performance"}),s.jsx("p",{className:"text-lg font-black text-white",children:"100%"})]}),e[77]=ae):ae=e[77];let le;e[78]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsxs("div",{className:"group relative overflow-hidden rounded-[2.5rem] bg-slate-900 p-8 text-white shadow-2xl",children:[se,te,s.jsxs("div",{className:"relative z-10 grid grid-cols-2 gap-4",children:[ae,s.jsxs("div",{className:"rounded-2xl bg-white/5 p-4 backdrop-blur-sm",children:[s.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Tickets"}),s.jsx("p",{className:"text-lg font-black text-white",children:"24"})]})]})]}),e[78]=le):le=e[78];let P;e[79]!==M?(P=s.jsxs("div",{className:"col-span-1 space-y-6",children:[M,le]}),e[79]=M,e[80]=P):P=e[80];let re;e[81]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white shadow-sm",children:s.jsx(ge,{className:"h-5 w-5 text-indigo-600"})}),s.jsx("h3",{className:"text-xl font-black text-slate-900",children:"Personnel Assigné"})]}),e[81]=re):re=e[81];const pe=l.users?.length||0;let ie;e[82]!==pe?(ie=s.jsxs("div",{className:"flex items-center justify-between",children:[re,s.jsxs("p",{className:"text-xs font-bold text-slate-400 uppercase",children:[pe," Membres"]})]}),e[82]=pe,e[83]=ie):ie=e[83];const ue=s.jsxs("div",{className:"flex flex-col gap-6",children:[ie,s.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:l.users&&l.users.length>0?l.users.map(a=>s.jsx(ye,{className:"group overflow-hidden rounded-[2rem] border-slate-100 bg-white transition-all hover:shadow-lg hover:shadow-indigo-500/5",children:s.jsxs(ke,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-indigo-50 text-xl font-black text-indigo-600",children:a.name.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-black text-slate-900",children:a.name}),s.jsx(qe,{variant:"outline",className:"mt-1 rounded-lg border-slate-100 bg-slate-50 px-2 py-0 text-[8px] font-black tracking-widest text-slate-500 uppercase",children:a.role})]})]}),s.jsx(p,{variant:"ghost",size:"icon",onClick:()=>x(a.id),className:"h-9 w-9 text-slate-400 transition-all hover:bg-red-50 hover:text-red-600",children:s.jsx(Je,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"mt-6 flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500",children:[s.jsx(We,{className:"h-3 w-3"})," ",a.email]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500",children:[s.jsx(Xe,{className:"h-3 w-3"})," ","+243 ..."]})]})]})},a.id)):s.jsxs("div",{className:"col-span-full flex h-40 flex-col items-center justify-center rounded-[2.5rem] border-2 border-dashed border-slate-200 bg-white/50",children:[s.jsx(ge,{className:"mb-3 h-8 w-8 text-slate-200"}),s.jsx("p",{className:"text-sm font-bold text-slate-400 italic",children:"Aucun membre assigné"}),s.jsx(p,{variant:"link",onClick:()=>m(!0),className:"font-black text-indigo-600",children:"Assigner maintenant"})]})})]});let U;e[84]!==ue?(U=s.jsx("div",{className:"col-span-1 lg:col-span-2",children:ue}),e[84]=ue,e[85]=U):U=e[85];let z;e[86]!==P||e[87]!==U?(z=s.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[P,U]}),e[86]=P,e[87]=U,e[88]=z):z=e[88];let ne;e[89]!==w||e[90]!==y||e[91]!==z?(ne=s.jsxs("div",{className:"min-h-screen bg-[#f8fafc] px-6 py-8 md:px-10",children:[w,y,z]}),e[89]=w,e[90]=y,e[91]=z,e[92]=ne):ne=e[92],O=s.jsxs(be,{currentPageName:"Admin",children:[R,ne,h&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 p-4 backdrop-blur-sm",children:s.jsxs("div",{className:"w-full max-w-xl animate-in overflow-hidden rounded-[2.5rem] bg-white shadow-2xl duration-300 zoom-in-95",children:[s.jsxs("div",{className:"border-b border-slate-100 bg-slate-50/50 p-8",children:[s.jsx("h3",{className:"text-2xl font-black text-slate-900",children:"Assigner du personnel"}),s.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Sélectionnez les membres à ajouter à"," ",l?.name]}),s.jsxs("div",{className:"relative mt-6",children:[s.jsx(Ye,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-slate-400"}),s.jsx(Qe,{placeholder:"Rechercher un manager...",value:I,onChange:a=>Pe(a.target.value),className:"h-12 rounded-xl border-slate-200 pl-11 font-bold focus:border-indigo-500"})]})]}),s.jsx("div",{className:"custom-scrollbar max-h-[50vh] overflow-y-auto p-8 pr-4",children:s.jsx("div",{className:"space-y-3",children:ce?.filter(a=>a.role==="manager"&&a.name.toLowerCase().includes(I.toLowerCase())).map(a=>s.jsxs("label",{htmlFor:`assign-${a.id}`,className:`flex cursor-pointer items-center justify-between rounded-2xl border p-4 transition-all ${i.includes(a.id)?"border-indigo-600 bg-indigo-50/50 shadow-sm":"border-slate-100 bg-white hover:border-slate-200 hover:bg-slate-50/50"}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl border border-slate-100 bg-white font-black text-slate-600 shadow-sm",children:a.name.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("p",{className:"font-black text-slate-900",children:a.name}),s.jsx("p",{className:"text-[9px] font-black tracking-widest text-slate-400 uppercase",children:a.role})]})]}),s.jsx(Oe,{id:`assign-${a.id}`,checked:i.includes(a.id),onCheckedChange:()=>x(a.id)})]},a.id))})}),s.jsx("div",{className:"flex justify-end border-t border-slate-100 p-8",children:s.jsx(p,{onClick:()=>m(!1),className:"h-12 rounded-2xl bg-slate-900 px-10 text-xs font-black tracking-widest text-white uppercase shadow-xl transition-all hover:bg-black",children:"Terminer"})})]})})]}),e[19]=ce,e[20]=r.user.name,e[21]=r.user.role,e[22]=h,e[23]=o,e[24]=I,e[25]=l.address,e[26]=l.counter_count,e[27]=l.name,e[28]=l.users,e[29]=t,e[30]=de,e[31]=O}else O=e[31];return O}function rs(c){return c.id}function is(){Ae.error("Erreur lors de la mise à jour du personnel")}function ns(){return je.entities.Shop.list()}export{As as default};
