import{r as d,c as m,j as s,u as Pe,L as De}from"./app-ZCVcWHBw.js";import{u as qe,b as K}from"./base44Client-BNl0UU2e.js";import{B as Te,D as Ae,a as Le,c as Ue,d as He}from"./index-gaBAzvHK.js";import{B as P}from"./button-0-m3FkQp.js";import{C as Me,U as Ie,M as Ke}from"./ManagerModal-QNh7bcS_.js";import{I as ke,L as D}from"./label-DBNBirpG.js";import{c as ze,a as x}from"./createLucideIcon-DMMdWEHt.js";import{u as _e}from"./check-Bf4iBBJ-.js";import{t as Q}from"./index-ChCbcm14.js";import{a as Qe}from"./app-main-UKJC7V_L.js";import{U as Be}from"./users-Cgpd6jQx.js";import{T as Ge}from"./trash-2-D1uArQ_d.js";import{P as Ve}from"./plus-Ck8ojNBg.js";const Je=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],We=ze("SquarePen",Je),Fe=d.forwardRef((e,o)=>{const t=m.c(9);let l,r;t[0]!==e?({className:l,...r}=e,t[0]=e,t[1]=l,t[2]=r):(l=t[1],r=t[2]);let a;t[3]!==l?(a=x("w-full caption-bottom text-sm",l),t[3]=l,t[4]=a):a=t[4];let n;return t[5]!==r||t[6]!==o||t[7]!==a?(n=s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:o,className:a,...r})}),t[5]=r,t[6]=o,t[7]=a,t[8]=n):n=t[8],n});Fe.displayName="Table";const $e=d.forwardRef((e,o)=>{const t=m.c(9);let l,r;t[0]!==e?({className:l,...r}=e,t[0]=e,t[1]=l,t[2]=r):(l=t[1],r=t[2]);let a;t[3]!==l?(a=x("[&_tr]:border-b",l),t[3]=l,t[4]=a):a=t[4];let n;return t[5]!==r||t[6]!==o||t[7]!==a?(n=s.jsx("thead",{ref:o,className:a,...r}),t[5]=r,t[6]=o,t[7]=a,t[8]=n):n=t[8],n});$e.displayName="TableHeader";const Re=d.forwardRef((e,o)=>{const t=m.c(9);let l,r;t[0]!==e?({className:l,...r}=e,t[0]=e,t[1]=l,t[2]=r):(l=t[1],r=t[2]);let a;t[3]!==l?(a=x("[&_tr:last-child]:border-0",l),t[3]=l,t[4]=a):a=t[4];let n;return t[5]!==r||t[6]!==o||t[7]!==a?(n=s.jsx("tbody",{ref:o,className:a,...r}),t[5]=r,t[6]=o,t[7]=a,t[8]=n):n=t[8],n});Re.displayName="TableBody";const Xe=d.forwardRef((e,o)=>{const t=m.c(9);let l,r;t[0]!==e?({className:l,...r}=e,t[0]=e,t[1]=l,t[2]=r):(l=t[1],r=t[2]);let a;t[3]!==l?(a=x("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),t[3]=l,t[4]=a):a=t[4];let n;return t[5]!==r||t[6]!==o||t[7]!==a?(n=s.jsx("tfoot",{ref:o,className:a,...r}),t[5]=r,t[6]=o,t[7]=a,t[8]=n):n=t[8],n});Xe.displayName="TableFooter";const z=d.forwardRef((e,o)=>{const t=m.c(9);let l,r;t[0]!==e?({className:l,...r}=e,t[0]=e,t[1]=l,t[2]=r):(l=t[1],r=t[2]);let a;t[3]!==l?(a=x("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),t[3]=l,t[4]=a):a=t[4];let n;return t[5]!==r||t[6]!==o||t[7]!==a?(n=s.jsx("tr",{ref:o,className:a,...r}),t[5]=r,t[6]=o,t[7]=a,t[8]=n):n=t[8],n});z.displayName="TableRow";const A=d.forwardRef((e,o)=>{const t=m.c(9);let l,r;t[0]!==e?({className:l,...r}=e,t[0]=e,t[1]=l,t[2]=r):(l=t[1],r=t[2]);let a;t[3]!==l?(a=x("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),t[3]=l,t[4]=a):a=t[4];let n;return t[5]!==r||t[6]!==o||t[7]!==a?(n=s.jsx("th",{ref:o,className:a,...r}),t[5]=r,t[6]=o,t[7]=a,t[8]=n):n=t[8],n});A.displayName="TableHead";const u=d.forwardRef((e,o)=>{const t=m.c(9);let l,r;t[0]!==e?({className:l,...r}=e,t[0]=e,t[1]=l,t[2]=r):(l=t[1],r=t[2]);let a;t[3]!==l?(a=x("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),t[3]=l,t[4]=a):a=t[4];let n;return t[5]!==r||t[6]!==o||t[7]!==a?(n=s.jsx("td",{ref:o,className:a,...r}),t[5]=r,t[6]=o,t[7]=a,t[8]=n):n=t[8],n});u.displayName="TableCell";const Ye=d.forwardRef((e,o)=>{const t=m.c(9);let l,r;t[0]!==e?({className:l,...r}=e,t[0]=e,t[1]=l,t[2]=r):(l=t[1],r=t[2]);let a;t[3]!==l?(a=x("mt-4 text-sm text-muted-foreground",l),t[3]=l,t[4]=a):a=t[4];let n;return t[5]!==r||t[6]!==o||t[7]!==a?(n=s.jsx("caption",{ref:o,className:a,...r}),t[5]=r,t[6]=o,t[7]=a,t[8]=n):n=t[8],n});Ye.displayName="TableCaption";function gt(){const e=m.c(91),[o,t]=d.useState(!1),[l,r]=d.useState(!1),[a,n]=d.useState(null),L=Pe();let G;e[0]===Symbol.for("react.memo_cache_sentinel")?(G=[],e[0]=G):G=e[0];let V;e[1]===Symbol.for("react.memo_cache_sentinel")?(V={name:"",address:"",counter_count:1,is_active:!0,user_ids:G},e[1]=V):V=e[1];const[c,h]=d.useState(V);let J;e[2]===Symbol.for("react.memo_cache_sentinel")?(J={queryKey:["shops"],queryFn:K.entities.Shop.list},e[2]=J):J=e[2];const{data:W,isLoading:fe}=qe(J);let X;e[3]===Symbol.for("react.memo_cache_sentinel")?(X={queryKey:["users"],queryFn:K.entities.User.list},e[3]=X):X=e[3];const{data:be}=qe(X),U=_e({mutationFn:K.entities.Shop.create,onSuccess:()=>{L.invalidateQueries({queryKey:["shops"]}),t(!1),I(),Q.success("Boutique créée avec succès")},onError:lt}),H=_e({mutationFn:at,onSuccess:()=>{L.invalidateQueries({queryKey:["shops"]}),n(null),t(!1),I(),Q.success("Boutique mise à jour avec succès")},onError:st});let Y;e[4]!==L?(Y={mutationFn:K.entities.Shop.delete,onSuccess:()=>{L.invalidateQueries({queryKey:["shops"]}),Q.success("Boutique supprimée avec succès")}},e[4]=L,e[5]=Y):Y=e[5];const ge=_e(Y),I=()=>{h({name:"",address:"",counter_count:1,is_active:!0,user_ids:[]})};let Z;e[6]!==U||e[7]!==a||e[8]!==c||e[9]!==H?(Z=i=>{i.preventDefault(),a?H.mutate({id:a.id,data:c}):U.mutate(c)},e[6]=U,e[7]=a,e[8]=c,e[9]=H,e[10]=Z):Z=e[10];const je=Z;let ee;e[11]===Symbol.for("react.memo_cache_sentinel")?(ee=i=>{n(i),h({name:i.name,address:i.address||"",counter_count:i.counter_count,is_active:i.is_active,user_ids:i.users?.map(tt)||[]}),t(!0)},e[11]=ee):ee=e[11];const Ee=ee;let te;e[12]!==ge?(te=i=>{confirm("Supprimer cette boutique ?")&&ge.mutate(i)},e[12]=ge,e[13]=te):te=e[13];const Ne=te;let se;e[14]===Symbol.for("react.memo_cache_sentinel")?(se=i=>{h(Se=>{const pe=[...Se.user_ids],Ce=pe.indexOf(i);return Ce>-1?pe.splice(Ce,1):pe.push(i),{...Se,user_ids:pe}})},e[14]=se):se=e[14];const Oe=se;let ae;e[15]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Gestion des Boutiques"}),s.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Configurez vos points de vente et assignez le personnel"})]}),e[15]=ae):ae=e[15];let le;e[16]===Symbol.for("react.memo_cache_sentinel")?(le=()=>r(!0),e[16]=le):le=e[16];let re;e[17]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsxs(P,{onClick:le,variant:"outline",className:"h-11 rounded-xl border-slate-200 bg-white px-6 text-xs font-black tracking-widest text-slate-600 uppercase shadow-sm transition-all hover:bg-slate-50 active:scale-95",children:[s.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Nouveau Manager"]}),e[17]=re):re=e[17];let p;e[18]!==I?(p=()=>{n(null),I(),t(!0)},e[18]=I,e[19]=p):p=e[19];let ie;e[20]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx(Ve,{className:"mr-2 h-4 w-4"}),e[20]=ie):ie=e[20];let f;e[21]!==p?(f=s.jsxs("div",{className:"flex items-center justify-between",children:[ae,s.jsxs("div",{className:"flex items-center gap-3",children:[re,s.jsxs(P,{onClick:p,className:"h-11 rounded-xl bg-indigo-600 px-6 text-xs font-black tracking-widest text-white uppercase shadow-lg shadow-indigo-600/20 transition-all hover:bg-indigo-700 active:scale-95",children:[ie,"Nouvelle Boutique"]})]})]}),e[21]=p,e[22]=f):f=e[22];let b;e[23]!==l?(b=s.jsx(Ke,{isOpen:l,onOpenChange:r}),e[23]=l,e[24]=b):b=e[24];let ne;e[25]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsx($e,{className:"bg-slate-50/50",children:s.jsxs(z,{className:"border-slate-100 hover:bg-transparent",children:[s.jsx(A,{className:"py-5 pl-8 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Boutique"}),s.jsx(A,{className:"text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Guichets"}),s.jsx(A,{className:"text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Personnel"}),s.jsx(A,{className:"text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Statut"}),s.jsx(A,{className:"pr-8 text-right text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Actions"})]})}),e[25]=ne):ne=e[25];let g;e[26]!==Ne||e[27]!==fe||e[28]!==W?(g=fe?s.jsx(z,{children:s.jsx(u,{colSpan:5,className:"h-40 text-center font-medium text-slate-400",children:"Chargement des boutiques..."})}):W?.length===0?s.jsx(z,{children:s.jsxs(u,{colSpan:5,className:"h-40 text-center text-slate-400",children:[s.jsx(Qe,{className:"mx-auto mb-4 h-12 w-12 opacity-10"}),"Aucune boutique configurée"]})}):W?.map(i=>s.jsxs(z,{className:"group border-slate-50 transition-colors hover:bg-slate-50/50",children:[s.jsx(u,{className:"py-6 pl-8",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-black text-slate-900",children:i.name}),s.jsx("div",{className:"text-[10px] font-bold tracking-wider text-slate-400 uppercase",children:i.address||"Sans adresse"})]})}),s.jsx(u,{children:s.jsxs(Te,{variant:"outline",className:"rounded-lg border-slate-200 bg-white px-2 py-1 text-[10px] font-black tracking-widest text-slate-600 uppercase",children:[i.counter_count," Guichet(s)"]})}),s.jsx(u,{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex -space-x-2",children:i.users&&i.users.length>0?i.users.slice(0,3).map(et):s.jsx("span",{className:"text-[10px] font-bold text-slate-300 uppercase italic",children:"Vide"})}),i.users&&i.users.length>3&&s.jsxs("span",{className:"text-[10px] font-black text-slate-400",children:["+",i.users.length-3]})]})}),s.jsx(u,{children:s.jsx(Te,{className:`rounded-full px-3 py-1 text-[9px] font-black tracking-widest uppercase ${i.is_active?"border-none bg-emerald-100 text-emerald-600":"border-none bg-slate-100 text-slate-400"}`,children:i.is_active?"Ouvert":"Fermé"})}),s.jsx(u,{className:"pr-8 text-right",children:s.jsxs("div",{className:"flex justify-end gap-2 opacity-0 transition-opacity group-hover:opacity-100",children:[s.jsx(De,{href:`/admin/shops/${i.id}`,className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-100 bg-white text-slate-400 transition-all hover:border-blue-500 hover:text-blue-600 hover:shadow-lg",children:s.jsx(Be,{className:"h-4 w-4"})}),s.jsx(P,{variant:"ghost",size:"icon",onClick:()=>Ee(i),className:"sm-indigo-500/10 h-9 w-9 rounded-xl border border-slate-100 bg-white text-slate-400 transition-all hover:border-indigo-500 hover:text-indigo-600 hover:shadow-lg",children:s.jsx(We,{className:"h-4 w-4"})}),s.jsx(P,{variant:"ghost",size:"icon",onClick:()=>Ne(i.id),className:"sm-red-500/10 h-9 w-9 rounded-xl border border-slate-100 bg-white text-slate-400 transition-all hover:border-red-500 hover:text-red-600 hover:shadow-lg",children:s.jsx(Ge,{className:"h-4 w-4"})})]})})]},i.id)),e[26]=Ne,e[27]=fe,e[28]=W,e[29]=g):g=e[29];let j;e[30]!==g?(j=s.jsx("div",{className:"overflow-hidden rounded-[2rem] border border-slate-100 bg-white/50 shadow-sm backdrop-blur-xl transition-all",children:s.jsxs(Fe,{children:[ne,s.jsx(Re,{children:g})]})}),e[30]=g,e[31]=j):j=e[31];const ve=a?"Modifier Boutique":"Nouvelle Boutique";let N;e[32]!==ve?(N=s.jsx("div",{className:"border-b border-slate-100 bg-slate-50/50 p-8",children:s.jsx(Ae,{children:s.jsx(Le,{className:"text-2xl font-black tracking-tight text-slate-900",children:ve})})}),e[32]=ve,e[33]=N):N=e[33];let oe;e[34]===Symbol.for("react.memo_cache_sentinel")?(oe=s.jsx(D,{htmlFor:"name",className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Nom de la Boutique"}),e[34]=oe):oe=e[34];let v;e[35]!==c?(v=i=>h({...c,name:i.target.value}),e[35]=c,e[36]=v):v=e[36];let y;e[37]!==c.name||e[38]!==v?(y=s.jsxs("div",{className:"space-y-3",children:[oe,s.jsx(ke,{id:"name",placeholder:"ex: Shop Central",className:"h-12 rounded-xl border-slate-200 font-bold focus:border-indigo-500 focus:ring-indigo-500",value:c.name,onChange:v,required:!0})]}),e[37]=c.name,e[38]=v,e[39]=y):y=e[39];let ce;e[40]===Symbol.for("react.memo_cache_sentinel")?(ce=s.jsx(D,{htmlFor:"counter_count",className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Nombre de Guichets"}),e[40]=ce):ce=e[40];let w;e[41]!==c?(w=i=>h({...c,counter_count:parseInt(i.target.value)}),e[41]=c,e[42]=w):w=e[42];let k;e[43]!==c.counter_count||e[44]!==w?(k=s.jsxs("div",{className:"space-y-3",children:[ce,s.jsx(ke,{id:"counter_count",type:"number",min:"1",className:"h-12 rounded-xl border-slate-200 font-bold focus:border-indigo-500 focus:ring-indigo-500",value:c.counter_count,onChange:w,required:!0})]}),e[43]=c.counter_count,e[44]=w,e[45]=k):k=e[45];let _;e[46]!==y||e[47]!==k?(_=s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[y,k]}),e[46]=y,e[47]=k,e[48]=_):_=e[48];let de;e[49]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx(D,{htmlFor:"address",className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Adresse / Localisation"}),e[49]=de):de=e[49];let S;e[50]!==c?(S=i=>h({...c,address:i.target.value}),e[50]=c,e[51]=S):S=e[51];let C;e[52]!==c.address||e[53]!==S?(C=s.jsxs("div",{className:"space-y-3",children:[de,s.jsx(ke,{id:"address",placeholder:"ex: Av. du Commerce, Kinshasa",className:"h-12 rounded-xl border-slate-200 font-bold focus:border-indigo-500 focus:ring-indigo-500",value:c.address,onChange:S})]}),e[52]=c.address,e[53]=S,e[54]=C):C=e[54];let me;e[55]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsxs(D,{className:"flex items-center gap-2 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[s.jsx(Be,{className:"h-3 w-3"})," Managers Assignés"]}),e[55]=me):me=e[55];let q;e[56]!==c.user_ids||e[57]!==be?(q=be?.filter(Ze).map(i=>s.jsxs("div",{className:`flex items-center gap-3 rounded-xl border p-3 transition-all ${c.user_ids.includes(i.id)?"border-indigo-200 bg-indigo-50/50":"border-slate-100 bg-white hover:border-slate-200"}`,children:[s.jsx(Me,{id:`user-${i.id}`,checked:c.user_ids.includes(i.id),onCheckedChange:()=>Oe(i.id)}),s.jsxs(D,{htmlFor:`user-${i.id}`,className:"flex flex-1 cursor-pointer flex-col",children:[s.jsx("span",{className:"text-xs font-bold text-slate-700",children:i.name}),s.jsx("span",{className:"text-[9px] font-black tracking-wider text-slate-400 uppercase",children:i.role})]})]},i.id)),e[56]=c.user_ids,e[57]=be,e[58]=q):q=e[58];let T;e[59]!==q?(T=s.jsxs("div",{className:"space-y-4",children:[me,s.jsx("div",{className:"custom-scrollbar grid max-h-40 grid-cols-2 gap-3 overflow-y-auto pr-2",children:q})]}),e[59]=q,e[60]=T):T=e[60];let M;e[61]!==c?(M=i=>h({...c,is_active:i}),e[61]=c,e[62]=M):M=e[62];let B;e[63]!==c.is_active||e[64]!==M?(B=s.jsx(Me,{id:"is_active",checked:c.is_active,onCheckedChange:M}),e[63]=c.is_active,e[64]=M,e[65]=B):B=e[65];let ue;e[66]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsx(D,{htmlFor:"is_active",className:"cursor-pointer text-xs font-bold text-slate-600",children:"Boutique Active / Ouverte"}),e[66]=ue):ue=e[66];let F;e[67]!==B?(F=s.jsxs("div",{className:"flex items-center gap-3",children:[B,ue]}),e[67]=B,e[68]=F):F=e[68];let xe;e[69]===Symbol.for("react.memo_cache_sentinel")?(xe=s.jsx(P,{type:"button",variant:"outline",onClick:()=>t(!1),className:"h-12 rounded-xl border-slate-200 px-8 text-xs font-black tracking-widest uppercase hover:bg-slate-50",children:"Annuler"}),e[69]=xe):xe=e[69];const ye=U.isPending||H.isPending,we=U.isPending||H.isPending?"Chargement...":"Enregistrer";let $;e[70]!==ye||e[71]!==we?($=s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[xe,s.jsx(P,{type:"submit",className:"h-12 rounded-xl bg-slate-900 px-8 text-xs font-black tracking-widest text-white uppercase shadow-xl transition-all hover:bg-black",disabled:ye,children:we})]}),e[70]=ye,e[71]=we,e[72]=$):$=e[72];let R;e[73]!==je||e[74]!==_||e[75]!==C||e[76]!==T||e[77]!==F||e[78]!==$?(R=s.jsxs("form",{onSubmit:je,className:"space-y-8 p-8",children:[_,C,T,F,$]}),e[73]=je,e[74]=_,e[75]=C,e[76]=T,e[77]=F,e[78]=$,e[79]=R):R=e[79];let E;e[80]!==N||e[81]!==R?(E=s.jsxs(Ue,{className:"max-w-2xl overflow-hidden rounded-[2.5rem] border-slate-100 p-0",children:[N,R]}),e[80]=N,e[81]=R,e[82]=E):E=e[82];let O;e[83]!==o||e[84]!==E?(O=s.jsx(He,{open:o,onOpenChange:t,children:E}),e[83]=o,e[84]=E,e[85]=O):O=e[85];let he;return e[86]!==f||e[87]!==b||e[88]!==j||e[89]!==O?(he=s.jsxs("div",{className:"space-y-6",children:[f,b,j,O]}),e[86]=f,e[87]=b,e[88]=j,e[89]=O,e[90]=he):he=e[90],he}function Ze(e){return e.role==="manager"}function et(e){return s.jsx("div",{title:e.name,className:"flex h-8 w-8 items-center justify-center rounded-full border-2 border-white bg-indigo-100 text-[10px] font-black text-indigo-600 shadow-sm",children:e.name.charAt(0).toUpperCase()},e.id)}function tt(e){return e.id}function st(e){Q.error(e.response?.data?.message||"Erreur lors de la mise à jour")}function at(e){const{id:o,data:t}=e;return K.entities.Shop.update(o,t)}function lt(e){Q.error(e.response?.data?.message||"Erreur lors de la création")}export{We as S,z as T,u as a,$e as b,A as c,Fe as d,Re as e,gt as f};
