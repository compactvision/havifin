import{c as $,j as s,r as de,a as Te,u as Ee,L as ye,H as Le}from"./app-BN2WBQBk.js";import{u as ke,b as ve}from"./base44Client-CATlPPvs.js";import{C as Oe,U as Re,M as qe}from"./ManagerModal-BMZRKd2F.js";import{B as He}from"./badge-CL9W2qSz.js";import{B as p}from"./button-CUrCXF_m.js";import{a as I,m as _e}from"./createLucideIcon-DARUc-ly.js";import{P as Be,I as Fe}from"./label-B0Rdi9S_.js";import{A as je,a as Qe}from"./app-main-BiQP5eIn.js";import{u as De}from"./check-BG-p6Fnn.js";import{t as Me}from"./index-DWCqWlx2.js";import{A as Ke}from"./arrow-left-CKWkj7Rn.js";import{T as Ge}from"./trash-2-P0Phvutt.js";import{M as Ve}from"./mail-Bqk9tmKJ.js";import{S as Je}from"./smartphone-BQupHVt7.js";import{U as Ne}from"./users-vdEkYr7D.js";import{S as We}from"./search-DqVfPEBh.js";import{M as Xe}from"./map-pin-CFIiWiq3.js";/* empty css            */import"./index-ChcDNbq_.js";import"./loader-circle-BoNHB6rS.js";function Se(i){const e=$.c(8);let a,l;e[0]!==i?({className:a,...l}=i,e[0]=i,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let t;e[3]!==a?(t=I("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),e[3]=a,e[4]=t):t=e[4];let r;return e[5]!==l||e[6]!==t?(r=s.jsx("div",{"data-slot":"card",className:t,...l}),e[5]=l,e[6]=t,e[7]=r):r=e[7],r}function Ye(i){const e=$.c(8);let a,l;e[0]!==i?({className:a,...l}=i,e[0]=i,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let t;e[3]!==a?(t=I("flex flex-col gap-1.5 px-6",a),e[3]=a,e[4]=t):t=e[4];let r;return e[5]!==l||e[6]!==t?(r=s.jsx("div",{"data-slot":"card-header",className:t,...l}),e[5]=l,e[6]=t,e[7]=r):r=e[7],r}function Ze(i){const e=$.c(8);let a,l;e[0]!==i?({className:a,...l}=i,e[0]=i,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let t;e[3]!==a?(t=I("leading-none font-semibold",a),e[3]=a,e[4]=t):t=e[4];let r;return e[5]!==l||e[6]!==t?(r=s.jsx("div",{"data-slot":"card-title",className:t,...l}),e[5]=l,e[6]=t,e[7]=r):r=e[7],r}function Ce(i){const e=$.c(8);let a,l;e[0]!==i?({className:a,...l}=i,e[0]=i,e[1]=a,e[2]=l):(a=e[1],l=e[2]);let t;e[3]!==a?(t=I("px-6",a),e[3]=a,e[4]=t):t=e[4];let r;return e[5]!==l||e[6]!==t?(r=s.jsx("div",{"data-slot":"card-content",className:t,...l}),e[5]=l,e[6]=t,e[7]=r):r=e[7],r}var es="Separator",Ae="horizontal",ss=["horizontal","vertical"],Pe=de.forwardRef((i,e)=>{const{decorative:a,orientation:l=Ae,...t}=i,r=ts(l)?l:Ae,m=a?{role:"none"}:{"aria-orientation":r==="vertical"?r:void 0,role:"separator"};return s.jsx(Be.div,{"data-orientation":r,...m,...t,ref:e})});Pe.displayName=es;function ts(i){return ss.includes(i)}var ls=Pe;function as(i){const e=$.c(12);let a,l,t,r;e[0]!==i?({className:a,orientation:t,decorative:r,...l}=i,e[0]=i,e[1]=a,e[2]=l,e[3]=t,e[4]=r):(a=e[1],l=e[2],t=e[3],r=e[4]);const h=t===void 0?"horizontal":t,m=r===void 0?!0:r;let d;e[5]!==a?(d=I("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",a),e[5]=a,e[6]=d):d=e[6];let f;return e[7]!==m||e[8]!==h||e[9]!==l||e[10]!==d?(f=s.jsx(ls,{"data-slot":"separator-root",decorative:m,orientation:h,className:d,...l}),e[7]=m,e[8]=h,e[9]=l,e[10]=d,e[11]=f):f=e[11],f}function As(i){const e=$.c(93),{id:a}=i,{auth:l}=Te().props,t=parseInt(a),r=Ee(),[h,m]=de.useState(!1),[d,f]=de.useState(!1),[T,Ue]=de.useState("");let u;e[0]!==t?(u=["shop",t],e[0]=t,e[1]=u):u=e[1];let b;e[2]!==t?(b=c=>c.find(x=>x.id===t),e[2]=t,e[3]=b):b=e[3];let E;e[4]!==u||e[5]!==b?(E={queryKey:u,queryFn:ns,select:b},e[4]=u,e[5]=b,e[6]=E):E=e[6];const{data:o,isLoading:ze}=ke(E);let L;e[7]===Symbol.for("react.memo_cache_sentinel")?(L={queryKey:["users"],queryFn:ve.entities.User.list},e[7]=L):L=e[7];const{data:me}=ke(L);let g;e[8]!==t?(g=c=>ve.entities.Shop.update(t,{user_ids:c}),e[8]=t,e[9]=g):g=e[9];let j;e[10]!==r||e[11]!==t?(j=()=>{r.invalidateQueries({queryKey:["shop",t]}),Me.success("Personnel mis à jour avec succès"),m(!1)},e[10]=r,e[11]=t,e[12]=j):j=e[12];let O;e[13]!==g||e[14]!==j?(O={mutationFn:g,onSuccess:j,onError:is},e[13]=g,e[14]=j,e[15]=O):O=e[15];const xe=De(O);if(ze){let c;return e[16]===Symbol.for("react.memo_cache_sentinel")?(c=s.jsx(je,{currentPageName:"Admin",children:s.jsx("div",{className:"flex h-screen items-center justify-center",children:s.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-indigo-600 border-t-transparent"})})}),e[16]=c):c=e[16],c}if(!o){let c;e[17]===Symbol.for("react.memo_cache_sentinel")?(c=s.jsx("h2",{className:"text-2xl font-black text-slate-900",children:"Boutique introuvable"}),e[17]=c):c=e[17];let x;return e[18]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx(je,{currentPageName:"Admin",children:s.jsxs("div",{className:"flex h-screen flex-col items-center justify-center space-y-4",children:[c,s.jsx(ye,{href:"/admin/shops",children:s.jsx(p,{variant:"outline",children:"Retour à la liste"})})]})}),e[18]=x):x=e[18],x}let R;if(e[19]!==me||e[20]!==l.user.name||e[21]!==l.user.role||e[22]!==h||e[23]!==d||e[24]!==T||e[25]!==o.address||e[26]!==o.counter_count||e[27]!==o.name||e[28]!==o.users||e[29]!==t||e[30]!==xe){const c=o.users?.map(rs)||[],x=n=>{const we=c.includes(n);if(we&&!confirm("Êtes-vous sûr de vouloir désassigner cet utilisateur ?"))return;const $e=we?c.filter(Ie=>Ie!==n):[...c,n];xe.mutate($e)},he=`Détails - ${o?.name||""}`;let q;e[32]!==he?(q=s.jsx(Le,{title:he}),e[32]=he,e[33]=q):q=e[33];let H;e[34]===Symbol.for("react.memo_cache_sentinel")?(H={x:-4},e[34]=H):H=e[34];let B,F;e[35]===Symbol.for("react.memo_cache_sentinel")?(B=s.jsx(ye,{href:"/admin/shops",children:s.jsx(_e.div,{whileHover:H,children:s.jsx(p,{variant:"ghost",size:"icon",className:"h-12 w-12 rounded-2xl border border-white/40 bg-white/50 shadow-sm backdrop-blur-md hover:bg-white/80",children:s.jsx(Ke,{className:"h-5 w-5 text-indigo-600"})})})}),F=s.jsx("div",{className:"h-10 w-[1px] bg-slate-200"}),e[35]=B,e[36]=F):(B=e[35],F=e[36]);let Q;e[37]===Symbol.for("react.memo_cache_sentinel")?(Q={scale:1.02},e[37]=Q):Q=e[37];let D;e[38]===Symbol.for("react.memo_cache_sentinel")?(D=s.jsxs("div",{className:"flex items-center gap-4",children:[B,F,s.jsx(_e.div,{whileHover:Q,className:"relative flex h-16 w-38 items-center justify-center p-2",children:s.jsx("img",{src:"/logo-color.png",alt:"Havifin",className:"h-full w-full object-contain"})})]}),e[38]=D):D=e[38];let K;e[39]===Symbol.for("react.memo_cache_sentinel")?(K=()=>f(!0),e[39]=K):K=e[39];let G;e[40]===Symbol.for("react.memo_cache_sentinel")?(G=s.jsxs(p,{onClick:K,variant:"outline",className:"h-12 rounded-2xl border-white/40 bg-white/50 px-6 text-xs font-black tracking-widest text-slate-600 uppercase shadow-sm backdrop-blur-md transition-all hover:bg-slate-50",children:[s.jsx(Re,{className:"mr-2 h-4 w-4"}),"Nouveau Manager"]}),e[40]=G):G=e[40];let V;e[41]===Symbol.for("react.memo_cache_sentinel")?(V=()=>m(!0),e[41]=V):V=e[41];let J;e[42]===Symbol.for("react.memo_cache_sentinel")?(J=s.jsxs("div",{className:"flex gap-3",children:[G,s.jsxs(p,{onClick:V,className:"h-12 rounded-2xl bg-indigo-600 px-6 text-xs font-black tracking-widest text-white uppercase shadow-lg shadow-indigo-600/20 transition-all hover:bg-indigo-700 active:scale-95",children:[s.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Assigner Personnel"]})]}),e[42]=J):J=e[42];let N;e[43]!==l.user.name?(N=s.jsx("div",{className:"text-sm leading-none font-black text-slate-900",children:l.user.name}),e[43]=l.user.name,e[44]=N):N=e[44];let v;e[45]!==l.user.role?(v=s.jsx("div",{className:"mt-1 text-[9px] font-black tracking-widest text-slate-400 uppercase",children:l.user.role}),e[45]=l.user.role,e[46]=v):v=e[46];let w;e[47]!==N||e[48]!==v?(w=s.jsxs("header",{className:"sticky top-0 z-50 mb-10 flex h-24 w-full flex-col gap-6 border-b border-white/20 bg-white/70 px-6 py-4 shadow-sm backdrop-blur-xl md:flex-row md:items-center md:justify-between md:px-10",children:[D,s.jsxs("div",{className:"flex items-center gap-6",children:[J,s.jsx("div",{className:"flex items-center gap-4 border-l border-slate-200/50 pl-6",children:s.jsxs("div",{className:"flex flex-col items-end text-right",children:[N,v]})})]})]}),e[47]=N,e[48]=v,e[49]=w):w=e[49];let y;e[50]!==d||e[51]!==t?(y=s.jsx(qe,{isOpen:d,onOpenChange:f,shopId:t}),e[50]=d,e[51]=t,e[52]=y):y=e[52];let W;e[53]===Symbol.for("react.memo_cache_sentinel")?(W=s.jsx(Ye,{className:"pb-4",children:s.jsx(Ze,{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Informations Générales"})}),e[53]=W):W=e[53];let X,Y;e[54]===Symbol.for("react.memo_cache_sentinel")?(X=s.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-slate-50 text-slate-400",children:s.jsx(Xe,{className:"h-5 w-5"})}),Y=s.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Localisation"}),e[54]=X,e[55]=Y):(X=e[54],Y=e[55]);const fe=o.address||"Non spécifiée";let k;e[56]!==fe?(k=s.jsxs("div",{className:"flex items-start gap-4",children:[X,s.jsxs("div",{children:[Y,s.jsx("p",{className:"font-bold text-slate-700",children:fe})]})]}),e[56]=fe,e[57]=k):k=e[57];let Z,ee;e[58]===Symbol.for("react.memo_cache_sentinel")?(Z=s.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-slate-50 text-slate-400",children:s.jsx(Qe,{className:"h-5 w-5"})}),ee=s.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Nombre de Guichets"}),e[58]=Z,e[59]=ee):(Z=e[58],ee=e[59]);let _;e[60]!==o.counter_count?(_=s.jsxs("div",{className:"flex items-start gap-4",children:[Z,s.jsxs("div",{children:[ee,s.jsxs("p",{className:"font-bold text-slate-700",children:[o.counter_count," guichets configurés"]})]})]}),e[60]=o.counter_count,e[61]=_):_=e[61];let se;e[62]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx(as,{className:"bg-slate-50"}),e[62]=se):se=e[62];let te;e[63]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx("h4",{className:"mb-2 text-[10px] font-black text-slate-500 uppercase",children:"Capacité Actuelle"}),e[63]=te):te=e[63];const pe=`${Math.min((o.users?.length||0)/(o.counter_count*2)*100,100)}%`;let S;e[64]!==pe?(S=s.jsx("div",{className:"flex-1 rounded-full bg-slate-200",children:s.jsx("div",{className:"h-2 rounded-full bg-indigo-500",style:{width:pe}})}),e[64]=pe,e[65]=S):S=e[65];const ue=o.users?.length||0;let C;e[66]!==ue?(C=s.jsxs("span",{className:"text-xs font-bold text-slate-600",children:[ue," agents"]}),e[66]=ue,e[67]=C):C=e[67];let A;e[68]!==S||e[69]!==C?(A=s.jsxs("div",{className:"rounded-2xl bg-slate-50 p-4",children:[te,s.jsxs("div",{className:"flex items-center gap-2",children:[S,C]})]}),e[68]=S,e[69]=C,e[70]=A):A=e[70];let M;e[71]!==k||e[72]!==_||e[73]!==A?(M=s.jsxs(Se,{className:"rounded-[2.5rem] border-slate-100 bg-white shadow-sm",children:[W,s.jsxs(Ce,{className:"space-y-6",children:[k,_,se,A]})]}),e[71]=k,e[72]=_,e[73]=A,e[74]=M):M=e[74];let le,ae;e[75]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-1/2 -translate-y-1/2 bg-indigo-500/20 blur-[80px]"}),ae=s.jsx("h4",{className:"relative z-10 mb-4 text-xl font-black",children:"Aperçu Rapide"}),e[75]=le,e[76]=ae):(le=e[75],ae=e[76]);let re;e[77]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsxs("div",{className:"rounded-2xl bg-white/5 p-4 backdrop-blur-sm",children:[s.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Performance"}),s.jsx("p",{className:"text-lg font-black text-white",children:"100%"})]}),e[77]=re):re=e[77];let ie;e[78]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsxs("div",{className:"group relative overflow-hidden rounded-[2.5rem] bg-slate-900 p-8 text-white shadow-2xl",children:[le,ae,s.jsxs("div",{className:"relative z-10 grid grid-cols-2 gap-4",children:[re,s.jsxs("div",{className:"rounded-2xl bg-white/5 p-4 backdrop-blur-sm",children:[s.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Tickets"}),s.jsx("p",{className:"text-lg font-black text-white",children:"24"})]})]})]}),e[78]=ie):ie=e[78];let P;e[79]!==M?(P=s.jsxs("div",{className:"col-span-1 space-y-6",children:[M,ie]}),e[79]=M,e[80]=P):P=e[80];let ne;e[81]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white shadow-sm",children:s.jsx(Ne,{className:"h-5 w-5 text-indigo-600"})}),s.jsx("h3",{className:"text-xl font-black text-slate-900",children:"Personnel Assigné"})]}),e[81]=ne):ne=e[81];const be=o.users?.length||0;let oe;e[82]!==be?(oe=s.jsxs("div",{className:"flex items-center justify-between",children:[ne,s.jsxs("p",{className:"text-xs font-bold text-slate-400 uppercase",children:[be," Membres"]})]}),e[82]=be,e[83]=oe):oe=e[83];const ge=s.jsxs("div",{className:"flex flex-col gap-6",children:[oe,s.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:o.users&&o.users.length>0?o.users.map(n=>s.jsx(Se,{className:"group overflow-hidden rounded-[2rem] border-slate-100 bg-white transition-all hover:shadow-lg hover:shadow-indigo-500/5",children:s.jsxs(Ce,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-indigo-50 text-xl font-black text-indigo-600",children:n.name.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-black text-slate-900",children:n.name}),s.jsx(He,{variant:"outline",className:"mt-1 rounded-lg border-slate-100 bg-slate-50 px-2 py-0 text-[8px] font-black tracking-widest text-slate-500 uppercase",children:n.role})]})]}),s.jsx(p,{variant:"ghost",size:"icon",onClick:()=>x(n.id),className:"h-9 w-9 text-slate-400 transition-all hover:bg-red-50 hover:text-red-600",children:s.jsx(Ge,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"mt-6 flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500",children:[s.jsx(Ve,{className:"h-3 w-3"})," ",n.email]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500",children:[s.jsx(Je,{className:"h-3 w-3"})," ","+243 ..."]})]})]})},n.id)):s.jsxs("div",{className:"col-span-full flex h-40 flex-col items-center justify-center rounded-[2.5rem] border-2 border-dashed border-slate-200 bg-white/50",children:[s.jsx(Ne,{className:"mb-3 h-8 w-8 text-slate-200"}),s.jsx("p",{className:"text-sm font-bold text-slate-400 italic",children:"Aucun membre assigné"}),s.jsx(p,{variant:"link",onClick:()=>m(!0),className:"font-black text-indigo-600",children:"Assigner maintenant"})]})})]});let U;e[84]!==ge?(U=s.jsx("div",{className:"col-span-1 lg:col-span-2",children:ge}),e[84]=ge,e[85]=U):U=e[85];let z;e[86]!==P||e[87]!==U?(z=s.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[P,U]}),e[86]=P,e[87]=U,e[88]=z):z=e[88];let ce;e[89]!==w||e[90]!==y||e[91]!==z?(ce=s.jsxs("div",{className:"min-h-screen bg-[#f8fafc] px-6 py-8 md:px-10",children:[w,y,z]}),e[89]=w,e[90]=y,e[91]=z,e[92]=ce):ce=e[92],R=s.jsxs(je,{currentPageName:"Admin",children:[q,ce,h&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 p-4 backdrop-blur-sm",children:s.jsxs("div",{className:"w-full max-w-xl animate-in overflow-hidden rounded-[2.5rem] bg-white shadow-2xl duration-300 zoom-in-95",children:[s.jsxs("div",{className:"border-b border-slate-100 bg-slate-50/50 p-8",children:[s.jsx("h3",{className:"text-2xl font-black text-slate-900",children:"Assigner du personnel"}),s.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Sélectionnez les membres à ajouter à"," ",o?.name]}),s.jsxs("div",{className:"relative mt-6",children:[s.jsx(We,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-slate-400"}),s.jsx(Fe,{placeholder:"Rechercher un manager...",value:T,onChange:n=>Ue(n.target.value),className:"h-12 rounded-xl border-slate-200 pl-11 font-bold focus:border-indigo-500"})]})]}),s.jsx("div",{className:"custom-scrollbar max-h-[50vh] overflow-y-auto p-8 pr-4",children:s.jsx("div",{className:"space-y-3",children:me?.filter(n=>n.role==="manager"&&n.name.toLowerCase().includes(T.toLowerCase())).map(n=>s.jsxs("label",{htmlFor:`assign-${n.id}`,className:`flex cursor-pointer items-center justify-between rounded-2xl border p-4 transition-all ${c.includes(n.id)?"border-indigo-600 bg-indigo-50/50 shadow-sm":"border-slate-100 bg-white hover:border-slate-200 hover:bg-slate-50/50"}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl border border-slate-100 bg-white font-black text-slate-600 shadow-sm",children:n.name.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("p",{className:"font-black text-slate-900",children:n.name}),s.jsx("p",{className:"text-[9px] font-black tracking-widest text-slate-400 uppercase",children:n.role})]})]}),s.jsx(Oe,{id:`assign-${n.id}`,checked:c.includes(n.id),onCheckedChange:()=>x(n.id)})]},n.id))})}),s.jsx("div",{className:"flex justify-end border-t border-slate-100 p-8",children:s.jsx(p,{onClick:()=>m(!1),className:"h-12 rounded-2xl bg-slate-900 px-10 text-xs font-black tracking-widest text-white uppercase shadow-xl transition-all hover:bg-black",children:"Terminer"})})]})})]}),e[19]=me,e[20]=l.user.name,e[21]=l.user.role,e[22]=h,e[23]=d,e[24]=T,e[25]=o.address,e[26]=o.counter_count,e[27]=o.name,e[28]=o.users,e[29]=t,e[30]=xe,e[31]=R}else R=e[31];return R}function rs(i){return i.id}function is(){Me.error("Erreur lors de la mise à jour du personnel")}function ns(){return ve.entities.Shop.list()}export{As as default};
