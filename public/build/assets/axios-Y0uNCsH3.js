import{a as c}from"./app-pbanxzkV.js";let s=!1;async function a(){if(!s)try{await i.get("/sanctum/csrf-cookie"),s=!0}catch(e){throw console.error("Failed to initialize CSRF protection:",e),e}}function l(){s=!1}const i=c.create({headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},withCredentials:!0,withXSRFToken:!0});let t=null;i.interceptors.request.use(async e=>{const r=e.method?.toLowerCase()==="get",n=e.url?.includes("/sanctum/csrf-cookie");return!r&&!n&&(t||(t=a().catch(o=>{throw t=null,o})),await t),e},e=>Promise.reject(e));i.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(l(),t=null,console.error("Authentication error (401):",{url:e.config?.url,method:e.config?.method,message:"Session expired or invalid. Please login again."})),Promise.reject(e)));export{i as c};
