import{c as E,j as s,r as de,u as Oe,L as _e,H as Re}from"./app-ZCVcWHBw.js";import{u as Se,b as ye}from"./base44Client-BNl0UU2e.js";import{C as qe,U as Be,M as De}from"./ManagerModal-QNh7bcS_.js";import{B as Ce}from"./index-gaBAzvHK.js";import{B as p}from"./button-0-m3FkQp.js";import{a as O}from"./createLucideIcon-DMMdWEHt.js";import{P as Fe,I as Qe}from"./label-DBNBirpG.js";import{A as ve,a as He}from"./app-main-UKJC7V_L.js";import{u as Ke}from"./check-Bf4iBBJ-.js";import{t as Pe}from"./index-ChCbcm14.js";import{T as Ge}from"./trash-2-D1uArQ_d.js";import{M as Ve}from"./mail-DYxkhF2J.js";import{S as Je}from"./smartphone-QvlF3J57.js";import{U as we}from"./users-Cgpd6jQx.js";import{S as We}from"./search-BNeiIswJ.js";import{A as Xe}from"./arrow-left-aJLIJEn9.js";import{M as Ye}from"./map-pin-Bq5wb2C3.js";/* empty css            */import"./loader-circle-BQNw9mM2.js";function Ae(n){const e=E.c(8);let l,t;e[0]!==n?({className:l,...t}=n,e[0]=n,e[1]=l,e[2]=t):(l=e[1],t=e[2]);let a;e[3]!==l?(a=O("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",l),e[3]=l,e[4]=a):a=e[4];let r;return e[5]!==t||e[6]!==a?(r=s.jsx("div",{"data-slot":"card",className:a,...t}),e[5]=t,e[6]=a,e[7]=r):r=e[7],r}function Ze(n){const e=E.c(8);let l,t;e[0]!==n?({className:l,...t}=n,e[0]=n,e[1]=l,e[2]=t):(l=e[1],t=e[2]);let a;e[3]!==l?(a=O("flex flex-col gap-1.5 px-6",l),e[3]=l,e[4]=a):a=e[4];let r;return e[5]!==t||e[6]!==a?(r=s.jsx("div",{"data-slot":"card-header",className:a,...t}),e[5]=t,e[6]=a,e[7]=r):r=e[7],r}function es(n){const e=E.c(8);let l,t;e[0]!==n?({className:l,...t}=n,e[0]=n,e[1]=l,e[2]=t):(l=e[1],t=e[2]);let a;e[3]!==l?(a=O("leading-none font-semibold",l),e[3]=l,e[4]=a):a=e[4];let r;return e[5]!==t||e[6]!==a?(r=s.jsx("div",{"data-slot":"card-title",className:a,...t}),e[5]=t,e[6]=a,e[7]=r):r=e[7],r}function Me(n){const e=E.c(8);let l,t;e[0]!==n?({className:l,...t}=n,e[0]=n,e[1]=l,e[2]=t):(l=e[1],t=e[2]);let a;e[3]!==l?(a=O("px-6",l),e[3]=l,e[4]=a):a=e[4];let r;return e[5]!==t||e[6]!==a?(r=s.jsx("div",{"data-slot":"card-content",className:a,...t}),e[5]=t,e[6]=a,e[7]=r):r=e[7],r}var ss="Separator",Ue="horizontal",ts=["horizontal","vertical"],Ie=de.forwardRef((n,e)=>{const{decorative:l,orientation:t=Ue,...a}=n,r=as(t)?t:Ue,d=l?{role:"none"}:{"aria-orientation":r==="vertical"?r:void 0,role:"separator"};return s.jsx(Fe.div,{"data-orientation":r,...d,...a,ref:e})});Ie.displayName=ss;function as(n){return ts.includes(n)}var ls=Ie;function is(n){const e=E.c(12);let l,t,a,r;e[0]!==n?({className:l,orientation:a,decorative:r,...t}=n,e[0]=n,e[1]=l,e[2]=t,e[3]=a,e[4]=r):(l=e[1],t=e[2],a=e[3],r=e[4]);const m=a===void 0?"horizontal":a,d=r===void 0?!0:r;let x;e[5]!==l?(x=O("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",l),e[5]=l,e[6]=x):x=e[6];let h;return e[7]!==d||e[8]!==m||e[9]!==t||e[10]!==x?(h=s.jsx(ls,{"data-slot":"separator-root",decorative:d,orientation:m,className:x,...t}),e[7]=d,e[8]=m,e[9]=t,e[10]=x,e[11]=h):h=e[11],h}function As(n){const e=E.c(100),{id:l}=n,t=parseInt(l),a=Oe(),[r,m]=de.useState(!1),[d,x]=de.useState(!1),[h,$e]=de.useState("");let u;e[0]!==t?(u=["shop",t],e[0]=t,e[1]=u):u=e[1];let b;e[2]!==t?(b=o=>o.find(f=>f.id===t),e[2]=t,e[3]=b):b=e[3];let R;e[4]!==u||e[5]!==b?(R={queryKey:u,queryFn:cs,select:b},e[4]=u,e[5]=b,e[6]=R):R=e[6];const{data:i,isLoading:ze}=Se(R);let q;e[7]===Symbol.for("react.memo_cache_sentinel")?(q={queryKey:["users"],queryFn:ye.entities.User.list},e[7]=q):q=e[7];const{data:me}=Se(q);let g;e[8]!==t?(g=o=>ye.entities.Shop.update(t,{user_ids:o}),e[8]=t,e[9]=g):g=e[9];let j;e[10]!==a||e[11]!==t?(j=()=>{a.invalidateQueries({queryKey:["shop",t]}),Pe.success("Personnel mis à jour avec succès"),m(!1)},e[10]=a,e[11]=t,e[12]=j):j=e[12];let B;e[13]!==g||e[14]!==j?(B={mutationFn:g,onSuccess:j,onError:ns},e[13]=g,e[14]=j,e[15]=B):B=e[15];const xe=Ke(B);if(ze){let o;return e[16]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx(ve,{currentPageName:"Admin",children:s.jsx("div",{className:"flex h-screen items-center justify-center",children:s.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-indigo-600 border-t-transparent"})})}),e[16]=o):o=e[16],o}if(!i){let o;e[17]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx("h2",{className:"text-2xl font-black text-slate-900",children:"Boutique introuvable"}),e[17]=o):o=e[17];let f;return e[18]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsx(ve,{currentPageName:"Admin",children:s.jsxs("div",{className:"flex h-screen flex-col items-center justify-center space-y-4",children:[o,s.jsx(_e,{href:"/admin/shops",children:s.jsx(p,{variant:"outline",children:"Retour à la liste"})})]})}),e[18]=f):f=e[18],f}let D;if(e[19]!==me||e[20]!==r||e[21]!==d||e[22]!==h||e[23]!==i.address||e[24]!==i.counter_count||e[25]!==i.id||e[26]!==i.is_active||e[27]!==i.name||e[28]!==i.users||e[29]!==t||e[30]!==xe){const o=i.users?.map(rs)||[],f=c=>{const ke=o.includes(c);if(ke&&!confirm("Êtes-vous sûr de vouloir désassigner cet utilisateur ?"))return;const Le=ke?o.filter(Ee=>Ee!==c):[...o,c];xe.mutate(Le)},he=`Détails - ${i?.name||""}`;let F;e[32]!==he?(F=s.jsx(Re,{title:he}),e[32]=he,e[33]=F):F=e[33];let Q,H;e[34]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsx(_e,{href:"/admin/shops",children:s.jsx(p,{variant:"ghost",size:"icon",className:"h-12 w-12 rounded-2xl bg-white shadow-sm hover:bg-slate-50",children:s.jsx(Xe,{className:"h-5 w-5 text-slate-600"})})}),H=s.jsx("div",{className:"h-12 w-[1px] bg-slate-200"}),e[34]=Q,e[35]=H):(Q=e[34],H=e[35]);let N;e[36]!==i.name?(N=s.jsx("h1",{className:"text-3xl font-black tracking-tight text-slate-900",children:i.name}),e[36]=i.name,e[37]=N):N=e[37];const fe=`rounded-full px-3 py-1 text-[9px] font-black tracking-widest uppercase ${i.is_active?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-400"}`,pe=i.is_active?"Active":"Inactive";let v;e[38]!==fe||e[39]!==pe?(v=s.jsx(Ce,{className:fe,children:pe}),e[38]=fe,e[39]=pe,e[40]=v):v=e[40];let w;e[41]!==N||e[42]!==v?(w=s.jsxs("div",{className:"flex items-center gap-3",children:[N,v]}),e[41]=N,e[42]=v,e[43]=w):w=e[43];const Te=i.id;let y;e[44]===Symbol.for("react.memo_cache_sentinel")?(y=new Date().toLocaleDateString(),e[44]=y):y=e[44];let k;e[45]!==i.id||e[46]!==y?(k=s.jsxs("p",{className:"mt-1 text-sm font-medium text-slate-500",children:["Boutique ID: #",Te," • Crée le"," ",y]}),e[45]=i.id,e[46]=y,e[47]=k):k=e[47];let _;e[48]!==w||e[49]!==k?(_=s.jsxs("div",{className:"flex items-center gap-4",children:[Q,H,s.jsxs("div",{children:[w,k]})]}),e[48]=w,e[49]=k,e[50]=_):_=e[50];let K;e[51]===Symbol.for("react.memo_cache_sentinel")?(K=()=>x(!0),e[51]=K):K=e[51];let G;e[52]===Symbol.for("react.memo_cache_sentinel")?(G=s.jsxs(p,{onClick:K,variant:"outline",className:"h-12 rounded-2xl border-slate-200 bg-white px-6 text-xs font-black tracking-widest text-slate-600 uppercase shadow-sm transition-all hover:bg-slate-50",children:[s.jsx(Be,{className:"mr-2 h-4 w-4"}),"Nouveau Manager"]}),e[52]=G):G=e[52];let V;e[53]===Symbol.for("react.memo_cache_sentinel")?(V=()=>m(!0),e[53]=V):V=e[53];let J;e[54]===Symbol.for("react.memo_cache_sentinel")?(J=s.jsxs("div",{className:"flex items-center gap-3",children:[G,s.jsxs(p,{onClick:V,className:"h-12 rounded-2xl bg-indigo-600 px-6 text-xs font-black tracking-widest text-white uppercase shadow-lg shadow-indigo-600/20 transition-all hover:bg-indigo-700 active:scale-95",children:[s.jsx(we,{className:"mr-2 h-4 w-4"}),"Assigner Personnel"]})]}),e[54]=J):J=e[54];let S;e[55]!==_?(S=s.jsxs("div",{className:"mb-10 flex flex-col items-start justify-between gap-6 md:flex-row md:items-center",children:[_,J]}),e[55]=_,e[56]=S):S=e[56];let C;e[57]!==d||e[58]!==t?(C=s.jsx(De,{isOpen:d,onOpenChange:x,shopId:t}),e[57]=d,e[58]=t,e[59]=C):C=e[59];let W;e[60]===Symbol.for("react.memo_cache_sentinel")?(W=s.jsx(Ze,{className:"pb-4",children:s.jsx(es,{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Informations Générales"})}),e[60]=W):W=e[60];let X,Y;e[61]===Symbol.for("react.memo_cache_sentinel")?(X=s.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-slate-50 text-slate-400",children:s.jsx(Ye,{className:"h-5 w-5"})}),Y=s.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Localisation"}),e[61]=X,e[62]=Y):(X=e[61],Y=e[62]);const ue=i.address||"Non spécifiée";let A;e[63]!==ue?(A=s.jsxs("div",{className:"flex items-start gap-4",children:[X,s.jsxs("div",{children:[Y,s.jsx("p",{className:"font-bold text-slate-700",children:ue})]})]}),e[63]=ue,e[64]=A):A=e[64];let Z,ee;e[65]===Symbol.for("react.memo_cache_sentinel")?(Z=s.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-slate-50 text-slate-400",children:s.jsx(He,{className:"h-5 w-5"})}),ee=s.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Nombre de Guichets"}),e[65]=Z,e[66]=ee):(Z=e[65],ee=e[66]);let M;e[67]!==i.counter_count?(M=s.jsxs("div",{className:"flex items-start gap-4",children:[Z,s.jsxs("div",{children:[ee,s.jsxs("p",{className:"font-bold text-slate-700",children:[i.counter_count," guichets configurés"]})]})]}),e[67]=i.counter_count,e[68]=M):M=e[68];let se;e[69]===Symbol.for("react.memo_cache_sentinel")?(se=s.jsx(is,{className:"bg-slate-50"}),e[69]=se):se=e[69];let te;e[70]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx("h4",{className:"mb-2 text-[10px] font-black text-slate-500 uppercase",children:"Capacité Actuelle"}),e[70]=te):te=e[70];const be=`${Math.min((i.users?.length||0)/(i.counter_count*2)*100,100)}%`;let U;e[71]!==be?(U=s.jsx("div",{className:"flex-1 rounded-full bg-slate-200",children:s.jsx("div",{className:"h-2 rounded-full bg-indigo-500",style:{width:be}})}),e[71]=be,e[72]=U):U=e[72];const ge=i.users?.length||0;let P;e[73]!==ge?(P=s.jsxs("span",{className:"text-xs font-bold text-slate-600",children:[ge," agents"]}),e[73]=ge,e[74]=P):P=e[74];let I;e[75]!==U||e[76]!==P?(I=s.jsxs("div",{className:"rounded-2xl bg-slate-50 p-4",children:[te,s.jsxs("div",{className:"flex items-center gap-2",children:[U,P]})]}),e[75]=U,e[76]=P,e[77]=I):I=e[77];let $;e[78]!==A||e[79]!==M||e[80]!==I?($=s.jsxs(Ae,{className:"rounded-[2.5rem] border-slate-100 bg-white shadow-sm",children:[W,s.jsxs(Me,{className:"space-y-6",children:[A,M,se,I]})]}),e[78]=A,e[79]=M,e[80]=I,e[81]=$):$=e[81];let ae,le;e[82]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-1/2 -translate-y-1/2 bg-indigo-500/20 blur-[80px]"}),le=s.jsx("h4",{className:"relative z-10 mb-4 text-xl font-black",children:"Aperçu Rapide"}),e[82]=ae,e[83]=le):(ae=e[82],le=e[83]);let ie;e[84]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsxs("div",{className:"rounded-2xl bg-white/5 p-4 backdrop-blur-sm",children:[s.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Performance"}),s.jsx("p",{className:"text-lg font-black text-white",children:"100%"})]}),e[84]=ie):ie=e[84];let re;e[85]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsxs("div",{className:"group relative overflow-hidden rounded-[2.5rem] bg-slate-900 p-8 text-white shadow-2xl",children:[ae,le,s.jsxs("div",{className:"relative z-10 grid grid-cols-2 gap-4",children:[ie,s.jsxs("div",{className:"rounded-2xl bg-white/5 p-4 backdrop-blur-sm",children:[s.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Tickets"}),s.jsx("p",{className:"text-lg font-black text-white",children:"24"})]})]})]}),e[85]=re):re=e[85];let z;e[86]!==$?(z=s.jsxs("div",{className:"col-span-1 space-y-6",children:[$,re]}),e[86]=$,e[87]=z):z=e[87];let ne;e[88]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white shadow-sm",children:s.jsx(we,{className:"h-5 w-5 text-indigo-600"})}),s.jsx("h3",{className:"text-xl font-black text-slate-900",children:"Personnel Assigné"})]}),e[88]=ne):ne=e[88];const je=i.users?.length||0;let ce;e[89]!==je?(ce=s.jsxs("div",{className:"flex items-center justify-between",children:[ne,s.jsxs("p",{className:"text-xs font-bold text-slate-400 uppercase",children:[je," Membres"]})]}),e[89]=je,e[90]=ce):ce=e[90];const Ne=s.jsxs("div",{className:"flex flex-col gap-6",children:[ce,s.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:i.users&&i.users.length>0?i.users.map(c=>s.jsx(Ae,{className:"group overflow-hidden rounded-[2rem] border-slate-100 bg-white transition-all hover:shadow-lg hover:shadow-indigo-500/5",children:s.jsxs(Me,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-indigo-50 text-xl font-black text-indigo-600",children:c.name.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-black text-slate-900",children:c.name}),s.jsx(Ce,{variant:"outline",className:"mt-1 rounded-lg border-slate-100 bg-slate-50 px-2 py-0 text-[8px] font-black tracking-widest text-slate-500 uppercase",children:c.role})]})]}),s.jsx(p,{variant:"ghost",size:"icon",onClick:()=>f(c.id),className:"h-9 w-9 text-slate-400 transition-all hover:bg-red-50 hover:text-red-600",children:s.jsx(Ge,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"mt-6 flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500",children:[s.jsx(Ve,{className:"h-3 w-3"})," ",c.email]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500",children:[s.jsx(Je,{className:"h-3 w-3"})," ","+243 ..."]})]})]})},c.id)):s.jsxs("div",{className:"col-span-full flex h-40 flex-col items-center justify-center rounded-[2.5rem] border-2 border-dashed border-slate-200 bg-white/50",children:[s.jsx(we,{className:"mb-3 h-8 w-8 text-slate-200"}),s.jsx("p",{className:"text-sm font-bold text-slate-400 italic",children:"Aucun membre assigné"}),s.jsx(p,{variant:"link",onClick:()=>m(!0),className:"font-black text-indigo-600",children:"Assigner maintenant"})]})})]});let T;e[91]!==Ne?(T=s.jsx("div",{className:"col-span-1 lg:col-span-2",children:Ne}),e[91]=Ne,e[92]=T):T=e[92];let L;e[93]!==z||e[94]!==T?(L=s.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[z,T]}),e[93]=z,e[94]=T,e[95]=L):L=e[95];let oe;e[96]!==S||e[97]!==C||e[98]!==L?(oe=s.jsxs("div",{className:"min-h-screen bg-[#f8fafc] px-6 py-8 md:px-10",children:[S,C,L]}),e[96]=S,e[97]=C,e[98]=L,e[99]=oe):oe=e[99],D=s.jsxs(ve,{currentPageName:"Admin",children:[F,oe,r&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 p-4 backdrop-blur-sm",children:s.jsxs("div",{className:"w-full max-w-xl animate-in overflow-hidden rounded-[2.5rem] bg-white shadow-2xl duration-300 zoom-in-95",children:[s.jsxs("div",{className:"border-b border-slate-100 bg-slate-50/50 p-8",children:[s.jsx("h3",{className:"text-2xl font-black text-slate-900",children:"Assigner du personnel"}),s.jsxs("p",{className:"text-sm font-medium text-slate-500",children:["Sélectionnez les membres à ajouter à"," ",i?.name]}),s.jsxs("div",{className:"relative mt-6",children:[s.jsx(We,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-slate-400"}),s.jsx(Qe,{placeholder:"Rechercher un manager...",value:h,onChange:c=>$e(c.target.value),className:"h-12 rounded-xl border-slate-200 pl-11 font-bold focus:border-indigo-500"})]})]}),s.jsx("div",{className:"custom-scrollbar max-h-[50vh] overflow-y-auto p-8 pr-4",children:s.jsx("div",{className:"space-y-3",children:me?.filter(c=>c.role==="manager"&&c.name.toLowerCase().includes(h.toLowerCase())).map(c=>s.jsxs("label",{htmlFor:`assign-${c.id}`,className:`flex cursor-pointer items-center justify-between rounded-2xl border p-4 transition-all ${o.includes(c.id)?"border-indigo-600 bg-indigo-50/50 shadow-sm":"border-slate-100 bg-white hover:border-slate-200 hover:bg-slate-50/50"}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl border border-slate-100 bg-white font-black text-slate-600 shadow-sm",children:c.name.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("p",{className:"font-black text-slate-900",children:c.name}),s.jsx("p",{className:"text-[9px] font-black tracking-widest text-slate-400 uppercase",children:c.role})]})]}),s.jsx(qe,{id:`assign-${c.id}`,checked:o.includes(c.id),onCheckedChange:()=>f(c.id)})]},c.id))})}),s.jsx("div",{className:"flex justify-end border-t border-slate-100 p-8",children:s.jsx(p,{onClick:()=>m(!1),className:"h-12 rounded-2xl bg-slate-900 px-10 text-xs font-black tracking-widest text-white uppercase shadow-xl transition-all hover:bg-black",children:"Terminer"})})]})})]}),e[19]=me,e[20]=r,e[21]=d,e[22]=h,e[23]=i.address,e[24]=i.counter_count,e[25]=i.id,e[26]=i.is_active,e[27]=i.name,e[28]=i.users,e[29]=t,e[30]=xe,e[31]=D}else D=e[31];return D}function rs(n){return n.id}function ns(){Pe.error("Erreur lors de la mise à jour du personnel")}function cs(){return ye.entities.Shop.list()}export{As as default};
