import{c as G,r as F,j as t,R as xe,b as ye,H as je}from"./app-XPqbswjP.js";import{b as V}from"./base44Client-D_8p-kpS.js";import{L as D,I as M}from"./label-ohV488kT.js";import{c as Z,m as A,a as $}from"./createLucideIcon-CscEagRl.js";import{u as ie,A as K}from"./users-3glLT9eq.js";import{A as J}from"./arrow-right-BHLruwHy.js";import{c as ve,P as re,b as we,a as Ne,C as _e}from"./phone-CiM53lzB.js";import{R as he,A as ke,L as Se}from"./refresh-cw-B5PkTHMb.js";import{T as Ce}from"./trending-up-BkFD3XIn.js";import{B as E,t as ce}from"./index-OjgNDduT.js";import{P as de}from"./plus-V0S5OPa3.js";import{L as Y}from"./loader-circle-uqjuVbFJ.js";import{C as Ae,u as se}from"./check-40j9Q1Ph.js";import{B as ee}from"./building-2-ClP7KNof.js";import{G as ne,C as me}from"./globe-hTSt0l9m.js";import{S as ue,a as ze}from"./smartphone-DFCBQS8K.js";import{C as Pe}from"./circle-check-DZMMeG0N.js";import{C as pe}from"./clock-hY7Azrf4.js";import{A as Fe,S as Re,a as Te}from"./app-main-p7Td2XQe.js";import{h as $e}from"./moment-B-YVwB4U.js";import{L as Ie}from"./lock-zW8xBJEF.js";/* empty css            */import"./axios-G5n3UMvP.js";const Le=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],Me=Z("Coins",Le);const De=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Be=Z("Copy",De);const Ee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],qe=Z("Info",Ee);const He=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Oe=Z("Printer",He);const Ve=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],Ue=Z("Ticket",Ve);function Xe(T){const e=G.c(28),{onSelect:n,initialAmount:l}=T,f=l===void 0?"":l,[a,u]=F.useState(null),[i,x]=F.useState(f),[c,d]=F.useState(null);let v;e[0]===Symbol.for("react.memo_cache_sentinel")?(v={queryKey:["exchange-rates","active"],queryFn:Ke},e[0]=v):v=e[0];const{data:y,isLoading:N}=ie(v);let h;e[1]!==y?(h=y===void 0?[]:y,e[1]=y,e[2]=h):h=e[2];const g=h;let p;e[3]!==i||e[4]!==n||e[5]!==a?(p=()=>{if(a&&i){const{rate:P,side:R}=a,B=R==="buy"?P.buy_rate:P.sell_rate,s=parseFloat(i);if(!isNaN(s)&&B){let j;const L=P.currency_pair?.split("/")||["USD","CDF"];R==="buy"?j=s*B:j=s/B,d(j),n({currency_from:R==="buy"?L[0]:L[1],currency_to:R==="buy"?L[1]:L[0],exchange_rate:B,amount_from:s,amount_to:j})}else d(null)}else d(null)},e[3]=i,e[4]=n,e[5]=a,e[6]=p):p=e[6];let _;if(e[7]!==i||e[8]!==a?(_=[a,i],e[7]=i,e[8]=a,e[9]=_):_=e[9],F.useEffect(p,_),N){let P;return e[10]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(he,{className:"h-12 w-12 animate-spin text-indigo-500"}),t.jsx("p",{className:"mt-4 font-bold text-slate-500",children:"Chargement des taux..."})]}),e[10]=P):P=e[10],P}let b;e[11]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsxs("div",{className:"flex items-center gap-3 px-2",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-indigo-50 text-indigo-500",children:t.jsx(Ce,{className:"h-5 w-5"})}),t.jsx("h3",{className:"text-xl font-black tracking-tight text-slate-800 uppercase",children:"Choisissez votre opération"})]}),e[11]=b):b=e[11];let m;if(e[12]!==g||e[13]!==a){let P;e[15]!==a?(P=(R,B)=>{const s=R.currency_pair?.split("/")||["USD","CDF"];return t.jsxs(xe.Fragment,{children:[t.jsxs("button",{onClick:()=>u({rate:R,side:"buy"}),className:$("group relative flex flex-col items-center justify-center rounded-[2.5rem] border-4 p-8 transition-all duration-300",a?.rate.id===R.id&&a.side==="buy"?"border-indigo-500 bg-white shadow-2xl shadow-indigo-500/20":"border-slate-100 bg-slate-50/50 hover:border-slate-200 hover:bg-white hover:shadow-xl"),children:[t.jsxs("div",{className:"flex items-center gap-4 text-2xl font-black text-slate-900",children:[t.jsx("span",{children:s[0]}),t.jsx(J,{className:$("h-6 w-6 transition-transform group-hover:translate-x-1",a?.side==="buy"?"text-indigo-500":"text-slate-300")}),t.jsx("span",{children:s[1]})]}),t.jsx("div",{className:"mt-4 rounded-2xl bg-indigo-50 px-6 py-2",children:t.jsxs("span",{className:"text-sm font-black text-indigo-600",children:["1 ",s[0]," = ",R.buy_rate," ",s[1]]})})]}),t.jsxs("button",{onClick:()=>u({rate:R,side:"sell"}),className:$("group relative flex flex-col items-center justify-center rounded-[2.5rem] border-4 p-8 transition-all duration-300",a?.rate.id===R.id&&a.side==="sell"?"border-indigo-500 bg-white shadow-2xl shadow-indigo-500/20":"border-slate-100 bg-slate-50/50 hover:border-slate-200 hover:bg-white hover:shadow-xl"),children:[t.jsxs("div",{className:"flex items-center gap-4 text-2xl font-black text-slate-900",children:[t.jsx("span",{children:s[1]}),t.jsx(J,{className:$("h-6 w-6 transition-transform group-hover:translate-x-1",a?.side==="sell"?"text-indigo-500":"text-slate-300")}),t.jsx("span",{children:s[0]})]}),t.jsx("div",{className:"mt-4 rounded-2xl bg-slate-100 px-6 py-2",children:t.jsxs("span",{className:"text-sm font-black text-slate-600",children:[R.sell_rate," ",s[1]," = 1"," ",s[0]]})})]})]},`exchange-rate-${R.id}-${B}`)},e[15]=a,e[16]=P):P=e[16],m=g.map(P),e[12]=g,e[13]=a,e[14]=m}else m=e[14];let w;e[17]!==m?(w=t.jsxs("div",{className:"space-y-6",children:[b,t.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:m})]}),e[17]=m,e[18]=w):w=e[18];let o;e[19]!==i||e[20]!==c||e[21]!==a?(o=a&&t.jsxs(A.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},className:"shadow-3xl overflow-hidden rounded-[3rem] border-4 border-white bg-white/60 p-10 backdrop-blur-2xl",children:[t.jsxs("div",{className:"grid gap-10 md:grid-cols-11 md:items-center",children:[t.jsxs("div",{className:"space-y-4 md:col-span-11 lg:col-span-5",children:[t.jsxs(D,{className:"ml-2 text-sm font-black tracking-widest text-slate-400 uppercase",children:["Montant en"," ",a.side==="buy"?a.rate.currency_pair?.split("/")[0]:a.rate.currency_pair?.split("/")[1]]}),t.jsxs("div",{className:"relative",children:[t.jsx(M,{type:"number",placeholder:"0.00",value:i,onChange:P=>x(P.target.value),className:"h-20 rounded-[2rem] border-none bg-white px-8 text-3xl font-black text-slate-900 shadow-xl focus:ring-4 focus:ring-indigo-500/20"}),t.jsx("div",{className:"absolute top-1/2 right-6 -translate-y-1/2 rounded-xl bg-slate-100 px-4 py-2 text-sm font-black text-slate-500",children:a.side==="buy"?a.rate.currency_pair?.split("/")[0]:a.rate.currency_pair?.split("/")[1]})]})]}),t.jsx("div",{className:"flex justify-center md:col-span-11 lg:col-span-1",children:t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-indigo-500 text-white shadow-lg shadow-indigo-500/30",children:t.jsx(J,{className:"h-6 w-6"})})}),t.jsxs("div",{className:"space-y-4 md:col-span-11 lg:col-span-5",children:[t.jsxs(D,{className:"ml-2 text-sm font-black tracking-widest text-slate-400 uppercase",children:["Vous recevrez (",a.side==="buy"?a.rate.currency_pair?.split("/")[1]:a.rate.currency_pair?.split("/")[0],")"]}),t.jsxs("div",{className:"flex h-20 items-center rounded-[2rem] bg-indigo-500 px-8",children:[t.jsx("span",{className:"text-3xl font-black text-white",children:c!==null?c.toLocaleString(void 0,{maximumFractionDigits:2}):"--.--"}),t.jsx("span",{className:"ml-auto rounded-xl bg-white/20 px-4 py-2 text-sm font-black text-white",children:a.side==="buy"?a.rate.currency_pair?.split("/")[1]:a.rate.currency_pair?.split("/")[0]})]})]})]}),t.jsxs("div",{className:"mt-10 flex flex-wrap items-center justify-between gap-4 border-t border-slate-100 pt-8",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-indigo-50 text-indigo-600",children:t.jsx(ve,{className:"h-5 w-5"})}),t.jsxs("span",{className:"text-lg font-bold text-slate-600",children:["Décompte :"," ",t.jsx("span",{className:"text-slate-900",children:i||"0"})," ",a.side==="buy"?"×":"÷"," ",t.jsx("span",{className:"text-indigo-600",children:a.side==="buy"?a.rate.buy_rate:a.rate.sell_rate})]})]}),t.jsxs("div",{className:"flex items-center gap-2 rounded-2xl bg-slate-50 px-6 py-3",children:[t.jsx(Me,{className:"h-5 w-5 text-amber-500"}),t.jsx("span",{className:"font-black text-slate-900 italic",children:a.side==="buy"?`Taux : 1 ${a.rate.currency_pair?.split("/")[0]} = ${a.rate.buy_rate} ${a.rate.currency_pair?.split("/")[1]}`:`Taux : ${a.rate.sell_rate} ${a.rate.currency_pair?.split("/")[1]} = 1 ${a.rate.currency_pair?.split("/")[0]}`})]})]})]}),e[19]=i,e[20]=c,e[21]=a,e[22]=o):o=e[22];let z;e[23]!==o?(z=t.jsx(K,{children:o}),e[23]=o,e[24]=z):z=e[24];let k;return e[25]!==z||e[26]!==w?(k=t.jsxs("div",{className:"space-y-10",children:[w,z]}),e[25]=z,e[26]=w,e[27]=k):k=e[27],k}function Ke(){return V.entities.ExchangeRate.getAll()}function Ge(T){const e=G.c(20),{phones:n,selectedPhone:l,onSelect:f,onAdd:a,isAdding:u}=T,i=u===void 0?!1:u,[x,c]=F.useState(!1),[d,v]=F.useState("");let y;e[0]!==d||e[1]!==a?(y=async()=>{d.length===10&&(await a(d),c(!1),v(""))},e[0]=d,e[1]=a,e[2]=y):y=e[2];const N=y;let h;if(e[3]!==f||e[4]!==n||e[5]!==l){let b;e[7]!==f||e[8]!==l?(b=m=>t.jsxs(A.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>f(m.phone_number),className:$("relative flex items-center gap-4 overflow-hidden rounded-2xl border-2 p-4 transition-all duration-200",l===m.phone_number?"border-blue-500 bg-blue-50/50 shadow-md":"border-slate-100 bg-white hover:border-slate-200"),children:[t.jsx("div",{className:$("flex h-10 w-10 items-center justify-center rounded-xl",l===m.phone_number?"bg-blue-500 text-white":"bg-slate-100 text-slate-400"),children:t.jsx(re,{className:"h-5 w-5"})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("span",{className:$("block text-lg font-bold",l===m.phone_number?"text-blue-700":"text-slate-700"),children:m.phone_number}),m.is_primary&&t.jsx("span",{className:"rounded-full bg-blue-100 px-2 py-0.5 text-[10px] font-black tracking-wider text-blue-500/60 uppercase",children:"Principal"})]}),l===m.phone_number&&t.jsx(A.div,{initial:{scale:0},animate:{scale:1},className:"flex h-6 w-6 items-center justify-center rounded-full bg-blue-500 text-white",children:t.jsx(Ae,{className:"h-4 w-4"})})]},m.id),e[7]=f,e[8]=l,e[9]=b):b=e[9],h=n.map(b),e[3]=f,e[4]=n,e[5]=l,e[6]=h}else h=e[6];let g;e[10]!==h?(g=t.jsx("div",{className:"grid grid-cols-1 gap-3",children:h}),e[10]=h,e[11]=g):g=e[11];let p;e[12]!==N||e[13]!==i||e[14]!==x||e[15]!==d?(p=t.jsx(K,{children:x?t.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"space-y-3 rounded-2xl border-2 border-blue-100 bg-blue-50/30 p-4",children:[t.jsx(D,{className:"mb-1 block font-bold text-blue-700",children:"Nouveau numéro"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(M,{type:"tel",inputMode:"numeric",pattern:"[0-9]*",value:d,onChange:b=>v(b.target.value.replace(/\D/g,"").slice(0,10)),placeholder:"0XXXXXXXXX",className:"h-12 rounded-xl bg-white focus:border-blue-500 focus:ring-blue-500",autoFocus:!0}),t.jsx(E,{onClick:N,disabled:d.length<10||i,className:"h-12 rounded-xl bg-blue-600 px-6 text-white hover:bg-blue-700",children:i?t.jsx(Y,{className:"h-5 w-5 animate-spin"}):t.jsx(de,{className:"h-5 w-5"})})]}),t.jsx(E,{variant:"ghost",size:"sm",onClick:()=>c(!1),className:"w-full text-slate-500 hover:text-red-500",children:"Annuler"})]}):t.jsxs(A.button,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>c(!0),className:"flex w-full items-center justify-center gap-2 rounded-2xl border-2 border-dashed border-slate-200 p-4 font-bold text-slate-400 transition-all hover:border-blue-300 hover:bg-blue-50/30 hover:text-blue-500",children:[t.jsx(de,{className:"h-5 w-5"}),"Ajouter un nouveau numéro"]})}),e[12]=N,e[13]=i,e[14]=x,e[15]=d,e[16]=p):p=e[16];let _;return e[17]!==g||e[18]!==p?(_=t.jsxs("div",{className:"space-y-4",children:[g,p]}),e[17]=g,e[18]=p,e[19]=_):_=e[19],_}const Qe=[{id:"change",name:"Change Devises",icon:ke,description:"USD ↔ CDF au meilleur taux",color:"from-amber-400 to-orange-500",hover:"shadow-orange-200"},{id:"depot",name:"Dépôt Cash",icon:we,description:"Alimentez vos comptes",color:"from-green-400 to-emerald-600",hover:"shadow-green-200"},{id:"retrait",name:"Retrait Cash",icon:Ne,description:"Retirez vos fonds",color:"from-blue-400 to-indigo-600",hover:"shadow-blue-200"},{id:"paiement",name:"Paiement",icon:_e,description:"Payez vos factures et services",color:"from-purple-400 to-pink-600",hover:"shadow-purple-200"}];function We(T){const e=G.c(5),{selectedOperation:n,onSelect:l}=T;let f;e[0]!==l||e[1]!==n?(f=Qe.map(u=>{const i=u.icon,x=n===u.id;return t.jsxs(A.button,{whileHover:{scale:1.05,y:-5},whileTap:{scale:.95},onClick:()=>l(u.id),className:$("group relative overflow-hidden rounded-[40px] border-4 p-8 text-center transition-all duration-300",x?"border-blue-500 bg-white shadow-2xl shadow-blue-500/20":"border-slate-50 bg-slate-50/50 hover:border-slate-200 hover:bg-white hover:shadow-xl"),children:[t.jsx("div",{className:$("absolute -top-12 -right-12 h-24 w-24 rounded-full blur-[40px] transition-opacity",x?"opacity-20":"opacity-0 group-hover:opacity-10",u.color.replace("from-","bg-"))}),t.jsx("div",{className:$("mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-[28px] bg-gradient-to-br shadow-lg transition-transform group-hover:rotate-6",u.color,x?"scale-110":""),children:t.jsx(i,{className:"h-10 w-10 text-white"})}),t.jsx("h3",{className:$("mb-2 text-xl font-black transition-colors",x?"text-slate-900":"text-slate-700"),children:u.name}),t.jsx("p",{className:"text-sm font-medium text-slate-400 group-hover:text-slate-500",children:u.description}),x&&t.jsx(A.div,{layoutId:"op-indicator",className:"absolute bottom-4 left-1/2 h-2 w-12 -translate-x-1/2 rounded-full bg-blue-500"})]},u.id)}),e[0]=l,e[1]=n,e[2]=f):f=e[2];let a;return e[3]!==f?(a=t.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-4",children:f}),e[3]=f,e[4]=a):a=e[4],a}function Je(T){const e=G.c(30),{institutions:n,selectedId:l,onSelect:f,type:a}=T;let u,i,x,c;if(e[0]!==n||e[1]!==f||e[2]!==l||e[3]!==a){let y;e[8]!==a?(y=k=>k.type===a,e[8]=a,e[9]=y):y=e[9];const N=n.filter(y);let h;e[10]!==a?(h=()=>{switch(a){case"mobile_money":return ue;case"bank":return ee;case"payment":case"other":return ne;default:return ee}},e[10]=a,e[11]=h):h=e[11];const g=h;let p;e[12]!==a?(p=()=>{switch(a){case"mobile_money":return"Opérateurs Mobile";case"bank":return"Banques";case"payment":return"Services de Paiement";case"other":return"Autres Partenaires";default:return"Institutions"}},e[12]=a,e[13]=p):p=e[13];const _=p;let b;e[14]!==g?(b=g(),e[14]=g,e[15]=b):b=e[15];const m=b;x="space-y-4";let w;e[16]!==m?(w=t.jsx(m,{className:"h-5 w-5 text-blue-500"}),e[16]=m,e[17]=w):w=e[17];const o=_();let z;e[18]!==o?(z=t.jsx("h3",{className:"text-lg font-bold text-slate-800",children:o}),e[18]=o,e[19]=z):z=e[19],e[20]!==z||e[21]!==w?(c=t.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[w,z]}),e[20]=z,e[21]=w,e[22]=c):c=e[22],u="grid grid-cols-2 gap-4 md:grid-cols-4",i=N.length>0?N.map(k=>t.jsxs(A.button,{whileHover:{scale:1.03,y:-2},whileTap:{scale:.97},onClick:()=>f(k.id),className:$("relative flex flex-col items-center justify-center rounded-[32px] border-2 p-6 transition-all duration-300",l===k.id?"border-blue-500 bg-white shadow-xl ring-4 shadow-blue-500/10 ring-blue-50":"border-slate-100 bg-slate-50/50 hover:border-slate-200 hover:bg-white"),children:[t.jsx("div",{className:$("mb-4 flex h-16 w-16 items-center justify-center rounded-2xl shadow-inner transition-colors",l===k.id?"bg-blue-50":"bg-white"),children:k.logo_url?t.jsx("img",{src:k.logo_url,alt:k.name,className:"h-10 w-10 object-contain"}):t.jsx(Se,{className:$("h-8 w-8",l===k.id?"text-blue-500":"text-slate-300")})}),t.jsx("span",{className:$("text-center text-sm font-black tracking-tight",l===k.id?"text-blue-700":"text-slate-600"),children:k.name}),l===k.id&&t.jsx(A.div,{layoutId:"active-indicator",className:"absolute -top-1 -right-1 h-6 w-6 rounded-full border-4 border-white bg-blue-500 shadow-sm"})]},k.id)):t.jsxs("div",{className:"col-span-full py-12 text-center",children:[t.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-slate-100 text-slate-300",children:t.jsx(m,{className:"h-8 w-8"})}),t.jsx("p",{className:"text-sm font-bold tracking-widest text-slate-400 uppercase",children:"Aucun partenaire disponible"})]}),e[0]=n,e[1]=f,e[2]=l,e[3]=a,e[4]=u,e[5]=i,e[6]=x,e[7]=c}else u=e[4],i=e[5],x=e[6],c=e[7];let d;e[23]!==u||e[24]!==i?(d=t.jsx("div",{className:u,children:i}),e[23]=u,e[24]=i,e[25]=d):d=e[25];let v;return e[26]!==x||e[27]!==c||e[28]!==d?(v=t.jsxs("div",{className:x,children:[c,d]}),e[26]=x,e[27]=c,e[28]=d,e[29]=v):v=e[29],v}const ae=[{id:"mobile_money",name:"Mobile Money",icon:ue,color:"text-emerald-500"},{id:"bank",name:"Banques",icon:ee,color:"text-blue-500"},{id:"payment",name:"Services de Paiement",icon:ne,color:"text-indigo-500"},{id:"other",name:"Autres",icon:ne,color:"text-amber-500"}];function Ze(T){const e=G.c(25),{institutions:n,selectedId:l,onSelect:f,isLoading:a,operationType:u}=T,[i,x]=xe.useState("mobile_money");let c;e:{if(u==="paiement"){let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=ae.filter(et),e[0]=o):o=e[0],c=o;break e}if(u==="depot"||u==="retrait"){let o;e[1]===Symbol.for("react.memo_cache_sentinel")?(o=ae.filter(Ye),e[1]=o):o=e[1],c=o;break e}c=ae}const d=c;let v,y;if(e[2]!==i||e[3]!==u?(v=()=>{u==="paiement"&&i!=="payment"?x("payment"):u!=="paiement"&&i==="payment"&&x("mobile_money")},y=[u,i],e[2]=i,e[3]=u,e[4]=v,e[5]=y):(v=e[4],y=e[5]),F.useEffect(v,y),a){let o;return e[6]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[t.jsx("div",{className:"mb-4 h-12 w-12 animate-spin rounded-full border-4 border-slate-200 border-t-indigo-600"}),t.jsx("p",{className:"text-sm font-bold tracking-widest text-slate-400 uppercase",children:"Récupération des partenaires..."})]}),e[6]=o):o=e[6],o}let N;e[7]!==i||e[8]!==d?(N=d.length>1&&t.jsx("div",{className:"flex gap-2 rounded-[24px] bg-slate-100 p-1.5",children:d.map(o=>t.jsxs("button",{onClick:()=>x(o.id),className:$("flex flex-1 items-center justify-center gap-2 rounded-[18px] px-4 py-4 text-sm font-bold transition-all",i===o.id?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"),children:[t.jsx(o.icon,{className:$("h-5 w-5",i===o.id?o.color:"text-slate-400")}),o.name]},o.id))}),e[7]=i,e[8]=d,e[9]=N):N=e[9];let h,g,p,_;e[10]===Symbol.for("react.memo_cache_sentinel")?(h={opacity:0,x:20},g={opacity:1,x:0},p={opacity:0,x:-20},_={duration:.2},e[10]=h,e[11]=g,e[12]=p,e[13]=_):(h=e[10],g=e[11],p=e[12],_=e[13]);let b;e[14]!==i||e[15]!==n||e[16]!==f||e[17]!==l?(b=t.jsx(Je,{institutions:n,selectedId:l,onSelect:f,type:i}),e[14]=i,e[15]=n,e[16]=f,e[17]=l,e[18]=b):b=e[18];let m;e[19]!==i||e[20]!==b?(m=t.jsx(K,{mode:"wait",children:t.jsx(A.div,{initial:h,animate:g,exit:p,transition:_,children:b},i)}),e[19]=i,e[20]=b,e[21]=m):m=e[21];let w;return e[22]!==m||e[23]!==N?(w=t.jsxs("div",{className:"space-y-8",children:[N,m]}),e[22]=m,e[23]=N,e[24]=w):w=e[24],w}function Ye(T){return T.id!=="payment"}function et(T){return T.id==="payment"}const tt=T=>{const e=G.c(22),{ticketNumber:n,details:l}=T;let f,a;if(e[0]===Symbol.for("react.memo_cache_sentinel")){const w=new Date;f=w.toLocaleDateString("fr-FR"),a=w.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),e[0]=f,e[1]=a}else f=e[0],a=e[1];const u=a;let i,x,c,d,v;e[2]===Symbol.for("react.memo_cache_sentinel")?(i={width:"58mm",fontFamily:"monospace",fontSize:"12px",color:"black",backgroundColor:"white",padding:"4px"},x=t.jsxs("div",{style:{textAlign:"center",borderBottom:"1px dashed black",paddingBottom:"8px",marginBottom:"8px"},children:[t.jsx("div",{style:{fontSize:"18px",fontWeight:"bold"},children:"HAVIFIN"}),t.jsxs("div",{style:{fontSize:"10px"},children:[f," - ",u]})]}),c={textAlign:"center",padding:"10px 0",borderBottom:"1px dashed black",marginBottom:"8px"},d=t.jsx("div",{style:{fontSize:"10px",textTransform:"uppercase"},children:"Ticket No."}),v={fontSize:"32px",fontWeight:"bold"},e[2]=i,e[3]=x,e[4]=c,e[5]=d,e[6]=v):(i=e[2],x=e[3],c=e[4],d=e[5],v=e[6]);let y;e[7]!==n?(y=t.jsxs("div",{style:c,children:[d,t.jsx("div",{style:v,children:n})]}),e[7]=n,e[8]=y):y=e[8];let N;e[9]===Symbol.for("react.memo_cache_sentinel")?(N={marginBottom:"8px"},e[9]=N):N=e[9];let h;e[10]!==l?(h=l?.service&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Service:"}),t.jsx("span",{children:l.service})]}),e[10]=l,e[11]=h):h=e[11];let g;e[12]!==l?(g=l?.operation_type&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Opér.:"}),t.jsx("span",{children:l.operation_type==="retrait"?"Retrait":"Dépôt"})]}),e[12]=l,e[13]=g):g=e[13];let p;e[14]!==g||e[15]!==h?(p=t.jsxs("div",{style:N,children:[h,g]}),e[14]=g,e[15]=h,e[16]=p):p=e[16];let _,b;e[17]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsxs("div",{style:{textAlign:"center",borderTop:"1px dashed black",paddingTop:"8px"},children:[t.jsx("div",{children:"MERCI DE VOTRE CONFIANCE"}),t.jsx("div",{style:{fontSize:"10px",marginTop:"4px"},children:"Attendez votre tour sur l'écran"})]}),b=t.jsx("div",{style:{height:"40px"}}),e[17]=_,e[18]=b):(_=e[17],b=e[18]);let m;return e[19]!==p||e[20]!==y?(m=t.jsxs("div",{id:"printable-ticket",style:i,children:[x,y,p,_,b]}),e[19]=p,e[20]=y,e[21]=m):m=e[21],m};function st(T){const e=G.c(38),{ticketNumber:n,onNewTicket:l}=T;let f,a;e[0]!==n?(f=()=>{if(n){const te=setTimeout(it,1e3);return()=>clearTimeout(te)}},a=[n],e[0]=n,e[1]=f,e[2]=a):(f=e[1],a=e[2]),F.useEffect(f,a);const u=at;let i,x;e[3]===Symbol.for("react.memo_cache_sentinel")?(i={opacity:0,scale:.95},x={opacity:1,scale:1},e[3]=i,e[4]=x):(i=e[3],x=e[4]);let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(A.div,{initial:{scale:.8,opacity:0},animate:{scale:1.5,opacity:0},transition:{repeat:1/0,duration:2,ease:"easeOut"},className:"absolute inset-0 rounded-full bg-green-500/20"}),e[5]=c):c=e[5];let d,v,y;e[6]===Symbol.for("react.memo_cache_sentinel")?(d={scale:0},v={scale:1},y={type:"spring",stiffness:200,damping:20},e[6]=d,e[7]=v,e[8]=y):(d=e[6],v=e[7],y=e[8]);let N,h,g;e[9]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsxs("div",{className:"relative mb-12",children:[c,t.jsx(A.div,{initial:d,animate:v,transition:y,className:"relative mx-auto flex h-28 w-28 items-center justify-center rounded-[36px] bg-gradient-to-br from-emerald-400 to-green-600 shadow-2xl shadow-green-500/30",children:t.jsx(Pe,{className:"h-14 w-14 text-white"})})]}),N=t.jsx("h2",{className:"mb-2 text-4xl font-black tracking-tight text-slate-900",children:"C'est fait !"}),h=t.jsx("p",{className:"mb-10 text-xl font-medium text-slate-500",children:"Votre ticket a été généré avec succès"}),e[9]=N,e[10]=h,e[11]=g):(N=e[9],h=e[10],g=e[11]);let p,_,b;e[12]===Symbol.for("react.memo_cache_sentinel")?(p={y:30,opacity:0},_={y:0,opacity:1},b={delay:.3,type:"spring"},e[12]=p,e[13]=_,e[14]=b):(p=e[12],_=e[13],b=e[14]);let m,w;e[15]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-8 -translate-y-8 rounded-full bg-white/5 blur-2xl transition-transform group-hover:scale-150"}),w=t.jsx("div",{className:"absolute bottom-0 left-0 h-24 w-24 -translate-x-8 translate-y-8 rounded-full bg-blue-500/10 blur-xl"}),e[15]=m,e[16]=w):(m=e[15],w=e[16]);let o;e[17]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsxs("div",{className:"mb-6 flex items-center justify-center gap-3 text-amber-400",children:[t.jsx(Ue,{className:"h-6 w-6 rotate-12"}),t.jsx("span",{className:"text-sm font-black tracking-[0.2em] uppercase",children:"Ticket No."})]}),e[17]=o):o=e[17];let z;e[18]!==n?(z=t.jsx("div",{className:"mb-8 font-mono text-7xl font-black tracking-tighter text-white",children:n}),e[18]=n,e[19]=z):z=e[19];let k;e[20]===Symbol.for("react.memo_cache_sentinel")?(k=t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/5 bg-white/5 px-4 py-2 text-sm font-bold text-slate-400",children:[t.jsx(pe,{className:"h-4 w-4 text-amber-500"}),t.jsx("span",{children:"Attendez d'être appelé sur l'écran"})]}),e[20]=k):k=e[20];let P;e[21]!==z?(P=t.jsxs(A.div,{initial:p,animate:_,transition:b,className:"group relative mx-auto max-w-sm overflow-hidden rounded-[40px] bg-slate-900 p-10 shadow-2xl",children:[m,w,t.jsxs("div",{className:"relative z-10",children:[o,z,k]})]}),e[21]=z,e[22]=P):P=e[22];let R,B,s;e[23]===Symbol.for("react.memo_cache_sentinel")?(R={opacity:0},B={opacity:1},s={delay:.6},e[23]=R,e[24]=B,e[25]=s):(R=e[23],B=e[24],s=e[25]);let j;e[26]===Symbol.for("react.memo_cache_sentinel")?(j=t.jsx(he,{className:"mr-2 h-5 w-5 text-blue-500"}),e[26]=j):j=e[26];let L;e[27]!==l?(L=t.jsxs(E,{onClick:l,className:"h-14 rounded-2xl border-none bg-slate-100 px-10 font-black tracking-tight text-slate-900 shadow-none transition-all hover:scale-105 hover:bg-slate-200 active:scale-95",children:[j,"Nouvelle opération"]}),e[27]=l,e[28]=L):L=e[28];let U;e[29]===Symbol.for("react.memo_cache_sentinel")?(U=t.jsxs(E,{onClick:u,variant:"ghost",className:"ml-4 h-14 rounded-2xl border-none bg-white/10 px-10 font-black tracking-tight text-white shadow-none transition-all hover:bg-white/20 active:scale-95",children:[t.jsx(Oe,{className:"mr-2 h-5 w-5 text-indigo-400"}),"Réimprimer"]}),e[29]=U):U=e[29];let q;e[30]!==n?(q=n&&t.jsx(tt,{ticketNumber:n}),e[30]=n,e[31]=q):q=e[31];let X;e[32]!==L||e[33]!==q?(X=t.jsxs(A.div,{initial:R,animate:B,transition:s,className:"mt-12",children:[L,U,q]}),e[32]=L,e[33]=q,e[34]=X):X=e[34];let Q;return e[35]!==P||e[36]!==X?(Q=t.jsxs(A.div,{initial:i,animate:x,className:"py-8 text-center",children:[g,N,h,P,X]}),e[35]=P,e[36]=X,e[37]=Q):Q=e[37],Q}function at(){window.print()}function it(){window.print()}function At(){const{auth:T}=ye().props,[e,n]=F.useState(1),[l,f]=F.useState(null),[a,u]=F.useState(!1),[i,x]=F.useState(null),[c,d]=F.useState(!1),[v,y]=F.useState(!1),[N,h]=F.useState(!1),[g,p]=F.useState(""),[_,b]=F.useState([]),[m,w]=F.useState(!1),[o,z]=F.useState(!1),{data:k=[],isPending:P}=ie({queryKey:["institutions","active"],queryFn:()=>V.entities.Institution.active()}),{data:R,isLoading:B}=ie({queryKey:["current-session"],queryFn:()=>V.entities.Session.current(),refetchInterval:1e4}),[s,j]=F.useState({phone:"",operation_type:"",institution_id:void 0,first_name:"",last_name:"",email:"",address:"",amount:"",currency:"USD",reason:"",beneficiary:"",beneficiary_number:"",account_number:"",currency_from:"",currency_to:"",amount_from:0,exchange_rate:0,metadata:{}});F.useEffect(()=>{(async()=>{if(s.phone.length===10&&!i&&!c){u(!0);try{const C=await V.entities.Client.verifyPhone(s.phone);C.exists&&C.client?(x(C.client),j(H=>({...H,phone:s.phone})),n(2),d(!1)):(x(null),d(!0))}catch(C){console.error("Phone verification failed:",C)}finally{u(!1)}}})()},[s.phone,i,c]);const L=se({mutationFn:async()=>(await V.entities.Client.register({phone:s.phone,first_name:s.first_name,last_name:s.last_name,email:s.email,address:s.address})).client,onSuccess:r=>{x(r),d(!1),n(2)}}),U=se({mutationFn:async r=>i?(await V.entities.Client.addPhone(i.id,r)).phone:void 0,onSuccess:r=>{i&&r&&x({...i,phones:[...i.phones||[],r]})}}),q=se({mutationFn:async r=>{const C={...r,phone:s.phone,status:"waiting",first_name:i?.first_name||r.first_name||"Client",last_name:i?.last_name||r.last_name||"Anonyme",is_registered:!!i&&!v,metadata:s.metadata};return(await V.entities.Client.create(C)).ticket_number},onSuccess:r=>{f(r),n(3)},onError:r=>{const C=r.response?.data?.error||r.response?.data?.message||"Une erreur est survenue lors de la création du ticket";ce.error(C)}}),X=async()=>{if(!(g.length<2)){w(!0);try{const r=await V.entities.Client.filter({first_name:g});b(r)}catch(r){console.error(r)}finally{w(!1)}}},Q=async r=>{try{await U.mutateAsync(s.phone);const C=await V.entities.Client.addPhone(r.id,s.phone);C.success&&C.phone&&(x({...r,phones:[...r.phones||[],C.phone]}),h(!1),d(!1),n(2))}catch(C){console.error("Failed to link account",C)}},te=()=>{if(e===1)c?L.mutate():i&&n(2);else if(e===2){if(s.operation_type==="change")q.mutate({...s,service:"bureau",amount:s.amount?Number(s.amount):void 0,amount_from:s.amount_from,exchange_rate:s.exchange_rate,currency_from:s.currency_from,currency_to:s.currency_to});else if(s.operation_type&&s.institution_id){const r=k.find(C=>C.id===s.institution_id);q.mutate({...s,operation_type:s.operation_type,service:r?.name||"",currency_from:s.currency,amount:s.amount?Number(s.amount):void 0,notes:`Motif: ${s.reason}${s.beneficiary?` | Bénéficiaire: ${s.beneficiary}`:""}${s.beneficiary_number?` | Numéro Bénéficiaire: ${s.beneficiary_number}`:""}${s.account_number?` | Compte: ${s.account_number}`:""}`})}}},le=()=>{n(1),be()},be=()=>{f(null),x(null),d(!1),y(!1),h(!1),z(!1),p(""),b([]),j({phone:"",operation_type:"",institution_id:void 0,first_name:"",last_name:"",email:"",address:"",amount:"",currency:"USD",reason:"",beneficiary:"",beneficiary_number:"",account_number:"",metadata:{}})},fe=()=>{if(e===1)return c?s.first_name.trim()!==""&&s.last_name.trim()!=="":!!i;if(e===2){if(s.operation_type==="change")return!!(s.amount&&s.amount_from&&s.exchange_rate);if(s.operation_type==="paiement")return!0;if(!!!(s.operation_type&&s.institution_id))return!1;if(s.operation_type==="depot"||s.operation_type==="retrait"){const C=k.find(S=>S.id===s.institution_id),H=!!s.amount;if(s.operation_type==="retrait")return H;const O=C?.settings;if(O?.required_fields||O?.custom_fields){const S=O?.required_fields||[],I=[H];return S.includes("account_number")&&I.push(!!s.account_number),S.includes("beneficiary")&&I.push(!!s.beneficiary),S.includes("beneficiary_number")&&I.push(!!s.beneficiary_number),S.includes("reason")&&I.push(!!s.reason),(O?.custom_fields||[]).filter(W=>!W.operation_type||W.operation_type==="both"||W.operation_type===s.operation_type).forEach(W=>{I.push(!!s.metadata[W.id])}),I.every(Boolean)}return C?.type==="bank"?!!(H&&s.account_number&&s.beneficiary):!!(H&&s.beneficiary&&s.beneficiary_number)}return!0}return!0},ge=()=>{switch(e){case 1:return t.jsxs(A.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"space-y-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"mb-8 flex h-20 w-20 items-center justify-center rounded-[24px] border border-white/20 bg-gradient-to-br from-brand-cyan/20 to-brand-purple/20 shadow-xl shadow-brand-purple/20 backdrop-blur-xl transition-transform group-hover:scale-110",children:t.jsx(re,{className:"h-12 w-12 text-brand-dark transition-transform group-hover:rotate-12"})}),t.jsx("h2",{className:"text-4xl font-black tracking-tight text-slate-800 drop-shadow-sm",children:c?"Nouvelle Inscription":"Bienvenue chez Havifin"}),t.jsx("p",{className:"mt-3 text-lg font-bold tracking-[0.2em] text-brand-blue uppercase",children:T.user?.shop}),t.jsx("p",{className:"mt-2 text-lg font-medium text-slate-600",children:c?"Laissez-nous faire connaissance pour mieux vous servir":"Identifiez-vous pour commencer votre opération"})]}),t.jsxs("div",{className:"mx-auto max-w-lg space-y-6",children:[!i&&!c&&t.jsxs("div",{className:"group relative",children:[t.jsx("div",{className:"absolute -inset-1 rounded-[28px] bg-gradient-to-r from-brand-cyan/40 via-brand-purple/40 to-brand-pink/40 opacity-60 blur-xl transition duration-1000 group-hover:opacity-100 group-hover:duration-200"}),t.jsx(M,{type:"tel",inputMode:"numeric",pattern:"[0-9]*",value:s.phone,onChange:r=>j({...s,phone:r.target.value.replace(/\D/g,"").slice(0,10)}),placeholder:"Entrez votre numéro (10 chiffres)",className:"relative h-20 rounded-[24px] border-2 border-white/30 bg-white/40 text-center font-mono text-2xl font-black text-slate-900 shadow-2xl shadow-purple-500/20 backdrop-blur-2xl transition-all placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30",autoFocus:!0,disabled:a}),a&&t.jsx("div",{className:"absolute top-1/2 right-6 -translate-y-1/2",children:t.jsx(Y,{className:"h-6 w-6 animate-spin text-brand-cyan"})})]}),N&&t.jsx(A.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"pt-6",children:t.jsxs("div",{className:"space-y-6 rounded-[32px] border border-white/20 bg-white/60 p-8 shadow-xl backdrop-blur-xl",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-xl font-black text-slate-800",children:"Lier à un compte existant"}),t.jsx("p",{className:"text-sm text-slate-500",children:"Recherchez le client propriétaire de ce numéro"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(M,{placeholder:"Rechercher par nom...",value:g,onChange:r=>p(r.target.value),className:"h-12 rounded-xl bg-white"}),t.jsx(E,{onClick:X,disabled:m,className:"h-12 rounded-xl bg-cyan-600 text-white hover:bg-cyan-700",children:m?t.jsx(Y,{className:"h-4 w-4 animate-spin"}):t.jsx(ze,{className:"h-4 w-4"})})]}),t.jsx("div",{className:"max-h-60 space-y-2 overflow-y-auto",children:_.map(r=>t.jsxs("div",{onClick:()=>Q(r),className:"flex cursor-pointer items-center justify-between rounded-xl border border-slate-100 bg-white p-4 transition-colors hover:border-cyan-200 hover:bg-cyan-50",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"font-bold text-slate-900",children:[r.first_name," ",r.last_name]}),t.jsx("p",{className:"text-xs text-slate-500",children:r.phone})]}),t.jsx(J,{className:"h-4 w-4 text-brand-cyan"})]},r.id))}),t.jsx(E,{variant:"ghost",onClick:()=>h(!1),className:"w-full text-slate-500 hover:text-red-500",children:"Annuler"})]})}),c&&!N&&t.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4 pt-6",children:[t.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-white/30 bg-white/10 px-6 py-4 shadow-xl backdrop-blur-xl",children:[t.jsx("span",{className:"text-sm font-bold text-slate-600",children:"Numéro à enregistrer"}),t.jsx("span",{className:"font-mono text-xl font-black text-brand-cyan",children:s.phone})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:"Prénom"}),t.jsx(M,{placeholder:"Jean",value:s.first_name,onChange:r=>j({...s,first_name:r.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:"Nom"}),t.jsx(M,{placeholder:"Lozé",value:s.last_name,onChange:r=>j({...s,last_name:r.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:"Email (Optionnel)"}),t.jsx(M,{placeholder:"jean.loze@example.com",type:"email",value:s.email,onChange:r=>j({...s,email:r.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:"Adresse (Optionnelle)"}),t.jsx(M,{placeholder:"Gombe, Kinshasa",value:s.address,onChange:r=>j({...s,address:r.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs(E,{variant:"ghost",onClick:()=>{d(!1),j({...s,phone:""})},className:"h-14 w-full rounded-2xl font-bold text-slate-500 transition-colors hover:bg-slate-100",children:[t.jsx(me,{className:"mr-2 h-5 w-5"})," ","Retour"]}),t.jsx(E,{variant:"outline",onClick:()=>h(!0),className:"h-14 w-full rounded-2xl border-2 border-dashed border-brand-cyan/40 bg-brand-cyan/10 font-bold text-brand-cyan hover:bg-brand-cyan/20",children:"Déjà client ? Lier ce numéro"})]})]})]});case 2:return t.jsxs(A.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-12",children:[t.jsxs("div",{className:"space-y-2 text-center",children:[t.jsx(A.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-2 inline-block rounded-full bg-brand-blue/10 px-4 py-1 text-xs font-black tracking-widest text-brand-blue uppercase",children:"Étape 2 • Opération"}),t.jsxs("h2",{className:"text-4xl font-black tracking-tight text-slate-900",children:["Bonjour"," ",t.jsx("span",{className:"text-brand-blue",children:i?.first_name||s.first_name}),",",t.jsx("p",{className:"text-lg font-medium text-slate-600",children:"Que souhaitez-vous faire aujourd'hui ?"})]})]}),i&&t.jsxs(A.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"rounded-[24px] border border-slate-200 bg-slate-50/50 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-blue-100 text-blue-600",children:t.jsx(re,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-500 uppercase",children:"Numéro Actif"}),t.jsx("p",{className:"font-mono text-xl font-bold text-slate-900",children:s.phone})]})]}),t.jsxs(E,{variant:"ghost",onClick:()=>z(!o),className:"font-bold text-slate-600 hover:text-slate-800",children:[t.jsx(me,{className:o?"mr-2 h-4 w-4 -rotate-90 transition-transform":"mr-2 h-4 w-4 transition-transform"}),"Changer"]})]}),t.jsx(K,{children:o&&t.jsx(A.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden bg-white/50 pt-4",children:t.jsx(Ge,{phones:i.phones||[],selectedPhone:s.phone,onSelect:r=>{j({...s,phone:r}),z(!1)},onAdd:async r=>{await U.mutateAsync(r)},isAdding:U.isPending})})})]}),t.jsxs("div",{className:"grid gap-10",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"text-center md:text-left",children:t.jsx("h3",{className:"text-2xl font-black text-slate-800",children:"Opérations disponibles"})}),t.jsx(We,{selectedOperation:s.operation_type,onSelect:r=>j({...s,operation_type:r,institution_id:void 0})})]}),t.jsxs(K,{children:[s.operation_type==="change"&&t.jsx(A.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:t.jsx(Xe,{initialAmount:s.amount_from>0?s.amount_from.toString():"",onSelect:r=>{j({...s,currency_from:r.currency_from,currency_to:r.currency_to,exchange_rate:r.exchange_rate,amount_from:r.amount_from,amount:r.amount_to.toString()})}})}),s.operation_type&&s.operation_type!=="change"&&t.jsxs(A.div,{initial:{opacity:0,height:0,y:20},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:20},className:"space-y-4 overflow-hidden",children:[t.jsx(D,{className:"ml-4 block text-sm font-black tracking-widest text-slate-400 uppercase",children:"Partenaire Bancaire / Mobile"}),t.jsx(Ze,{institutions:k,selectedId:s.institution_id,onSelect:r=>j({...s,institution_id:r}),operationType:s.operation_type})]},"service-selector-container"),t.jsx(K,{children:(s.operation_type==="depot"||s.operation_type==="retrait")&&s.institution_id&&t.jsx(A.div,{initial:{opacity:0,height:0,y:20},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:20},className:"space-y-4 pt-4",children:(()=>{const r=k.find(S=>S.id===s.institution_id),C=r?.settings,H=C?.required_fields,O=S=>s.operation_type==="retrait"?!1:H?H.includes(S):r?.type==="bank"?["account_number","beneficiary","reason"].includes(S):["beneficiary_number","beneficiary","reason"].includes(S);return t.jsxs("div",{className:"grid gap-6",children:[O("account_number")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:"Numéro de compte"}),t.jsx(M,{value:s.account_number,onChange:S=>j({...s,account_number:S.target.value}),placeholder:"Compte bancaire...",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),O("beneficiary_number")&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:"Numéro du bénéficiaire"}),t.jsx("button",{type:"button",onClick:()=>j({...s,beneficiary_number:s.phone}),className:"text-xs font-bold text-cyan-800 transition-colors hover:text-cyan-900",children:"Utiliser le mien"})]}),t.jsx(M,{value:s.beneficiary_number,onChange:S=>j({...s,beneficiary_number:S.target.value}),placeholder:"08...",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:"Montant"}),t.jsxs("div",{className:"relative",children:[t.jsx(M,{type:"number",value:s.amount,onChange:S=>j({...s,amount:S.target.value}),placeholder:"0.00",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 pr-24 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"}),t.jsx("div",{className:"absolute top-1 right-1 bottom-1 flex rounded-xl bg-slate-100 p-1",children:["USD","CDF"].map(S=>t.jsx("button",{onClick:()=>j({...s,currency:S}),className:`relative z-10 w-12 rounded-lg text-sm font-black transition-all ${s.currency===S?"bg-white text-slate-900 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:S},S))})]})]}),O("beneficiary")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:"Bénéficiaire"}),t.jsx(M,{value:s.beneficiary,onChange:S=>j({...s,beneficiary:S.target.value}),placeholder:"Nom du bénéficiaire",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]})]}),s.operation_type==="retrait"&&t.jsxs("div",{className:"rounded-[2.5rem] border-2 border-indigo-100/50 bg-white/40 p-10 shadow-[0_20px_50px_rgba(79,70,229,0.1)] backdrop-blur-2xl transition-all hover:shadow-[0_20px_50px_rgba(79,70,229,0.15)]",children:[t.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-2xl bg-indigo-600 shadow-xl shadow-indigo-600/20",children:t.jsx(ee,{className:"h-7 w-7 text-white"})}),t.jsxs("div",{className:"text-left",children:[t.jsx("h4",{className:"text-base font-black tracking-tight text-slate-900 uppercase",children:"Infos de l'Agent"}),t.jsx("p",{className:"text-[10px] font-bold tracking-widest text-indigo-500 uppercase",children:"Transaction Sécurisée"})]})]}),t.jsx("div",{className:"rounded-full bg-slate-100 px-4 py-1.5 text-[11px] font-black tracking-widest text-slate-600 uppercase",children:r?.name})]}),t.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[t.jsxs("div",{className:"group flex flex-col gap-2 text-left",children:[t.jsx("span",{className:"ml-2 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Nom de l'Agent"}),t.jsx("div",{className:"flex h-16 items-center rounded-2xl border-2 border-slate-100 bg-white/80 px-6 text-lg font-black tracking-tight text-slate-900 shadow-sm transition-all group-hover:border-indigo-100 group-hover:bg-white",children:C?.withdrawal_agent_name||"NON CONFIGURÉ"})]}),t.jsxs("div",{className:"group flex flex-col gap-2 text-left",children:[t.jsxs("div",{className:"mb-0 flex items-center justify-between px-2",children:[t.jsx("span",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Numéro Agent"}),t.jsxs("div",{className:"flex items-center gap-1.5 rounded-full bg-emerald-500/10 px-2 py-0.5 text-[8px] font-black text-emerald-600 uppercase",children:[t.jsx(Te,{className:"h-2.5 w-2.5"}),"Vérifié"]})]}),t.jsxs("div",{className:"flex h-16 items-center justify-between rounded-2xl border-2 border-slate-100 bg-white/50 px-6 shadow-sm backdrop-blur-sm transition-all group-hover:border-indigo-100 group-hover:bg-white",children:[t.jsx("span",{className:"text-xl font-black tracking-[0.2em] text-indigo-900",children:C?.withdrawal_agent_number||"---"}),t.jsx(E,{variant:"ghost",size:"icon",className:"h-10 w-10 shrink-0 rounded-xl bg-slate-50 text-slate-400 transition-all hover:bg-emerald-50 hover:text-emerald-600",onClick:()=>{C?.withdrawal_agent_number&&(navigator.clipboard.writeText(C.withdrawal_agent_number),ce.success("Copié !"))},children:t.jsx(Be,{className:"h-5 w-5"})})]})]})]}),t.jsxs("div",{className:"mt-8 flex items-start gap-4 rounded-3xl border border-indigo-100/30 bg-indigo-50/50 p-5 text-left",children:[t.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-white shadow-sm",children:t.jsx(qe,{className:"h-4 w-4 text-indigo-500"})}),t.jsx("p",{className:"text-[11px] leading-relaxed font-semibold text-indigo-900/70",children:"Veuillez effectuer votre retrait vers ce numéro d'agent. Une fois terminé, indiquez le montant ci-dessous pour validation par notre équipe."})]})]}),O("reason")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:"Motif / Raison"}),t.jsx(M,{value:s.reason,onChange:S=>j({...s,reason:S.target.value}),placeholder:"Raison du dépôt...",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),s.operation_type==="retrait"?null:(r?.settings?.custom_fields||[]).filter(I=>!I.operation_type||I.operation_type==="both"||I.operation_type==="depot").map(I=>t.jsxs("div",{className:"space-y-2",children:[t.jsx(D,{className:"ml-2 font-bold text-slate-800",children:I.label}),t.jsx(M,{value:s.metadata[I.id]||"",onChange:oe=>j({...s,metadata:{...s.metadata,[I.id]:oe.target.value}}),placeholder:`Entrez ${I.label.toLowerCase()}...`,className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]},I.id))]})})()},"operation-fields-container")})]})]})]});case 3:return t.jsx(st,{ticketNumber:l,onNewTicket:le});default:return null}};return t.jsxs(Fe,{currentPageName:"Client",children:[t.jsx(je,{title:"Client"}),t.jsxs("div",{className:"relative flex h-screen w-screen flex-col overflow-hidden",children:[t.jsx(K,{children:!B&&!R&&t.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/40 p-6 backdrop-blur-3xl",children:t.jsxs(A.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"relative w-full max-w-2xl overflow-hidden rounded-[3rem] bg-white p-12 text-center font-sans shadow-2xl",children:[t.jsx("div",{className:"absolute top-0 right-0 -z-10 h-64 w-64 translate-x-1/2 -translate-y-1/2 rounded-full bg-indigo-50"}),t.jsx("div",{className:"mx-auto mb-8 flex h-24 w-24 items-center justify-center rounded-[2rem] border border-slate-100 bg-slate-50",children:t.jsx(Ie,{className:"h-12 w-12 text-slate-300"})}),t.jsxs("h1",{className:"mb-4 text-4xl font-black tracking-tighter text-slate-900 uppercase",children:["Agence"," ",t.jsx("span",{className:"text-indigo-600",children:"Fermée"})]}),t.jsx("p",{className:"mb-10 text-lg leading-relaxed font-medium text-slate-500",children:"Veuillez patienter... Le manager n'a pas encore ouvert la session de travail pour cette agence."}),t.jsxs("div",{className:"mx-auto grid max-w-md grid-cols-2 gap-4",children:[t.jsxs("div",{className:"flex flex-col items-center rounded-3xl border border-slate-100 bg-slate-50 p-6",children:[t.jsx(pe,{className:"mb-2 h-6 w-6 text-indigo-500"}),t.jsx("span",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Heure Locale"}),t.jsx("span",{className:"text-lg font-black text-slate-800",children:$e().format("HH:mm")})]}),t.jsxs("div",{className:"flex flex-col items-center rounded-3xl border border-slate-100 bg-slate-50 p-6",children:[t.jsx(Re,{className:"mb-2 h-6 w-6 text-indigo-500"}),t.jsx("span",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Agence"}),t.jsx("span",{className:"text-lg font-black text-slate-800",children:"Kinshasa"})]})]}),t.jsx("div",{className:"mt-12 flex justify-center",children:t.jsxs("div",{className:"flex items-center gap-3 rounded-2xl bg-indigo-50 px-6 py-3",children:[t.jsx("div",{className:"h-2 w-2 animate-pulse rounded-full bg-indigo-600"}),t.jsx("span",{className:"text-xs font-black tracking-widest text-indigo-600 uppercase",children:"Actualisation automatique"})]})})]})})}),t.jsxs("div",{className:"fixed inset-0 z-0",children:[t.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(/images/background1.png)"}}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-900/40 via-slate-900/20 to-slate-900/40"})]}),t.jsxs("div",{className:"relative z-10 flex w-full flex-1 flex-col overflow-hidden px-4 pb-4",children:[t.jsx("div",{className:"flex shrink-0 items-center justify-between py-4",children:t.jsxs("div",{className:"flex items-center gap-4 rounded-full bg-white/10 px-6 py-2 backdrop-blur-md",children:[t.jsx("img",{src:"/logo.png",alt:"Havifin",className:"h-10 w-10 object-contain"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-black tracking-tight text-white uppercase",children:"Havifin"}),t.jsx("p",{className:"text-[10px] font-bold tracking-widest text-white/60 uppercase",children:"Smart Ticket"})]})]})}),t.jsx("div",{className:"scrollbar-hide flex-1 overflow-y-auto",children:t.jsxs("div",{className:"mx-auto max-w-5xl",children:[t.jsxs("div",{className:"rounded-[40px] border border-white/20 bg-white/60 p-8 shadow-2xl shadow-purple-500/20 backdrop-blur-2xl md:p-12",children:[t.jsx(K,{mode:"wait",children:ge()}),e<3&&t.jsxs("div",{className:"mt-12 flex justify-center gap-4",children:[e===2&&t.jsx(E,{variant:"ghost",onClick:le,size:"lg",className:"h-16 rounded-3xl border border-white/30 bg-white/20 px-16 text-xl font-bold text-slate-600 shadow-xl backdrop-blur-xl transition-all hover:bg-white/40 hover:text-red-500",children:"Annuler"}),t.jsx(E,{onClick:te,disabled:!fe()||q.isPending||L.isPending||a,size:"lg",className:"h-16 rounded-3xl border border-white/30 bg-gradient-to-r from-cyan-500 via-blue-600 to-purple-600 px-16 text-xl font-bold text-white shadow-2xl shadow-cyan-500/30 backdrop-blur-xl transition-all hover:scale-[1.02] hover:border-white/50 hover:shadow-cyan-500/50 active:scale-[0.98]",children:q.isPending||L.isPending?t.jsxs(t.Fragment,{children:[t.jsx(Y,{className:"mr-3 h-6 w-6 animate-spin"}),"Traitement..."]}):t.jsxs(t.Fragment,{children:[e===1&&"Continuer",e===2&&"Confirmer",t.jsx(J,{className:"ml-3 h-6 w-6"})]})})]})]}),e<3&&t.jsx("div",{className:"mt-12 flex justify-center gap-4",children:[1,2].map(r=>t.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${e===r?"w-12 bg-blue-600":"w-2 bg-slate-200"}`},r))})]})})]})]})]})}export{At as default};
