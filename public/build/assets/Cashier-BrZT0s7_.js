import{c as ze,R as tt,j as s,r as ue,u as ot,a as gt,H as yt}from"./app-DfVEQ2Jl.js";import{A as Be,b as be,u as Ke}from"./base44Client-B9xVS0TF.js";import{B as _t}from"./badge-DPmvw1-s.js";import{B as xe,t as He}from"./index-Cp6nHwXV.js";import{c as Ne,b as ke,m as Ve}from"./createLucideIcon-Bn3wTAHH.js";import{h as nt}from"./moment-B-YVwB4U.js";import{C as ct,L as jt,R as dt,a as mt,A as vt}from"./refresh-cw-DpKbC7r5.js";import{S as wt,a as Nt}from"./smartphone-B57bGqXY.js";import{A as st}from"./arrow-right-Czje2kVV.js";import{P as Ct,C as kt,a as St,b as Pt}from"./phone-CaKICcFL.js";import{D as ut,a as ht,b as Dt,c as xt,d as ft}from"./index-CqhivdR4.js";import{u as We}from"./check-4s6hy00p.js";import{C as Mt}from"./circle-alert-DnYV10WY.js";import{I as Qe,L as Te}from"./label-C8lY9vse.js";import{S as Je,a as Xe,b as Ye,c as Ze,d as pe}from"./select-C8S73Dzd.js";import{L as At}from"./loader-circle-BLNs6w7n.js";import{A as Ft}from"./app-main-CYzwZkPW.js";import{U as Rt}from"./users-Ba1Nnk9m.js";/* empty css            */const $t=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],Et=Ne("Calculator",$t);const qt=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Lt=Ne("CircleCheckBig",qt);const Ut=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],Tt=Ne("CircleUser",Ut);const zt=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v2",key:"stiyo7"}],["path",{d:"M12 13h.01",key:"y0uutt"}]],Ht=Ne("MessageSquareWarning",zt);const It=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]],rt=Ne("PhoneCall",It);const Ot=[["polyline",{points:"18 2 22 6 18 10",key:"6vjanh"}],["line",{x1:"14",x2:"22",y1:"6",y2:"6",key:"1jsywh"}],["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],Bt=Ne("PhoneForwarded",Ot);const Kt=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Qt=Ne("Send",Kt);const Vt=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Wt=Ne("TriangleAlert",Vt);function lt(t){const e=ze.c(71),{client:a,onCall:c,onRecall:n,onProcess:d,onHelp:v,isProcessing:p}=t,[o,N]=tt.useState(!1),l=a.status==="called",y=a.status==="completed",r=a.status==="waiting";let b,g;e[0]!==l?(b=()=>{l&&N(!0)},g=[l],e[0]=l,e[1]=b,e[2]=g):(b=e[1],g=e[2]),tt.useEffect(b,g);let h,m,u;e[3]===Symbol.for("react.memo_cache_sentinel")?(h={opacity:0,scale:.98,y:5},m={opacity:1,scale:1,y:0},u={opacity:0,scale:.95,y:-5},e[3]=h,e[4]=m,e[5]=u):(h=e[3],m=e[4],u=e[5]);let x;e[6]!==l||e[7]!==o?(x=()=>!l&&N(!o),e[6]=l,e[7]=o,e[8]=x):x=e[8];const S=l?"rounded-[2rem] border-blue-500/30 bg-white p-5 shadow-xl ring-1 shadow-blue-500/5 ring-blue-50":y?"rounded-2xl border-slate-100 bg-slate-50/50 p-3 opacity-60 hover:opacity-100":"rounded-2xl border-slate-200 bg-white p-3 shadow-sm hover:border-blue-300 hover:shadow-md";let f;e[9]!==S?(f=ke("group relative cursor-pointer overflow-hidden transition-all duration-300",S),e[9]=S,e[10]=f):f=e[10];const P=l?"h-14 w-14 rounded-2xl bg-blue-600 text-xl text-white shadow-lg shadow-blue-500/20":"h-10 w-10 rounded-xl bg-slate-900 text-sm text-white";let w;e[11]!==P?(w=ke("flex flex-shrink-0 items-center justify-center font-black tracking-tighter transition-all",P),e[11]=P,e[12]=w):w=e[12];let k;e[13]!==a.ticket_number||e[14]!==w?(k=s.jsx("div",{className:w,children:a.ticket_number}),e[13]=a.ticket_number,e[14]=w,e[15]=k):k=e[15];const A=l?"text-lg":"text-sm";let T;e[16]!==A?(T=ke("truncate leading-tight font-black tracking-tight text-slate-800",A),e[16]=A,e[17]=T):T=e[17];const B=a.first_name?`${a.first_name} ${a.last_name||""}`:a.phone;let F;e[18]!==T||e[19]!==B?(F=s.jsx("h4",{className:T,children:B}),e[18]=T,e[19]=B,e[20]=F):F=e[20];let I;e[21]!==a.created_date||e[22]!==a.service||e[23]!==l||e[24]!==o?(I=!l&&!o&&s.jsxs("p",{className:"truncate text-[10px] font-bold tracking-wider text-slate-400 uppercase",children:[a.service," •"," ",nt(a.created_date).fromNow()]}),e[21]=a.created_date,e[22]=a.service,e[23]=l,e[24]=o,e[25]=I):I=e[25];let D;e[26]!==F||e[27]!==I?(D=s.jsxs("div",{className:"overflow-hidden",children:[F,I]}),e[26]=F,e[27]=I,e[28]=D):D=e[28];let te;e[29]!==k||e[30]!==D?(te=s.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[k,D]}),e[29]=k,e[30]=D,e[31]=te):te=e[31];let C;e[32]!==a||e[33]!==o||e[34]!==p||e[35]!==r||e[36]!==c?(C=r&&!o&&s.jsx(xe,{size:"icon",variant:"secondary",onClick:H=>{H.stopPropagation(),c?.(a)},disabled:p,className:"h-10 w-10 rounded-xl bg-blue-50 text-blue-600 shadow-sm transition-all hover:bg-blue-600 hover:text-white",children:p?s.jsx(dt,{className:"h-4 w-4 animate-spin"}):s.jsx(Ct,{className:"h-4 w-4"})}),e[32]=a,e[33]=o,e[34]=p,e[35]=r,e[36]=c,e[37]=C):C=e[37];let q;e[38]!==a||e[39]!==l||e[40]!==v||e[41]!==n?(q=l&&s.jsxs("div",{className:"flex gap-1.5",onClick:Gt,children:[s.jsx(xe,{variant:"ghost",size:"icon",onClick:()=>v?.(a),className:"h-9 w-9 rounded-xl border border-amber-100/50 bg-amber-50 text-amber-600 hover:bg-amber-100",children:s.jsx(Ht,{className:"h-4 w-4"})}),s.jsx(xe,{variant:"ghost",size:"icon",onClick:()=>n?.(a),className:"h-9 w-9 rounded-xl border border-blue-100/50 bg-blue-50 text-blue-600 hover:bg-blue-100",children:s.jsx(Bt,{className:"h-4 w-4"})})]}),e[38]=a,e[39]=l,e[40]=v,e[41]=n,e[42]=q):q=e[42];let R;e[43]!==C||e[44]!==q?(R=s.jsxs("div",{className:"flex items-center gap-2",children:[C,q]}),e[43]=C,e[44]=q,e[45]=R):R=e[45];let _;e[46]!==te||e[47]!==R?(_=s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[te,R]}),e[46]=te,e[47]=R,e[48]=_):_=e[48];let $;e[49]!==a||e[50]!==l||e[51]!==o||e[52]!==p||e[53]!==r||e[54]!==c||e[55]!==d?($=o&&s.jsx(Ve.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:s.jsxs("div",{className:ke("mt-4 space-y-3",l?"":"border-t border-slate-100 pt-3"),children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2 font-bold text-slate-500",children:[s.jsx(ct,{className:"h-3.5 w-3.5"}),nt(a.created_date).format("HH:mm")]}),s.jsx(_t,{variant:"outline",className:"h-5 py-0 text-[9px] font-black tracking-tighter uppercase",children:a.operation_type})]}),s.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-100/50 bg-slate-50 p-3",children:[s.jsx("div",{className:"rounded-lg bg-white p-1.5 shadow-sm",children:a.operation_type==="change"?s.jsx(jt,{className:"h-3.5 w-3.5 text-indigo-500"}):s.jsx(wt,{className:"h-3.5 w-3.5 text-amber-500"})}),s.jsx("span",{className:"text-[10px] font-black tracking-widest text-slate-600 uppercase",children:a.service})]}),a.amount&&s.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-blue-100/20 bg-blue-50/50 p-3",children:[s.jsx("span",{className:"text-[9px] font-black tracking-widest text-blue-600/60 uppercase",children:"Estimation"}),s.jsxs("span",{className:"font-mono text-sm font-black text-blue-700",children:[a.amount?.toLocaleString()," ",a.currency_to]})]}),s.jsxs("div",{className:"pt-2",children:[r&&s.jsxs(xe,{onClick:H=>{H.stopPropagation(),c?.(a)},disabled:p,className:"h-11 w-full rounded-xl bg-blue-600 text-sm font-black text-white shadow-lg shadow-blue-600/20",children:["Appeler Ticket",s.jsx(st,{className:"ml-2 h-4 w-4"})]}),l&&s.jsxs(xe,{onClick:H=>{H.stopPropagation(),d?.(a)},className:"h-12 w-full rounded-xl bg-slate-900 text-sm font-black text-white shadow-xl shadow-slate-900/10",children:["Démarrer le service",s.jsx(st,{className:"ml-2 h-4 w-4 text-[#00e2f6]"})]})]})]})}),e[49]=a,e[50]=l,e[51]=o,e[52]=p,e[53]=r,e[54]=c,e[55]=d,e[56]=$):$=e[56];let L;e[57]!==$?(L=s.jsx(Be,{children:$}),e[57]=$,e[58]=L):L=e[58];let E;e[59]!==y||e[60]!==o?(E=y&&!o&&s.jsxs("div",{className:"mt-2 flex items-center justify-center gap-1 text-[9px] font-black tracking-widest text-emerald-600 uppercase",children:[s.jsx(mt,{className:"h-3 w-3"}),"Terminé"]}),e[59]=y,e[60]=o,e[61]=E):E=e[61];let M;e[62]!==l?(M=l&&s.jsx("div",{className:"absolute -right-6 -bottom-6 h-16 w-16 rounded-full bg-blue-500/5 blur-2xl"}),e[62]=l,e[63]=M):M=e[63];let z;return e[64]!==_||e[65]!==L||e[66]!==E||e[67]!==M||e[68]!==x||e[69]!==f?(z=s.jsxs(Ve.div,{layout:!0,initial:h,animate:m,exit:u,onClick:x,className:f,children:[_,L,E,M]}),e[64]=_,e[65]=L,e[66]=E,e[67]=M,e[68]=x,e[69]=f,e[70]=z):z=e[70],z}function Gt(t){return t.stopPropagation()}const at=ue.forwardRef((t,e)=>{const a=ze.c(9);let c,n;a[0]!==t?({className:c,...n}=t,a[0]=t,a[1]=c,a[2]=n):(c=a[1],n=a[2]);let d;a[3]!==c?(d=ke("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",c),a[3]=c,a[4]=d):d=a[4];let v;return a[5]!==n||a[6]!==e||a[7]!==d?(v=s.jsx("textarea",{className:d,ref:e,...n}),a[5]=n,a[6]=e,a[7]=d,a[8]=v):v=a[8],v});at.displayName="Textarea";function Jt(t){const e=ze.c(36),{isOpen:a,onClose:c,clientPhone:n}=t,[d,v]=tt.useState("");let p;e[0]!==c?(p={mutationFn:Yt,onSuccess:()=>{He.success("Demande d'aide envoyée au manager"),v(""),c()},onError:Xt},e[0]=c,e[1]=p):p=e[1];const o=We(p);let N;e[2]!==n||e[3]!==d||e[4]!==o?(N=A=>{A.preventDefault(),d.trim()&&o.mutate({client_phone:n||"N/A",description:d})},e[2]=n,e[3]=d,e[4]=o,e[5]=N):N=e[5];const l=N;let y;e[6]===Symbol.for("react.memo_cache_sentinel")?(y=s.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-1/2 -translate-y-1/2 bg-amber-500/10 blur-3xl"}),e[6]=y):y=e[6];let r;e[7]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsxs(ut,{className:"mb-6",children:[s.jsx("div",{className:"mb-4 flex h-14 w-14 items-center justify-center rounded-2xl border border-amber-500/30 bg-amber-500/20",children:s.jsx(Wt,{className:"h-8 w-8 text-amber-500"})}),s.jsx(ht,{className:"text-3xl font-black tracking-tight",children:"Besoin d'aide ?"}),s.jsx(Dt,{className:"text-lg font-medium text-slate-400",children:"Expliquez brièvement le problème au manager."})]}),e[7]=r):r=e[7];let b;e[8]===Symbol.for("react.memo_cache_sentinel")?(b=s.jsx("label",{className:"ml-1 text-xs font-black tracking-widest text-slate-500 uppercase",children:"Message d'urgence"}),e[8]=b):b=e[8];let g;e[9]===Symbol.for("react.memo_cache_sentinel")?(g=A=>v(A.target.value),e[9]=g):g=e[9];let h;e[10]!==d?(h=s.jsxs("div",{className:"space-y-2",children:[b,s.jsx(at,{value:d,onChange:g,placeholder:"Ex: Problème de validation M-Pesa, client impatient...",className:"min-h-[120px] resize-none rounded-2xl border-white/10 bg-white/5 p-4 text-lg text-white placeholder:text-slate-600 focus:border-amber-500 focus:ring-amber-500"})]}),e[10]=d,e[11]=h):h=e[11];let m;e[12]!==n?(m=n&&s.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border border-white/5 bg-white/5 p-4",children:[s.jsx(Mt,{className:"h-5 w-5 text-slate-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[10px] font-black tracking-wider text-slate-500 uppercase",children:"Client associé"}),s.jsx("div",{className:"text-sm font-bold",children:n})]})]}),e[12]=n,e[13]=m):m=e[13];let u;e[14]!==c?(u=s.jsx(xe,{type:"button",variant:"ghost",onClick:c,className:"h-14 flex-1 rounded-2xl border border-white/5 font-bold text-slate-400 hover:bg-white/5",children:"Annuler"}),e[14]=c,e[15]=u):u=e[15];let x;e[16]!==d||e[17]!==o.isPending?(x=o.isPending||!d.trim(),e[16]=d,e[17]=o.isPending,e[18]=x):x=e[18];let S;e[19]!==o.isPending?(S=o.isPending?s.jsx(Ve.div,{animate:{rotate:360},transition:{repeat:1/0,duration:1,ease:"linear"},children:s.jsx(RefreshCw,{className:"h-6 w-6"})}):s.jsxs(s.Fragment,{children:["Envoyer Alerte",s.jsx(Qt,{className:"ml-2 h-5 w-5"})]}),e[19]=o.isPending,e[20]=S):S=e[20];let f;e[21]!==x||e[22]!==S?(f=s.jsx(xe,{type:"submit",disabled:x,className:"h-14 flex-[2] rounded-2xl bg-amber-500 text-lg font-black text-black shadow-lg shadow-amber-500/20 hover:bg-amber-600",children:S}),e[21]=x,e[22]=S,e[23]=f):f=e[23];let P;e[24]!==f||e[25]!==u?(P=s.jsxs("div",{className:"flex gap-4 pt-2",children:[u,f]}),e[24]=f,e[25]=u,e[26]=P):P=e[26];let w;e[27]!==l||e[28]!==P||e[29]!==h||e[30]!==m?(w=s.jsx(xt,{className:"overflow-hidden rounded-[32px] border-none bg-slate-900 p-0 text-white sm:max-w-[500px]",children:s.jsxs("div",{className:"relative p-8",children:[y,r,s.jsxs("form",{onSubmit:l,className:"space-y-6",children:[h,m,P]})]})}),e[27]=l,e[28]=P,e[29]=h,e[30]=m,e[31]=w):w=e[31];let k;return e[32]!==a||e[33]!==c||e[34]!==w?(k=s.jsx(ft,{open:a,onOpenChange:c,children:w}),e[32]=a,e[33]=c,e[34]=w,e[35]=k):k=e[35],k}function Xt(){He.error("Erreur lors de l'envoi de la demande")}async function Yt(t){return be.entities.HelpRequest.create(t)}function et(t){const e=ze.c(28),{title:a,icon:c,count:n,color:d,children:v}=t;let p;e[0]!==d?(p=ke("rounded-2xl border p-2.5 shadow-sm",d),e[0]=d,e[1]=p):p=e[1];let o;e[2]!==c?(o=s.jsx(c,{className:"h-5 w-5"}),e[2]=c,e[3]=o):o=e[3];let N;e[4]!==p||e[5]!==o?(N=s.jsx("div",{className:p,children:o}),e[4]=p,e[5]=o,e[6]=N):N=e[6];let l;e[7]!==a?(l=s.jsx("h3",{className:"text-xl leading-none font-black tracking-tight text-slate-800",children:a}),e[7]=a,e[8]=l):l=e[8];const y=n>1?"Clients":"Client";let r;e[9]!==n||e[10]!==y?(r=s.jsxs("p",{className:"mt-1.5 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[n," ",y]}),e[9]=n,e[10]=y,e[11]=r):r=e[11];let b;e[12]!==l||e[13]!==r?(b=s.jsxs("div",{children:[l,r]}),e[12]=l,e[13]=r,e[14]=b):b=e[14];let g;e[15]!==N||e[16]!==b?(g=s.jsxs("div",{className:"flex items-center gap-3",children:[N,b]}),e[15]=N,e[16]=b,e[17]=g):g=e[17];let h;e[18]!==n?(h=s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl border border-slate-200 bg-slate-100 text-sm font-black text-slate-400 shadow-inner",children:n}),e[18]=n,e[19]=h):h=e[19];let m;e[20]!==g||e[21]!==h?(m=s.jsxs("div",{className:"mb-6 flex items-center justify-between px-1",children:[g,h]}),e[20]=g,e[21]=h,e[22]=m):m=e[22];let u;e[23]!==v?(u=s.jsx("div",{className:"scrollbar-none custom-kanban-scroll flex-1 overflow-y-auto pr-2",children:s.jsx("div",{className:"space-y-4 pb-12",children:v})}),e[23]=v,e[24]=u):u=e[24];let x;return e[25]!==m||e[26]!==u?(x=s.jsxs("div",{className:"flex h-full max-w-[450px] min-w-[320px] flex-1 flex-col",children:[m,u]}),e[25]=m,e[26]=u,e[27]=x):x=e[27],x}const it={depot:{label:"Dépôt",icon:Pt,color:"text-green-500",action:"Déposer"},retrait:{label:"Retrait",icon:St,color:"text-blue-500",action:"Retirer"},change:{label:"Change",icon:vt,color:"text-amber-500",action:"Changer"},transfert:{label:"Transfert",icon:st,color:"text-purple-500",action:"Transférer"},paiement:{label:"Paiement",icon:kt,color:"text-pink-500",action:"Payer"}};function Zt(t){const e=ze.c(133),{client:a,open:c,onClose:n}=t,d=ot(),v=a?.amount?String(a.amount):"",p=a?.currency_from||"USD",o=a?.currency_to||"CDF";let N;e[0]!==v||e[1]!==p||e[2]!==o?(N={amount_from:v,amount_given:"",currency_from:p,currency_to:o,exchange_rate:"",commission:"0",notes:""},e[0]=v,e[1]=p,e[2]=o,e[3]=N):N=e[3];const[l,y]=ue.useState(N),[r,b]=ue.useState(0);let g;e[4]===Symbol.for("react.memo_cache_sentinel")?(g={queryKey:["rates"],queryFn:es},e[4]=g):g=e[4];const{data:h}=Ke(g);let m;e[5]!==h?(m=h===void 0?[]:h,e[5]=h,e[6]=m):m=e[6];const u=m;let x,S;e[7]!==a?(x=()=>{a&&y(j=>({...j,amount_from:a.amount?String(a.amount):"",currency_from:a.currency_from||"USD",currency_to:a.currency_to||"CDF",amount_given:"",exchange_rate:"",commission:"0"}))},S=[a],e[7]=a,e[8]=x,e[9]=S):(x=e[8],S=e[9]),ue.useEffect(x,S);let f;e[10]!==a?.operation_type||e[11]!==l.currency_from||e[12]!==l.currency_to||e[13]!==u?(f=()=>{if(a?.operation_type==="change"){const j=`${l.currency_from}_${l.currency_to}`,U=u.find(K=>K.currency_pair===j||K.currency_from===l.currency_from&&K.currency_to===l.currency_to);U&&y(K=>({...K,exchange_rate:String(U.buy_rate||U.rate)}))}},e[10]=a?.operation_type,e[11]=l.currency_from,e[12]=l.currency_to,e[13]=u,e[14]=f):f=e[14];const P=a?.operation_type;let w;e[15]!==l.currency_from||e[16]!==l.currency_to||e[17]!==u||e[18]!==P?(w=[l.currency_from,l.currency_to,u,P],e[15]=l.currency_from,e[16]=l.currency_to,e[17]=u,e[18]=P,e[19]=w):w=e[19],ue.useEffect(f,w);let k;e[20]!==a?.operation_type||e[21]!==l.amount_from||e[22]!==l.amount_given||e[23]!==l.commission||e[24]!==l.exchange_rate?(k=()=>{if(!l.amount_from)return;const j=parseFloat(l.amount_from),U=parseFloat(l.amount_given)||0,K=parseFloat(l.exchange_rate)||1,fe=parseFloat(l.commission)||0;a?.operation_type==="change"?b(j*K-fe):["depot","transfert"].includes(a?.operation_type||"")&&U>0?b(U-j-fe):b(0)},e[20]=a?.operation_type,e[21]=l.amount_from,e[22]=l.amount_given,e[23]=l.commission,e[24]=l.exchange_rate,e[25]=k):k=e[25];const A=a?.operation_type;let T;e[26]!==l.amount_from||e[27]!==l.amount_given||e[28]!==l.commission||e[29]!==l.exchange_rate||e[30]!==A?(T=[l.amount_from,l.amount_given,l.exchange_rate,l.commission,A],e[26]=l.amount_from,e[27]=l.amount_given,e[28]=l.commission,e[29]=l.exchange_rate,e[30]=A,e[31]=T):T=e[31],ue.useEffect(k,T);let B;e[32]!==r||e[33]!==a||e[34]!==l.amount_from||e[35]!==l.commission||e[36]!==l.currency_from||e[37]!==l.currency_to||e[38]!==l.exchange_rate||e[39]!==l.notes?(B=async()=>{if(!a)return;const j=isNaN(r)?0:r,U=a.operation_type==="change"?parseFloat(l.exchange_rate)||0:1;if(isNaN(U)||a.operation_type==="change"&&U===0)throw new Error("Taux de change invalide");await be.entities.Transaction.create({client_id:a.id,ticket_number:a.ticket_number,operation_type:a.operation_type,service:a.service,currency_from:l.currency_from,currency_to:a.operation_type==="change"?l.currency_to:l.currency_from,amount_from:parseFloat(l.amount_from)||0,amount_to:a.operation_type==="change"?j:parseFloat(l.amount_from)||0,exchange_rate:U,commission:parseFloat(l.commission)||0,client_phone:a.phone}),await be.entities.Client.update(a.id,{status:"completed",completed_at:new Date().toISOString(),notes:l.notes})},e[32]=r,e[33]=a,e[34]=l.amount_from,e[35]=l.commission,e[36]=l.currency_from,e[37]=l.currency_to,e[38]=l.exchange_rate,e[39]=l.notes,e[40]=B):B=e[40];let F;e[41]!==n||e[42]!==d?(F=()=>{d.invalidateQueries({queryKey:["clients"]}),d.invalidateQueries({queryKey:["transactions"]}),n()},e[41]=n,e[42]=d,e[43]=F):F=e[43];let I;e[44]!==B||e[45]!==F?(I={mutationFn:B,onSuccess:F},e[44]=B,e[45]=F,e[46]=I):I=e[46];const D=We(I);if(!a)return null;const te=a.operation_type,C=it[te]||it.depot,q=C.icon;let R;e[47]!==a.ticket_number?(R=s.jsx("span",{className:"text-2xl font-black text-slate-800",children:a.ticket_number}),e[47]=a.ticket_number,e[48]=R):R=e[48];const _=`flex items-center gap-1 rounded-md bg-slate-100 px-2 py-1 text-sm font-medium ${C.color}`;let $;e[49]!==q?($=s.jsx(q,{className:"h-4 w-4"}),e[49]=q,e[50]=$):$=e[50];let L;e[51]!==C.label||e[52]!==_||e[53]!==$?(L=s.jsxs("span",{className:_,children:[$,C.label]}),e[51]=C.label,e[52]=_,e[53]=$,e[54]=L):L=e[54];let E;e[55]!==R||e[56]!==L?(E=s.jsxs("div",{className:"flex items-center gap-3",children:[R,L]}),e[55]=R,e[56]=L,e[57]=E):E=e[57];let M;e[58]!==a.phone?(M=s.jsx("span",{className:"text-sm font-normal text-slate-500",children:a.phone}),e[58]=a.phone,e[59]=M):M=e[59];let z;e[60]!==E||e[61]!==M?(z=s.jsx(ut,{children:s.jsxs(ht,{className:"flex items-center justify-between",children:[E,M]})}),e[60]=E,e[61]=M,e[62]=z):z=e[62];let H;e[63]===Symbol.for("react.memo_cache_sentinel")?(H=s.jsx("div",{className:"text-xs font-semibold tracking-wider text-slate-500 uppercase",children:"Service"}),e[63]=H):H=e[63];const ge=a.service==="bureau"?"Bureau de Change":a.service;let ye;e[64]!==ge?(ye=s.jsxs("div",{children:[H,s.jsx("div",{className:"text-lg font-bold text-slate-800",children:ge})]}),e[64]=ge,e[65]=ye):ye=e[65];let se;e[66]!==a.operation_type||e[67]!==l.currency_from?(se=["depot","transfert","retrait"].includes(a.operation_type)&&s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xs font-semibold tracking-wider text-slate-500 uppercase",children:"Devise"}),s.jsx("div",{className:"text-lg font-bold text-slate-800",children:l.currency_from})]}),e[66]=a.operation_type,e[67]=l.currency_from,e[68]=se):se=e[68];let _e;e[69]!==ye||e[70]!==se?(_e=s.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-slate-50 p-4",children:[ye,se]}),e[69]=ye,e[70]=se,e[71]=_e):_e=e[71];const je=a.operation_type==="retrait"?"Montant à retirer":"Montant de l'opération";let he;e[72]!==je?(he=s.jsx(Te,{children:je}),e[72]=je,e[73]=he):he=e[73];let le;e[74]!==l?(le=j=>y({...l,amount_from:j.target.value}),e[74]=l,e[75]=le):le=e[75];let ae;e[76]!==l.amount_from||e[77]!==le?(ae=s.jsx(Qe,{type:"number",value:l.amount_from,onChange:le,className:"text-lg font-bold"}),e[76]=l.amount_from,e[77]=le,e[78]=ae):ae=e[78];let ne;e[79]!==a.operation_type||e[80]!==l?(ne=["depot","transfert","retrait"].includes(a.operation_type)&&s.jsxs(Je,{value:l.currency_from,onValueChange:j=>y({...l,currency_from:j}),children:[s.jsx(Xe,{className:"w-24",children:s.jsx(Ye,{})}),s.jsxs(Ze,{children:[s.jsx(pe,{value:"USD",children:"USD"}),s.jsx(pe,{value:"CDF",children:"CDF"}),s.jsx(pe,{value:"EUR",children:"EUR"})]})]}),e[79]=a.operation_type,e[80]=l,e[81]=ne):ne=e[81];let re;e[82]!==ae||e[83]!==ne?(re=s.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[ae,ne]}),e[82]=ae,e[83]=ne,e[84]=re):re=e[84];let ie;e[85]!==he||e[86]!==re?(ie=s.jsxs("div",{children:[he,re]}),e[85]=he,e[86]=re,e[87]=ie):ie=e[87];let oe;e[88]!==r||e[89]!==a.operation_type||e[90]!==l?(oe=["depot","transfert"].includes(a.operation_type)&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx(Te,{children:"Montant reçu du client"}),s.jsx(Qe,{type:"number",value:l.amount_given,onChange:j=>y({...l,amount_given:j.target.value}),className:"mt-1",placeholder:"Combien le client a donné ?"})]}),r>0&&s.jsxs("div",{className:"rounded-xl border border-yellow-200 bg-yellow-50 p-4",children:[s.jsxs("div",{className:"mb-1 flex items-center gap-2 text-yellow-700",children:[s.jsx(Et,{className:"h-4 w-4"}),s.jsx("span",{className:"font-bold",children:"A rendre au client"})]}),s.jsxs("div",{className:"text-2xl font-black text-yellow-600",children:[r.toLocaleString()," ",l.currency_from]})]})]}),e[88]=r,e[89]=a.operation_type,e[90]=l,e[91]=oe):oe=e[91];let ce;e[92]!==r||e[93]!==a.operation_type||e[94]!==l?(ce=a.operation_type==="change"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Te,{children:"Devise Source"}),s.jsxs(Je,{value:l.currency_from,onValueChange:j=>y({...l,currency_from:j}),children:[s.jsx(Xe,{className:"mt-1",children:s.jsx(Ye,{})}),s.jsxs(Ze,{children:[s.jsx(pe,{value:"USD",children:"USD"}),s.jsx(pe,{value:"CDF",children:"CDF"}),s.jsx(pe,{value:"EUR",children:"EUR"})]})]})]}),s.jsxs("div",{children:[s.jsx(Te,{children:"Devise Cible"}),s.jsxs(Je,{value:l.currency_to,onValueChange:j=>y({...l,currency_to:j}),children:[s.jsx(Xe,{className:"mt-1",children:s.jsx(Ye,{})}),s.jsxs(Ze,{children:[s.jsx(pe,{value:"USD",children:"USD"}),s.jsx(pe,{value:"CDF",children:"CDF"}),s.jsx(pe,{value:"EUR",children:"EUR"})]})]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(Te,{children:"Taux de change"}),s.jsx(Qe,{type:"number",value:l.exchange_rate,onChange:j=>y({...l,exchange_rate:j.target.value}),className:"mt-1"})]}),s.jsxs("div",{className:"col-span-2 rounded-xl border border-amber-200 bg-amber-50 p-4",children:[s.jsx("div",{className:"mb-1 font-bold text-amber-700",children:"Montant à remettre"}),s.jsxs("div",{className:"text-3xl font-black text-amber-600",children:[r.toLocaleString()," ",l.currency_to]})]})]}),e[92]=r,e[93]=a.operation_type,e[94]=l,e[95]=ce):ce=e[95];let Q;e[96]!==ie||e[97]!==oe||e[98]!==ce?(Q=s.jsxs("div",{className:"space-y-4",children:[ie,oe,ce]}),e[96]=ie,e[97]=oe,e[98]=ce,e[99]=Q):Q=e[99];let ve;e[100]===Symbol.for("react.memo_cache_sentinel")?(ve=s.jsx(Te,{children:"Notes (optionnel)"}),e[100]=ve):ve=e[100];let V;e[101]!==l?(V=j=>y({...l,notes:j.target.value}),e[101]=l,e[102]=V):V=e[102];let W;e[103]!==l.notes||e[104]!==V?(W=s.jsxs("div",{children:[ve,s.jsx(at,{value:l.notes,onChange:V,className:"mt-1",placeholder:"Remarques..."})]}),e[103]=l.notes,e[104]=V,e[105]=W):W=e[105];let G;e[106]!==n?(G=s.jsx(xe,{variant:"outline",onClick:n,className:"flex-1",children:"Annuler"}),e[106]=n,e[107]=G):G=e[107];let de;e[108]!==D?(de=()=>D.mutate(),e[108]=D,e[109]=de):de=e[109];const we=D.isPending||!l.amount_from,Ce=`flex-1 text-white ${a.operation_type==="depot"||a.operation_type==="transfert"?"bg-green-600 hover:bg-green-700":a.operation_type==="retrait"?"bg-blue-600 hover:bg-blue-700":"bg-amber-500 hover:bg-amber-600"}`;let J;e[110]!==D.isPending?(J=D.isPending?s.jsx(At,{className:"mr-2 h-4 w-4 animate-spin"}):s.jsx(Lt,{className:"mr-2 h-4 w-4"}),e[110]=D.isPending,e[111]=J):J=e[111];let X;e[112]!==C.label||e[113]!==de||e[114]!==we||e[115]!==Ce||e[116]!==J?(X=s.jsxs(xe,{onClick:de,disabled:we,className:Ce,children:[J,"Valider ",C.label]}),e[112]=C.label,e[113]=de,e[114]=we,e[115]=Ce,e[116]=J,e[117]=X):X=e[117];let Y;e[118]!==G||e[119]!==X?(Y=s.jsxs("div",{className:"flex gap-3 pt-4",children:[G,X]}),e[118]=G,e[119]=X,e[120]=Y):Y=e[120];let Z;e[121]!==_e||e[122]!==Q||e[123]!==W||e[124]!==Y?(Z=s.jsxs("div",{className:"space-y-6 py-4",children:[_e,Q,W,Y]}),e[121]=_e,e[122]=Q,e[123]=W,e[124]=Y,e[125]=Z):Z=e[125];let ee;e[126]!==z||e[127]!==Z?(ee=s.jsxs(xt,{className:"max-w-lg",children:[z,Z]}),e[126]=z,e[127]=Z,e[128]=ee):ee=e[128];let me;return e[129]!==n||e[130]!==c||e[131]!==ee?(me=s.jsx(ft,{open:c,onOpenChange:n,children:ee}),e[129]=n,e[130]=c,e[131]=ee,e[132]=me):me=e[132],me}function es(){return be.entities.ExchangeRate.filter({is_active:!0})}function Cs(){const t=ze.c(133),{auth:e}=gt().props,[a,c]=ue.useState(null),[n,d]=ue.useState(!1),[v,p]=ue.useState(!1),[o,N]=ue.useState(null),[l,y]=ue.useState(""),r=ot();let b;t[0]===Symbol.for("react.memo_cache_sentinel")?(b={queryKey:["clients","waiting"],queryFn:ns,refetchInterval:5e3},t[0]=b):b=t[0];const{data:g}=Ke(b);let h;t[1]!==g?(h=g===void 0?[]:g,t[1]=g,t[2]=h):h=t[2];const m=h;let u;t[3]!==e.user.id?(u={queryKey:["clients","called",e.user.id],queryFn:()=>be.entities.Client.filter({status:"called",cashier_id:e.user.id.toString()},"-called_at"),refetchInterval:5e3},t[3]=e.user.id,t[4]=u):u=t[4];const{data:x}=Ke(u);let S;t[5]!==x?(S=x===void 0?[]:x,t[5]=x,t[6]=S):S=t[6];const f=S;let P;t[7]===Symbol.for("react.memo_cache_sentinel")?(P={queryKey:["clients","completed"],queryFn:as,refetchInterval:1e4},t[7]=P):P=t[7];const{data:w}=Ke(P);let k;t[8]!==w?(k=w===void 0?[]:w,t[8]=w,t[9]=k):k=t[9];const A=k;let T;if(t[10]!==l||t[11]!==m){let i;t[13]!==l?(i=O=>O.ticket_number?.toLowerCase().includes(l.toLowerCase())||O.phone?.includes(l),t[13]=l,t[14]=i):i=t[14],T=m.filter(i),t[10]=l,t[11]=m,t[12]=T}else T=t[12];const B=T;let F;if(t[15]!==f||t[16]!==l){let i;t[18]!==l?(i=O=>O.ticket_number?.toLowerCase().includes(l.toLowerCase())||O.phone?.includes(l),t[18]=l,t[19]=i):i=t[19],F=f.filter(i),t[15]=f,t[16]=l,t[17]=F}else F=t[17];const I=F;let D;if(t[20]!==A||t[21]!==l){let i;t[23]!==l?(i=O=>O.ticket_number.toLowerCase().includes(l.toLowerCase())||O.phone.includes(l),t[23]=l,t[24]=i):i=t[24],D=A.filter(i),t[20]=A,t[21]=l,t[22]=D}else D=t[22];const te=D;let C;t[25]!==e.user.counter_number||t[26]!==e.user.id?(C=async i=>(await be.entities.Client.update(i.id,{status:"called",called_at:new Date().toISOString(),counter_number:e.user.counter_number||1,cashier_id:e.user.id.toString()}),i),t[25]=e.user.counter_number,t[26]=e.user.id,t[27]=C):C=t[27];let q;t[28]!==r?(q=i=>{r.invalidateQueries({queryKey:["clients"]}),He.success(`Client ${i.ticket_number} appelé`)},t[28]=r,t[29]=q):q=t[29];let R;t[30]!==C||t[31]!==q?(R={mutationFn:C,onSuccess:q},t[30]=C,t[31]=q,t[32]=R):R=t[32];const _=We(R);let $;t[33]===Symbol.for("react.memo_cache_sentinel")?($={mutationFn:ls,onSuccess:ss},t[33]=$):$=t[33];const L=We($);let E;t[34]!==_?(E=i=>_.mutate(i),t[34]=_,t[35]=E):E=t[35];const M=E;let z;t[36]!==L?(z=i=>L.mutate(i),t[36]=L,t[37]=z):z=t[37];const H=z;let ge;t[38]===Symbol.for("react.memo_cache_sentinel")?(ge=i=>{c(i),d(!0)},t[38]=ge):ge=t[38];const ye=ge;let se;t[39]===Symbol.for("react.memo_cache_sentinel")?(se=i=>{N(i),p(!0)},t[39]=se):se=t[39];const _e=se;let je;t[40]!==r?(je=()=>{r.invalidateQueries({queryKey:["clients"]}),He.info("Données actualisées")},t[40]=r,t[41]=je):je=t[41];const he=je;let le;t[42]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx(yt,{title:"Tableau de Bord Caissier"}),t[42]=le):le=t[42];let ae;t[43]===Symbol.for("react.memo_cache_sentinel")?(ae={scale:1.02},t[43]=ae):ae=t[43];let ne,re;t[44]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsx(Ve.div,{whileHover:ae,className:"relative flex h-16 w-36 items-center justify-center px-4",children:s.jsx("img",{src:"/logo-color.png",alt:"Havifin",className:"h-full w-full object-contain"})}),re=s.jsx("div",{className:"h-10 w-[1px] bg-slate-100"}),t[44]=ne,t[45]=re):(ne=t[44],re=t[45]);let ie;t[46]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsxs("div",{className:"flex items-center gap-6",children:[ne,re,s.jsx("div",{className:"hidden md:block",children:s.jsxs("h1",{className:"text-lg font-black tracking-tighter text-slate-800 uppercase",children:["Terminal"," ",s.jsx("span",{className:"text-brand-blue",children:"Caisse"})]})})]}),t[46]=ie):ie=t[46];let oe;t[47]===Symbol.for("react.memo_cache_sentinel")?(oe=s.jsx(Nt,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-slate-400 transition-colors group-focus-within:text-brand-blue"}),t[47]=oe):oe=t[47];let ce;t[48]===Symbol.for("react.memo_cache_sentinel")?(ce=i=>y(i.target.value),t[48]=ce):ce=t[48];let Q;t[49]!==l?(Q=s.jsx("div",{className:"mx-10 max-w-sm flex-1",children:s.jsxs("div",{className:"group relative",children:[oe,s.jsx(Qe,{placeholder:"Rechercher ticket...",value:l,onChange:ce,className:"h-11 w-full rounded-2xl border-transparent bg-slate-50 pl-11 font-medium text-slate-700 transition-all focus:border-blue-500 focus:bg-white"})]})}),t[49]=l,t[50]=Q):Q=t[50];const ve=_.isPending&&"animate-spin";let V;t[51]!==ve?(V=ke("mr-2 h-4 w-4",ve),t[51]=ve,t[52]=V):V=t[52];let W;t[53]!==V?(W=s.jsx(dt,{className:V}),t[53]=V,t[54]=W):W=t[54];let G;t[55]!==he||t[56]!==W?(G=s.jsxs(xe,{variant:"outline",onClick:he,className:"h-12 rounded-2xl border-slate-200 bg-white px-6 font-bold shadow-sm transition-all hover:border-brand-blue hover:text-brand-blue",children:[W,"Actualiser"]}),t[55]=he,t[56]=W,t[57]=G):G=t[57];let de;t[58]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx("div",{className:"h-10 w-[1px] bg-slate-200"}),t[58]=de):de=t[58];let we;t[59]===Symbol.for("react.memo_cache_sentinel")?(we=s.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-100 bg-white text-slate-600 shadow-sm",children:s.jsx(Tt,{className:"h-6 w-6"})}),t[59]=we):we=t[59];const Ce=e.user.shop?`• ${e.user.shop}`:"";let J;t[60]!==e.user.role||t[61]!==Ce?(J=s.jsxs("div",{className:"text-[10px] font-black tracking-wider text-slate-400 uppercase",children:[e.user.role," ",Ce]}),t[60]=e.user.role,t[61]=Ce,t[62]=J):J=t[62];let X;t[63]!==e.user.name?(X=s.jsx("div",{className:"text-xs font-bold text-slate-700",children:e.user.name}),t[63]=e.user.name,t[64]=X):X=t[64];let Y;t[65]!==J||t[66]!==X?(Y=s.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border border-slate-200 bg-slate-100 p-1.5 pr-4 shadow-inner",children:[we,s.jsxs("div",{children:[J,X]})]}),t[65]=J,t[66]=X,t[67]=Y):Y=t[67];let Z;t[68]!==e.user.counter?(Z=e.user.counter&&s.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-brand-blue/20 bg-brand-blue/10 px-4 py-2 font-bold text-brand-blue",children:[s.jsx("span",{className:"text-[10px] tracking-widest uppercase",children:"Guichet"}),s.jsx("span",{className:"text-sm",children:e.user.counter})]}),t[68]=e.user.counter,t[69]=Z):Z=t[69];let ee;t[70]!==G||t[71]!==Y||t[72]!==Z?(ee=s.jsxs("div",{className:"flex items-center gap-4",children:[G,de,Y,Z]}),t[70]=G,t[71]=Y,t[72]=Z,t[73]=ee):ee=t[73];let me;t[74]!==Q||t[75]!==ee?(me=s.jsxs("header",{className:"z-20 flex h-20 flex-shrink-0 items-center justify-between border-b border-slate-200 bg-white px-10 shadow-[0_1px_3px_rgba(0,0,0,0.02)]",children:[ie,Q,ee]}),t[74]=Q,t[75]=ee,t[76]=me):me=t[76];const j=m.length;let U;if(t[77]!==_.isPending||t[78]!==_.variables?.id||t[79]!==B||t[80]!==M){let i;t[82]!==_.isPending||t[83]!==_.variables?.id||t[84]!==M?(i=O=>s.jsx(lt,{client:O,onCall:M,isProcessing:_.isPending&&_.variables?.id===O.id},O.id),t[82]=_.isPending,t[83]=_.variables?.id,t[84]=M,t[85]=i):i=t[85],U=B.map(i),t[77]=_.isPending,t[78]=_.variables?.id,t[79]=B,t[80]=M,t[81]=U}else U=t[81];let K;t[86]!==U?(K=s.jsx(Be,{mode:"popLayout",children:U}),t[86]=U,t[87]=K):K=t[87];let fe;t[88]!==m.length?(fe=m.length===0&&s.jsxs("div",{className:"mt-12 text-center opacity-30",children:[s.jsx(Rt,{className:"mx-auto mb-4 h-16 w-16"}),s.jsx("p",{className:"text-sm font-bold tracking-widest uppercase",children:"Aucun client"})]}),t[88]=m.length,t[89]=fe):fe=t[89];let Se;t[90]!==K||t[91]!==fe||t[92]!==m.length?(Se=s.jsxs(et,{title:"Clients en Attente",icon:ct,count:j,color:"bg-slate-900 text-white border-slate-900",children:[K,fe]}),t[90]=K,t[91]=fe,t[92]=m.length,t[93]=Se):Se=t[93];const pt=f.length;let Pe;if(t[94]!==I||t[95]!==H){let i;t[97]!==H?(i=O=>s.jsx(lt,{client:O,onRecall:H,onProcess:ye,onHelp:_e},O.id),t[97]=H,t[98]=i):i=t[98],Pe=I.map(i),t[94]=I,t[95]=H,t[96]=Pe}else Pe=t[96];let De;t[99]!==Pe?(De=s.jsx(Be,{mode:"popLayout",children:Pe}),t[99]=Pe,t[100]=De):De=t[100];let Me;t[101]!==f.length?(Me=f.length===0&&s.jsxs("div",{className:"mt-12 text-center opacity-20",children:[s.jsx(rt,{className:"mx-auto mb-4 h-16 w-16"}),s.jsx("p",{className:"text-sm font-bold tracking-widest uppercase",children:"Prenez un ticket"})]}),t[101]=f.length,t[102]=Me):Me=t[102];let Ae;t[103]!==f.length||t[104]!==De||t[105]!==Me?(Ae=s.jsxs(et,{title:"En Cours de Service",icon:rt,count:pt,color:"bg-brand-blue text-white border-brand-blue",children:[De,Me]}),t[103]=f.length,t[104]=De,t[105]=Me,t[106]=Ae):Ae=t[106];const bt=A.length;let Fe;t[107]!==te?(Fe=te.map(ts),t[107]=te,t[108]=Fe):Fe=t[108];let Re;t[109]!==Fe?(Re=s.jsx(Be,{mode:"popLayout",children:Fe}),t[109]=Fe,t[110]=Re):Re=t[110];let $e;t[111]!==A.length||t[112]!==Re?($e=s.jsx(et,{title:"Derniers Traités",icon:mt,count:bt,color:"bg-brand-cyan text-brand-dark border-brand-cyan shadow-lg shadow-brand-cyan/20",children:Re}),t[111]=A.length,t[112]=Re,t[113]=$e):$e=t[113];let Ee;t[114]!==Se||t[115]!==Ae||t[116]!==$e?(Ee=s.jsx("main",{className:"flex-1 overflow-x-auto overflow-y-hidden bg-[url('/grid.svg')] bg-[length:40px_40px] bg-fixed px-10 py-8",children:s.jsxs("div",{className:"flex h-full min-w-max gap-10 pb-4",children:[Se,Ae,$e]})}),t[114]=Se,t[115]=Ae,t[116]=$e,t[117]=Ee):Ee=t[117];let qe;t[118]!==r?(qe=()=>{d(!1),c(null),r.invalidateQueries({queryKey:["clients"]})},t[118]=r,t[119]=qe):qe=t[119];let Le;t[120]!==n||t[121]!==a||t[122]!==qe?(Le=s.jsx(Zt,{client:a,open:n,onClose:qe}),t[120]=n,t[121]=a,t[122]=qe,t[123]=Le):Le=t[123];let Ie;t[124]===Symbol.for("react.memo_cache_sentinel")?(Ie=()=>{p(!1),N(null)},t[124]=Ie):Ie=t[124];const Ge=o?.phone;let Ue;t[125]!==v||t[126]!==Ge?(Ue=s.jsx(Jt,{isOpen:v,onClose:Ie,clientPhone:Ge}),t[125]=v,t[126]=Ge,t[127]=Ue):Ue=t[127];let Oe;return t[128]!==me||t[129]!==Ee||t[130]!==Le||t[131]!==Ue?(Oe=s.jsxs(Ft,{currentPageName:"Tableau de Bord Caissier",children:[le,s.jsxs("div",{className:"flex flex-col overflow-hidden bg-slate-50",children:[me,Ee,Le,Ue]})]}),t[128]=me,t[129]=Ee,t[130]=Le,t[131]=Ue,t[132]=Oe):Oe=t[132],Oe}function ts(t){return s.jsx(lt,{client:t},t.id)}function ss(){He.info("Rappel envoyé à l'affichage")}async function ls(t){await be.entities.Client.update(t.id,{called_at:new Date().toISOString()})}function as(){return be.entities.Client.filter({status:"completed"},"-completed_at",20)}function ns(){return be.entities.Client.filter({status:"waiting"},"created_date")}export{Cs as default};
