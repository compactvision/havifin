import{c as X,r as z,j as t,R as xe,b as je,H as ve}from"./app-sj5sN_G8.js";import{b as q}from"./base44Client-DAEF8o8X.js";import{B as I,t as ce}from"./index-PZTgIcWY.js";import{L as $,I as R}from"./label-D9tdbS9f.js";import{u as ie,A as O}from"./users-DerS2__8.js";import{T as we}from"./trending-up-DZV_E65W.js";import{A as Y}from"./arrow-right-CRx9u8Uz.js";import{c as J,m as S,a as L}from"./createLucideIcon-DgynkeM3.js";import{c as Ne,P as ne,b as _e,a as ke,C as he}from"./phone-Br8UIhn5.js";import{R as ue,A as Ce,L as Se}from"./refresh-cw-B2z2Akrr.js";import{P as de}from"./plus-DTH9be9K.js";import{L as Z}from"./loader-circle-CH7iWCpR.js";import{C as Ae}from"./check-DOrNNhu4.js";import{B as ee}from"./building-2-CXNefrAQ.js";import{G as re,C as me}from"./globe-DwW23ID4.js";import{S as pe,a as Fe}from"./smartphone-B8PDcnvC.js";import{C as ze}from"./circle-check-ChbTJxBB.js";import{C as be}from"./clock-qRNAa-h9.js";import{A as De,S as Pe,a as Te}from"./app-main-Bt9MoLIe.js";import{u as se}from"./useMutation-uOdm-zRO.js";import{h as Re}from"./moment-B-YVwB4U.js";import{L as $e}from"./lock-Y9s_M2nO.js";/* empty css            */import"./axios-BWKhhBfN.js";const Ie=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],Le=J("Coins",Ie);const Me=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Be=J("Copy",Me);const Ee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ue=J("Info",Ee);const qe=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Ve=J("Printer",qe);const He=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],Oe=J("Ticket",He);function Xe(D){const e=X.c(23),{onSelect:l,initialAmount:o}=D,y=o===void 0?"":o,[n,h]=z.useState(null),[i,x]=z.useState(y),[c,d]=z.useState(null);let _;e[0]===Symbol.for("react.memo_cache_sentinel")?(_={queryKey:["exchange-rates","active"],queryFn:Ke},e[0]=_):_=e[0];const{data:v,isLoading:k}=ie(_);let u;e[1]!==v?(u=v===void 0?[]:v,e[1]=v,e[2]=u):u=e[2];const j=u;let f;e[3]!==n?.rate.currency_pair?(f=n?.rate.currency_pair?.split("/")||["USD","CDF"],e[3]=n?.rate.currency_pair,e[4]=f):f=e[4];const p=f,r=n?n.side==="buy"?n.rate.buy_rate:n.rate.sell_rate:0;let b;e[5]!==i||e[6]!==r||e[7]!==p||e[8]!==l||e[9]!==n?(b=()=>{if(n&&i&&r){const g=parseFloat(i);if(isNaN(g))d(null);else{let N;n.side==="buy"?N=g*r:N=g/r,d(N),l({currency_from:n.side==="buy"?p[0]:p[1],currency_to:n.side==="buy"?p[1]:p[0],exchange_rate:r,amount_from:g,amount_to:N})}}else d(null)},e[5]=i,e[6]=r,e[7]=p,e[8]=l,e[9]=n,e[10]=b):b=e[10];let A;if(e[11]!==i||e[12]!==r||e[13]!==n?(A=[n,i,r],e[11]=i,e[12]=r,e[13]=n,e[14]=A):A=e[14],z.useEffect(b,A),k){let g;return e[15]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(ue,{className:"h-12 w-12 animate-spin text-indigo-500"}),t.jsx("p",{className:"mt-4 font-bold text-slate-500",children:"Chargement des taux..."})]}),e[15]=g):g=e[15],g}let m;return e[16]!==i||e[17]!==r||e[18]!==p||e[19]!==j||e[20]!==c||e[21]!==n?(m=t.jsx("div",{className:"space-y-10",children:n?t.jsxs(S.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"space-y-8",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-indigo-600 shadow-lg shadow-indigo-600/20",children:t.jsx(Ne,{className:"h-5 w-5 text-white"})}),t.jsxs("h3",{className:"text-xl font-black tracking-tight text-slate-800 uppercase",children:["Calcul du Change :"," ",n.side==="buy"?"USD → CDF":"CDF → USD"]})]}),t.jsx(I,{variant:"ghost",onClick:()=>h(null),className:"h-10 rounded-xl font-black text-indigo-600 hover:bg-indigo-50",children:"Changer d'opération"})]}),t.jsx("div",{className:"shadow-3xl overflow-hidden rounded-[3rem] border-4 border-white bg-white/60 p-10 backdrop-blur-2xl",children:t.jsxs("div",{className:"grid gap-12 lg:grid-cols-2 lg:items-center",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs($,{className:"ml-2 text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:["Vous donnez (",n.side==="buy"?"USD":"CDF",")"]}),t.jsxs("div",{className:"relative mt-2",children:[t.jsx(R,{type:"number",placeholder:"0.00",value:i,onChange:g=>x(g.target.value),className:"h-24 rounded-[2.5rem] border-none bg-white px-10 text-4xl font-black text-slate-900 shadow-2xl focus:ring-4 focus:ring-indigo-500/20",autoFocus:!0}),t.jsx("div",{className:"absolute top-1/2 right-8 -translate-y-1/2 rounded-2xl bg-slate-900 px-6 py-3 text-sm font-black text-white",children:n.side==="buy"?"USD":"CDF"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 rounded-2xl bg-indigo-50 p-5 px-6",children:[t.jsx("div",{className:"h-2 w-2 animate-pulse rounded-full bg-indigo-500"}),t.jsxs("span",{className:"text-sm font-black text-indigo-600 italic",children:["Libellé :"," ",n.side==="buy"?`Client donne ${p[0]}, reçoit ${p[1]}`:`Client donne ${p[1]}, reçoit ${p[0]}`," | "," Taux : 1 ",p[0]," ="," ",r," ",p[1]]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs($,{className:"ml-2 text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:["Vous recevrez (",n.side==="buy"?"CDF":"USD",")"]}),t.jsxs("div",{className:"relative mt-2 flex h-24 items-center rounded-[2.5rem] bg-indigo-600 px-10 shadow-2xl shadow-indigo-600/30",children:[t.jsx("span",{className:"text-4xl font-black text-white",children:c!==null?c.toLocaleString(void 0,{maximumFractionDigits:2}):"0.00"}),t.jsx("div",{className:"ml-auto rounded-2xl bg-white/20 px-6 py-3 text-sm font-black text-white",children:n.side==="buy"?"CDF":"USD"})]})]}),t.jsxs("div",{className:"flex items-center justify-between px-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Le,{className:"h-4 w-4 text-amber-500"}),t.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Conversion Directe"})]}),i&&t.jsxs("span",{className:"text-xs font-black text-slate-400 uppercase",children:["Calcul : ",i," ",n.side==="buy"?"×":"÷"," ",n.side==="buy"?n.rate.buy_rate:n.rate.sell_rate]})]})]})]})})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-3 px-2",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-indigo-50 text-indigo-500",children:t.jsx(we,{className:"h-5 w-5"})}),t.jsx("h3",{className:"text-xl font-black tracking-tight text-slate-800 uppercase",children:"Quel change souhaitez-vous effectuer ?"})]}),t.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:j.map((g,N)=>{const P=g.currency_pair?.split("/")||["USD","CDF"];return t.jsxs(xe.Fragment,{children:[t.jsxs("button",{onClick:()=>h({rate:g,side:"buy"}),className:"group relative flex flex-col items-center justify-center rounded-[3rem] border-4 border-slate-100 bg-slate-50/50 p-10 transition-all duration-300 hover:border-indigo-200 hover:bg-white hover:shadow-2xl",children:[t.jsx("div",{className:"mb-4 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Vendre mes Dollars"}),t.jsxs("div",{className:"flex items-center gap-4 text-3xl font-black text-slate-900",children:[t.jsx("span",{children:P[0]}),t.jsx(Y,{className:"h-8 w-8 text-indigo-500 transition-transform group-hover:translate-x-2"}),t.jsx("span",{children:P[1]})]}),t.jsx("div",{className:"mt-6 rounded-2xl bg-indigo-50 px-6 py-2",children:t.jsxs("span",{className:"text-sm font-black text-indigo-600",children:["Taux : 1 ",P[0]," ="," ",g.buy_rate," ",P[1]]})})]}),t.jsxs("button",{onClick:()=>h({rate:g,side:"sell"}),className:"group relative flex flex-col items-center justify-center rounded-[3rem] border-4 border-slate-100 bg-slate-50/50 p-10 transition-all duration-300 hover:border-indigo-200 hover:bg-white hover:shadow-2xl",children:[t.jsx("div",{className:"mb-4 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Acheter des Dollars"}),t.jsxs("div",{className:"flex items-center gap-4 text-3xl font-black text-slate-900",children:[t.jsx("span",{children:P[1]}),t.jsx(Y,{className:"h-8 w-8 text-indigo-500 transition-transform group-hover:translate-x-2"}),t.jsx("span",{children:P[0]})]}),t.jsx("div",{className:"mt-6 rounded-2xl bg-indigo-50 px-6 py-2",children:t.jsxs("span",{className:"text-sm font-black text-indigo-600",children:["Taux : 1 ",P[0]," ="," ",g.sell_rate," ",P[1]]})})]})]},`rate-${g.id||N}`)})})]})}),e[16]=i,e[17]=r,e[18]=p,e[19]=j,e[20]=c,e[21]=n,e[22]=m):m=e[22],m}function Ke(){return q.entities.ExchangeRate.getAll()}function Qe(D){const e=X.c(20),{phones:l,selectedPhone:o,onSelect:y,onAdd:n,isAdding:h}=D,i=h===void 0?!1:h,[x,c]=z.useState(!1),[d,_]=z.useState("");let v;e[0]!==d||e[1]!==n?(v=async()=>{d.length===10&&(await n(d),c(!1),_(""))},e[0]=d,e[1]=n,e[2]=v):v=e[2];const k=v;let u;if(e[3]!==y||e[4]!==l||e[5]!==o){let r;e[7]!==y||e[8]!==o?(r=b=>t.jsxs(S.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>y(b.phone_number),className:L("relative flex items-center gap-4 overflow-hidden rounded-2xl border-2 p-4 transition-all duration-200",o===b.phone_number?"border-blue-500 bg-blue-50/50 shadow-md":"border-slate-100 bg-white hover:border-slate-200"),children:[t.jsx("div",{className:L("flex h-10 w-10 items-center justify-center rounded-xl",o===b.phone_number?"bg-blue-500 text-white":"bg-slate-100 text-slate-400"),children:t.jsx(ne,{className:"h-5 w-5"})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("span",{className:L("block text-lg font-bold",o===b.phone_number?"text-blue-700":"text-slate-700"),children:b.phone_number}),b.is_primary&&t.jsx("span",{className:"rounded-full bg-blue-100 px-2 py-0.5 text-[10px] font-black tracking-wider text-blue-500/60 uppercase",children:"Principal"})]}),o===b.phone_number&&t.jsx(S.div,{initial:{scale:0},animate:{scale:1},className:"flex h-6 w-6 items-center justify-center rounded-full bg-blue-500 text-white",children:t.jsx(Ae,{className:"h-4 w-4"})})]},b.id),e[7]=y,e[8]=o,e[9]=r):r=e[9],u=l.map(r),e[3]=y,e[4]=l,e[5]=o,e[6]=u}else u=e[6];let j;e[10]!==u?(j=t.jsx("div",{className:"grid grid-cols-1 gap-3",children:u}),e[10]=u,e[11]=j):j=e[11];let f;e[12]!==k||e[13]!==i||e[14]!==x||e[15]!==d?(f=t.jsx(O,{children:x?t.jsxs(S.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"space-y-3 rounded-2xl border-2 border-blue-100 bg-blue-50/30 p-4",children:[t.jsx($,{className:"mb-1 block font-bold text-blue-700",children:"Nouveau numéro"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(R,{type:"tel",inputMode:"numeric",pattern:"[0-9]*",value:d,onChange:r=>_(r.target.value.replace(/\D/g,"").slice(0,10)),placeholder:"0XXXXXXXXX",className:"h-12 rounded-xl bg-white focus:border-blue-500 focus:ring-blue-500",autoFocus:!0}),t.jsx(I,{onClick:k,disabled:d.length<10||i,className:"h-12 rounded-xl bg-blue-600 px-6 text-white hover:bg-blue-700",children:i?t.jsx(Z,{className:"h-5 w-5 animate-spin"}):t.jsx(de,{className:"h-5 w-5"})})]}),t.jsx(I,{variant:"ghost",size:"sm",onClick:()=>c(!1),className:"w-full text-slate-500 hover:text-red-500",children:"Annuler"})]}):t.jsxs(S.button,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>c(!0),className:"flex w-full items-center justify-center gap-2 rounded-2xl border-2 border-dashed border-slate-200 p-4 font-bold text-slate-400 transition-all hover:border-blue-300 hover:bg-blue-50/30 hover:text-blue-500",children:[t.jsx(de,{className:"h-5 w-5"}),"Ajouter un nouveau numéro"]})}),e[12]=k,e[13]=i,e[14]=x,e[15]=d,e[16]=f):f=e[16];let p;return e[17]!==j||e[18]!==f?(p=t.jsxs("div",{className:"space-y-4",children:[j,f]}),e[17]=j,e[18]=f,e[19]=p):p=e[19],p}const Ge=[{id:"change",name:"Change Devises",icon:Ce,description:"USD ↔ CDF au meilleur taux",color:"from-amber-400 to-orange-500",hover:"shadow-orange-200"},{id:"depot",name:"Dépôt Cash",icon:_e,description:"Alimentez vos comptes",color:"from-green-400 to-emerald-600",hover:"shadow-green-200"},{id:"retrait",name:"Retrait Cash",icon:ke,description:"Retirez vos fonds",color:"from-blue-400 to-indigo-600",hover:"shadow-blue-200"},{id:"paiement",name:"Paiement",icon:he,description:"Payez vos factures et services",color:"from-purple-400 to-pink-600",hover:"shadow-purple-200"}];function We(D){const e=X.c(5),{selectedOperation:l,onSelect:o}=D;let y;e[0]!==o||e[1]!==l?(y=Ge.map(h=>{const i=h.icon,x=l===h.id;return t.jsxs(S.button,{whileHover:{scale:1.05,y:-5},whileTap:{scale:.95},onClick:()=>o(h.id),className:L("group relative overflow-hidden rounded-[40px] border-4 p-8 text-center transition-all duration-300",x?"border-blue-500 bg-white shadow-2xl shadow-blue-500/20":"border-slate-50 bg-slate-50/50 hover:border-slate-200 hover:bg-white hover:shadow-xl"),children:[t.jsx("div",{className:L("absolute -top-12 -right-12 h-24 w-24 rounded-full blur-[40px] transition-opacity",x?"opacity-20":"opacity-0 group-hover:opacity-10",h.color.replace("from-","bg-"))}),t.jsx("div",{className:L("mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-[28px] bg-gradient-to-br shadow-lg transition-transform group-hover:rotate-6",h.color,x?"scale-110":""),children:t.jsx(i,{className:"h-10 w-10 text-white"})}),t.jsx("h3",{className:L("mb-2 text-xl font-black transition-colors",x?"text-slate-900":"text-slate-700"),children:h.name}),t.jsx("p",{className:"text-sm font-medium text-slate-400 group-hover:text-slate-500",children:h.description}),x&&t.jsx(S.div,{layoutId:"op-indicator",className:"absolute bottom-4 left-1/2 h-2 w-12 -translate-x-1/2 rounded-full bg-blue-500"})]},h.id)}),e[0]=o,e[1]=l,e[2]=y):y=e[2];let n;return e[3]!==y?(n=t.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-4",children:y}),e[3]=y,e[4]=n):n=e[4],n}function Je(D){const e=X.c(30),{institutions:l,selectedId:o,onSelect:y,type:n}=D;let h,i,x,c;if(e[0]!==l||e[1]!==y||e[2]!==o||e[3]!==n){let v;e[8]!==n?(v=N=>N.type===n,e[8]=n,e[9]=v):v=e[9];const k=l.filter(v);let u;e[10]!==n?(u=()=>{switch(n){case"mobile_money":return pe;case"bank":return ee;case"payment":case"other":return re;default:return ee}},e[10]=n,e[11]=u):u=e[11];const j=u;let f;e[12]!==n?(f=()=>{switch(n){case"mobile_money":return"Opérateurs Mobile";case"bank":return"Banques";case"payment":return"Services de Paiement";case"other":return"Autres Partenaires";default:return"Institutions"}},e[12]=n,e[13]=f):f=e[13];const p=f;let r;e[14]!==j?(r=j(),e[14]=j,e[15]=r):r=e[15];const b=r;x="space-y-4";let A;e[16]!==b?(A=t.jsx(b,{className:"h-5 w-5 text-blue-500"}),e[16]=b,e[17]=A):A=e[17];const m=p();let g;e[18]!==m?(g=t.jsx("h3",{className:"text-lg font-bold text-slate-800",children:m}),e[18]=m,e[19]=g):g=e[19],e[20]!==g||e[21]!==A?(c=t.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[A,g]}),e[20]=g,e[21]=A,e[22]=c):c=e[22],h="grid grid-cols-2 gap-4 md:grid-cols-4",i=k.length>0?k.map(N=>t.jsxs(S.button,{whileHover:{scale:1.03,y:-2},whileTap:{scale:.97},onClick:()=>y(N.id),className:L("relative flex flex-col items-center justify-center rounded-[32px] border-2 p-6 transition-all duration-300",o===N.id?"border-blue-500 bg-white shadow-xl ring-4 shadow-blue-500/10 ring-blue-50":"border-slate-100 bg-slate-50/50 hover:border-slate-200 hover:bg-white"),children:[t.jsx("div",{className:L("mb-4 flex h-16 w-16 items-center justify-center rounded-2xl shadow-inner transition-colors",o===N.id?"bg-blue-50":"bg-white"),children:N.logo_url?t.jsx("img",{src:N.logo_url,alt:N.name,className:"h-10 w-10 object-contain"}):t.jsx(Se,{className:L("h-8 w-8",o===N.id?"text-blue-500":"text-slate-300")})}),t.jsx("span",{className:L("text-center text-sm font-black tracking-tight",o===N.id?"text-blue-700":"text-slate-600"),children:N.name}),o===N.id&&t.jsx(S.div,{layoutId:"active-indicator",className:"absolute -top-1 -right-1 h-6 w-6 rounded-full border-4 border-white bg-blue-500 shadow-sm"})]},N.id)):t.jsxs("div",{className:"col-span-full py-12 text-center",children:[t.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-slate-100 text-slate-300",children:t.jsx(b,{className:"h-8 w-8"})}),t.jsx("p",{className:"text-sm font-bold tracking-widest text-slate-400 uppercase",children:"Aucun partenaire disponible"})]}),e[0]=l,e[1]=y,e[2]=o,e[3]=n,e[4]=h,e[5]=i,e[6]=x,e[7]=c}else h=e[4],i=e[5],x=e[6],c=e[7];let d;e[23]!==h||e[24]!==i?(d=t.jsx("div",{className:h,children:i}),e[23]=h,e[24]=i,e[25]=d):d=e[25];let _;return e[26]!==x||e[27]!==c||e[28]!==d?(_=t.jsxs("div",{className:x,children:[c,d]}),e[26]=x,e[27]=c,e[28]=d,e[29]=_):_=e[29],_}const ae=[{id:"mobile_money",name:"Mobile Money",icon:pe,color:"text-emerald-500"},{id:"bank",name:"Banques",icon:ee,color:"text-blue-500"},{id:"payment",name:"Services de Paiement",icon:re,color:"text-indigo-500"},{id:"other",name:"Autres",icon:re,color:"text-amber-500"}];function Ze(D){const e=X.c(25),{institutions:l,selectedId:o,onSelect:y,isLoading:n,operationType:h}=D,[i,x]=xe.useState("mobile_money");let c;e:{if(h==="paiement"){let m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m=ae.filter(et),e[0]=m):m=e[0],c=m;break e}if(h==="depot"||h==="retrait"){let m;e[1]===Symbol.for("react.memo_cache_sentinel")?(m=ae.filter(Ye),e[1]=m):m=e[1],c=m;break e}c=ae}const d=c;let _,v;if(e[2]!==i||e[3]!==h?(_=()=>{h==="paiement"&&i!=="payment"?x("payment"):h!=="paiement"&&i==="payment"&&x("mobile_money")},v=[h,i],e[2]=i,e[3]=h,e[4]=_,e[5]=v):(_=e[4],v=e[5]),z.useEffect(_,v),n){let m;return e[6]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[t.jsx("div",{className:"mb-4 h-12 w-12 animate-spin rounded-full border-4 border-slate-200 border-t-indigo-600"}),t.jsx("p",{className:"text-sm font-bold tracking-widest text-slate-400 uppercase",children:"Récupération des partenaires..."})]}),e[6]=m):m=e[6],m}let k;e[7]!==i||e[8]!==d?(k=d.length>1&&t.jsx("div",{className:"flex gap-2 rounded-[24px] bg-slate-100 p-1.5",children:d.map(m=>t.jsxs("button",{onClick:()=>x(m.id),className:L("flex flex-1 items-center justify-center gap-2 rounded-[18px] px-4 py-4 text-sm font-bold transition-all",i===m.id?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"),children:[t.jsx(m.icon,{className:L("h-5 w-5",i===m.id?m.color:"text-slate-400")}),m.name]},m.id))}),e[7]=i,e[8]=d,e[9]=k):k=e[9];let u,j,f,p;e[10]===Symbol.for("react.memo_cache_sentinel")?(u={opacity:0,x:20},j={opacity:1,x:0},f={opacity:0,x:-20},p={duration:.2},e[10]=u,e[11]=j,e[12]=f,e[13]=p):(u=e[10],j=e[11],f=e[12],p=e[13]);let r;e[14]!==i||e[15]!==l||e[16]!==y||e[17]!==o?(r=t.jsx(Je,{institutions:l,selectedId:o,onSelect:y,type:i}),e[14]=i,e[15]=l,e[16]=y,e[17]=o,e[18]=r):r=e[18];let b;e[19]!==i||e[20]!==r?(b=t.jsx(O,{mode:"wait",children:t.jsx(S.div,{initial:u,animate:j,exit:f,transition:p,children:r},i)}),e[19]=i,e[20]=r,e[21]=b):b=e[21];let A;return e[22]!==b||e[23]!==k?(A=t.jsxs("div",{className:"space-y-8",children:[k,b]}),e[22]=b,e[23]=k,e[24]=A):A=e[24],A}function Ye(D){return D.id!=="payment"}function et(D){return D.id==="payment"}const tt=D=>{const e=X.c(22),{ticketNumber:l,details:o}=D;let y,n;if(e[0]===Symbol.for("react.memo_cache_sentinel")){const A=new Date;y=A.toLocaleDateString("fr-FR"),n=A.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),e[0]=y,e[1]=n}else y=e[0],n=e[1];const h=n;let i,x,c,d,_;e[2]===Symbol.for("react.memo_cache_sentinel")?(i={width:"58mm",fontFamily:"monospace",fontSize:"12px",color:"black",backgroundColor:"white",padding:"4px"},x=t.jsxs("div",{style:{textAlign:"center",borderBottom:"1px dashed black",paddingBottom:"8px",marginBottom:"8px"},children:[t.jsx("div",{style:{fontSize:"18px",fontWeight:"bold"},children:"HAVIFIN"}),t.jsxs("div",{style:{fontSize:"10px"},children:[y," - ",h]})]}),c={textAlign:"center",padding:"10px 0",borderBottom:"1px dashed black",marginBottom:"8px"},d=t.jsx("div",{style:{fontSize:"10px",textTransform:"uppercase"},children:"Ticket No."}),_={fontSize:"32px",fontWeight:"bold"},e[2]=i,e[3]=x,e[4]=c,e[5]=d,e[6]=_):(i=e[2],x=e[3],c=e[4],d=e[5],_=e[6]);let v;e[7]!==l?(v=t.jsxs("div",{style:c,children:[d,t.jsx("div",{style:_,children:l})]}),e[7]=l,e[8]=v):v=e[8];let k;e[9]===Symbol.for("react.memo_cache_sentinel")?(k={marginBottom:"8px"},e[9]=k):k=e[9];let u;e[10]!==o?(u=o?.service&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Service:"}),t.jsx("span",{children:o.service})]}),e[10]=o,e[11]=u):u=e[11];let j;e[12]!==o?(j=o?.operation_type&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Opér.:"}),t.jsx("span",{children:o.operation_type==="retrait"?"Retrait":"Dépôt"})]}),e[12]=o,e[13]=j):j=e[13];let f;e[14]!==j||e[15]!==u?(f=t.jsxs("div",{style:k,children:[u,j]}),e[14]=j,e[15]=u,e[16]=f):f=e[16];let p,r;e[17]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsxs("div",{style:{textAlign:"center",borderTop:"1px dashed black",paddingTop:"8px"},children:[t.jsx("div",{children:"MERCI DE VOTRE CONFIANCE"}),t.jsx("div",{style:{fontSize:"10px",marginTop:"4px"},children:"Attendez votre tour sur l'écran"})]}),r=t.jsx("div",{style:{height:"40px"}}),e[17]=p,e[18]=r):(p=e[17],r=e[18]);let b;return e[19]!==f||e[20]!==v?(b=t.jsxs("div",{id:"printable-ticket",style:i,children:[x,v,f,p,r]}),e[19]=f,e[20]=v,e[21]=b):b=e[21],b};function st(D){const e=X.c(38),{ticketNumber:l,onNewTicket:o}=D;let y,n;e[0]!==l?(y=()=>{if(l){const te=setTimeout(it,1e3);return()=>clearTimeout(te)}},n=[l],e[0]=l,e[1]=y,e[2]=n):(y=e[1],n=e[2]),z.useEffect(y,n);const h=at;let i,x;e[3]===Symbol.for("react.memo_cache_sentinel")?(i={opacity:0,scale:.95},x={opacity:1,scale:1},e[3]=i,e[4]=x):(i=e[3],x=e[4]);let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(S.div,{initial:{scale:.8,opacity:0},animate:{scale:1.5,opacity:0},transition:{repeat:1/0,duration:2,ease:"easeOut"},className:"absolute inset-0 rounded-full bg-green-500/20"}),e[5]=c):c=e[5];let d,_,v;e[6]===Symbol.for("react.memo_cache_sentinel")?(d={scale:0},_={scale:1},v={type:"spring",stiffness:200,damping:20},e[6]=d,e[7]=_,e[8]=v):(d=e[6],_=e[7],v=e[8]);let k,u,j;e[9]===Symbol.for("react.memo_cache_sentinel")?(j=t.jsxs("div",{className:"relative mb-12",children:[c,t.jsx(S.div,{initial:d,animate:_,transition:v,className:"relative mx-auto flex h-28 w-28 items-center justify-center rounded-[36px] bg-gradient-to-br from-emerald-400 to-green-600 shadow-2xl shadow-green-500/30",children:t.jsx(ze,{className:"h-14 w-14 text-white"})})]}),k=t.jsx("h2",{className:"mb-2 text-4xl font-black tracking-tight text-slate-900",children:"C'est fait !"}),u=t.jsx("p",{className:"mb-10 text-xl font-medium text-slate-500",children:"Votre ticket a été généré avec succès"}),e[9]=k,e[10]=u,e[11]=j):(k=e[9],u=e[10],j=e[11]);let f,p,r;e[12]===Symbol.for("react.memo_cache_sentinel")?(f={y:30,opacity:0},p={y:0,opacity:1},r={delay:.3,type:"spring"},e[12]=f,e[13]=p,e[14]=r):(f=e[12],p=e[13],r=e[14]);let b,A;e[15]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-8 -translate-y-8 rounded-full bg-white/5 blur-2xl transition-transform group-hover:scale-150"}),A=t.jsx("div",{className:"absolute bottom-0 left-0 h-24 w-24 -translate-x-8 translate-y-8 rounded-full bg-blue-500/10 blur-xl"}),e[15]=b,e[16]=A):(b=e[15],A=e[16]);let m;e[17]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsxs("div",{className:"mb-6 flex items-center justify-center gap-3 text-amber-400",children:[t.jsx(Oe,{className:"h-6 w-6 rotate-12"}),t.jsx("span",{className:"text-sm font-black tracking-[0.2em] uppercase",children:"Ticket No."})]}),e[17]=m):m=e[17];let g;e[18]!==l?(g=t.jsx("div",{className:"mb-8 font-mono text-7xl font-black tracking-tighter text-white",children:l}),e[18]=l,e[19]=g):g=e[19];let N;e[20]===Symbol.for("react.memo_cache_sentinel")?(N=t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/5 bg-white/5 px-4 py-2 text-sm font-bold text-slate-400",children:[t.jsx(be,{className:"h-4 w-4 text-amber-500"}),t.jsx("span",{children:"Attendez d'être appelé sur l'écran"})]}),e[20]=N):N=e[20];let P;e[21]!==g?(P=t.jsxs(S.div,{initial:f,animate:p,transition:r,className:"group relative mx-auto max-w-sm overflow-hidden rounded-[40px] bg-slate-900 p-10 shadow-2xl",children:[b,A,t.jsxs("div",{className:"relative z-10",children:[m,g,N]})]}),e[21]=g,e[22]=P):P=e[22];let K,Q,s;e[23]===Symbol.for("react.memo_cache_sentinel")?(K={opacity:0},Q={opacity:1},s={delay:.6},e[23]=K,e[24]=Q,e[25]=s):(K=e[23],Q=e[24],s=e[25]);let F;e[26]===Symbol.for("react.memo_cache_sentinel")?(F=t.jsx(ue,{className:"mr-2 h-5 w-5 text-blue-500"}),e[26]=F):F=e[26];let B;e[27]!==o?(B=t.jsxs(I,{onClick:o,className:"h-14 rounded-2xl border-none bg-slate-100 px-10 font-black tracking-tight text-slate-900 shadow-none transition-all hover:scale-105 hover:bg-slate-200 active:scale-95",children:[F,"Nouvelle opération"]}),e[27]=o,e[28]=B):B=e[28];let V;e[29]===Symbol.for("react.memo_cache_sentinel")?(V=t.jsxs(I,{onClick:h,variant:"ghost",className:"ml-4 h-14 rounded-2xl border-none bg-white/10 px-10 font-black tracking-tight text-white shadow-none transition-all hover:bg-white/20 active:scale-95",children:[t.jsx(Ve,{className:"mr-2 h-5 w-5 text-indigo-400"}),"Réimprimer"]}),e[29]=V):V=e[29];let M;e[30]!==l?(M=l&&t.jsx(tt,{ticketNumber:l}),e[30]=l,e[31]=M):M=e[31];let H;e[32]!==B||e[33]!==M?(H=t.jsxs(S.div,{initial:K,animate:Q,transition:s,className:"mt-12",children:[B,V,M]}),e[32]=B,e[33]=M,e[34]=H):H=e[34];let G;return e[35]!==P||e[36]!==H?(G=t.jsxs(S.div,{initial:i,animate:x,className:"py-8 text-center",children:[j,k,u,P,H]}),e[35]=P,e[36]=H,e[37]=G):G=e[37],G}function at(){window.print()}function it(){window.print()}function Ft(){const{auth:D}=je().props,[e,l]=z.useState(1),[o,y]=z.useState(null),[n,h]=z.useState(!1),[i,x]=z.useState(null),[c,d]=z.useState(!1),[_,v]=z.useState(!1),[k,u]=z.useState(!1),[j,f]=z.useState(""),[p,r]=z.useState([]),[b,A]=z.useState(!1),[m,g]=z.useState(!1),{data:N=[],isPending:P}=ie({queryKey:["institutions","active"],queryFn:()=>q.entities.Institution.active()}),{data:K,isLoading:Q}=ie({queryKey:["current-session"],queryFn:()=>q.entities.Session.current(),refetchInterval:1e4}),[s,F]=z.useState({phone:"",operation_type:"",institution_id:void 0,first_name:"",last_name:"",email:"",address:"",amount:"",currency:"USD",reason:"",beneficiary:"",beneficiary_number:"",account_number:"",currency_from:"",currency_to:"",amount_from:0,exchange_rate:0,metadata:{}});z.useEffect(()=>{(async()=>{if(s.phone.length===10&&!i&&!c){h(!0);try{const w=await q.entities.Client.verifyPhone(s.phone);w.exists&&w.client?(x(w.client),F(E=>({...E,phone:s.phone})),l(2),d(!1)):(x(null),d(!0))}catch(w){console.error("Phone verification failed:",w)}finally{h(!1)}}})()},[s.phone,i,c]),z.useEffect(()=>{s.operation_type&&F(a=>({...a,institution_id:void 0,amount:"",reason:"",beneficiary:"",beneficiary_number:"",account_number:"",currency_from:"",currency_to:"",amount_from:0,exchange_rate:0,metadata:{}}))},[s.operation_type]);const B=se({mutationFn:async()=>(await q.entities.Client.register({phone:s.phone,first_name:s.first_name,last_name:s.last_name,email:s.email,address:s.address})).client,onSuccess:a=>{x(a),d(!1),l(2)}}),V=se({mutationFn:async a=>i?(await q.entities.Client.addPhone(i.id,a)).phone:void 0,onSuccess:a=>{i&&a&&x({...i,phones:[...i.phones||[],a]})}}),M=se({mutationFn:async a=>{const w={...a,phone:s.phone,status:"waiting",first_name:i?.first_name||a.first_name||"Client",last_name:i?.last_name||a.last_name||"Anonyme",is_registered:!!i&&!_,metadata:s.metadata};return(await q.entities.Client.create(w)).ticket_number},onSuccess:a=>{y(a),l(3)},onError:a=>{const w=a.response?.data?.error||a.response?.data?.message||"Une erreur est survenue lors de la création du ticket";ce.error(w)}}),H=async()=>{if(!(j.length<2)){A(!0);try{const a=await q.entities.Client.filter({first_name:j});r(a)}catch(a){console.error(a)}finally{A(!1)}}},G=async a=>{try{await V.mutateAsync(s.phone);const w=await q.entities.Client.addPhone(a.id,s.phone);w.success&&w.phone&&(x({...a,phones:[...a.phones||[],w.phone]}),u(!1),d(!1),l(2))}catch(w){console.error("Failed to link account",w)}},te=()=>{if(e===1)c?B.mutate():i&&l(2);else if(e===2){if(s.operation_type==="change")M.mutate({...s,service:"bureau",amount:s.amount?Number(s.amount):void 0,amount_from:s.amount_from,exchange_rate:s.exchange_rate,currency_from:s.currency_from,currency_to:s.currency_to});else if(s.operation_type&&s.institution_id){const a=N.find(w=>w.id===s.institution_id);M.mutate({...s,operation_type:s.operation_type,service:a?.name||"",currency_from:s.currency,amount:s.amount?Number(s.amount):void 0,notes:`Motif: ${s.reason}${s.beneficiary?` | Bénéficiaire: ${s.beneficiary}`:""}${s.beneficiary_number?` | Numéro Bénéficiaire: ${s.beneficiary_number}`:""}${s.account_number?` | Compte: ${s.account_number}`:""}`})}}},le=()=>{l(1),fe()},fe=()=>{y(null),x(null),d(!1),v(!1),u(!1),g(!1),f(""),r([]),F({phone:"",operation_type:"",institution_id:void 0,first_name:"",last_name:"",email:"",address:"",amount:"",currency:"USD",reason:"",beneficiary:"",beneficiary_number:"",account_number:"",currency_from:"",currency_to:"",amount_from:0,exchange_rate:0,metadata:{}})},ge=()=>{if(e===1)return c?s.first_name.trim()!==""&&s.last_name.trim()!=="":!!i;if(e===2){if(s.operation_type==="change")return!!(s.amount&&s.amount_from&&s.exchange_rate);if(s.operation_type==="paiement")return!0;if(!!!(s.operation_type&&s.institution_id))return!1;if(s.operation_type==="depot"||s.operation_type==="retrait"){const w=N.find(C=>C.id===s.institution_id),E=!!s.amount;if(s.operation_type==="retrait")return E;const U=w?.settings;if(U?.required_fields||U?.custom_fields){const C=U?.required_fields||[],T=[E];return C.includes("account_number")&&T.push(!!s.account_number),C.includes("beneficiary")&&T.push(!!s.beneficiary),C.includes("beneficiary_number")&&T.push(!!s.beneficiary_number),C.includes("reason")&&T.push(!!s.reason),(U?.custom_fields||[]).filter(W=>!W.operation_type||W.operation_type==="both"||W.operation_type===s.operation_type).forEach(W=>{T.push(!!s.metadata[W.id])}),T.every(Boolean)}return w?.type==="bank"?!!(E&&s.account_number&&s.beneficiary):!!(E&&s.beneficiary&&s.beneficiary_number)}return!0}return!0},ye=()=>{switch(e){case 1:return t.jsxs(S.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"space-y-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"mb-8 flex h-20 w-20 items-center justify-center rounded-[24px] border border-white/20 bg-gradient-to-br from-brand-cyan/20 to-brand-purple/20 shadow-xl shadow-brand-purple/20 backdrop-blur-xl transition-transform group-hover:scale-110",children:t.jsx(ne,{className:"h-12 w-12 text-brand-dark transition-transform group-hover:rotate-12"})}),t.jsx("h2",{className:"text-4xl font-black tracking-tight text-slate-800 drop-shadow-sm",children:c?"Nouvelle Inscription":"Bienvenue chez Havifin"}),t.jsx("p",{className:"mt-3 text-lg font-bold tracking-[0.2em] text-brand-blue uppercase",children:D.user?.shop}),t.jsx("p",{className:"mt-2 text-lg font-medium text-slate-600",children:c?"Laissez-nous faire connaissance pour mieux vous servir":"Identifiez-vous pour commencer votre opération"})]}),t.jsxs("div",{className:"mx-auto max-w-lg space-y-6",children:[!i&&!c&&t.jsxs("div",{className:"group relative",children:[t.jsx("div",{className:"absolute -inset-1 rounded-[28px] bg-gradient-to-r from-brand-cyan/40 via-brand-purple/40 to-brand-pink/40 opacity-60 blur-xl transition duration-1000 group-hover:opacity-100 group-hover:duration-200"}),t.jsx(R,{type:"tel",inputMode:"numeric",pattern:"[0-9]*",value:s.phone,onChange:a=>F({...s,phone:a.target.value.replace(/\D/g,"").slice(0,10)}),placeholder:"Entrez votre numéro (10 chiffres)",className:"relative h-20 rounded-[24px] border-2 border-white/30 bg-white/40 text-center font-mono text-2xl font-black text-slate-900 shadow-2xl shadow-purple-500/20 backdrop-blur-2xl transition-all placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30",autoFocus:!0,disabled:n}),n&&t.jsx("div",{className:"absolute top-1/2 right-6 -translate-y-1/2",children:t.jsx(Z,{className:"h-6 w-6 animate-spin text-brand-cyan"})})]}),k&&t.jsx(S.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"pt-6",children:t.jsxs("div",{className:"space-y-6 rounded-[32px] border border-white/20 bg-white/60 p-8 shadow-xl backdrop-blur-xl",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-xl font-black text-slate-800",children:"Lier à un compte existant"}),t.jsx("p",{className:"text-sm text-slate-500",children:"Recherchez le client propriétaire de ce numéro"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(R,{placeholder:"Rechercher par nom...",value:j,onChange:a=>f(a.target.value),className:"h-12 rounded-xl bg-white"}),t.jsx(I,{onClick:H,disabled:b,className:"h-12 rounded-xl bg-cyan-600 text-white hover:bg-cyan-700",children:b?t.jsx(Z,{className:"h-4 w-4 animate-spin"}):t.jsx(Fe,{className:"h-4 w-4"})})]}),t.jsx("div",{className:"max-h-60 space-y-2 overflow-y-auto",children:p.map(a=>t.jsxs("div",{onClick:()=>G(a),className:"flex cursor-pointer items-center justify-between rounded-xl border border-slate-100 bg-white p-4 transition-colors hover:border-cyan-200 hover:bg-cyan-50",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"font-bold text-slate-900",children:[a.first_name," ",a.last_name]}),t.jsx("p",{className:"text-xs text-slate-500",children:a.phone})]}),t.jsx(Y,{className:"h-4 w-4 text-brand-cyan"})]},a.id))}),t.jsx(I,{variant:"ghost",onClick:()=>u(!1),className:"w-full text-slate-500 hover:text-red-500",children:"Annuler"})]})}),c&&!k&&t.jsxs(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4 pt-6",children:[t.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-white/30 bg-white/10 px-6 py-4 shadow-xl backdrop-blur-xl",children:[t.jsx("span",{className:"text-sm font-bold text-slate-600",children:"Numéro à enregistrer"}),t.jsx("span",{className:"font-mono text-xl font-black text-brand-cyan",children:s.phone})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:"Prénom"}),t.jsx(R,{placeholder:"Jean",value:s.first_name,onChange:a=>F({...s,first_name:a.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:"Nom"}),t.jsx(R,{placeholder:"Lozé",value:s.last_name,onChange:a=>F({...s,last_name:a.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:"Email (Optionnel)"}),t.jsx(R,{placeholder:"jean.loze@example.com",type:"email",value:s.email,onChange:a=>F({...s,email:a.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:"Adresse (Optionnelle)"}),t.jsx(R,{placeholder:"Gombe, Kinshasa",value:s.address,onChange:a=>F({...s,address:a.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs(I,{variant:"ghost",onClick:()=>{d(!1),F({...s,phone:""})},className:"h-14 w-full rounded-2xl font-bold text-slate-500 transition-colors hover:bg-slate-100",children:[t.jsx(me,{className:"mr-2 h-5 w-5"})," ","Retour"]}),t.jsx(I,{variant:"outline",onClick:()=>u(!0),className:"h-14 w-full rounded-2xl border-2 border-dashed border-brand-cyan/40 bg-brand-cyan/10 font-bold text-brand-cyan hover:bg-brand-cyan/20",children:"Déjà client ? Lier ce numéro"})]})]})]});case 2:return t.jsxs(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-12",children:[t.jsxs("div",{className:"space-y-2 text-center",children:[t.jsx(S.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-2 inline-block rounded-full bg-brand-blue/10 px-4 py-1 text-xs font-black tracking-widest text-brand-blue uppercase",children:"Étape 2 • Opération"}),t.jsxs("h2",{className:"text-4xl font-black tracking-tight text-slate-900",children:["Bonjour"," ",t.jsx("span",{className:"text-brand-blue",children:i?.first_name||s.first_name}),",",t.jsx("p",{className:"text-lg font-medium text-slate-600",children:"Que souhaitez-vous faire aujourd'hui ?"})]})]}),i&&t.jsxs(S.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"rounded-[24px] border border-slate-200 bg-slate-50/50 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-blue-100 text-blue-600",children:t.jsx(ne,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-500 uppercase",children:"Numéro Actif"}),t.jsx("p",{className:"font-mono text-xl font-bold text-slate-900",children:s.phone})]})]}),t.jsxs(I,{variant:"ghost",onClick:()=>g(!m),className:"font-bold text-slate-600 hover:text-slate-800",children:[t.jsx(me,{className:m?"mr-2 h-4 w-4 -rotate-90 transition-transform":"mr-2 h-4 w-4 transition-transform"}),"Changer"]})]}),t.jsx(O,{children:m&&t.jsx(S.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden bg-white/50 pt-4",children:t.jsx(Qe,{phones:i.phones||[],selectedPhone:s.phone,onSelect:a=>{F({...s,phone:a}),g(!1)},onAdd:async a=>{await V.mutateAsync(a)},isAdding:V.isPending})})})]}),t.jsxs("div",{className:"grid gap-10",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"text-center md:text-left",children:t.jsx("h3",{className:"text-2xl font-black text-slate-800",children:"Opérations disponibles"})}),t.jsx(We,{selectedOperation:s.operation_type,onSelect:a=>F({...s,operation_type:a,institution_id:void 0})})]}),t.jsx(O,{mode:"wait",children:s.operation_type==="change"?t.jsxs(S.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-6",children:[t.jsx("div",{className:"text-center md:text-left",children:t.jsx("h3",{className:"text-2xl font-black text-slate-800",children:"Bureau de Change"})}),t.jsx(Xe,{initialAmount:s.amount_from>0?s.amount_from.toString():"",onSelect:a=>{F(w=>({...w,currency_from:a.currency_from,currency_to:a.currency_to,exchange_rate:a.exchange_rate,amount_from:a.amount_from,amount:a.amount_to.toString()}))}})]},"exchange-calculator"):s.operation_type&&s.operation_type!=="paiement"?t.jsxs(S.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-10",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx($,{className:"ml-4 block text-sm font-black tracking-widest text-slate-400 uppercase",children:"Partenaire Bancaire / Mobile"}),t.jsx(Ze,{institutions:N,selectedId:s.institution_id,onSelect:a=>F(w=>({...w,institution_id:a})),operationType:s.operation_type})]}),t.jsx(O,{mode:"wait",children:s.institution_id&&t.jsx(S.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:(()=>{const a=N.find(C=>C.id===s.institution_id),w=a?.settings,E=w?.required_fields,U=C=>s.operation_type==="retrait"?!1:E?E.includes(C):a?.type==="bank"?["account_number","beneficiary","reason"].includes(C):["beneficiary_number","beneficiary","reason"].includes(C);return t.jsxs("div",{className:"grid gap-6",children:[U("account_number")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:"Numéro de compte"}),t.jsx(R,{value:s.account_number,onChange:C=>F({...s,account_number:C.target.value}),placeholder:"Compte bancaire...",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),U("beneficiary_number")&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:"Numéro du bénéficiaire"}),t.jsx("button",{type:"button",onClick:()=>F({...s,beneficiary_number:s.phone}),className:"text-xs font-bold text-cyan-800 transition-colors hover:text-cyan-900",children:"Utiliser le mien"})]}),t.jsx(R,{value:s.beneficiary_number,onChange:C=>F({...s,beneficiary_number:C.target.value}),placeholder:"08...",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:"Montant"}),t.jsxs("div",{className:"relative",children:[t.jsx(R,{type:"number",value:s.amount,onChange:C=>F({...s,amount:C.target.value}),placeholder:"0.00",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 pr-24 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"}),t.jsx("div",{className:"absolute top-1 right-1 bottom-1 flex rounded-xl bg-slate-100 p-1",children:["USD","CDF"].map(C=>t.jsx("button",{onClick:()=>F({...s,currency:C}),className:`relative z-10 w-12 rounded-lg text-sm font-black transition-all ${s.currency===C?"bg-white text-slate-900 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:C},C))})]})]}),U("beneficiary")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:"Bénéficiaire"}),t.jsx(R,{value:s.beneficiary,onChange:C=>F({...s,beneficiary:C.target.value}),placeholder:"Nom du bénéficiaire",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]})]}),s.operation_type==="retrait"&&t.jsxs("div",{className:"rounded-[2.5rem] border-2 border-indigo-100/50 bg-white/40 p-10 shadow-[0_20px_50px_rgba(79,70,229,0.1)] backdrop-blur-2xl transition-all hover:shadow-[0_20px_50px_rgba(79,70,229,0.15)]",children:[t.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-2xl bg-indigo-600 shadow-xl shadow-indigo-600/20",children:t.jsx(ee,{className:"h-7 w-7 text-white"})}),t.jsxs("div",{className:"text-left",children:[t.jsx("h4",{className:"text-base font-black tracking-tight text-slate-900 uppercase",children:"Infos de l'Agent"}),t.jsx("p",{className:"text-[10px] font-bold tracking-widest text-indigo-500 uppercase",children:"Transaction Sécurisée"})]})]}),t.jsx("div",{className:"rounded-full bg-slate-100 px-4 py-1.5 text-[11px] font-black tracking-widest text-slate-600 uppercase",children:a?.name})]}),t.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[t.jsxs("div",{className:"group flex flex-col gap-2 text-left",children:[t.jsx("span",{className:"ml-2 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Nom de l'Agent"}),t.jsx("div",{className:"flex h-16 items-center rounded-2xl border-2 border-slate-100 bg-white/80 px-6 text-lg font-black tracking-tight text-slate-900 shadow-sm transition-all group-hover:border-indigo-100 group-hover:bg-white",children:w?.withdrawal_agent_name||"NON CONFIGURÉ"})]}),t.jsxs("div",{className:"group flex flex-col gap-2 text-left",children:[t.jsxs("div",{className:"mb-0 flex items-center justify-between px-2",children:[t.jsx("span",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Numéro Agent"}),t.jsxs("div",{className:"flex items-center gap-1.5 rounded-full bg-emerald-500/10 px-2 py-0.5 text-[8px] font-black text-emerald-600 uppercase",children:[t.jsx(Te,{className:"h-2.5 w-2.5"}),"Vérifié"]})]}),t.jsxs("div",{className:"flex h-16 items-center justify-between rounded-2xl border-2 border-slate-100 bg-white/50 px-6 shadow-sm backdrop-blur-sm transition-all group-hover:border-indigo-100 group-hover:bg-white",children:[t.jsx("span",{className:"text-xl font-black tracking-[0.2em] text-indigo-900",children:w?.withdrawal_agent_number||"---"}),t.jsx(I,{variant:"ghost",size:"icon",className:"h-10 w-10 shrink-0 rounded-xl bg-slate-50 text-slate-400 transition-all hover:bg-emerald-50 hover:text-emerald-600",onClick:()=>{w?.withdrawal_agent_number&&(navigator.clipboard.writeText(w.withdrawal_agent_number),ce.success("Copié !"))},children:t.jsx(Be,{className:"h-5 w-5"})})]})]})]}),t.jsxs("div",{className:"mt-8 flex items-start gap-4 rounded-3xl border border-indigo-100/30 bg-indigo-50/50 p-5 text-left",children:[t.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-white shadow-sm",children:t.jsx(Ue,{className:"h-4 w-4 text-indigo-500"})}),t.jsx("p",{className:"text-[11px] leading-relaxed font-semibold text-indigo-900/70",children:"Veuillez effectuer votre retrait vers ce numéro d'agent. Une fois terminé, indiquez le montant ci-dessous pour validation par notre équipe."})]})]}),U("reason")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:"Motif / Raison"}),t.jsx(R,{value:s.reason,onChange:C=>F({...s,reason:C.target.value}),placeholder:"Raison du dépôt...",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),s.operation_type==="retrait"?null:(a?.settings?.custom_fields||[]).filter(T=>!T.operation_type||T.operation_type==="both"||T.operation_type==="depot").map(T=>t.jsxs("div",{className:"space-y-2",children:[t.jsx($,{className:"ml-2 font-bold text-slate-800",children:T.label}),t.jsx(R,{value:s.metadata[T.id]||"",onChange:oe=>F({...s,metadata:{...s.metadata,[T.id]:oe.target.value}}),placeholder:`Entrez ${T.label.toLowerCase()}...`,className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]},T.id))]})})()},`fields-${s.institution_id}-${s.operation_type}`)})]},"standard-operation"):s.operation_type==="paiement"?t.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},className:"py-20 text-center",children:[t.jsx("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-3xl bg-purple-50 text-purple-600",children:t.jsx(he,{className:"h-10 w-10"})}),t.jsx("h3",{className:"text-2xl font-black text-slate-800",children:"Service de Paiement"}),t.jsx("p",{className:"mx-auto mt-2 max-w-sm font-medium text-slate-500",children:"Ce service sera bientôt disponible. Veuillez contacter un agent pour plus d'informations."})]},"paiement-placeholder"):null})]})]});case 3:return t.jsx(st,{ticketNumber:o,onNewTicket:le});default:return null}};return t.jsxs(De,{currentPageName:"Client",children:[t.jsx(ve,{title:"Client"}),t.jsxs("div",{className:"relative flex h-screen w-screen flex-col overflow-hidden",children:[t.jsx(O,{children:!Q&&!K&&t.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/40 p-6 backdrop-blur-3xl",children:t.jsxs(S.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"relative w-full max-w-2xl overflow-hidden rounded-[3rem] bg-white p-12 text-center font-sans shadow-2xl",children:[t.jsx("div",{className:"absolute top-0 right-0 -z-10 h-64 w-64 translate-x-1/2 -translate-y-1/2 rounded-full bg-indigo-50"}),t.jsx("div",{className:"mx-auto mb-8 flex h-24 w-24 items-center justify-center rounded-[2rem] border border-slate-100 bg-slate-50",children:t.jsx($e,{className:"h-12 w-12 text-slate-300"})}),t.jsxs("h1",{className:"mb-4 text-4xl font-black tracking-tighter text-slate-900 uppercase",children:["Agence"," ",t.jsx("span",{className:"text-indigo-600",children:"Fermée"})]}),t.jsx("p",{className:"mb-10 text-lg leading-relaxed font-medium text-slate-500",children:"Veuillez patienter... Le manager n'a pas encore ouvert la session de travail pour cette agence."}),t.jsxs("div",{className:"mx-auto grid max-w-md grid-cols-2 gap-4",children:[t.jsxs("div",{className:"flex flex-col items-center rounded-3xl border border-slate-100 bg-slate-50 p-6",children:[t.jsx(be,{className:"mb-2 h-6 w-6 text-indigo-500"}),t.jsx("span",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Heure Locale"}),t.jsx("span",{className:"text-lg font-black text-slate-800",children:Re().format("HH:mm")})]}),t.jsxs("div",{className:"flex flex-col items-center rounded-3xl border border-slate-100 bg-slate-50 p-6",children:[t.jsx(Pe,{className:"mb-2 h-6 w-6 text-indigo-500"}),t.jsx("span",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Agence"}),t.jsx("span",{className:"text-lg font-black text-slate-800",children:"Kinshasa"})]})]}),t.jsx("div",{className:"mt-12 flex justify-center",children:t.jsxs("div",{className:"flex items-center gap-3 rounded-2xl bg-indigo-50 px-6 py-3",children:[t.jsx("div",{className:"h-2 w-2 animate-pulse rounded-full bg-indigo-600"}),t.jsx("span",{className:"text-xs font-black tracking-widest text-indigo-600 uppercase",children:"Actualisation automatique"})]})})]})})}),t.jsxs("div",{className:"fixed inset-0 z-0",children:[t.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(/images/background1.png)"}}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-900/40 via-slate-900/20 to-slate-900/40"})]}),t.jsxs("div",{className:"relative z-10 flex w-full flex-1 flex-col overflow-hidden px-4 pb-4",children:[t.jsx("div",{className:"flex shrink-0 items-center justify-between py-4",children:t.jsxs("div",{className:"flex items-center gap-4 rounded-full bg-white/10 px-6 py-2 backdrop-blur-md",children:[t.jsx("img",{src:"/logo.png",alt:"Havifin",className:"h-10 w-10 object-contain"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-black tracking-tight text-white uppercase",children:"Havifin"}),t.jsx("p",{className:"text-[10px] font-bold tracking-widest text-white/60 uppercase",children:"Smart Ticket"})]})]})}),t.jsx("div",{className:"scrollbar-hide flex-1 overflow-y-auto",children:t.jsxs("div",{className:"mx-auto max-w-5xl",children:[t.jsxs("div",{className:"rounded-[40px] border border-white/20 bg-white/60 p-8 shadow-2xl shadow-purple-500/20 backdrop-blur-2xl md:p-12",children:[t.jsx(O,{mode:"wait",children:ye()}),e<3&&t.jsxs("div",{className:"mt-12 flex justify-center gap-4",children:[e===2&&t.jsx(I,{variant:"ghost",onClick:le,size:"lg",className:"h-16 rounded-3xl border border-white/30 bg-white/20 px-16 text-xl font-bold text-slate-600 shadow-xl backdrop-blur-xl transition-all hover:bg-white/40 hover:text-red-500",children:"Annuler"}),t.jsx(I,{onClick:te,disabled:!ge()||M.isPending||B.isPending||n,size:"lg",className:"h-16 rounded-3xl border border-white/30 bg-gradient-to-r from-cyan-500 via-blue-600 to-purple-600 px-16 text-xl font-bold text-white shadow-2xl shadow-cyan-500/30 backdrop-blur-xl transition-all hover:scale-[1.02] hover:border-white/50 hover:shadow-cyan-500/50 active:scale-[0.98]",children:M.isPending||B.isPending?t.jsxs(t.Fragment,{children:[t.jsx(Z,{className:"mr-3 h-6 w-6 animate-spin"}),"Traitement..."]}):t.jsxs(t.Fragment,{children:[e===1&&"Continuer",e===2&&"Confirmer",t.jsx(Y,{className:"ml-3 h-6 w-6"})]})})]})]}),e<3&&t.jsx("div",{className:"mt-12 flex justify-center gap-4",children:[1,2].map(a=>t.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${e===a?"w-12 bg-blue-600":"w-2 bg-slate-200"}`},a))})]})})]})]})]})}export{Ft as default};
