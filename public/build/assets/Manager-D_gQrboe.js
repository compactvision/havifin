import{c as Se,u as Ze,r as Q,j as t,R as Ot,b as jt,a as ht,H as Yt}from"./app-XPqbswjP.js";import{b as J}from"./base44Client-D_8p-kpS.js";import{t as Y,B as $}from"./index-OjgNDduT.js";import{L as se,I as he}from"./label-ohV488kT.js";import{S as at,a as lt,b as it,c as rt,d as ke}from"./select--LJarav_.js";import{c as Ve}from"./axios-G5n3UMvP.js";import{c as xe,a as V,m as be}from"./createLucideIcon-CscEagRl.js";import{u as _e,A as Ge,U as nt}from"./users-3glLT9eq.js";import{u as pe}from"./check-40j9Q1Ph.js";import{L as Qe,R as Je,A as Kt}from"./refresh-cw-B5PkTHMb.js";import{B as ut}from"./building-2-ClP7KNof.js";import{C as kt}from"./circle-check-DZMMeG0N.js";import{P as Ke}from"./plus-V0S5OPa3.js";import{T as ot}from"./trash-2-BfmCV63y.js";import{a as gt,X as ct,S as vt,U as Rt,b as _t,A as Bt}from"./app-main-p7Td2XQe.js";import{G as St,C as Vt}from"./globe-hTSt0l9m.js";import{S as Gt,a as ft}from"./smartphone-DFCBQS8K.js";import{L as $t}from"./loader-circle-uqjuVbFJ.js";import{T as Ct,A as Xe,C as Et}from"./trending-down-CW_h-nbn.js";import{T as Be}from"./trending-up-BkFD3XIn.js";import{b as Ut,c as Qt}from"./card-C8bUzc1h.js";import{h as W}from"./moment-B-YVwB4U.js";import{c as Tt,d as Jt,b as It,e as Xt,a as Lt,D as Pt}from"./dialog-Bfaowtgw.js";import{T as Wt}from"./textarea-D7JmwleY.js";import{D as Zt}from"./dollar-sign-I5Xuqhtm.js";import{L as es}from"./lock-open-42mnpy67.js";import{C as We}from"./clock-hY7Azrf4.js";import{E as Nt}from"./eye-CVeGzO8K.js";import{C as ts}from"./circle-alert-DRz5lfV5.js";import{S as ss,a as as}from"./ShopManager-BWIKnlKp.js";import{B as Ye}from"./badge-BZemhbWI.js";import{T as pt,a as Re,b as ls,c as Oe,d as is,e as rs}from"./table-Dc3gysDx.js";/* empty css            */import"./index-D6xtymZ0.js";import"./ManagerModal-CPMpBt2Z.js";const ns=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Ft=xe("Activity",ns);const os=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],cs=xe("ArrowDownLeft",os);const ds=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],xs=xe("ArrowUpRight",ds);const ms=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],wt=xe("Calendar",ms);const hs=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Mt=xe("ChartPie",hs);const us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],yt=xe("CircleStop",us);const ps=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],gs=xe("Download",ps);const fs=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],bs=xe("Filter",fs);const js=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],zt=xe("Hash",js);const vs=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Ns=xe("LayoutGrid",vs);const ws=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],ys=xe("List",ws);const ks=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],_s=xe("Pencil",ks);const Ss=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],dt=xe("Play",Ss);const Cs=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ht=xe("Save",Cs);const Fs=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],bt=xe("Settings",Fs);const Ms=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Ds=xe("Shield",Ms);function qs(){const e=Se.c(50),s=Ze(),[l,r]=Q.useState(!1),[o,i]=Q.useState(null),[d,h]=Q.useState(null),[c,M]=Q.useState("all");let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={name:"",type:"bank",code:"",logo:null},e[0]=f):f=e[0];const[a,u]=Q.useState(f),[j,_]=Q.useState(""),[v,S]=Q.useState("depot");let x;e[1]===Symbol.for("react.memo_cache_sentinel")?(x={queryKey:["institutions"],queryFn:Ys},e[1]=x):x=e[1];const{data:D,isLoading:N}=_e(x),p=D===void 0?[]:D;let w;e[2]!==c?(w=n=>c==="all"?!0:n.type===c,e[2]=c,e[3]=w):w=e[3];const C=p.filter(w),b=pe({mutationFn:Os,onSuccess:()=>{s.invalidateQueries({queryKey:["institutions"]}),R(),Y.success("Institution ajoutée avec succès")},onError:Hs}),A=pe({mutationFn:zs,onSuccess:()=>{s.invalidateQueries({queryKey:["institutions"]}),R(),Y.success("Institution mise à jour avec succès")},onError:Ps});let m;e[4]!==s?(m={mutationFn:Ls,onSuccess:()=>{s.invalidateQueries({queryKey:["institutions"]}),Y.success("Configuration mise à jour")}},e[4]=s,e[5]=m):m=e[5];const y=pe(m),R=()=>{u({name:"",type:"bank",code:"",logo:null}),i(null),r(!1)};let E;e[6]===Symbol.for("react.memo_cache_sentinel")?(E=n=>{u({name:n.name,type:n.type,code:n.code,logo:null}),i(n.id),r(!0)},e[6]=E):E=e[6];const k=E;let q;e[7]!==s?(q={mutationFn:Is,onSuccess:()=>{s.invalidateQueries({queryKey:["institutions"]}),Y.success("Institution supprimée")}},e[7]=s,e[8]=q):q=e[8];const T=pe(q);let L;e[9]!==s?(L={mutationFn:Ts,onSuccess:()=>{s.invalidateQueries({queryKey:["institutions"]}),Y.success("Statut mis à jour")}},e[9]=s,e[10]=L):L=e[10];const U=pe(L);let I;e[11]!==s?(I={mutationFn:Us,onSuccess:()=>{s.invalidateQueries({queryKey:["institutions"]}),_(""),S("depot"),Y.success("Champ ajouté")},onError:Es},e[11]=s,e[12]=I):I=e[12];const B=pe(I);let z;e[13]!==s?(z={mutationFn:$s,onSuccess:()=>{s.invalidateQueries({queryKey:["institutions"]}),Y.success("Champ supprimé")}},e[13]=s,e[14]=z):z=e[14];const O=pe(z);let K;e[15]!==s?(K={mutationFn:Rs,onSuccess:()=>{s.invalidateQueries({queryKey:["institutions"]}),Y.success("Infos agent mises à jour")}},e[15]=s,e[16]=K):K=e[16];const g=pe(K);let P,H;e[17]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-indigo-600 shadow-lg shadow-indigo-600/20",children:t.jsx(ut,{className:"h-5 w-5 text-white"})}),H=t.jsx("h4",{className:"text-sm font-black tracking-tight text-slate-800 uppercase",children:"Partenaires & Institutions"}),e[17]=P,e[18]=H):(P=e[17],H=e[18]);let ne;e[19]!==l?(ne=()=>r(!l),e[19]=l,e[20]=ne):ne=e[20];const ae=l?"bg-slate-200 text-slate-600 hover:bg-slate-300":"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20 hover:bg-indigo-700";let X;e[21]!==ae?(X=V("h-11 rounded-xl px-6 text-xs font-black tracking-widest uppercase transition-all",ae),e[21]=ae,e[22]=X):X=e[22];let me;e[23]!==l?(me=l?t.jsx(ct,{className:"mr-2 h-4 w-4"}):t.jsx(Ke,{className:"mr-2 h-4 w-4"}),e[23]=l,e[24]=me):me=e[24];const le=l?"Fermer":"Nouvelle Institution";let oe;e[25]!==ne||e[26]!==X||e[27]!==me||e[28]!==le?(oe=t.jsxs($,{onClick:ne,className:X,children:[me,le]}),e[25]=ne,e[26]=X,e[27]=me,e[28]=le,e[29]=oe):oe=e[29];let ie;e[30]!==b||e[31]!==o||e[32]!==a||e[33]!==R||e[34]!==l||e[35]!==A?(ie=l&&t.jsx(be.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:t.jsxs("div",{className:"relative rounded-[2rem] bg-slate-900 p-8 text-white shadow-2xl",children:[t.jsx("div",{className:"pointer-events-none absolute top-0 right-0 h-64 w-64 bg-indigo-500/10 blur-[100px]"}),t.jsxs("h5",{className:"mb-8 flex items-center gap-3 text-xl font-black tracking-tight",children:[t.jsx(Qe,{className:"h-6 w-6 text-indigo-400"}),o?"Modifier l'institution":"Configurer un nouveau partenaire"]}),t.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-3",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(se,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Nom de l'institution"}),t.jsx(he,{placeholder:"ex: Bank of Africa",value:a.name,onChange:n=>u({...a,name:n.target.value}),className:"h-12 rounded-xl border-white/10 bg-white/5 font-bold text-white outline-none focus:ring-2 focus:ring-indigo-500"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(se,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Type de service"}),t.jsxs(at,{value:a.type,onValueChange:n=>u({...a,type:n}),children:[t.jsx(lt,{className:"h-12 rounded-xl border-white/10 bg-white/5 font-bold text-white outline-none focus:ring-2 focus:ring-indigo-500",children:t.jsx(it,{})}),t.jsxs(rt,{className:"border-slate-800 bg-slate-900 text-white",children:[t.jsx(ke,{value:"bank",className:"focus:bg-slate-800",children:"Banque Classique"}),t.jsx(ke,{value:"mobile_money",className:"focus:bg-slate-800",children:"Mobile Money"}),t.jsx(ke,{value:"payment",className:"focus:bg-slate-800",children:"Service de Paiement"}),t.jsx(ke,{value:"other",className:"focus:bg-slate-800",children:"Autre Service (MoneyGram, etc.)"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(se,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Code Identifiant"}),t.jsx(he,{placeholder:"ex: BOA-CD",value:a.code,onChange:n=>u({...a,code:n.target.value}),className:"h-12 rounded-xl border-white/10 bg-white/5 font-mono font-black text-white outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),t.jsxs("div",{className:"mt-6 space-y-2",children:[t.jsx(se,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Logo de l'institution (Optionnel)"}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"relative flex h-16 w-16 items-center justify-center overflow-hidden rounded-xl border border-white/10 bg-white/5",children:a.logo?t.jsx("img",{src:URL.createObjectURL(a.logo),alt:"Preview",className:"h-full w-full object-cover"}):t.jsx(ut,{className:"h-6 w-6 text-white/20"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx(he,{type:"file",accept:"image/*",onChange:n=>{n.target.files&&n.target.files[0]&&u({...a,logo:n.target.files[0]})},className:"h-12 w-full cursor-pointer rounded-xl border-white/10 bg-white/5 pt-2 text-sm font-bold text-white file:mr-4 file:rounded-lg file:border-0 file:bg-indigo-600 file:px-4 file:py-1 file:text-xs file:font-bold file:text-white hover:file:bg-indigo-700"}),t.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"Format recommandé: PNG ou JPG, fond transparent. Max 2MB."})]})]})]}),t.jsxs("div",{className:"mt-10 flex justify-end gap-3",children:[t.jsx($,{variant:"ghost",onClick:R,className:"h-12 rounded-xl px-8 text-xs font-black tracking-widest text-slate-400 uppercase hover:bg-white/5 hover:text-white",children:"Annuler"}),t.jsx($,{onClick:()=>{o?A.mutate({id:o,data:a}):b.mutate(a)},disabled:b.isPending||A.isPending||!a.name||!a.code,className:"h-12 rounded-xl bg-white px-10 text-xs font-black tracking-widest text-slate-900 uppercase transition-all hover:bg-slate-100",children:b.isPending?t.jsx(Je,{className:"h-4 w-4 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx(Ht,{className:"mr-2 h-4 w-4"}),o?"Mettre à jour":"Enregistrer Partenaire"]})})]})]})}),e[30]=b,e[31]=o,e[32]=a,e[33]=R,e[34]=l,e[35]=A,e[36]=ie):ie=e[36];let ce;e[37]!==ie?(ce=t.jsx(Ge,{children:ie}),e[37]=ie,e[38]=ce):ce=e[38];let de;e[39]===Symbol.for("react.memo_cache_sentinel")?(de=[{id:"all",label:"Tout"},{id:"bank",label:"Banques"},{id:"mobile_money",label:"Mobile Money"},{id:"payment",label:"Paiement"},{id:"other",label:"Autres"}],e[39]=de):de=e[39];let ge;e[40]!==c?(ge=t.jsx("div",{className:"flex gap-2",children:de.map(n=>t.jsx("button",{onClick:()=>M(n.id),className:V("rounded-xl px-4 py-2 text-xs font-black tracking-widest uppercase transition-all",c===n.id?"bg-slate-900 text-white shadow-lg shadow-slate-900/10":"bg-white text-slate-400 hover:bg-slate-50 hover:text-slate-600"),children:n.label},n.id))}),e[40]=c,e[41]=ge):ge=e[41];let Z;e[42]!==T||e[43]!==U?(Z=n=>t.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"group relative overflow-hidden rounded-[2rem] border-2 border-slate-50 bg-white p-6 shadow-xl shadow-slate-200/50 transition-all duration-300 hover:border-indigo-100",children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsx("div",{className:V("flex h-14 w-14 items-center justify-center rounded-2xl shadow-lg transition-transform group-hover:rotate-6",n.type==="bank"?"bg-slate-900 text-white shadow-slate-900/10":n.type==="payment"?"bg-indigo-500 text-white shadow-indigo-500/10":n.type==="other"?"bg-amber-500 text-white shadow-amber-500/10":"bg-emerald-500 text-white shadow-emerald-500/10"),children:n.logo_url?t.jsx("img",{src:n.logo_url,alt:n.name,className:"h-9 w-9 object-contain"}):n.type==="bank"?t.jsx(ut,{className:"h-7 w-7"}):n.type==="payment"?t.jsx(St,{className:"h-7 w-7"}):n.type==="other"?t.jsx(St,{className:"h-7 w-7"}):t.jsx(Gt,{className:"h-7 w-7"})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx($,{variant:"ghost",size:"icon",onClick:()=>U.mutate({id:n.id,is_active:!n.is_active}),className:V("h-10 w-10 rounded-xl transition-all",n.is_active?"bg-emerald-50 text-emerald-500":"bg-slate-50 text-slate-300"),children:t.jsx(gt,{className:"h-5 w-5"})}),t.jsx($,{variant:"ghost",size:"icon",onClick:()=>T.mutate(n.id),className:"h-10 w-10 rounded-xl text-slate-300 opacity-0 transition-all group-hover:opacity-100 hover:bg-rose-50 hover:text-rose-500",children:t.jsx(ot,{className:"h-5 w-5"})}),t.jsx($,{variant:"ghost",size:"icon",onClick:()=>h(n.id),className:"h-10 w-10 rounded-xl bg-slate-50 text-slate-400 transition-all hover:bg-emerald-50 hover:text-emerald-600",children:t.jsx(bt,{className:"h-5 w-5"})}),t.jsx($,{variant:"ghost",size:"icon",onClick:()=>k(n),className:"h-10 w-10 rounded-xl bg-slate-50 text-slate-400 transition-all hover:bg-indigo-50 hover:text-indigo-600",children:t.jsx(_s,{className:"h-5 w-5"})})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h3",{className:"text-lg font-black tracking-tight text-slate-900",children:n.name}),!n.is_active&&t.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[8px] font-black tracking-widest text-slate-400 uppercase",children:"Inactif"}),n.settings?.required_fields&&n.settings.required_fields.length>0&&t.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-emerald-500/10 px-2 py-0.5 text-[8px] font-black tracking-widest text-emerald-600 uppercase",children:[t.jsx(kt,{className:"h-2 w-2"}),"Configuré"]})]}),t.jsxs("div",{className:"mt-1 flex items-center gap-3",children:[t.jsx("span",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:n.code}),t.jsx("span",{className:"h-1 w-1 rounded-full bg-slate-200"}),t.jsx("span",{className:"text-[10px] font-bold text-indigo-500 uppercase",children:n.type==="bank"?"Banque":n.type==="payment"?"Service de Paiement":n.type==="other"?"Autre Service":"Mobile Money"})]})]}),t.jsx("div",{className:V("absolute -right-6 -bottom-6 h-24 w-24 rounded-full opacity-[0.03] transition-transform group-hover:scale-150",n.type==="bank"?"bg-slate-900":"bg-emerald-500")})]},n.id),e[42]=T,e[43]=U,e[44]=Z):Z=e[44];let ue;e[45]!==N?(ue=N&&t.jsx("div",{className:"flex justify-center p-20",children:t.jsx($t,{className:"h-10 w-10 animate-spin text-indigo-600"})}),e[45]=N,e[46]=ue):ue=e[46];const je=Ge,re=d&&t.jsx(be.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 p-4 backdrop-blur-sm",onClick:()=>h(null),children:t.jsxs(be.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"w-full max-w-md overflow-hidden rounded-[2.5rem] bg-white shadow-2xl",onClick:As,children:[t.jsxs("div",{className:"relative bg-slate-900 p-8 text-white",children:[t.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 bg-indigo-500/10 blur-3xl"}),t.jsxs("h3",{className:"flex items-center gap-3 text-xl font-black tracking-tight",children:[t.jsx(bt,{className:"h-6 w-6 text-indigo-400"}),"Champs Requis"]}),t.jsxs("p",{className:"mt-2 text-xs font-medium text-slate-400",children:["Configurez les informations obligatoires pour"," ",t.jsx("span",{className:"text-white",children:p.find(n=>n.id===d)?.name})]})]}),t.jsxs("div",{className:"p-8",children:[t.jsx("div",{className:"space-y-3",children:[{id:"account_number",label:"Numéro de Compte"},{id:"beneficiary",label:"Nom du Bénéficiaire"},{id:"beneficiary_number",label:"Numéro du Bénéficiaire"},{id:"reason",label:"Motif / Raison"}].map(n=>{const G=p.find(Ce=>Ce.id===d),te=(G?.settings?.required_fields||[]).includes(n.id);return t.jsxs("button",{onClick:()=>y.mutate({institution:G,field:n.id}),className:V("flex w-full items-center justify-between rounded-2xl border-2 p-5 transition-all",te?"border-indigo-100 bg-indigo-50/50 text-indigo-900 shadow-sm":"border-slate-100 bg-slate-50/50 text-slate-500 hover:border-slate-200"),children:[t.jsx("span",{className:"text-sm font-black tracking-tight",children:n.label}),te?t.jsx(kt,{className:"h-6 w-6 text-indigo-600"}):t.jsx("div",{className:"h-6 w-6 rounded-full border-2 border-slate-200 bg-white"})]},n.id)})}),t.jsxs("div",{className:"mt-8 space-y-4",children:[t.jsxs("h4",{className:"flex items-center gap-2 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[t.jsx(Ke,{className:"h-3 w-3"}),"Ajouter un champ personnalisé"]}),t.jsx("div",{className:"flex flex-col gap-2",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(he,{placeholder:"ex: Code Agence...",value:j,onChange:n=>_(n.target.value),className:"h-12 rounded-xl border-slate-200"}),t.jsxs(at,{value:v,onValueChange:n=>S(n),children:[t.jsx(lt,{className:"h-12 w-32 rounded-xl border-slate-200",children:t.jsx(it,{})}),t.jsxs(rt,{className:"bg-white",children:[t.jsx(ke,{value:"depot",children:"Dépôt"}),t.jsx(ke,{value:"retrait",children:"Retrait"}),t.jsx(ke,{value:"both",children:"Les deux"})]})]}),t.jsx($,{onClick:()=>{if(j.trim()){const n=p.find(G=>G.id===d);B.mutate({institution:n,label:j,operation_type:v})}},disabled:!j.trim()||B.isPending,className:"h-12 rounded-xl bg-indigo-600 px-4 text-white hover:bg-indigo-700",children:B.isPending?t.jsx(Je,{className:"h-4 w-4 animate-spin"}):t.jsx(Ke,{className:"h-4 w-4"})})]})}),t.jsx("div",{className:"space-y-2",children:(p.find(n=>n.id===d)?.settings?.custom_fields||[]).map(n=>t.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-100 bg-slate-50 p-3",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-bold text-slate-700",children:n.label}),t.jsx("span",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:n.operation_type==="depot"?"Dépôt":n.operation_type==="retrait"?"Retrait":"Les deux"})]}),t.jsx($,{variant:"ghost",size:"icon",onClick:()=>{const G=p.find(te=>te.id===d);O.mutate({institution:G,fieldId:n.id})},className:"h-8 w-8 text-slate-400 hover:text-red-500",children:t.jsx(ot,{className:"h-4 w-4"})})]},n.id))})]}),t.jsxs("div",{className:"mt-8 space-y-4 border-t border-slate-100 pt-6",children:[t.jsxs("h4",{className:"flex items-center gap-2 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[t.jsx(gt,{className:"h-3 w-3"}),"Infos Agent (Retrait)"]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(se,{className:"ml-1 text-[10px] font-bold text-slate-500",children:"Nom de l'Agent"}),t.jsx(he,{placeholder:"ex: HAVIFIN BOUTIQUE",defaultValue:p.find(n=>n.id===d)?.settings?.withdrawal_agent_name||"",onBlur:n=>{const G=p.find(te=>te.id===d);G&&n.target.value!==(G.settings?.withdrawal_agent_name||"")&&g.mutate({institution:G,name:n.target.value,number:G.settings?.withdrawal_agent_number||""})},className:"h-10 rounded-xl border-slate-200 text-sm"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(se,{className:"ml-1 text-[10px] font-bold text-slate-500",children:"Numéro de l'Agent"}),t.jsx(he,{placeholder:"ex: 123456",defaultValue:p.find(n=>n.id===d)?.settings?.withdrawal_agent_number||"",onBlur:n=>{const G=p.find(te=>te.id===d);G&&n.target.value!==(G.settings?.withdrawal_agent_number||"")&&g.mutate({institution:G,name:G.settings?.withdrawal_agent_name||"",number:n.target.value})},className:"h-10 rounded-xl border-slate-200 text-sm"})]})]})]}),t.jsx($,{onClick:()=>h(null),className:"mt-8 h-14 w-full rounded-2xl bg-slate-900 text-sm font-black tracking-widest text-white uppercase transition-all hover:bg-slate-800",children:"Terminer"})]})]})});let ee;return e[47]!==je||e[48]!==re?(ee=t.jsx(je,{children:re}),e[47]=je,e[48]=re,e[49]=ee):ee=e[49],t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"flex items-center justify-between rounded-[1.5rem] border border-slate-100 bg-slate-100/50 p-4",children:[t.jsxs("div",{className:"ml-2 flex items-center gap-3",children:[P,t.jsxs("div",{children:[H,t.jsxs("p",{className:"text-[10px] font-bold tracking-widest text-slate-400 uppercase",children:[p.length," Entités Enregistrées"]})]})]}),oe]}),ce,ge,t.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:[C.map(Z),p.length===0&&!N&&t.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center rounded-[3rem] border-2 border-dashed border-slate-200 bg-slate-50/50 py-20",children:[t.jsx(Qe,{className:"mb-4 h-16 w-16 text-slate-200"}),t.jsx("p",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Aucune institution configurée"})]})]}),ue,ee]})}function As(e){return e.stopPropagation()}function Rs(e){const{institution:s,name:l,number:r}=e,o=s.settings||{required_fields:[]};return Ve.post(`/api/institutions/${s.id}`,{_method:"PUT",settings:{...o,withdrawal_agent_name:l,withdrawal_agent_number:r}})}function $s(e){const{institution:s,fieldId:l}=e,r=s.settings||{required_fields:[]},i=(r.custom_fields||[]).filter(d=>d.id!==l);return Ve.post(`/api/institutions/${s.id}`,{_method:"PUT",settings:{...r,custom_fields:i}})}function Es(e){return Y.error(typeof e=="string"?e:"Erreur lors de l’ajout")}function Us(e){const{institution:s,label:l,operation_type:r}=e,o=s.settings||{required_fields:[]},i=o.custom_fields||[],d=l.toLowerCase().replace(/\s+/g,"_").replace(/[^\w]/g,"");if(i.find(c=>c.id===d))return Promise.reject("Ce champ existe déjà");const h=[...i,{id:d,label:l,type:"text",operation_type:r}];return Ve.post(`/api/institutions/${s.id}`,{_method:"PUT",settings:{...o,custom_fields:h}})}function Ts(e){const{id:s,is_active:l}=e;return J.entities.Institution.update(s,{is_active:l})}function Is(e){return J.entities.Institution.delete(e)}function Ls(e){const{institution:s,field:l}=e,r=s.settings||{required_fields:[]},o=r.required_fields||[],i=o.includes(l)?o.filter(d=>d!==l):[...o,l];return Ve.post(`/api/institutions/${s.id}`,{_method:"PUT",settings:{...r,required_fields:i}})}function Ps(){return Y.error("Erreur lors de la mise à jour")}function zs(e){const{id:s,data:l}=e,r=new FormData;return r.append("_method","PUT"),r.append("name",l.name),r.append("type",l.type),r.append("code",l.code),l.logo&&r.append("logo",l.logo),Ve.post(`/api/institutions/${s}`,r,{headers:{"Content-Type":"multipart/form-data"}})}function Hs(){return Y.error("Erreur lors de l'ajout de l'institution")}function Os(e){const s=new FormData;return s.append("name",e.name),s.append("type",e.type),s.append("code",e.code),e.logo&&s.append("logo",e.logo),Ve.post("/api/institutions",s,{headers:{"Content-Type":"multipart/form-data"}})}function Ys(){return J.entities.Institution.list()}const Dt=[{id:"USD_CDF",label:"USD → CDF",from:"USD",to:"CDF"},{id:"EUR_CDF",label:"EUR → CDF",from:"EUR",to:"CDF"},{id:"EUR_USD",label:"EUR → USD",from:"EUR",to:"USD"},{id:"CDF_USD",label:"CDF → USD",from:"CDF",to:"USD"}];function Ks(){const e=Se.c(56),s=Ze();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l={currency_pair:"",buy_rate:"",sell_rate:""},e[0]=l):l=e[0];const[r,o]=Q.useState(l),[i,d]=Q.useState(!1);let h;e[1]===Symbol.for("react.memo_cache_sentinel")?(h={queryKey:["rates"],queryFn:Xs},e[1]=h):h=e[1];const{data:c,isLoading:M}=_e(h);let f;e[2]!==c?(f=c===void 0?[]:c,e[2]=c,e[3]=f):f=e[3];const a=f;let u;e[4]!==s?(u={mutationFn:Js,onSuccess:()=>{s.invalidateQueries({queryKey:["rates"]}),Y.success("Taux mis à jour")}},e[4]=s,e[5]=u):u=e[5];const j=pe(u);let _;e[6]!==s?(_={mutationFn:Qs,onSuccess:()=>{s.invalidateQueries({queryKey:["rates"]}),o({currency_pair:"",buy_rate:"",sell_rate:""}),d(!1),Y.success("Nouveau taux de change configuré")},onError:Gs},e[6]=s,e[7]=_):_=e[7];const v=pe(_);let S;e[8]!==s?(S={mutationFn:Vs,onSuccess:()=>{s.invalidateQueries({queryKey:["rates"]}),Y.success("Configuration supprimée")}},e[8]=s,e[9]=S):S=e[9];const x=pe(S);let D;e[10]!==j?(D=(O,K,g)=>{g&&j.mutate({id:O.id,data:{[K]:parseFloat(g)}})},e[10]=j,e[11]=D):D=e[11];const N=D;let p,w;e[12]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-indigo-600 shadow-lg shadow-indigo-600/20",children:t.jsx(Xe,{className:"h-5 w-5 text-white"})}),w=t.jsx("h4",{className:"text-sm font-black tracking-tight text-slate-800 uppercase",children:"Marché des Devises"}),e[12]=p,e[13]=w):(p=e[12],w=e[13]);let C;e[14]!==a.length?(C=t.jsxs("div",{className:"ml-2 flex items-center gap-3",children:[p,t.jsxs("div",{children:[w,t.jsxs("p",{className:"text-[10px] font-bold tracking-widest text-slate-400 uppercase",children:[a.length," Paires Actives"]})]})]}),e[14]=a.length,e[15]=C):C=e[15];let b;e[16]!==i?(b=()=>d(!i),e[16]=i,e[17]=b):b=e[17];const A=i?"bg-slate-200 text-slate-600 hover:bg-slate-300":"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20 hover:bg-indigo-700";let m;e[18]!==A?(m=V("h-11 rounded-xl px-6 text-xs font-black tracking-widest uppercase transition-all",A),e[18]=A,e[19]=m):m=e[19];let y;e[20]!==i?(y=i?t.jsx(ct,{className:"mr-2 h-4 w-4"}):t.jsx(Ke,{className:"mr-2 h-4 w-4"}),e[20]=i,e[21]=y):y=e[21];const R=i?"Fermer":"Ajouter une Paire";let E;e[22]!==b||e[23]!==m||e[24]!==y||e[25]!==R?(E=t.jsxs($,{onClick:b,className:m,children:[y,R]}),e[22]=b,e[23]=m,e[24]=y,e[25]=R,e[26]=E):E=e[26];let k;e[27]!==C||e[28]!==E?(k=t.jsxs("div",{className:"flex items-center justify-between rounded-[1.5rem] border border-slate-100 bg-slate-100/50 p-4",children:[C,E]}),e[27]=C,e[28]=E,e[29]=k):k=e[29];let q;e[30]!==v||e[31]!==r||e[32]!==i?(q=i&&t.jsx(be.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:t.jsxs("div",{className:"relative rounded-[2rem] bg-slate-900 p-8 text-white shadow-2xl",children:[t.jsx("div",{className:"pointer-events-none absolute top-0 right-0 h-64 w-64 bg-indigo-500/10 blur-[100px]"}),t.jsxs("h5",{className:"mb-8 flex items-center gap-3 text-xl font-black tracking-tight",children:[t.jsx(Ke,{className:"h-6 w-6 text-indigo-400"}),"Nouvelle Configuration"]}),t.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-3",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(se,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Paire de devises"}),t.jsxs(at,{value:r.currency_pair,onValueChange:O=>o({...r,currency_pair:O}),children:[t.jsx(lt,{className:"h-12 rounded-xl border-white/10 bg-white/5 font-bold text-white outline-none focus:ring-2 focus:ring-indigo-500",children:t.jsx(it,{placeholder:"Choisir une paire"})}),t.jsx(rt,{className:"border-slate-800 bg-slate-900 text-white",children:Dt.map(Bs)})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(se,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Taux d'Achat (Buy)"}),t.jsxs("div",{className:"relative",children:[t.jsx(Ct,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-emerald-400"}),t.jsx(he,{type:"number",placeholder:"0.00",value:r.buy_rate,onChange:O=>o({...r,buy_rate:O.target.value}),className:"h-12 rounded-xl border-white/10 bg-white/5 pl-11 font-mono font-black text-white"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(se,{className:"ml-1 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Taux de Vente (Sell)"}),t.jsxs("div",{className:"relative",children:[t.jsx(Be,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-blue-400"}),t.jsx(he,{type:"number",placeholder:"0.00",value:r.sell_rate,onChange:O=>o({...r,sell_rate:O.target.value}),className:"h-12 rounded-xl border-white/10 bg-white/5 pl-11 font-mono font-black text-white"})]})]})]}),t.jsxs("div",{className:"mt-10 flex justify-end gap-3",children:[t.jsx($,{variant:"ghost",onClick:()=>d(!1),className:"h-12 rounded-xl px-8 text-xs font-black tracking-widest text-slate-400 uppercase hover:bg-white/5 hover:text-white",children:"Annuler"}),t.jsx($,{onClick:()=>v.mutate(r),disabled:v.isPending||!r.currency_pair,className:"h-12 rounded-xl bg-white px-10 text-xs font-black tracking-widest text-slate-900 uppercase transition-all hover:bg-slate-100",children:v.isPending?t.jsx(Je,{className:"h-4 w-4 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Activer le Taux"]})})]})]})}),e[30]=v,e[31]=r,e[32]=i,e[33]=q):q=e[33];let T;e[34]!==q?(T=t.jsx(Ge,{children:q}),e[34]=q,e[35]=T):T=e[35];let L;if(e[36]!==x||e[37]!==N||e[38]!==a){let O;e[40]!==x||e[41]!==N?(O=K=>{const g=Dt.find(P=>P.id===K.currency_pair);return t.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"group rounded-[2rem] border-2 border-slate-50 bg-white p-8 shadow-xl shadow-slate-200/50 transition-all duration-300 hover:border-indigo-100",children:[t.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-slate-900 shadow-lg shadow-slate-900/10 transition-transform group-hover:rotate-6",children:t.jsx("span",{className:"text-sm font-black text-white",children:g?.from||K.currency_pair.split("_")[0]})}),t.jsx(Be,{className:"h-4 w-4 text-slate-300"}),t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl border border-indigo-100 bg-indigo-50",children:t.jsx("span",{className:"text-sm font-black text-indigo-600",children:g?.to||K.currency_pair.split("_")[1]})})]}),t.jsx($,{variant:"ghost",size:"icon",onClick:()=>x.mutate(K.id),className:"h-10 w-10 rounded-xl text-slate-300 opacity-0 transition-all group-hover:opacity-100 hover:bg-rose-50 hover:text-rose-500",children:t.jsx(ot,{className:"h-5 w-5"})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between px-1",children:[t.jsx("span",{className:"text-[9px] font-black tracking-widest text-slate-400 uppercase",children:"Achat (Buy)"}),t.jsx(Ct,{className:"h-3 w-3 text-emerald-500"})]}),t.jsx("div",{className:"relative",children:t.jsx(he,{type:"number",value:K.buy_rate,onChange:P=>N(K,"buy_rate",P.target.value),className:"h-14 rounded-2xl border-transparent bg-slate-50 font-mono text-xl font-black text-slate-900 focus:border-indigo-500 focus:bg-white"})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between px-1",children:[t.jsx("span",{className:"text-[9px] font-black tracking-widest text-slate-400 uppercase",children:"Vente (Sell)"}),t.jsx(Be,{className:"h-3 w-3 text-blue-500"})]}),t.jsx("div",{className:"relative",children:t.jsx(he,{type:"number",value:K.sell_rate,onChange:P=>N(K,"sell_rate",P.target.value),className:"h-14 rounded-2xl border-transparent bg-slate-50 font-mono text-xl font-black text-slate-900 focus:border-indigo-500 focus:bg-white"})})]})]})]},K.id)},e[40]=x,e[41]=N,e[42]=O):O=e[42],L=a.map(O),e[36]=x,e[37]=N,e[38]=a,e[39]=L}else L=e[39];let U;e[43]!==M||e[44]!==a.length?(U=a.length===0&&!M&&t.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center rounded-[3rem] border-2 border-dashed border-slate-200 bg-slate-50/50 py-20",children:[t.jsx(Xe,{className:"mb-4 h-16 w-16 text-slate-200"}),t.jsx("p",{className:"text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:"Aucun taux configuré"})]}),e[43]=M,e[44]=a.length,e[45]=U):U=e[45];let I;e[46]!==L||e[47]!==U?(I=t.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-2",children:[L,U]}),e[46]=L,e[47]=U,e[48]=I):I=e[48];let B;e[49]!==M?(B=M&&t.jsx("div",{className:"flex justify-center p-20",children:t.jsx($t,{className:"h-10 w-10 animate-spin text-indigo-600"})}),e[49]=M,e[50]=B):B=e[50];let z;return e[51]!==k||e[52]!==T||e[53]!==I||e[54]!==B?(z=t.jsxs("div",{className:"space-y-8",children:[k,T,I,B]}),e[51]=k,e[52]=T,e[53]=I,e[54]=B,e[55]=z):z=e[55],z}function Bs(e){return t.jsx(ke,{value:e.id,className:"hover:bg-slate-800 focus:bg-slate-800",children:e.label},e.id)}async function Vs(e){await J.entities.ExchangeRate.delete(e)}function Gs(){return Y.error("Erreur lors de la création du taux")}async function Qs(e){await J.entities.ExchangeRate.create({...e,buy_rate:parseFloat(e.buy_rate),sell_rate:parseFloat(e.sell_rate),is_active:!0})}async function Js(e){const{id:s,data:l}=e;await J.entities.ExchangeRate.update(s,l)}function Xs(){return J.entities.ExchangeRate.filter({is_active:!0})}const Ws=["USD","CDF","EUR"];function Zs(e){const s=Se.c(43),{isOpen:l,onClose:r,onConfirm:o,shopName:i,isLoading:d}=e;let h;s[0]===Symbol.for("react.memo_cache_sentinel")?(h={USD:"0",CDF:"0",EUR:"0"},s[0]=h):h=s[0];const[c,M]=Q.useState(h),[f,a]=Q.useState("");let u;s[1]!==c||s[2]!==f||s[3]!==o?(u=U=>{U.preventDefault(),o({notes:f,globalAmounts:c})},s[1]=c,s[2]=f,s[3]=o,s[4]=u):u=s[4];const j=u;let _;s[5]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx(vt,{className:"h-6 w-6 text-indigo-600"}),s[5]=_):_=s[5];let v;s[6]!==i?(v=t.jsxs(Tt,{className:"flex items-center gap-2 text-2xl font-black",children:[_,"Ouvrir la Boutique : ",i]}),s[6]=i,s[7]=v):v=s[7];let S;s[8]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx(Jt,{children:"Initialisez la session de travail et le fond de caisse global."}),s[8]=S):S=s[8];let x;s[9]!==v?(x=t.jsxs(It,{children:[v,S]}),s[9]=v,s[10]=x):x=s[10];let D;s[11]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx(se,{htmlFor:"notes",className:"font-bold text-slate-700",children:"Note d'ouverture"}),s[11]=D):D=s[11];let N;s[12]===Symbol.for("react.memo_cache_sentinel")?(N=U=>a(U.target.value),s[12]=N):N=s[12];let p;s[13]!==f?(p=t.jsxs("div",{className:"space-y-2",children:[D,t.jsx(Wt,{id:"notes",value:f,onChange:N,placeholder:"Ex: Équipe du jour...",className:"rounded-xl bg-slate-50"})]}),s[13]=f,s[14]=p):p=s[14];let w;s[15]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsxs("h4",{className:"flex items-center gap-2 text-lg font-black text-slate-900",children:[t.jsx(Zt,{className:"h-5 w-5 text-emerald-600"}),"Fond de Caisse (Global)"]}),s[15]=w):w=s[15];let C;s[16]!==c?(C=Ws.map(U=>t.jsxs("div",{className:"space-y-1",children:[t.jsx(se,{className:"text-xs font-bold text-slate-400",children:U}),t.jsx(he,{type:"number",min:"0",value:c[U],onChange:I=>M(B=>({...B,[U]:I.target.value})),className:"h-9 text-sm font-bold"})]},U)),s[16]=c,s[17]=C):C=s[17];let b;s[18]!==C?(b=t.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:t.jsx("div",{className:"grid grid-cols-3 gap-3",children:C})}),s[18]=C,s[19]=b):b=s[19];let A;s[20]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx("p",{className:"text-xs text-slate-500",children:"Ce montant sera disponible pour tous les guichets de la boutique."}),s[20]=A):A=s[20];let m;s[21]!==b?(m=t.jsxs("div",{className:"space-y-4",children:[w,b,A]}),s[21]=b,s[22]=m):m=s[22];let y;s[23]!==r?(y=t.jsx($,{type:"button",variant:"outline",onClick:r,children:"Annuler"}),s[23]=r,s[24]=y):y=s[24];const R=d?"Ouverture...":"Ouvrir la Session";let E;s[25]!==d||s[26]!==R?(E=t.jsx($,{type:"submit",disabled:d,className:"bg-indigo-600 font-bold hover:bg-indigo-700",children:R}),s[25]=d,s[26]=R,s[27]=E):E=s[27];let k;s[28]!==y||s[29]!==E?(k=t.jsxs(Xt,{children:[y,E]}),s[28]=y,s[29]=E,s[30]=k):k=s[30];let q;s[31]!==j||s[32]!==m||s[33]!==k||s[34]!==p?(q=t.jsxs("form",{onSubmit:j,className:"space-y-6 py-4",children:[p,m,k]}),s[31]=j,s[32]=m,s[33]=k,s[34]=p,s[35]=q):q=s[35];let T;s[36]!==q||s[37]!==x?(T=t.jsxs(Lt,{className:"sm:max-w-[500px]",children:[x,q]}),s[36]=q,s[37]=x,s[38]=T):T=s[38];let L;return s[39]!==l||s[40]!==r||s[41]!==T?(L=t.jsx(Pt,{open:l,onOpenChange:r,children:T}),s[39]=l,s[40]=r,s[41]=T,s[42]=L):L=s[42],L}function ea(){const e=Ze(),[s,l]=Q.useState("grid"),[r,o]=Q.useState(null),[i,d]=Q.useState(!1),[h,c]=Q.useState(!1),[M,f]=Q.useState(!1),[a,u]=Q.useState(1),[j,_]=Q.useState("all"),[v,S]=Q.useState(""),[x,D]=Q.useState(null),[N,p]=Q.useState(""),{data:w=[]}=_e({queryKey:["manager-shops"],queryFn:()=>J.entities.Shop.list()});Ot.useEffect(()=>{w.length>0&&!x&&D(w[0].id)},[w,x]);const{data:C,isLoading:b}=_e({queryKey:["sessions",x,a,j,v],queryFn:()=>J.entities.Session.list({shop_id:x?.toString(),status:j==="all"?void 0:j,date:v||void 0,page:a.toString()}),enabled:!!x}),{data:A}=_e({queryKey:["counters",x],queryFn:()=>J.entities.Counter.list(x),enabled:!!x}),m=C?.data||[],y=C,{data:R,isLoading:E}=_e({queryKey:["session-report",r],queryFn:()=>J.entities.Session.report(r),enabled:!!r}),k=m.find(g=>g.status==="open"),[q,T]=Q.useState(!1),{data:L}=_e({queryKey:["registers",x],queryFn:()=>ht.get(`/api/cash/registers?shop_id=${x}`).then(g=>g.data),enabled:!!x&&q}),U=async g=>{if(x){d(!0);try{await J.entities.Session.create({session_date:W().format("YYYY-MM-DD"),shop_id:x,notes:g.notes});let P=L?.[0]?.id;if(!P)try{Y.info("Configuration automatique de la caisse principale..."),P=(await ht.post("/api/cash/registers",{shop_id:x,name:"Caisse Principale"})).data.id,Y.success("Caisse principale créée avec succès"),e.invalidateQueries({queryKey:["registers",x]})}catch(H){console.error("Failed to auto-create register",H),Y.error("Impossible de créer la caisse automatique.")}if(P)try{await ht.post("/api/cash/sessions",{cash_register_id:P,opening_amounts:g.globalAmounts,notes:"Session Caisse Globale"}),Y.success("Session ouverte avec succès (Globale)")}catch(H){console.error("Failed to open global cash session",H),Y.error("Erreur ouverture caisse globale")}else Y.warning("Attention: Aucune caisse n’a pu être configurée. Seule la session administrative est ouverte.");e.invalidateQueries({queryKey:["sessions"]}),T(!1),p("")}catch(P){const H=P.response?.data?.error||P.response?.data?.message||"Erreur lors de l’ouverture";Y.error(H)}finally{d(!1)}}},I=async g=>{c(!0);try{await J.entities.Session.close(g),Y.success("Session fermée avec succès"),e.invalidateQueries({queryKey:["sessions"]})}catch(P){const H=P.response?.data?.error||P.response?.data?.message||"Erreur lors de la fermeture";Y.error(H)}finally{c(!1)}},B=async g=>{try{await J.entities.Session.reopen(g),Y.success("Session réouverte avec succès"),e.invalidateQueries({queryKey:["sessions"]})}catch(P){const H=P.response?.data?.error||P.response?.data?.message||"Erreur lors de la réouverture de la session";Y.error(H)}},z=w.find(g=>g.id===x),{auth:O}=jt().props,K=O.user;return t.jsxs("div",{className:"animate-in space-y-8 pb-10 font-sans duration-500 fade-in slide-in-from-bottom-4",children:[t.jsxs("div",{className:"flex flex-col justify-between gap-6 md:flex-row md:items-center",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-3xl font-black tracking-tighter text-slate-900 uppercase",children:["Console"," ",t.jsx("span",{className:"text-indigo-600",children:"Sessions"})]}),t.jsx("p",{className:"mt-1 text-sm font-medium text-slate-400",children:"Pilotez l'activité journalière de vos guichets."})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[w.length>1&&t.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border border-slate-200 bg-white p-1 shadow-sm",children:[t.jsx("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-2",children:t.jsx(vt,{className:"h-4 w-4 text-slate-500"})}),t.jsx("select",{className:"cursor-pointer border-none bg-transparent pr-10 text-sm font-black text-slate-700 uppercase focus:ring-0",value:x||"",onChange:g=>D(Number(g.target.value)),children:w.map(g=>t.jsx("option",{value:g.id,children:g.name},g.id))})]}),t.jsxs("div",{className:"flex rounded-2xl border border-slate-200 bg-slate-100 p-1 shadow-inner",children:[t.jsxs("button",{onClick:()=>l("grid"),className:V("flex items-center gap-2 rounded-xl p-2 px-4 text-[10px] font-black tracking-widest uppercase transition-all duration-300",s==="grid"?"bg-white text-indigo-600 shadow-md":"text-slate-400 hover:text-slate-600"),children:[t.jsx(Ns,{className:"h-4 w-4"})," Grille"]}),t.jsxs("button",{onClick:()=>l("list"),className:V("flex items-center gap-2 rounded-xl p-2 px-4 text-[10px] font-black tracking-widest uppercase transition-all duration-300",s==="list"?"bg-white text-indigo-600 shadow-md":"text-slate-400 hover:text-slate-600"),children:[t.jsx(ys,{className:"h-4 w-4"})," Liste"]})]})]})]}),t.jsxs(Ut,{className:"relative overflow-hidden rounded-[3rem] border-none bg-white shadow-2xl",children:[t.jsx("div",{className:V("absolute inset-0 z-0 opacity-[0.04]",k?"bg-emerald-500":"bg-indigo-600")}),t.jsx(Qt,{className:"relative z-10 p-10",children:k?t.jsxs("div",{className:"flex flex-col items-center justify-between gap-12 lg:flex-row",children:[t.jsx("div",{className:"flex-1 space-y-8",children:t.jsxs("div",{className:"inline-flex items-center gap-6 rounded-[2.5rem] border border-slate-100 bg-slate-50 p-8 shadow-sm",children:[t.jsx("div",{className:"rounded-3xl bg-emerald-500 p-5 shadow-xl shadow-emerald-500/30",children:t.jsx(es,{className:"h-10 w-10 text-white"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[t.jsx("span",{className:"rounded-full bg-emerald-100 px-3 py-1 text-[9px] font-bold tracking-tighter text-emerald-600 uppercase",children:"Session Active"}),t.jsxs("span",{className:"text-[9px] font-bold tracking-widest text-slate-400 uppercase",children:["• ",z?.name]})]}),t.jsx("div",{className:"text-4xl font-black tracking-tighter text-slate-900",children:W(k.session_date).format("DD MMMM YYYY")}),t.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm font-bold text-slate-400",children:[t.jsxs("span",{className:"flex items-center gap-1.5",children:[t.jsx(We,{className:"h-4 w-4 text-indigo-500"})," ",W(k.opened_at).format("HH:mm")]}),t.jsx("span",{className:"h-4 w-[1px] bg-slate-200"}),t.jsxs("span",{className:"flex items-center gap-1.5",children:[t.jsx(nt,{className:"h-4 w-4 text-indigo-500"})," ",k.opened_by," ","(Opérateur)"]})]})]})]})}),t.jsxs("div",{className:"flex w-full flex-col items-center gap-4 lg:w-96",children:[t.jsxs($,{onClick:()=>I(k.id),disabled:h,className:"flex h-24 w-full flex-col items-center justify-center gap-2 rounded-[2.5rem] bg-slate-900 text-sm font-black tracking-widest text-white uppercase shadow-2xl transition-all hover:bg-black active:scale-95",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(yt,{className:V("h-7 w-7 text-red-500",h&&"animate-pulse")}),"Fermer la Boutique"]}),t.jsx("span",{className:"text-[9px] font-bold opacity-40",children:"Arrêter le flux de transactions"})]}),t.jsxs("div",{className:"flex w-full gap-4",children:[t.jsxs($,{variant:"outline",onClick:()=>f(!0),className:"h-14 flex-1 rounded-2xl border-slate-200 bg-white font-black tracking-widest text-slate-900 uppercase shadow-sm transition-all hover:border-indigo-500 hover:text-indigo-600",children:[t.jsx(Xe,{className:"mr-2 h-4 w-4 text-indigo-500"}),"Ajustement"]}),t.jsxs($,{variant:"outline",onClick:()=>o(k.id),className:"h-14 flex-1 rounded-2xl border-slate-200 bg-white font-black tracking-widest text-slate-900 uppercase shadow-sm transition-all hover:border-indigo-500 hover:text-indigo-600",children:[t.jsx(Nt,{className:"mr-2 h-4 w-4 text-indigo-500"}),"Stats"]})]})]})]}):t.jsxs("div",{className:"flex flex-col items-center justify-between gap-12 lg:flex-row",children:[t.jsxs("div",{className:"flex-1 space-y-8",children:[t.jsxs("div",{className:"flex items-start gap-6",children:[t.jsx("div",{className:"rounded-[2rem] border border-slate-100 bg-slate-50 p-6",children:t.jsx(ts,{className:"h-10 w-10 text-slate-300"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"mb-2 text-3xl font-black tracking-tight text-slate-900",children:"Prêt pour l'ouverture ?"}),t.jsxs("p",{className:"max-w-lg leading-relaxed font-medium text-slate-500",children:["Aucune session n'est ouverte pour"," ",t.jsx("span",{className:"font-bold text-indigo-600",children:z?.name})," ","aujourd'hui. Ouvrez une session pour autoriser les caissiers à traiter les tickets."]})]})]}),t.jsxs("div",{className:"max-w-xl space-y-4",children:[t.jsx(se,{className:"ml-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Commentaire d'ouverture"}),t.jsx(he,{value:N,onChange:g=>p(g.target.value),placeholder:"Ex: Fond de caisse, équipe du jour...",className:"h-16 rounded-3xl border-slate-200 bg-slate-50 px-8 font-bold text-slate-700 transition-colors focus:bg-white"})]})]}),t.jsxs("div",{className:"group relative w-full overflow-hidden rounded-[3rem] bg-indigo-600 p-8 text-white shadow-2xl shadow-indigo-600/20 lg:w-96",children:[t.jsx("div",{className:"absolute top-0 right-0 h-40 w-40 translate-x-1/2 -translate-y-1/2 bg-white/10 blur-[60px]"}),t.jsxs("div",{className:"relative z-10 space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"rounded-2xl bg-white/20 p-4",children:t.jsx(wt,{className:"h-8 w-8 text-white"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-[10px] leading-none font-black tracking-widest uppercase opacity-60",children:"Session du"}),t.jsx("div",{className:"text-2xl font-black",children:W().format("DD/MM/YYYY")})]})]}),t.jsxs($,{onClick:()=>T(!0),disabled:i||!x,className:"flex h-20 w-full items-center justify-center gap-3 rounded-[2rem] bg-white text-xs font-black tracking-[0.2em] text-indigo-600 uppercase shadow-xl transition-all hover:bg-slate-50 active:scale-95",children:[i?t.jsx(We,{className:"h-5 w-5 animate-spin"}):t.jsx(dt,{className:"h-5 w-5 fill-indigo-600"}),"Ouvrir Session"]}),t.jsx("p",{className:"text-center text-[9px] font-black tracking-widest uppercase opacity-60",children:"Active le terminal client immédiatement"})]})]})]})}),t.jsx(Zs,{isOpen:q,onClose:()=>T(!1),onConfirm:U,shopName:z?.name||"Boutique",counters:A||[],isLoading:i})]}),t.jsxs("div",{className:"space-y-8 pt-10",children:[t.jsxs("div",{className:"flex flex-col items-end justify-between gap-6 border-b border-slate-100 pb-8 lg:flex-row",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-12 w-1.5 rounded-full bg-indigo-500 shadow-[0_0_15px_rgba(79,70,229,0.5)]"}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-2xl font-black tracking-tight text-slate-900 uppercase",children:"Registre Historique"}),t.jsxs("p",{className:"mt-0.5 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:[y?.total||0," sessions enregistrées au total"]})]})]}),t.jsxs("div",{className:"flex w-full flex-wrap items-center gap-4 lg:w-auto",children:[t.jsxs("div",{className:"flex h-14 flex-1 items-center gap-3 rounded-2xl border border-slate-200 bg-white px-4 shadow-sm transition-all focus-within:border-indigo-500 lg:min-w-[200px] lg:flex-none",children:[t.jsx(ft,{className:"h-4 w-4 text-slate-400"}),t.jsx("input",{type:"date",value:v,onChange:g=>{S(g.target.value),u(1)},className:"w-full border-none bg-transparent text-xs font-bold text-slate-600 focus:ring-0"})]}),t.jsxs("div",{className:"flex h-14 flex-1 items-center gap-3 rounded-2xl border border-slate-200 bg-white px-4 shadow-sm transition-all focus-within:border-indigo-500 lg:min-w-[200px] lg:flex-none",children:[t.jsx(bs,{className:"h-4 w-4 text-slate-400"}),t.jsxs("select",{value:j,onChange:g=>{_(g.target.value),u(1)},className:"w-full border-none bg-transparent text-xs font-bold text-slate-600 uppercase focus:ring-0",children:[t.jsx("option",{value:"all",children:"Tous les Statuts"}),t.jsx("option",{value:"open",children:"En Cours"}),t.jsx("option",{value:"closed",children:"Clôturées"})]})]}),(v||j!=="all")&&t.jsx($,{variant:"ghost",size:"icon",onClick:()=>{S(""),_("all")},className:"h-14 w-14 rounded-2xl text-red-500 hover:bg-red-50 hover:text-red-600",children:t.jsx(ct,{className:"h-5 w-5"})})]})]}),t.jsx(Ge,{mode:"wait",children:b?t.jsxs(be.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex h-96 flex-col items-center justify-center space-y-6",children:[t.jsx("div",{className:"h-16 w-16 animate-spin rounded-full border-4 border-indigo-100 border-t-indigo-600"}),t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-400 uppercase",children:"Chargement du registre..."})]},"loading"):m.length===0?t.jsxs(be.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0},className:"flex h-96 flex-col items-center justify-center space-y-4 rounded-[3rem] border-2 border-dashed border-slate-100",children:[t.jsx("div",{className:"rounded-full bg-slate-50 p-6 text-slate-300",children:t.jsx(ft,{className:"h-12 w-12"})}),t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-400 uppercase",children:"Aucune session trouvée"})]},"empty"):t.jsx(be.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},children:s==="grid"?t.jsx("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3",children:m.map(g=>t.jsx(ta,{session:g,userRole:K?.role,onView:()=>o(g.id),onClose:()=>I(g.id),onReopen:()=>B(g.id)},g.id))}):t.jsx(sa,{sessions:m,userRole:K?.role,onView:g=>o(g),onClose:g=>I(g),onReopen:g=>B(g)})},s)}),y&&y.last_page>1&&t.jsxs("div",{className:"mt-12 flex items-center justify-center gap-4 self-center rounded-3xl border border-white bg-white/50 p-4 backdrop-blur-sm",children:[t.jsx($,{variant:"ghost",disabled:a===1,onClick:()=>u(a-1),className:"h-12 w-12 rounded-2xl border border-slate-100 hover:bg-white",children:t.jsx(Vt,{className:"h-5 w-5"})}),t.jsxs("div",{className:"flex items-center gap-2",children:[Array.from({length:Math.min(y.last_page,5)}).map((g,P)=>{const H=P+1;return t.jsx("button",{onClick:()=>u(H),className:V("h-12 w-12 rounded-2xl text-xs font-black transition-all",a===H?"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20":"text-slate-400 hover:bg-white hover:text-slate-600"),children:H},H)}),y.last_page>5&&t.jsx("span",{className:"mx-2 text-slate-300",children:"•••"})]}),t.jsx($,{variant:"ghost",disabled:a===y.last_page,onClick:()=>u(a+1),className:"h-12 w-12 rounded-2xl border border-slate-100 hover:bg-white",children:t.jsx(Et,{className:"h-5 w-5"})})]})]}),t.jsx(Ge,{children:r&&R&&t.jsx(aa,{session:R?.session,stats:R?.statistics,clients:R?.clients,transactions:R?.transactions,activities:R?.activities,loading:E,onClose:()=>o(null)})})]})}function ta(e){const s=Se.c(61),{session:l,userRole:r,onView:o,onClose:i,onReopen:d}=e;let h;s[0]!==l.session_date?(h=W(l.session_date).isSame(W(),"day"),s[0]=l.session_date,s[1]=h):h=s[1];const c=h,M=l.status==="open"?"animate-pulse bg-emerald-500":"bg-slate-200";let f;s[2]!==M?(f=V("absolute top-0 right-0 h-2 w-full",M),s[2]=M,s[3]=f):f=s[3];let a;s[4]!==f?(a=t.jsx("div",{className:f}),s[4]=f,s[5]=a):a=s[5];let u;s[6]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx("div",{className:"rounded-2xl bg-slate-50 p-4 transition-colors duration-500 group-hover:bg-indigo-50",children:t.jsx(wt,{className:"h-7 w-7 text-slate-400 group-hover:text-indigo-500"})}),s[6]=u):u=s[6];const j=l.status==="open"?"border border-emerald-500/20 bg-emerald-500/10 text-emerald-600":"border border-slate-200 bg-slate-100 text-slate-500";let _;s[7]!==j?(_=V("flex items-center gap-1.5 rounded-full px-4 py-1.5 text-[10px] font-black tracking-widest uppercase",j),s[7]=j,s[8]=_):_=s[8];let v;s[9]!==l.status?(v=l.status==="open"?t.jsx("div",{className:"h-1.5 w-1.5 animate-ping rounded-full bg-emerald-500"}):null,s[9]=l.status,s[10]=v):v=s[10];const S=l.status==="open"?"En cours":"Terminé";let x;s[11]!==_||s[12]!==v||s[13]!==S?(x=t.jsxs("div",{className:"mb-8 flex items-start justify-between",children:[u,t.jsxs("div",{className:_,children:[v,S]})]}),s[11]=_,s[12]=v,s[13]=S,s[14]=x):x=s[14];let D;s[15]!==l.session_date?(D=W(l.session_date).format("DD MMMM YYYY"),s[15]=l.session_date,s[16]=D):D=s[16];let N;s[17]!==D?(N=t.jsx("div",{className:"mb-1 text-2xl font-black tracking-tight text-slate-900",children:D}),s[17]=D,s[18]=N):N=s[18];let p;s[19]!==c?(p=c&&t.jsx("p",{className:"text-[10px] leading-none font-black tracking-widest text-indigo-500 uppercase",children:"Aujourd'hui"}),s[19]=c,s[20]=p):p=s[20];let w;s[21]!==N||s[22]!==p?(w=t.jsxs("div",{children:[N,p]}),s[21]=N,s[22]=p,s[23]=w):w=s[23];let C;s[24]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx("span",{className:"text-[9px] font-black tracking-[0.2em] uppercase opacity-60",children:"Ouverture"}),s[24]=C):C=s[24];let b;s[25]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx(We,{className:"h-3 w-3"}),s[25]=b):b=s[25];let A;s[26]!==l.opened_at?(A=W(l.opened_at).format("HH:mm"),s[26]=l.opened_at,s[27]=A):A=s[27];let m;s[28]!==A?(m=t.jsxs("div",{className:"flex flex-col gap-1",children:[C,t.jsxs("span",{className:"flex items-center gap-1.5 text-slate-700",children:[b,A]})]}),s[28]=A,s[29]=m):m=s[29];let y;s[30]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsx("div",{className:"h-8 w-[1px] bg-slate-200"}),s[30]=y):y=s[30];let R;s[31]===Symbol.for("react.memo_cache_sentinel")?(R=t.jsx("span",{className:"text-[9px] font-black tracking-[0.2em] uppercase opacity-60",children:"Clôture"}),s[31]=R):R=s[31];let E;s[32]!==l.closed_at?(E=l.closed_at?t.jsxs(t.Fragment,{children:[t.jsx(We,{className:"h-3 w-3"}),W(l.closed_at).format("HH:mm")]}):"--:--",s[32]=l.closed_at,s[33]=E):E=s[33];let k;s[34]!==E?(k=t.jsxs("div",{className:"flex flex-col items-end gap-1",children:[R,t.jsx("span",{className:"flex items-center gap-1.5 text-slate-700",children:E})]}),s[34]=E,s[35]=k):k=s[35];let q;s[36]!==m||s[37]!==k?(q=t.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-50 bg-slate-50/50 p-4 text-xs font-bold text-slate-400",children:[m,y,k]}),s[36]=m,s[37]=k,s[38]=q):q=s[38];let T;s[39]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx(Nt,{className:"mr-2 h-4 w-4"}),s[39]=T):T=s[39];let L;s[40]!==o?(L=t.jsxs($,{onClick:o,className:"h-14 flex-1 rounded-2xl bg-indigo-600 text-[10px] font-black tracking-widest text-white uppercase shadow-lg shadow-indigo-600/20 transition-all hover:scale-105 hover:bg-indigo-700 active:scale-95",children:[T," Rapport"]}),s[40]=o,s[41]=L):L=s[41];let U;s[42]!==i||s[43]!==l.status?(U=l.status==="open"&&t.jsx($,{onClick:i,variant:"outline",className:"h-14 w-14 rounded-2xl border-slate-200 text-red-500 transition-all hover:border-red-100 hover:bg-red-50 active:scale-95",children:t.jsx(yt,{className:"h-5 w-5"})}),s[42]=i,s[43]=l.status,s[44]=U):U=s[44];let I;s[45]!==d||s[46]!==l.status||s[47]!==r?(I=l.status==="closed"&&r==="super-admin"&&t.jsx($,{onClick:d,variant:"outline",className:"h-14 w-14 rounded-2xl border-indigo-200 text-indigo-500 transition-all hover:bg-indigo-50 active:scale-95",title:"Réouvrir la session",children:t.jsx(dt,{className:"h-5 w-5"})}),s[45]=d,s[46]=l.status,s[47]=r,s[48]=I):I=s[48];let B;s[49]!==L||s[50]!==U||s[51]!==I?(B=t.jsxs("div",{className:"flex gap-3 pt-4",children:[L,U,I]}),s[49]=L,s[50]=U,s[51]=I,s[52]=B):B=s[52];let z;s[53]!==w||s[54]!==q||s[55]!==B?(z=t.jsxs("div",{className:"space-y-6",children:[w,q,B]}),s[53]=w,s[54]=q,s[55]=B,s[56]=z):z=s[56];let O;return s[57]!==x||s[58]!==z||s[59]!==a?(O=t.jsxs(Ut,{className:"group hover:shadow-3xl relative overflow-hidden rounded-[2.5rem] border border-none border-transparent bg-white p-8 shadow-xl shadow-slate-200/50 transition-all duration-500 hover:-translate-y-2 hover:border-indigo-100",children:[a,x,z]}),s[57]=x,s[58]=z,s[59]=a,s[60]=O):O=s[60],O}function sa(e){const s=Se.c(14),{sessions:l,userRole:r,onView:o,onClose:i,onReopen:d}=e;let h;s[0]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx("thead",{children:t.jsxs("tr",{className:"bg-slate-50/80 backdrop-blur-md",children:[t.jsx("th",{className:"p-8 text-[11px] font-black tracking-widest text-slate-400 uppercase first:rounded-tl-[2.5rem]",children:"Date"}),t.jsx("th",{className:"p-8 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Boutique / Guichet"}),t.jsx("th",{className:"p-8 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Statut"}),t.jsx("th",{className:"p-8 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Horaire"}),t.jsx("th",{className:"p-8 text-right text-[11px] font-black tracking-widest text-slate-400 uppercase last:rounded-tr-[2.5rem]",children:"Actions"})]})}),s[0]=h):h=s[0];let c;if(s[1]!==i||s[2]!==d||s[3]!==o||s[4]!==l||s[5]!==r){let f;s[7]!==i||s[8]!==d||s[9]!==o||s[10]!==r?(f=a=>t.jsxs("tr",{className:"group transition-colors hover:bg-slate-50/50",children:[t.jsx("td",{className:"p-8 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-slate-100 text-slate-400 transition-colors group-hover:bg-indigo-100 group-hover:text-indigo-600",children:t.jsx(wt,{className:"h-5 w-5"})}),t.jsx("span",{className:"text-sm font-black tracking-tight text-slate-700",children:W(a.session_date).format("DD/MM/YYYY")})]})}),t.jsx("td",{className:"p-8",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-xs font-bold text-slate-700",children:a.shop?.name||"Agence Centrale"}),t.jsxs("span",{className:"mt-0.5 text-[10px] font-bold tracking-widest text-slate-400 uppercase",children:["ID: ",a.shop_id]})]})}),t.jsx("td",{className:"p-8",children:t.jsx("span",{className:V("rounded-full px-4 py-1.5 text-[9px] font-black tracking-widest uppercase",a.status==="open"?"border border-emerald-100 bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-400"),children:a.status==="open"?"En Cours":"Clôturé"})}),t.jsx("td",{className:"p-8",children:t.jsxs("div",{className:"flex items-center gap-4 text-xs font-bold text-slate-400",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"mb-0.5 text-[9px] uppercase opacity-50",children:"Ouvert"}),t.jsx("span",{className:"text-slate-600",children:W(a.opened_at).format("HH:mm")})]}),t.jsx(Xe,{className:"h-3 w-3 opacity-20"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"mb-0.5 text-[9px] uppercase opacity-50",children:"Fermé"}),t.jsx("span",{className:"text-slate-600",children:a.closed_at?W(a.closed_at).format("HH:mm"):"--:--"})]})]})}),t.jsx("td",{className:"p-8 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsxs($,{onClick:()=>o(a.id),className:"h-10 rounded-xl bg-indigo-50 px-4 text-[10px] font-black tracking-widest text-indigo-600 uppercase shadow-none transition-all hover:bg-indigo-600 hover:text-white",children:[t.jsx(Nt,{className:"mr-2 h-3.5 w-3.5"})," ","Rapport"]}),a.status==="open"&&t.jsx($,{onClick:()=>i(a.id),size:"icon",className:"h-10 w-10 rounded-xl bg-red-50 text-red-500 shadow-none transition-all hover:bg-red-500 hover:text-white",children:t.jsx(yt,{className:"h-4 w-4"})}),a.status==="closed"&&r==="super-admin"&&t.jsx($,{onClick:()=>d(a.id),size:"icon",className:"h-10 w-10 rounded-xl bg-indigo-50 text-indigo-500 shadow-none transition-all hover:bg-indigo-500 hover:text-white",title:"Réouvrir la session",children:t.jsx(dt,{className:"h-4 w-4"})})]})})]},a.id),s[7]=i,s[8]=d,s[9]=o,s[10]=r,s[11]=f):f=s[11],c=l.map(f),s[1]=i,s[2]=d,s[3]=o,s[4]=l,s[5]=r,s[6]=c}else c=s[6];let M;return s[12]!==c?(M=t.jsx("div",{className:"w-full overflow-hidden rounded-[2.5rem] border border-slate-100 bg-white shadow-xl shadow-slate-200/30",children:t.jsxs("table",{className:"w-full border-collapse text-left",children:[h,t.jsx("tbody",{className:"divide-y divide-slate-100",children:c})]})}),s[12]=c,s[13]=M):M=s[13],M}function aa(e){const s=Se.c(47),{session:l,stats:r,transactions:o,loading:i,onClose:d}=e;let h,c,M;s[0]===Symbol.for("react.memo_cache_sentinel")?(h={opacity:0},c={opacity:1},M={opacity:0},s[0]=h,s[1]=c,s[2]=M):(h=s[0],c=s[1],M=s[2]);let f;s[3]!==d?(f=t.jsx(be.div,{initial:h,animate:c,exit:M,onClick:d,className:"absolute inset-0 bg-slate-900/60 backdrop-blur-xl"}),s[3]=d,s[4]=f):f=s[4];let a,u,j;s[5]===Symbol.for("react.memo_cache_sentinel")?(a={opacity:0,scale:.9,y:30},u={opacity:1,scale:1,y:0},j={opacity:0,scale:.9,y:30},s[5]=a,s[6]=u,s[7]=j):(a=s[5],u=s[6],j=s[7]);let _;s[8]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx("div",{className:"rounded-[2rem] bg-indigo-600 p-5 shadow-xl shadow-indigo-600/30",children:t.jsx(Be,{className:"h-10 w-10 text-white"})}),s[8]=_):_=s[8];let v;s[9]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx("h3",{className:"text-3xl font-black tracking-tighter text-slate-900 uppercase",children:"Rapport de Session"}),s[9]=v):v=s[9];const S=l?.status==="open"?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500";let x;s[10]!==S?(x=V("rounded-full px-4 py-1.5 text-[10px] font-black tracking-widest uppercase",S),s[10]=S,s[11]=x):x=s[11];const D=l?.status==="open"?"Live":"Archivé";let N;s[12]!==x||s[13]!==D?(N=t.jsxs("div",{className:"mb-1 flex items-center gap-3",children:[v,t.jsx("span",{className:x,children:D})]}),s[12]=x,s[13]=D,s[14]=N):N=s[14];let p;s[15]!==l?(p=l?W(l.session_date).format("dddd DD MMMM YYYY"):"Chargement...",s[15]=l,s[16]=p):p=s[16];const w=l?.shop?.name;let C;s[17]!==p||s[18]!==w?(C=t.jsxs("p",{className:"text-sm font-bold text-slate-400",children:[p," ","• Guichet ",w]}),s[17]=p,s[18]=w,s[19]=C):C=s[19];let b;s[20]!==N||s[21]!==C?(b=t.jsxs("div",{className:"flex items-center gap-6",children:[_,t.jsxs("div",{children:[N,C]})]}),s[20]=N,s[21]=C,s[22]=b):b=s[22];let A;s[23]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx(ct,{className:"h-8 w-8"}),s[23]=A):A=s[23];let m;s[24]!==d?(m=t.jsx($,{onClick:d,variant:"ghost",className:"h-16 w-16 rounded-[2rem] bg-slate-50 text-slate-400 transition-all hover:bg-red-50 hover:text-red-500",children:A}),s[24]=d,s[25]=m):m=s[25];let y;s[26]!==b||s[27]!==m?(y=t.jsxs("div",{className:"flex shrink-0 items-center justify-between border-b border-slate-100 bg-white p-8 md:p-12",children:[b,m]}),s[26]=b,s[27]=m,s[28]=y):y=s[28];let R;s[29]!==i||s[30]!==r?.cashier_stats||s[31]!==r?.total_clients||s[32]!==r?.total_transactions||s[33]!==r?.volume_cdf||s[34]!==r?.volume_usd||s[35]!==o?(R=t.jsx("div",{className:"flex-1 space-y-12 overflow-y-auto p-8 md:p-12",children:i?t.jsxs("div",{className:"flex h-96 flex-col items-center justify-center space-y-6",children:[t.jsx("div",{className:"h-20 w-20 animate-spin rounded-full border-4 border-indigo-100 border-t-indigo-600"}),t.jsx("p",{className:"animate-pulse text-sm font-black tracking-widest text-slate-400 uppercase",children:"Synthèse des données..."})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-4",children:[t.jsx(tt,{title:"Clients",value:r?.total_clients,icon:nt,color:"blue"}),t.jsx(tt,{title:"Transactions",value:r?.total_transactions,icon:Xe,color:"emerald"}),t.jsx(tt,{title:"Volume USD",value:`$ ${r?.volume_usd?.toLocaleString()}`,icon:Be,color:"indigo"}),t.jsx(tt,{title:"Volume CDF",value:`${r?.volume_cdf?.toLocaleString()} FC`,icon:Qe,color:"amber"})]}),t.jsxs("div",{className:"space-y-12",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-10 w-1 rounded-full bg-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.5)]"}),t.jsx("h5",{className:"text-xl font-black tracking-tight text-slate-900 uppercase",children:"Flux Financier"})]}),t.jsx("div",{className:"overflow-hidden rounded-[2.5rem] border border-slate-100 bg-white shadow-xl shadow-slate-200/20",children:t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-slate-50/50",children:[t.jsx("th",{className:"p-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Heure"}),t.jsx("th",{className:"p-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Opération"}),t.jsx("th",{className:"p-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Montant Envoyé"}),t.jsx("th",{className:"p-6 text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Montant Reçu"}),t.jsx("th",{className:"p-6 text-right text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Commission"})]})}),t.jsxs("tbody",{className:"divide-y divide-slate-100",children:[o?.map(ia),o?.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"p-12 text-center text-xs font-black tracking-widest text-slate-300 uppercase",children:"Aucune transaction"})})]})]})})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"h-10 w-1 rounded-full bg-indigo-500"}),t.jsx("h5",{className:"text-xl font-black tracking-tight text-slate-900 uppercase",children:"Performance Opérateurs"})]}),t.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:r?.cashier_stats?.map(la)})]})]})]})}),s[29]=i,s[30]=r?.cashier_stats,s[31]=r?.total_clients,s[32]=r?.total_transactions,s[33]=r?.volume_cdf,s[34]=r?.volume_usd,s[35]=o,s[36]=R):R=s[36];let E;s[37]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsxs("div",{className:"text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:["Document généré le ",W().format("DD/MM/YYYY HH:mm")]}),s[37]=E):E=s[37];let k;s[38]!==d?(k=t.jsxs("div",{className:"flex shrink-0 items-center justify-between border-t border-slate-100 bg-white p-8 md:p-12",children:[E,t.jsx($,{onClick:d,className:"h-14 rounded-2xl bg-slate-900 px-10 text-xs font-black tracking-widest text-white uppercase",children:"Fermer le Rapport"})]}),s[38]=d,s[39]=k):k=s[39];let q;s[40]!==y||s[41]!==R||s[42]!==k?(q=t.jsxs(be.div,{initial:a,animate:u,exit:j,className:"relative flex max-h-[90vh] w-full max-w-6xl flex-col overflow-hidden rounded-[3.5rem] border border-white/20 bg-[#f8fafc] shadow-[0_40px_100px_rgba(0,0,0,0.5)]",children:[y,R,k]}),s[40]=y,s[41]=R,s[42]=k,s[43]=q):q=s[43];let T;return s[44]!==q||s[45]!==f?(T=t.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-6 font-sans md:p-12",children:[f,q]}),s[44]=q,s[45]=f,s[46]=T):T=s[46],T}function la(e,s){return t.jsxs("div",{className:"group rounded-[2rem] border border-slate-100 bg-white p-8 shadow-lg shadow-slate-200/30 transition-all hover:border-indigo-200",children:[t.jsxs("div",{className:"mb-6 flex items-center gap-4",children:[t.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-2xl bg-indigo-50 text-xl font-black text-indigo-600 transition-all group-hover:bg-indigo-600 group-hover:text-white",children:e.cashier.charAt(0)}),t.jsxs("div",{children:[t.jsx("div",{className:"text-lg font-black tracking-tighter text-slate-800",children:e.cashier}),t.jsx("div",{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Opérateur"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"rounded-xl bg-slate-50 p-4",children:[t.jsx("div",{className:"mb-1 text-[9px] font-black text-slate-400 uppercase",children:"Appels"}),t.jsx("div",{className:"text-xl font-black text-slate-700",children:e.clients_called})]}),t.jsxs("div",{className:"rounded-xl bg-slate-50 p-4",children:[t.jsx("div",{className:"mb-1 text-[9px] font-black text-slate-400 uppercase",children:"Succès"}),t.jsx("div",{className:"text-xl font-black text-emerald-600",children:e.transactions_completed})]})]})]},s)}function ia(e){return t.jsxs("tr",{className:"transition-colors hover:bg-slate-50/30",children:[t.jsx("td",{className:"p-6 text-xs font-bold text-slate-500",children:W(e.created_at).format("HH:mm:ss")}),t.jsx("td",{className:"p-6",children:t.jsx("span",{className:"text-xs font-black tracking-tighter text-slate-800 uppercase",children:e.operation_type})}),t.jsx("td",{className:"p-6",children:t.jsxs("span",{className:"text-sm font-black text-emerald-600",children:[e.amount_from?.toLocaleString()," ",e.currency_from]})}),t.jsx("td",{className:"p-6",children:t.jsxs("span",{className:"text-sm font-black text-slate-600",children:[e.amount_to?.toLocaleString()," ",e.currency_to]})}),t.jsx("td",{className:"p-6 text-right",children:t.jsxs("span",{className:"text-xs font-black text-indigo-600",children:["$"," ",e.commission]})})]},e.id)}function tt(e){const s=Se.c(21),{title:l,value:r,icon:o,color:i}=e;let d,h,c,M;if(s[0]!==o||s[1]!==i){const v={blue:"bg-blue-500 text-blue-500 border-blue-100 shadow-blue-500/20",emerald:"bg-emerald-500 text-emerald-500 border-emerald-100 shadow-emerald-500/20",indigo:"bg-indigo-500 text-indigo-500 border-indigo-100 shadow-indigo-500/20",amber:"bg-amber-500 text-amber-500 border-amber-100 shadow-amber-500/20"};M="flex flex-col items-center rounded-[2.5rem] border border-slate-100 bg-white p-8 text-center shadow-xl shadow-slate-200/30",c=V("mb-6 rounded-2xl p-5 shadow-xl",v[i].split(" ")[0],"bg-opacity-10"),d=o,h=V("h-8 w-8",v[i].split(" ")[1]),s[0]=o,s[1]=i,s[2]=d,s[3]=h,s[4]=c,s[5]=M}else d=s[2],h=s[3],c=s[4],M=s[5];let f;s[6]!==d||s[7]!==h?(f=t.jsx(d,{className:h}),s[6]=d,s[7]=h,s[8]=f):f=s[8];let a;s[9]!==c||s[10]!==f?(a=t.jsx("div",{className:c,children:f}),s[9]=c,s[10]=f,s[11]=a):a=s[11];let u;s[12]!==l?(u=t.jsx("div",{className:"mb-2 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:l}),s[12]=l,s[13]=u):u=s[13];let j;s[14]!==r?(j=t.jsx("div",{className:"text-3xl leading-none font-black tracking-tighter text-slate-900",children:r}),s[14]=r,s[15]=j):j=s[15];let _;return s[16]!==M||s[17]!==a||s[18]!==u||s[19]!==j?(_=t.jsxs("div",{className:M,children:[a,u,j]}),s[16]=M,s[17]=a,s[18]=u,s[19]=j,s[20]=_):_=s[20],_}const qt={blue:{bg:"bg-blue-50",icon:"bg-blue-600 text-white shadow-blue-200",text:"text-blue-600",border:"border-blue-100",accent:"bg-blue-600/5",glow:"shadow-blue-500/10"},emerald:{bg:"bg-emerald-50",icon:"bg-emerald-600 text-white shadow-emerald-200",text:"text-emerald-600",border:"border-emerald-100",accent:"bg-emerald-600/5",glow:"shadow-emerald-500/10"},amber:{bg:"bg-amber-50",icon:"bg-amber-500 text-white shadow-amber-200",text:"text-amber-600",border:"border-amber-100",accent:"bg-amber-600/5",glow:"shadow-amber-500/10"},indigo:{bg:"bg-indigo-50",icon:"bg-indigo-600 text-white shadow-indigo-200",text:"text-indigo-600",border:"border-indigo-100",accent:"bg-indigo-600/5",glow:"shadow-indigo-500/10"},purple:{bg:"bg-purple-50",icon:"bg-purple-600 text-white shadow-purple-200",text:"text-purple-600",border:"border-purple-100",accent:"bg-purple-600/5",glow:"shadow-purple-500/10"},rose:{bg:"bg-rose-50",icon:"bg-rose-600 text-white shadow-rose-200",text:"text-rose-600",border:"border-rose-100",accent:"bg-rose-600/5",glow:"shadow-rose-500/10"}};function st(e){const s=Se.c(43),{title:l,value:r,subtitle:o,icon:i,color:d,trend:h}=e,c=qt[d]||qt.blue;let M,f;s[0]===Symbol.for("react.memo_cache_sentinel")?(M={y:-5,scale:1.02},f={type:"spring",stiffness:400,damping:25},s[0]=M,s[1]=f):(M=s[0],f=s[1]);let a;s[2]!==c.glow?(a=V("group relative overflow-hidden rounded-[2.5rem] border border-white bg-white/70 p-8 shadow-xl backdrop-blur-xl transition-all",c.glow),s[2]=c.glow,s[3]=a):a=s[3];let u;s[4]!==c.bg?(u=V("absolute -top-12 -right-12 h-32 w-32 rounded-full opacity-20 blur-3xl",c.bg),s[4]=c.bg,s[5]=u):u=s[5];let j;s[6]!==u?(j=t.jsx("div",{className:u}),s[6]=u,s[7]=j):j=s[7];let _;s[8]!==c.icon?(_=V("flex h-14 w-14 items-center justify-center rounded-2xl shadow-lg transition-transform duration-500 group-hover:scale-110",c.icon),s[8]=c.icon,s[9]=_):_=s[9];let v;s[10]!==i?(v=t.jsx(i,{className:"h-8 w-8"}),s[10]=i,s[11]=v):v=s[11];let S;s[12]!==_||s[13]!==v?(S=t.jsx("div",{className:_,children:v}),s[12]=_,s[13]=v,s[14]=S):S=s[14];let x;s[15]!==h?(x=h&&t.jsxs("div",{className:V("flex items-center gap-1 rounded-full px-3 py-1 text-[10px] font-black tracking-widest uppercase",h.positive?"bg-emerald-100 text-emerald-600":"bg-rose-100 text-rose-600"),children:[h.positive?"↑":"↓"," ",h.value]}),s[15]=h,s[16]=x):x=s[16];let D;s[17]!==S||s[18]!==x?(D=t.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[S,x]}),s[17]=S,s[18]=x,s[19]=D):D=s[19];let N;s[20]!==l?(N=t.jsx("p",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:l}),s[20]=l,s[21]=N):N=s[21];let p;s[22]!==r?(p=t.jsx("h2",{className:"text-3xl leading-tight font-black tracking-tight text-slate-900",children:r}),s[22]=r,s[23]=p):p=s[23];let w;s[24]!==c.text||s[25]!==o?(w=o&&t.jsxs("p",{className:"mt-2 flex items-center gap-1.5 text-[11px] font-bold tracking-wide text-slate-400 uppercase",children:[t.jsx("span",{className:V("h-1.5 w-1.5 rounded-full",c.text.replace("text","bg"))}),o]}),s[24]=c.text,s[25]=o,s[26]=w):w=s[26];let C;s[27]!==N||s[28]!==p||s[29]!==w?(C=t.jsxs("div",{className:"space-y-1",children:[N,p,w]}),s[27]=N,s[28]=p,s[29]=w,s[30]=C):C=s[30];let b;s[31]!==D||s[32]!==C?(b=t.jsxs("div",{className:"relative z-10 flex h-full flex-col",children:[D,C]}),s[31]=D,s[32]=C,s[33]=b):b=s[33];let A;s[34]!==c.text?(A=V("absolute bottom-0 left-0 h-1.5 w-full opacity-30",c.text.replace("text","bg")),s[34]=c.text,s[35]=A):A=s[35];let m;s[36]!==A?(m=t.jsx("div",{className:A}),s[36]=A,s[37]=m):m=s[37];let y;return s[38]!==b||s[39]!==m||s[40]!==a||s[41]!==j?(y=t.jsxs(be.div,{whileHover:M,transition:f,className:a,children:[j,b,m]}),s[38]=b,s[39]=m,s[40]=a,s[41]=j,s[42]=y):y=s[42],y}function At(e){const s=Se.c(6),{transactions:l}=e;if(l.length===0){let d;return s[0]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsxs("div",{className:"flex flex-col items-center justify-center rounded-[2rem] border-2 border-dashed border-slate-200 bg-slate-50/50 p-20",children:[t.jsx("div",{className:"mb-4 flex h-16 w-16 items-center justify-center rounded-2xl border border-slate-100 bg-white shadow-sm",children:t.jsx(zt,{className:"h-8 w-8 text-slate-300"})}),t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-400 uppercase",children:"Aucune transaction trouvée"})]}),s[0]=d):d=s[0],d}let r;s[1]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx("thead",{children:t.jsxs("tr",{className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[t.jsx("th",{className:"px-6 py-4 font-black",children:"Transaction / Client"}),t.jsx("th",{className:"px-6 py-4 text-center font-black",children:"Type"}),t.jsx("th",{className:"px-6 py-4 text-right font-black",children:"Montant Entrée"}),t.jsx("th",{className:"px-6 py-4 text-right font-black",children:"Montant Sortie"}),t.jsx("th",{className:"px-6 py-4 text-right font-black",children:"Commission"}),t.jsx("th",{className:"px-6 py-4 text-right font-black",children:"Date / Heure"})]})}),s[1]=r):r=s[1];let o;s[2]!==l?(o=l.map(ra),s[2]=l,s[3]=o):o=s[3];let i;return s[4]!==o?(i=t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-separate border-spacing-y-3 text-left",children:[r,t.jsx("tbody",{children:o})]})}),s[4]=o,s[5]=i):i=s[5],i}function ra(e){return t.jsxs("tr",{className:"group rounded-2xl border border-slate-100 bg-white transition-all duration-300 hover:bg-slate-50",children:[t.jsx("td",{className:"rounded-l-2xl border-y border-l border-slate-100 px-6 py-5 group-hover:border-indigo-100",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-xl bg-slate-900 shadow-lg shadow-slate-900/10 transition-transform group-hover:scale-110",children:t.jsx(Rt,{className:"h-5 w-5 text-white"})}),t.jsxs("div",{className:"flex min-w-0 flex-col",children:[t.jsx("span",{className:"truncate text-sm font-black text-slate-900",children:e.client_name||"Utilisateur"}),t.jsxs("span",{className:"flex items-center gap-1 text-[10px] font-bold tracking-tight text-slate-400 uppercase",children:[t.jsx(zt,{className:"h-2.5 w-2.5"})," ID-",e.id.toString().slice(-4).toUpperCase()]})]})]})}),t.jsx("td",{className:"border-y border-slate-100 px-6 py-5 text-center group-hover:border-indigo-100",children:t.jsxs("div",{className:V("inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-[10px] font-black tracking-widest uppercase",e.operation_type==="change"?"bg-indigo-50 text-indigo-600":"bg-amber-50 text-amber-600"),children:[e.operation_type==="change"?t.jsx(xs,{className:"h-3 w-3"}):t.jsx(cs,{className:"h-3 w-3"}),e.operation_type]})}),t.jsx("td",{className:"border-y border-slate-100 px-6 py-5 text-right group-hover:border-indigo-100",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-black text-slate-900",children:e.amount_from?.toLocaleString()}),t.jsx("span",{className:"text-[10px] font-black tracking-tighter text-slate-400 uppercase",children:e.currency_from})]})}),t.jsx("td",{className:"border-y border-slate-100 px-6 py-5 text-right group-hover:border-indigo-100",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-black text-emerald-600",children:e.amount_to?.toLocaleString()}),t.jsx("span",{className:"text-[10px] font-black tracking-tighter text-emerald-600 uppercase opacity-60",children:e.currency_to})]})}),t.jsx("td",{className:"border-y border-slate-100 px-6 py-5 text-right group-hover:border-indigo-100",children:t.jsxs("span",{className:"rounded-lg bg-slate-900 px-3 py-1 font-mono text-xs font-black text-white shadow-lg shadow-slate-900/10",children:["$",parseFloat(e.commission).toLocaleString()]})}),t.jsx("td",{className:"rounded-r-2xl border-y border-r border-slate-100 px-6 py-5 text-right group-hover:border-indigo-100",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-black text-slate-700",children:W(e.created_date).format("DD/MM/YYYY")}),t.jsxs("span",{className:"flex items-center justify-end gap-1 text-[10px] font-bold text-slate-400",children:[t.jsx(We,{className:"h-2.5 w-2.5"})," ",W(e.created_date).format("HH:mm")]})]})})]},e.id)}function na(){const e=Se.c(96),{auth:s}=jt().props,l=s.user?.role==="super-admin",[r,o]=Q.useState(!1),[i,d]=Q.useState(null),h=Ze(),c=l?"manager":"cashier";let M;e[0]===Symbol.for("react.memo_cache_sentinel")?(M=[],e[0]=M):M=e[0];let f;e[1]!==c?(f={name:"",email:"",password:"",role:c,is_active:!0,shop_ids:M},e[1]=c,e[2]=f):f=e[2];const[a,u]=Q.useState(f);let j;e[3]===Symbol.for("react.memo_cache_sentinel")?(j=["shops"],e[3]=j):j=e[3];let _;e[4]!==l?(_={queryKey:j,queryFn:J.entities.Shop.list,enabled:l},e[4]=l,e[5]=_):_=e[5];const{data:v}=_e(_);let S;e[6]===Symbol.for("react.memo_cache_sentinel")?(S={queryKey:["users"],queryFn:J.entities.User.list},e[6]=S):S=e[6];const{data:x,isLoading:D}=_e(S);let N;e[7]!==h?(N={mutationFn:J.entities.User.create,onSuccess:()=>{h.invalidateQueries({queryKey:["users"]}),o(!1),u({name:"",email:"",password:"",role:"cashier",is_active:!0}),Y.success("Utilisateur créé avec succès")},onError:ua},e[7]=h,e[8]=N):N=e[8];const p=pe(N);let w;e[9]!==h?(w={mutationFn:ha,onSuccess:()=>{h.invalidateQueries({queryKey:["users"]}),d(null),u({name:"",email:"",password:"",role:"cashier",is_active:!0}),Y.success("Utilisateur mis à jour avec succès")},onError:ma},e[9]=h,e[10]=w):w=e[10];const C=pe(w);let b;e[11]!==h?(b={mutationFn:xa,onSuccess:()=>{h.invalidateQueries({queryKey:["users"]}),Y.success("Utilisateur supprimé avec succès")},onError:da},e[11]=h,e[12]=b):b=e[12];const A=pe(b);let m;e[13]!==p||e[14]!==i||e[15]!==a||e[16]!==C?(m=F=>{F.preventDefault(),i?C.mutate({id:i.id,data:a}):p.mutate(a)},e[13]=p,e[14]=i,e[15]=a,e[16]=C,e[17]=m):m=e[17];const y=m;let R;e[18]===Symbol.for("react.memo_cache_sentinel")?(R=F=>{d(F),u({name:F.name,email:F.email,role:F.role,is_active:F.is_active}),o(!0)},e[18]=R):R=e[18];const E=R;let k;e[19]!==A?(k=F=>{confirm("Êtes-vous sûr de vouloir supprimer cet utilisateur ?")&&A.mutate(F)},e[19]=A,e[20]=k):k=e[20];const q=k,T=ca;let L;e[21]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold tracking-tight text-slate-900",children:"Gestion des utilisateurs"}),t.jsx("p",{className:"text-slate-500",children:"Gérez les accès et les rôles des utilisateurs"})]}),e[21]=L):L=e[21];let U;e[22]!==l?(U=()=>{d(null),u({name:"",email:"",password:"",role:l?"manager":"cashier",is_active:!0}),o(!0)},e[22]=l,e[23]=U):U=e[23];let I;e[24]===Symbol.for("react.memo_cache_sentinel")?(I=t.jsx(Ke,{className:"mr-2 h-4 w-4"}),e[24]=I):I=e[24];const B=l?"Nouvel utilisateur":"Nouveau Caissier";let z;e[25]!==U||e[26]!==B?(z=t.jsxs("div",{className:"flex items-center justify-between",children:[L,t.jsxs($,{onClick:U,className:"bg-[#1f61e4] hover:bg-[#1f61e4]/90",children:[I,B]})]}),e[25]=U,e[26]=B,e[27]=z):z=e[27];let O;e[28]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx(ls,{children:t.jsxs(pt,{children:[t.jsx(Oe,{children:"Nom"}),t.jsx(Oe,{children:"Email"}),t.jsx(Oe,{children:"Boutique"}),t.jsx(Oe,{children:"Rôle"}),t.jsx(Oe,{children:"Statut"}),t.jsx(Oe,{className:"text-right",children:"Actions"})]})}),e[28]=O):O=e[28];let K;e[29]!==q||e[30]!==D||e[31]!==x?(K=D?t.jsx(pt,{children:t.jsx(Re,{colSpan:5,className:"h-24 text-center",children:"Chargement..."})}):x?.map(F=>t.jsxs(pt,{children:[t.jsx(Re,{className:"font-medium",children:F.name}),t.jsx(Re,{children:F.email}),t.jsx(Re,{children:t.jsx("div",{className:"flex flex-wrap gap-1",children:F.shops&&F.shops.length>0?F.shops.map(oa):t.jsx("span",{className:"text-[10px] text-slate-400 italic",children:"Aucune"})})}),t.jsx(Re,{children:T(F.role)}),t.jsx(Re,{children:t.jsx(Ye,{variant:F.is_active?"default":"destructive",className:F.is_active?"bg-green-500 hover:bg-green-600":"",children:F.is_active?"Actif":"Inactif"})}),t.jsx(Re,{className:"text-right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx($,{variant:"ghost",size:"icon",onClick:()=>E(F),className:"h-8 w-8 text-slate-500 hover:text-[#1f61e4]",children:t.jsx(ss,{className:"h-4 w-4"})}),t.jsx($,{variant:"ghost",size:"icon",onClick:()=>q(F.id),className:"h-8 w-8 text-slate-500 hover:text-red-600",children:t.jsx(ot,{className:"h-4 w-4"})})]})})]},F.id)),e[29]=q,e[30]=D,e[31]=x,e[32]=K):K=e[32];let g;e[33]!==K?(g=t.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:t.jsxs(is,{children:[O,t.jsx(rs,{children:K})]})}),e[33]=K,e[34]=g):g=e[34];const P=i?"Modifier l'utilisateur":"Nouvel utilisateur";let H;e[35]!==P?(H=t.jsx(It,{children:t.jsx(Tt,{children:P})}),e[35]=P,e[36]=H):H=e[36];let ne;e[37]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx(se,{htmlFor:"name",children:"Nom complet"}),e[37]=ne):ne=e[37];let ae;e[38]!==a?(ae=F=>u({...a,name:F.target.value}),e[38]=a,e[39]=ae):ae=e[39];let X;e[40]!==a.name||e[41]!==ae?(X=t.jsxs("div",{className:"space-y-2",children:[ne,t.jsx(he,{id:"name",value:a.name,onChange:ae,required:!0})]}),e[40]=a.name,e[41]=ae,e[42]=X):X=e[42];let me;e[43]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx(se,{htmlFor:"email",children:"Email"}),e[43]=me):me=e[43];let le;e[44]!==a?(le=F=>u({...a,email:F.target.value}),e[44]=a,e[45]=le):le=e[45];let oe;e[46]!==a.email||e[47]!==le?(oe=t.jsxs("div",{className:"space-y-2",children:[me,t.jsx(he,{id:"email",type:"email",value:a.email,onChange:le,required:!0})]}),e[46]=a.email,e[47]=le,e[48]=oe):oe=e[48];let ie;e[49]!==i||e[50]!==a?(ie=!i&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(se,{htmlFor:"password",children:"Mot de passe"}),t.jsx(he,{id:"password",type:"password",value:a.password,onChange:F=>u({...a,password:F.target.value}),required:!i})]}),e[49]=i,e[50]=a,e[51]=ie):ie=e[51];let ce;e[52]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(se,{htmlFor:"role",children:"Rôle"}),e[52]=ce):ce=e[52];let de;e[53]!==a?(de=F=>u({...a,role:F}),e[53]=a,e[54]=de):de=e[54];let ge;e[55]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsx(lt,{children:t.jsx(it,{placeholder:"Sélectionner un rôle"})}),e[55]=ge):ge=e[55];let Z;e[56]!==l?(Z=l&&t.jsx(ke,{value:"manager",children:"Manager"}),e[56]=l,e[57]=Z):Z=e[57];let ue,je;e[58]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx(ke,{value:"cashier",children:"Caissier"}),je=t.jsx(ke,{value:"client",children:"Client"}),e[58]=ue,e[59]=je):(ue=e[58],je=e[59]);let re;e[60]!==Z?(re=t.jsxs(rt,{children:[Z,ue,je]}),e[60]=Z,e[61]=re):re=e[61];let ee;e[62]!==a.role||e[63]!==de||e[64]!==re?(ee=t.jsxs("div",{className:"space-y-2",children:[ce,t.jsxs(at,{value:a.role,onValueChange:de,disabled:!1,children:[ge,re]})]}),e[62]=a.role,e[63]=de,e[64]=re,e[65]=ee):ee=e[65];let n;e[66]!==v||e[67]!==a||e[68]!==l?(n=l&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(se,{className:"text-[10px] font-black tracking-widest text-slate-400 uppercase",children:"Assigner aux Boutiques"}),t.jsx("div",{className:"grid max-h-32 grid-cols-2 gap-2 overflow-y-auto rounded-lg border p-1",children:v?.map(F=>t.jsxs("div",{onClick:()=>{const Fe=a.shop_ids||[],qe=Fe.includes(F.id)?Fe.filter(Ae=>Ae!==F.id):[...Fe,F.id];u({...a,shop_ids:qe})},className:`flex cursor-pointer items-center gap-2 rounded-md border p-2 transition-colors ${a.shop_ids?.includes(F.id)?"border-indigo-200 bg-indigo-50":"bg-white hover:bg-slate-50"}`,children:[t.jsx("div",{className:`h-3 w-3 rounded-sm border ${a.shop_ids?.includes(F.id)?"border-indigo-600 bg-indigo-600":"border-slate-300"}`}),t.jsx("span",{className:"text-xs font-bold",children:F.name})]},F.id))})]}),e[66]=v,e[67]=a,e[68]=l,e[69]=n):n=e[69];let G;e[70]!==i||e[71]!==a?(G=i&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"is_active",checked:a.is_active,onChange:F=>u({...a,is_active:F.target.checked}),className:"h-4 w-4 rounded border-gray-300"}),t.jsx(se,{htmlFor:"is_active",children:"Compte actif"})]}),e[70]=i,e[71]=a,e[72]=G):G=e[72];let te;e[73]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx($,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Annuler"}),e[73]=te):te=e[73];const Ce=p.isPending||C.isPending,De=p.isPending||C.isPending?"Enregistrement...":"Enregistrer";let ve;e[74]!==Ce||e[75]!==De?(ve=t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[te,t.jsx($,{type:"submit",className:"bg-[#1f61e4] hover:bg-[#1f61e4]/90",disabled:Ce,children:De})]}),e[74]=Ce,e[75]=De,e[76]=ve):ve=e[76];let Ne;e[77]!==y||e[78]!==X||e[79]!==oe||e[80]!==ie||e[81]!==ee||e[82]!==n||e[83]!==G||e[84]!==ve?(Ne=t.jsxs("form",{onSubmit:y,className:"space-y-4",children:[X,oe,ie,ee,n,G,ve]}),e[77]=y,e[78]=X,e[79]=oe,e[80]=ie,e[81]=ee,e[82]=n,e[83]=G,e[84]=ve,e[85]=Ne):Ne=e[85];let we;e[86]!==H||e[87]!==Ne?(we=t.jsxs(Lt,{children:[H,Ne]}),e[86]=H,e[87]=Ne,e[88]=we):we=e[88];let fe;e[89]!==r||e[90]!==we?(fe=t.jsx(Pt,{open:r,onOpenChange:o,children:we}),e[89]=r,e[90]=we,e[91]=fe):fe=e[91];let ye;return e[92]!==z||e[93]!==g||e[94]!==fe?(ye=t.jsxs("div",{className:"space-y-6",children:[z,g,fe]}),e[92]=z,e[93]=g,e[94]=fe,e[95]=ye):ye=e[95],ye}function oa(e){return t.jsx(Ye,{variant:"outline",className:"py-0 text-[10px]",children:e.name},e.id)}function ca(e){switch(e){case"manager":return t.jsxs(Ye,{className:"bg-purple-500 hover:bg-purple-600",children:[t.jsx(gt,{className:"mr-1 h-3 w-3"})," Manager"]});case"cashier":return t.jsxs(Ye,{className:"bg-pink-500 hover:bg-pink-600",children:[t.jsx(Ds,{className:"mr-1 h-3 w-3"})," Caissier"]});case"client":return t.jsxs(Ye,{className:"bg-cyan-500 hover:bg-cyan-600",children:[t.jsx(Rt,{className:"mr-1 h-3 w-3"})," Client"]});default:return t.jsx(Ye,{variant:"secondary",children:e})}}function da(e){Y.error(e.message||"Erreur lors de la suppression")}function xa(e){return J.entities.User.delete(e)}function ma(e){Y.error(e.message||"Erreur lors de la mise à jour")}function ha(e){const{id:s,data:l}=e;return J.entities.User.update(s,l)}function ua(e){Y.error(e.message||"Erreur lors de la création")}function ll(){const e=Se.c(119),{auth:s}=jt().props,r=s.user?.role==="super-admin",o=Ze(),[i,d]=Q.useState(r?"shops":"overview");let h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h={queryKey:["all-clients"],queryFn:wa,refetchInterval:3e4},e[0]=h):h=e[0];const{data:c,isLoading:M}=_e(h);let f;e[1]!==c?(f=c===void 0?[]:c,e[1]=c,e[2]=f):f=e[2];const a=f;let u;e[3]===Symbol.for("react.memo_cache_sentinel")?(u={queryKey:["all-transactions"],queryFn:Na,refetchInterval:3e4},e[3]=u):u=e[3];const{data:j,isLoading:_}=_e(u);let v;e[4]!==j?(v=j===void 0?[]:j,e[4]=j,e[5]=v):v=e[5];const S=v;let x,D,N,p;if(e[6]!==a||e[7]!==S){const Me=W().startOf("day");D=a.filter(mt=>W(mt.created_date).isSameOrAfter(Me));const xt=S.filter(mt=>W(mt.created_date).isSameOrAfter(Me));p=xt.filter(va).reduce(ja,0),N=xt.filter(ba).reduce(fa,0),x=xt.reduce(ga,0),e[6]=a,e[7]=S,e[8]=x,e[9]=D,e[10]=N,e[11]=p}else x=e[8],D=e[9],N=e[10],p=e[11];const w=x,C=D.length;let b;e[12]!==a?(b=a.filter(pa),e[12]=a,e[13]=b):b=e[13];let A;e[14]!==b.length||e[15]!==D.length||e[16]!==w||e[17]!==N||e[18]!==p?(A={todayClients:C,waiting:b.length,volumeUSD:p,volumeCDF:N,commissions:w},e[14]=b.length,e[15]=D.length,e[16]=w,e[17]=N,e[18]=p,e[19]=A):A=e[19];const m=A;let y;e[20]!==o?(y=()=>{o.invalidateQueries({queryKey:["all-clients"]}),o.invalidateQueries({queryKey:["all-transactions"]}),Y.success("Tableau de bord actualisé")},e[20]=o,e[21]=y):y=e[21];const R=y;let E;e[22]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsx(Yt,{title:"Manager"}),e[22]=E):E=e[22];let k;e[23]===Symbol.for("react.memo_cache_sentinel")?(k={scale:1.02},e[23]=k):k=e[23];let q,T;e[24]===Symbol.for("react.memo_cache_sentinel")?(q=t.jsx(be.div,{whileHover:k,className:"relative flex h-16 w-38 items-center justify-center px-4",children:t.jsx("img",{src:"/logo-color.png",alt:"Havifin",className:"h-full w-full object-contain"})}),T=t.jsx("div",{className:"h-10 w-[1px] bg-slate-100"}),e[24]=q,e[25]=T):(q=e[24],T=e[25]);let L;e[26]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("h1",{className:"text-2xl font-black tracking-tight text-slate-900 uppercase",children:["Console"," ",t.jsx("span",{className:"text-indigo-600",children:"Manager"})]}),t.jsx("span",{className:"rounded-full border border-emerald-500/20 bg-emerald-500/10 px-3 py-1 text-[10px] font-black tracking-widest text-emerald-600 uppercase",children:"Live"})]}),e[26]=L):L=e[26];const U=s.user.shop||"Supervision & Reporting";let I;e[27]!==s.user.role||e[28]!==U?(I=t.jsxs("div",{className:"flex items-center gap-6",children:[q,T,t.jsxs("div",{children:[L,t.jsxs("p",{className:"mt-1 flex items-center gap-2 text-[10px] font-black tracking-[0.15em] text-slate-400 uppercase",children:[s.user.role," •"," ",U]})]})]}),e[27]=s.user.role,e[28]=U,e[29]=I):I=e[29];const B=(M||_)&&"animate-spin";let z;e[30]!==B?(z=V("h-5 w-5",B),e[30]=B,e[31]=z):z=e[31];let O;e[32]!==z?(O=t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl border border-slate-100 bg-white text-slate-400 shadow-sm",children:t.jsx(Je,{className:z})}),e[32]=z,e[33]=O):O=e[33];let K;e[34]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsxs("div",{children:[t.jsx("div",{className:"text-[10px] font-black tracking-wider text-slate-400 uppercase",children:"Dernier Sync"}),t.jsx("div",{className:"text-xs font-bold text-slate-600",children:"A l'instant"})]}),e[34]=K):K=e[34];let g;e[35]!==O?(g=t.jsxs("div",{className:"hidden items-center gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-1.5 pr-5 xl:flex",children:[O,K]}),e[35]=O,e[36]=g):g=e[36];let P;e[37]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx(Je,{className:"mr-2 h-4 w-4"}),e[37]=P):P=e[37];let H;e[38]!==R?(H=t.jsxs($,{variant:"outline",onClick:R,className:"h-12 rounded-2xl border-slate-200 bg-white px-6 text-xs font-black tracking-widest uppercase shadow-sm transition-all hover:border-indigo-500 hover:text-indigo-600",children:[P,"Actualiser"]}),e[38]=R,e[39]=H):H=e[39];let ne;e[40]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsxs($,{className:"h-12 rounded-2xl bg-slate-900 px-6 text-xs font-black tracking-widest text-white uppercase shadow-xl shadow-slate-900/10 transition-all hover:bg-black active:scale-95",children:[t.jsx(gs,{className:"mr-2 h-4 w-4 text-emerald-400"}),"Exporter Rapport"]}),e[40]=ne):ne=e[40];let ae;e[41]!==g||e[42]!==H?(ae=t.jsxs("div",{className:"flex items-center gap-4",children:[g,H,ne]}),e[41]=g,e[42]=H,e[43]=ae):ae=e[43];let X;e[44]!==I||e[45]!==ae?(X=t.jsxs("header",{className:"z-20 flex h-24 flex-shrink-0 items-center justify-between border-b border-slate-200 bg-white px-10 shadow-[0_1px_3px_rgba(0,0,0,0.02)]",children:[I,ae]}),e[44]=I,e[45]=ae,e[46]=X):X=e[46];const me=`${m.waiting} en attente`;let le;e[47]!==m.todayClients||e[48]!==me?(le=t.jsx(st,{title:"Clients Aujourd'hui",value:m.todayClients,subtitle:me,icon:nt,color:"blue"}),e[47]=m.todayClients,e[48]=me,e[49]=le):le=e[49];let oe;e[50]!==m.volumeUSD?(oe=m.volumeUSD.toLocaleString(),e[50]=m.volumeUSD,e[51]=oe):oe=e[51];const ie=`$ ${oe}`;let ce;e[52]!==ie?(ce=t.jsx(st,{title:"Volume USD",value:ie,icon:Be,color:"emerald"}),e[52]=ie,e[53]=ce):ce=e[53];let de;e[54]!==m.volumeCDF?(de=m.volumeCDF.toLocaleString(),e[54]=m.volumeCDF,e[55]=de):de=e[55];const ge=`${de} FC`;let Z;e[56]!==ge?(Z=t.jsx(st,{title:"Volume CDF",value:ge,icon:Qe,color:"amber"}),e[56]=ge,e[57]=Z):Z=e[57];let ue;e[58]!==m.commissions?(ue=m.commissions.toLocaleString(),e[58]=m.commissions,e[59]=ue):ue=e[59];const je=`$ ${ue}`;let re;e[60]!==je?(re=t.jsx(st,{title:"Commissions Estimées",value:je,icon:Mt,color:"indigo"}),e[60]=je,e[61]=re):re=e[61];let ee;e[62]!==le||e[63]!==ce||e[64]!==Z||e[65]!==re?(ee=t.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:[le,ce,Z,re]}),e[62]=le,e[63]=ce,e[64]=Z,e[65]=re,e[66]=ee):ee=e[66];let n;e[67]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx("h3",{className:"mb-6 px-2 text-[11px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Navigation"}),e[67]=n):n=e[67];let G,te,Ce,De,ve,Ne,we;e[68]===Symbol.for("react.memo_cache_sentinel")?(G={id:"overview",label:"Vue d'ensemble",icon:_t},te={id:"transactions",label:"Flux Transactions",icon:Kt},Ce={id:"rates",label:"Gestion Taux",icon:bt},De={id:"users",label:"Utilisateurs",icon:nt},ve={id:"institutions",label:"Banques & Partenaires",icon:Qe},Ne={id:"logs",label:"Journal Activité",icon:Ft},we={id:"sessions",label:"Gestion Sessions",icon:dt},e[68]=G,e[69]=te,e[70]=Ce,e[71]=De,e[72]=ve,e[73]=Ne,e[74]=we):(G=e[68],te=e[69],Ce=e[70],De=e[71],ve=e[72],Ne=e[73],we=e[74]);let fe;e[75]!==r?(fe=[G,te,Ce,De,ve,Ne,we,...r?[{id:"shops",label:"Gestion Boutiques",icon:vt}]:[]],e[75]=r,e[76]=fe):fe=e[76];let ye;e[77]!==i||e[78]!==fe?(ye=t.jsxs("div",{className:"rounded-[2rem] border border-white bg-white/50 p-6 shadow-sm backdrop-blur-xl",children:[n,t.jsx("nav",{className:"space-y-2",children:fe.map(Me=>t.jsxs("button",{onClick:()=>d(Me.id),className:V("flex w-full items-center justify-between rounded-2xl border p-4 text-sm font-bold transition-all duration-300",i===Me.id?"border-indigo-600 bg-indigo-600 text-white shadow-lg shadow-indigo-600/20":"border-slate-100 bg-white/40 text-slate-500 hover:border-slate-200 hover:bg-white"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Me.icon,{className:V("h-5 w-5",i===Me.id?"text-white":"text-slate-400")}),Me.label]}),t.jsx(Et,{className:V("h-4 w-4 transition-transform",i===Me.id?"translate-x-1":"opacity-0")})]},Me.id))})]}),e[77]=i,e[78]=fe,e[79]=ye):ye=e[79];let F;e[80]===Symbol.for("react.memo_cache_sentinel")?(F=t.jsxs("div",{className:"group relative overflow-hidden rounded-[2rem] bg-slate-900 p-8 text-white shadow-2xl",children:[t.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-1/2 -translate-y-1/2 bg-indigo-500/20 blur-[80px]"}),t.jsx("h4",{className:"relative z-10 mb-2 text-xl font-black",children:"Besoin d'aide ?"}),t.jsx("p",{className:"relative z-10 mb-6 text-xs font-medium text-slate-400",children:"Consultez la documentation technique du bureau de change."}),t.jsx($,{className:"relative z-10 w-full rounded-xl bg-white text-[10px] font-black tracking-widest text-slate-900 uppercase hover:bg-slate-100",children:"Guide Manager"})]}),e[80]=F):F=e[80];let Fe;e[81]!==ye?(Fe=t.jsxs("div",{className:"col-span-12 space-y-4 lg:col-span-3",children:[ye,F]}),e[81]=ye,e[82]=Fe):Fe=e[82];let qe;e[83]!==i||e[84]!==S?(qe=i==="overview"&&t.jsxs("div",{className:"animate-in space-y-8 duration-500 fade-in slide-in-from-bottom-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-2xl font-black tracking-tight text-slate-800",children:"Performances du Jour"}),t.jsx("p",{className:"text-sm font-medium text-slate-400",children:"Aperçu rapide des flux financiers et des clients."})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("span",{className:"rounded-xl border border-indigo-100 bg-indigo-50 px-4 py-2 text-xs font-black tracking-wider text-indigo-600 uppercase",children:"Hebdomadaire"}),t.jsx("span",{className:"cursor-pointer rounded-xl border border-slate-100 bg-white px-4 py-2 text-xs font-black tracking-wider text-slate-400 uppercase hover:bg-slate-50",children:"Mensuel"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[t.jsxs("div",{className:"flex h-64 flex-col items-center justify-center rounded-3xl border border-slate-100 bg-slate-50 p-8 opacity-50",children:[t.jsx(Mt,{className:"mb-4 h-16 w-16 text-slate-300"}),t.jsx("p",{className:"text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:"Graphique des Flux (Soon)"})]}),t.jsxs("div",{className:"flex h-64 flex-col items-center justify-center rounded-3xl border border-slate-100 bg-slate-50 p-8 opacity-50",children:[t.jsx(_t,{className:"mb-4 h-16 w-16 text-slate-300"}),t.jsx("p",{className:"text-xs font-black tracking-[0.2em] text-slate-400 uppercase",children:"Volume par Guichet (Soon)"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsx("h4",{className:"text-lg font-black tracking-tight text-slate-800",children:"Activités Récentes"}),t.jsx($,{variant:"ghost",className:"font-bold text-indigo-600 hover:bg-indigo-50",children:"Voir tout"})]}),t.jsx(At,{transactions:S.slice(0,5)})]})]}),e[83]=i,e[84]=S,e[85]=qe):qe=e[85];let Ae;e[86]!==i||e[87]!==S?(Ae=i==="transactions"&&t.jsxs("div",{className:"animate-in space-y-6 duration-300 fade-in",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsx("h3",{className:"text-2xl font-black tracking-tight text-slate-800",children:"Journal Complet"}),t.jsxs("div",{className:"relative w-72",children:[t.jsx(ft,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-slate-400"}),t.jsx("input",{placeholder:"Filtrer...",className:"h-10 w-full rounded-xl border-slate-200 pr-4 pl-10 text-sm focus:ring-indigo-500"})]})]}),t.jsx(At,{transactions:S})]}),e[86]=i,e[87]=S,e[88]=Ae):Ae=e[88];let $e;e[89]!==i?($e=i==="rates"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx(Ks,{})}),e[89]=i,e[90]=$e):$e=e[90];let Ee;e[91]!==i?(Ee=i==="institutions"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx(qs,{})}),e[91]=i,e[92]=Ee):Ee=e[92];let Ue;e[93]!==i?(Ue=i==="users"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx(na,{})}),e[93]=i,e[94]=Ue):Ue=e[94];let Te;e[95]!==i?(Te=i==="shops"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx(as,{})}),e[95]=i,e[96]=Te):Te=e[96];let Ie;e[97]!==i?(Ie=i==="sessions"&&t.jsx("div",{className:"animate-in duration-300 fade-in",children:t.jsx(ea,{})}),e[97]=i,e[98]=Ie):Ie=e[98];let Le;e[99]!==i?(Le=i==="logs"&&t.jsxs("div",{className:"flex h-96 animate-in flex-col items-center justify-center space-y-4 opacity-40 duration-300 zoom-in-95",children:[t.jsx(Ft,{className:"h-20 w-20 text-slate-200"}),t.jsx("p",{className:"text-xs font-black tracking-[0.3em] text-slate-400 uppercase",children:"Journal d'audit Manager bientôt disponible"})]}),e[99]=i,e[100]=Le):Le=e[100];let Pe;e[101]!==qe||e[102]!==Ae||e[103]!==$e||e[104]!==Ee||e[105]!==Ue||e[106]!==Te||e[107]!==Ie||e[108]!==Le?(Pe=t.jsx("div",{className:"col-span-12 lg:col-span-9",children:t.jsx("div",{className:"min-h-[600px] overflow-hidden rounded-[2.5rem] border border-white bg-white/80 shadow-xl shadow-slate-200/50 backdrop-blur-xl",children:t.jsxs("div",{className:"p-10",children:[qe,Ae,$e,Ee,Ue,Te,Ie,Le]})})}),e[101]=qe,e[102]=Ae,e[103]=$e,e[104]=Ee,e[105]=Ue,e[106]=Te,e[107]=Ie,e[108]=Le,e[109]=Pe):Pe=e[109];let ze;e[110]!==Fe||e[111]!==Pe?(ze=t.jsxs("div",{className:"grid grid-cols-12 gap-8",children:[Fe,Pe]}),e[110]=Fe,e[111]=Pe,e[112]=ze):ze=e[112];let He;e[113]!==ee||e[114]!==ze?(He=t.jsx("main",{className:"flex-1 overflow-y-auto bg-[url('/grid.svg')] bg-[length:40px_40px] px-10 py-10",children:t.jsxs("div",{className:"w-full max-w-none space-y-10",children:[ee,ze]})}),e[113]=ee,e[114]=ze,e[115]=He):He=e[115];let et;return e[116]!==X||e[117]!==He?(et=t.jsxs(Bt,{currentPageName:"Manager",children:[E,t.jsxs("div",{className:"flex flex-col overflow-hidden bg-[#f8fafc]",children:[X,He]})]}),e[116]=X,e[117]=He,e[118]=et):et=e[118],et}function pa(e){return e.status==="waiting"}function ga(e,s){return e+(parseFloat(s.commission)||0)}function fa(e,s){return e+(s.amount_from||0)}function ba(e){return e.currency_from==="CDF"}function ja(e,s){return e+(s.amount_from||0)}function va(e){return e.currency_from==="USD"}function Na(){return J.entities.Transaction.list("-created_date",500)}function wa(){return J.entities.Client.list("-created_date",500)}export{ll as default};
