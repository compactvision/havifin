import{c as E,r as C,j as t,R as oe,a as ce}from"./app-CsNlkN5W.js";import{A as q,u as de,b as T}from"./base44Client-DfWbQB5Z.js";import{B as I}from"./button-CG5C5VAf.js";import{L as M,I as P}from"./label-ufZEIcyJ.js";import{c as K,m as y,b as A}from"./createLucideIcon-C-xKprhZ.js";import{P as Z}from"./plus-CENF9pi0.js";import{L as U}from"./loader-circle-DoFH-E_7.js";import{P as G,b as he,a as me,C as ue}from"./phone-B5vJiqmH.js";import{C as xe,u as Q}from"./check-B2a5Rz3B.js";import{A as pe,a as be,C as fe,R as ge}from"./refresh-cw-GGI1878y.js";import{S as ee}from"./smartphone-DjPV4nK0.js";import{B as te}from"./building-2-MGr0Ad0j.js";import{L as ye}from"./landmark-Bgt2FOBC.js";import{A as ve}from"./app-main-Brs8XROE.js";import{A as W}from"./arrow-right-CgAgPXpD.js";import{S as je}from"./search-Do1WbJcx.js";/* empty css            */const we=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Y=K("ChevronLeft",we);const Ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],_e=K("Globe",Ne);const ke=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],Ce=K("Ticket",ke);function Se(S){const e=E.c(20),{phones:f,selectedPhone:d,onSelect:m,onAdd:p,isAdding:i}=S,n=i===void 0?!1:i,[r,l]=C.useState(!1),[o,N]=C.useState("");let j;e[0]!==o||e[1]!==p?(j=async()=>{o.length===10&&(await p(o),l(!1),N(""))},e[0]=o,e[1]=p,e[2]=j):j=e[2];const _=j;let u;if(e[3]!==m||e[4]!==f||e[5]!==d){let x;e[7]!==m||e[8]!==d?(x=k=>t.jsxs(y.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>m(k.phone_number),className:A("relative flex items-center gap-4 overflow-hidden rounded-2xl border-2 p-4 transition-all duration-200",d===k.phone_number?"border-blue-500 bg-blue-50/50 shadow-md":"border-slate-100 bg-white hover:border-slate-200"),children:[t.jsx("div",{className:A("flex h-10 w-10 items-center justify-center rounded-xl",d===k.phone_number?"bg-blue-500 text-white":"bg-slate-100 text-slate-400"),children:t.jsx(G,{className:"h-5 w-5"})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("span",{className:A("block text-lg font-bold",d===k.phone_number?"text-blue-700":"text-slate-700"),children:k.phone_number}),k.is_primary&&t.jsx("span",{className:"rounded-full bg-blue-100 px-2 py-0.5 text-[10px] font-black tracking-wider text-blue-500/60 uppercase",children:"Principal"})]}),d===k.phone_number&&t.jsx(y.div,{initial:{scale:0},animate:{scale:1},className:"flex h-6 w-6 items-center justify-center rounded-full bg-blue-500 text-white",children:t.jsx(xe,{className:"h-4 w-4"})})]},k.id),e[7]=m,e[8]=d,e[9]=x):x=e[9],u=f.map(x),e[3]=m,e[4]=f,e[5]=d,e[6]=u}else u=e[6];let h;e[10]!==u?(h=t.jsx("div",{className:"grid grid-cols-1 gap-3",children:u}),e[10]=u,e[11]=h):h=e[11];let v;e[12]!==_||e[13]!==n||e[14]!==r||e[15]!==o?(v=t.jsx(q,{children:r?t.jsxs(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"space-y-3 rounded-2xl border-2 border-blue-100 bg-blue-50/30 p-4",children:[t.jsx(M,{className:"mb-1 block font-bold text-blue-700",children:"Nouveau numéro"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(P,{type:"tel",inputMode:"numeric",pattern:"[0-9]*",value:o,onChange:x=>N(x.target.value.replace(/\D/g,"").slice(0,10)),placeholder:"0XXXXXXXXX",className:"h-12 rounded-xl bg-white focus:border-blue-500 focus:ring-blue-500",autoFocus:!0}),t.jsx(I,{onClick:_,disabled:o.length<10||n,className:"h-12 rounded-xl bg-blue-600 px-6 text-white hover:bg-blue-700",children:n?t.jsx(U,{className:"h-5 w-5 animate-spin"}):t.jsx(Z,{className:"h-5 w-5"})})]}),t.jsx(I,{variant:"ghost",size:"sm",onClick:()=>l(!1),className:"w-full text-slate-500 hover:text-red-500",children:"Annuler"})]}):t.jsxs(y.button,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>l(!0),className:"flex w-full items-center justify-center gap-2 rounded-2xl border-2 border-dashed border-slate-200 p-4 font-bold text-slate-400 transition-all hover:border-blue-300 hover:bg-blue-50/30 hover:text-blue-500",children:[t.jsx(Z,{className:"h-5 w-5"}),"Ajouter un nouveau numéro"]})}),e[12]=_,e[13]=n,e[14]=r,e[15]=o,e[16]=v):v=e[16];let c;return e[17]!==h||e[18]!==v?(c=t.jsxs("div",{className:"space-y-4",children:[h,v]}),e[17]=h,e[18]=v,e[19]=c):c=e[19],c}const Ae=[{id:"change",name:"Change Devises",icon:pe,description:"USD ↔ CDF au meilleur taux",color:"from-amber-400 to-orange-500",hover:"shadow-orange-200"},{id:"depot",name:"Dépôt Cash",icon:he,description:"Alimentez vos comptes",color:"from-green-400 to-emerald-600",hover:"shadow-green-200"},{id:"retrait",name:"Retrait Cash",icon:me,description:"Retirez vos fonds",color:"from-blue-400 to-indigo-600",hover:"shadow-blue-200"},{id:"paiement",name:"Paiement",icon:ue,description:"Payez vos factures et services",color:"from-purple-400 to-pink-600",hover:"shadow-purple-200"}];function Pe(S){const e=E.c(5),{selectedOperation:f,onSelect:d}=S;let m;e[0]!==d||e[1]!==f?(m=Ae.map(i=>{const n=i.icon,r=f===i.id;return t.jsxs(y.button,{whileHover:{scale:1.05,y:-5},whileTap:{scale:.95},onClick:()=>d(i.id),className:A("group relative overflow-hidden rounded-[40px] border-4 p-8 text-center transition-all duration-300",r?"border-blue-500 bg-white shadow-2xl shadow-blue-500/20":"border-slate-50 bg-slate-50/50 hover:border-slate-200 hover:bg-white hover:shadow-xl"),children:[t.jsx("div",{className:A("absolute -top-12 -right-12 h-24 w-24 rounded-full blur-[40px] transition-opacity",r?"opacity-20":"opacity-0 group-hover:opacity-10",i.color.replace("from-","bg-"))}),t.jsx("div",{className:A("mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-[28px] bg-gradient-to-br shadow-lg transition-transform group-hover:rotate-6",i.color,r?"scale-110":""),children:t.jsx(n,{className:"h-10 w-10 text-white"})}),t.jsx("h3",{className:A("mb-2 text-xl font-black transition-colors",r?"text-slate-900":"text-slate-700"),children:i.name}),t.jsx("p",{className:"text-sm font-medium text-slate-400 group-hover:text-slate-500",children:i.description}),r&&t.jsx(y.div,{layoutId:"op-indicator",className:"absolute bottom-4 left-1/2 h-2 w-12 -translate-x-1/2 rounded-full bg-blue-500"})]},i.id)}),e[0]=d,e[1]=f,e[2]=m):m=e[2];let p;return e[3]!==m?(p=t.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-4",children:m}),e[3]=m,e[4]=p):p=e[4],p}function Me(S){const e=E.c(24),{institutions:f,selectedId:d,onSelect:m,type:p}=S;let i,n,r,l;if(e[0]!==f||e[1]!==m||e[2]!==d||e[3]!==p){let j;e[8]!==p?(j=x=>x.type===p,e[8]=p,e[9]=j):j=e[9];const _=f.filter(j),u=p==="mobile_money"?ee:te;r="space-y-4";let h;e[10]!==u?(h=t.jsx(u,{className:"h-5 w-5 text-blue-500"}),e[10]=u,e[11]=h):h=e[11];const v=p==="mobile_money"?"Opérateurs Mobile":"Banques";let c;e[12]!==v?(c=t.jsx("h3",{className:"text-lg font-bold text-slate-800",children:v}),e[12]=v,e[13]=c):c=e[13],e[14]!==h||e[15]!==c?(l=t.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[h,c]}),e[14]=h,e[15]=c,e[16]=l):l=e[16],i="grid grid-cols-2 gap-4 md:grid-cols-4",n=_.length>0?_.map(x=>t.jsxs(y.button,{whileHover:{scale:1.03,y:-2},whileTap:{scale:.97},onClick:()=>m(x.id),className:A("relative flex flex-col items-center justify-center rounded-[32px] border-2 p-6 transition-all duration-300",d===x.id?"border-blue-500 bg-white shadow-xl ring-4 shadow-blue-500/10 ring-blue-50":"border-slate-100 bg-slate-50/50 hover:border-slate-200 hover:bg-white"),children:[t.jsx("div",{className:A("mb-4 flex h-16 w-16 items-center justify-center rounded-2xl shadow-inner transition-colors",d===x.id?"bg-blue-50":"bg-white"),children:x.logo_url?t.jsx("img",{src:x.logo_url,alt:x.name,className:"h-10 w-10 object-contain"}):t.jsx(ye,{className:A("h-8 w-8",d===x.id?"text-blue-500":"text-slate-300")})}),t.jsx("span",{className:A("text-center text-sm font-black tracking-tight",d===x.id?"text-blue-700":"text-slate-600"),children:x.name}),d===x.id&&t.jsx(y.div,{layoutId:"active-indicator",className:"absolute -top-1 -right-1 h-6 w-6 rounded-full border-4 border-white bg-blue-500 shadow-sm"})]},x.id)):t.jsxs("div",{className:"col-span-full py-12 text-center",children:[t.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-slate-100 text-slate-300",children:t.jsx(u,{className:"h-8 w-8"})}),t.jsx("p",{className:"text-sm font-bold tracking-widest text-slate-400 uppercase",children:"Aucun partenaire disponible"})]}),e[0]=f,e[1]=m,e[2]=d,e[3]=p,e[4]=i,e[5]=n,e[6]=r,e[7]=l}else i=e[4],n=e[5],r=e[6],l=e[7];let o;e[17]!==i||e[18]!==n?(o=t.jsx("div",{className:i,children:n}),e[17]=i,e[18]=n,e[19]=o):o=e[19];let N;return e[20]!==r||e[21]!==l||e[22]!==o?(N=t.jsxs("div",{className:r,children:[l,o]}),e[20]=r,e[21]=l,e[22]=o,e[23]=N):N=e[23],N}const ze=[{id:"mobile_money",name:"Mobile Money",icon:ee,color:"text-emerald-500"},{id:"bank",name:"Banques",icon:te,color:"text-blue-500"},{id:"other",name:"Autres",icon:_e,color:"text-amber-500"}];function Re(S){const e=E.c(20),{institutions:f,selectedId:d,onSelect:m,isLoading:p}=S,[i,n]=oe.useState("mobile_money");if(p){let c;return e[0]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[t.jsx("div",{className:"mb-4 h-12 w-12 animate-spin rounded-full border-4 border-slate-200 border-t-indigo-600"}),t.jsx("p",{className:"text-sm font-bold tracking-widest text-slate-400 uppercase",children:"Récupération des partenaires..."})]}),e[0]=c):c=e[0],c}let r;e[1]!==i?(r=ze.map(c=>t.jsxs("button",{onClick:()=>n(c.id),className:A("flex flex-1 items-center justify-center gap-2 rounded-[18px] px-4 py-4 text-sm font-bold transition-all",i===c.id?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"),children:[t.jsx(c.icon,{className:A("h-5 w-5",i===c.id?c.color:"text-slate-400")}),c.name]},c.id)),e[1]=i,e[2]=r):r=e[2];let l;e[3]!==r?(l=t.jsx("div",{className:"flex gap-2 rounded-[24px] bg-slate-100 p-1.5",children:r}),e[3]=r,e[4]=l):l=e[4];let o,N,j,_;e[5]===Symbol.for("react.memo_cache_sentinel")?(o={opacity:0,x:20},N={opacity:1,x:0},j={opacity:0,x:-20},_={duration:.2},e[5]=o,e[6]=N,e[7]=j,e[8]=_):(o=e[5],N=e[6],j=e[7],_=e[8]);let u;e[9]!==i||e[10]!==f||e[11]!==m||e[12]!==d?(u=t.jsx(Me,{institutions:f,selectedId:d,onSelect:m,type:i}),e[9]=i,e[10]=f,e[11]=m,e[12]=d,e[13]=u):u=e[13];let h;e[14]!==i||e[15]!==u?(h=t.jsx(q,{mode:"wait",children:t.jsx(y.div,{initial:o,animate:N,exit:j,transition:_,children:u},i)}),e[14]=i,e[15]=u,e[16]=h):h=e[16];let v;return e[17]!==l||e[18]!==h?(v=t.jsxs("div",{className:"space-y-8",children:[l,h]}),e[17]=l,e[18]=h,e[19]=v):v=e[19],v}function Ie(S){const e=E.c(29),{ticketNumber:f,onNewTicket:d}=S;let m,p;e[0]===Symbol.for("react.memo_cache_sentinel")?(m={opacity:0,scale:.95},p={opacity:1,scale:1},e[0]=m,e[1]=p):(m=e[0],p=e[1]);let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsx(y.div,{initial:{scale:.8,opacity:0},animate:{scale:1.5,opacity:0},transition:{repeat:1/0,duration:2,ease:"easeOut"},className:"absolute inset-0 rounded-full bg-green-500/20"}),e[2]=i):i=e[2];let n,r,l;e[3]===Symbol.for("react.memo_cache_sentinel")?(n={scale:0},r={scale:1},l={type:"spring",stiffness:200,damping:20},e[3]=n,e[4]=r,e[5]=l):(n=e[3],r=e[4],l=e[5]);let o,N,j;e[6]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsxs("div",{className:"relative mb-12",children:[i,t.jsx(y.div,{initial:n,animate:r,transition:l,className:"relative mx-auto flex h-28 w-28 items-center justify-center rounded-[36px] bg-gradient-to-br from-emerald-400 to-green-600 shadow-2xl shadow-green-500/30",children:t.jsx(be,{className:"h-14 w-14 text-white"})})]}),N=t.jsx("h2",{className:"mb-2 text-4xl font-black tracking-tight text-slate-900",children:"C'est fait !"}),j=t.jsx("p",{className:"mb-10 text-xl font-medium text-slate-500",children:"Votre ticket a été généré avec succès"}),e[6]=o,e[7]=N,e[8]=j):(o=e[6],N=e[7],j=e[8]);let _,u,h;e[9]===Symbol.for("react.memo_cache_sentinel")?(_={y:30,opacity:0},u={y:0,opacity:1},h={delay:.3,type:"spring"},e[9]=_,e[10]=u,e[11]=h):(_=e[9],u=e[10],h=e[11]);let v,c;e[12]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-8 -translate-y-8 rounded-full bg-white/5 blur-2xl transition-transform group-hover:scale-150"}),c=t.jsx("div",{className:"absolute bottom-0 left-0 h-24 w-24 -translate-x-8 translate-y-8 rounded-full bg-blue-500/10 blur-xl"}),e[12]=v,e[13]=c):(v=e[12],c=e[13]);let x;e[14]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsxs("div",{className:"mb-6 flex items-center justify-center gap-3 text-amber-400",children:[t.jsx(Ce,{className:"h-6 w-6 rotate-12"}),t.jsx("span",{className:"text-sm font-black tracking-[0.2em] uppercase",children:"Ticket No."})]}),e[14]=x):x=e[14];let k;e[15]!==f?(k=t.jsx("div",{className:"mb-8 font-mono text-7xl font-black tracking-tighter text-white",children:f}),e[15]=f,e[16]=k):k=e[16];let D;e[17]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/5 bg-white/5 px-4 py-2 text-sm font-bold text-slate-400",children:[t.jsx(fe,{className:"h-4 w-4 text-amber-500"}),t.jsx("span",{children:"Attendez d'être appelé sur l'écran"})]}),e[17]=D):D=e[17];let z;e[18]!==k?(z=t.jsxs(y.div,{initial:_,animate:u,transition:h,className:"group relative mx-auto max-w-sm overflow-hidden rounded-[40px] bg-slate-900 p-10 shadow-2xl",children:[v,c,t.jsxs("div",{className:"relative z-10",children:[x,k,D]})]}),e[18]=k,e[19]=z):z=e[19];let $,L,O;e[20]===Symbol.for("react.memo_cache_sentinel")?($={opacity:0},L={opacity:1},O={delay:.6},e[20]=$,e[21]=L,e[22]=O):($=e[20],L=e[21],O=e[22]);let s;e[23]===Symbol.for("react.memo_cache_sentinel")?(s=t.jsx(ge,{className:"mr-2 h-5 w-5 text-blue-500"}),e[23]=s):s=e[23];let g;e[24]!==d?(g=t.jsx(y.div,{initial:$,animate:L,transition:O,className:"mt-12",children:t.jsxs(I,{onClick:d,className:"h-14 rounded-2xl border-none bg-slate-100 px-10 font-black tracking-tight text-slate-900 shadow-none transition-all hover:scale-105 hover:bg-slate-200 active:scale-95",children:[s,"Nouvelle opération"]})}),e[24]=d,e[25]=g):g=e[25];let B;return e[26]!==z||e[27]!==g?(B=t.jsxs(y.div,{initial:m,animate:p,className:"py-8 text-center",children:[o,N,j,z,g]}),e[26]=z,e[27]=g,e[28]=B):B=e[28],B}const Le=()=>{const S=String.fromCharCode(65+Math.floor(Math.random()*26)),e=String(Math.floor(Math.random()*999)+1).padStart(3,"0");return`${S}${e}`};function We(){const{auth:S}=ce().props,[e,f]=C.useState(1),[d,m]=C.useState(null),[p,i]=C.useState(!1),[n,r]=C.useState(null),[l,o]=C.useState(!1),[N,j]=C.useState(!1),[_,u]=C.useState(!1),[h,v]=C.useState(""),[c,x]=C.useState([]),[k,D]=C.useState(!1),[z,$]=C.useState(!1),{data:L=[],isPending:O}=de({queryKey:["institutions","active"],queryFn:()=>T.entities.Institution.active()}),[s,g]=C.useState({phone:"",operation_type:"",institution_id:void 0,first_name:"",last_name:"",email:"",address:"",amount:"",currency:"USD",reason:"",beneficiary:"",beneficiary_number:"",account_number:""});C.useEffect(()=>{(async()=>{if(s.phone.length===10&&!n&&!l){i(!0);try{const w=await T.entities.Client.verifyPhone(s.phone);w.exists&&w.client?(r(w.client),g(R=>({...R,phone:s.phone})),f(2),o(!1)):(r(null),o(!0))}catch(w){console.error("Phone verification failed:",w)}finally{i(!1)}}})()},[s.phone,n,l]);const B=Q({mutationFn:async()=>(await T.entities.Client.register({phone:s.phone,first_name:s.first_name,last_name:s.last_name,email:s.email,address:s.address})).client,onSuccess:a=>{r(a),o(!1),f(2)}}),V=Q({mutationFn:async a=>n?(await T.entities.Client.addPhone(n.id,a)).phone:void 0,onSuccess:a=>{n&&a&&r({...n,phones:[...n.phones||[],a]})}}),H=Q({mutationFn:async a=>{const w=Le(),R={...a,phone:s.phone,ticket_number:w,status:"waiting",first_name:n?.first_name||a.first_name||"Client",last_name:n?.last_name||a.last_name||"Anonyme",is_registered:!!n&&!N};return await T.entities.Client.create(R),w},onSuccess:a=>{m(a),f(3)}}),se=async()=>{if(!(h.length<2)){D(!0);try{const a=await T.entities.Client.filter({first_name:h});x(a)}catch(a){console.error(a)}finally{D(!1)}}},ae=async a=>{try{await V.mutateAsync(s.phone);const w=await T.entities.Client.addPhone(a.id,s.phone);w.success&&w.phone&&(r({...a,phones:[...a.phones||[],w.phone]}),u(!1),o(!1),f(2))}catch(w){console.error("Failed to link account",w)}},ie=()=>{if(e===1)l?B.mutate():n&&f(2);else if(e===2){if(s.operation_type==="change")H.mutate({...s,service:"bureau"});else if(s.operation_type&&s.institution_id){const a=L.find(w=>w.id===s.institution_id);H.mutate({...s,operation_type:s.operation_type,service:a?.name||"",currency_from:s.currency,amount:s.amount?Number(s.amount):void 0,notes:`Motif: ${s.reason}${s.beneficiary?` | Bénéficiaire: ${s.beneficiary}`:""}${s.beneficiary_number?` | Numéro Bénéficiaire: ${s.beneficiary_number}`:""}${s.account_number?` | Compte: ${s.account_number}`:""}`})}}},J=()=>{f(1),ne()},ne=()=>{m(null),r(null),o(!1),j(!1),u(!1),$(!1),v(""),x([]),g({phone:"",operation_type:"",institution_id:void 0,first_name:"",last_name:"",email:"",address:"",amount:"",currency:"USD",reason:"",beneficiary:"",beneficiary_number:"",account_number:""})},re=()=>{if(e===1)return l?s.first_name.trim()!==""&&s.last_name.trim()!=="":!!n;if(e===2){if(s.operation_type==="change"||s.operation_type==="paiement")return!0;if(!!!(s.operation_type&&s.institution_id))return!1;if(s.operation_type==="depot"){const w=L.find(b=>b.id===s.institution_id),R=!!s.amount,F=w?.settings;if(F?.required_fields){const b=F.required_fields,X=[R];return b.includes("account_number")&&X.push(!!s.account_number),b.includes("beneficiary")&&X.push(!!s.beneficiary),b.includes("beneficiary_number")&&X.push(!!s.beneficiary_number),b.includes("reason")&&X.push(!!s.reason),X.every(Boolean)}return w?.type==="bank"?!!(R&&s.account_number&&s.beneficiary):!!(R&&s.beneficiary&&s.beneficiary_number)}return!0}return!0},le=()=>{switch(e){case 1:return t.jsxs(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"space-y-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"mb-8 flex h-20 w-20 items-center justify-center rounded-[24px] border border-white/20 bg-gradient-to-br from-cyan-400/20 to-purple-500/20 shadow-xl shadow-purple-500/20 backdrop-blur-xl transition-transform group-hover:scale-110",children:t.jsx(G,{className:"h-12 w-12 text-slate-800 transition-transform group-hover:rotate-12"})}),t.jsx("h2",{className:"text-4xl font-black tracking-tight text-slate-800 drop-shadow-sm",children:l?"Nouvelle Inscription":"Bienvenue chez Havifin"}),t.jsx("p",{className:"mt-3 text-lg font-bold tracking-[0.2em] text-blue-600 uppercase",children:S.user?.shop}),t.jsx("p",{className:"mt-2 text-lg font-medium text-slate-600",children:l?"Laissez-nous faire connaissance pour mieux vous servir":"Identifiez-vous pour commencer votre opération"})]}),t.jsxs("div",{className:"mx-auto max-w-lg space-y-6",children:[!n&&!l&&t.jsxs("div",{className:"group relative",children:[t.jsx("div",{className:"absolute -inset-1 rounded-[28px] bg-gradient-to-r from-cyan-400/40 via-purple-500/40 to-pink-500/40 opacity-60 blur-xl transition duration-1000 group-hover:opacity-100 group-hover:duration-200"}),t.jsx(P,{type:"tel",inputMode:"numeric",pattern:"[0-9]*",value:s.phone,onChange:a=>g({...s,phone:a.target.value.replace(/\D/g,"").slice(0,10)}),placeholder:"Entrez votre numéro (10 chiffres)",className:"relative h-20 rounded-[24px] border-2 border-white/30 bg-white/40 text-center font-mono text-2xl font-black text-slate-900 shadow-2xl shadow-purple-500/20 backdrop-blur-2xl transition-all placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30",autoFocus:!0,disabled:p}),p&&t.jsx("div",{className:"absolute top-1/2 right-6 -translate-y-1/2",children:t.jsx(U,{className:"h-6 w-6 animate-spin text-cyan-300"})})]}),_&&t.jsx(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"pt-6",children:t.jsxs("div",{className:"space-y-6 rounded-[32px] border border-white/20 bg-white/60 p-8 shadow-xl backdrop-blur-xl",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-xl font-black text-slate-800",children:"Lier à un compte existant"}),t.jsx("p",{className:"text-sm text-slate-500",children:"Recherchez le client propriétaire de ce numéro"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(P,{placeholder:"Rechercher par nom...",value:h,onChange:a=>v(a.target.value),className:"h-12 rounded-xl bg-white"}),t.jsx(I,{onClick:se,disabled:k,className:"h-12 rounded-xl bg-cyan-600 text-white hover:bg-cyan-700",children:k?t.jsx(U,{className:"h-4 w-4 animate-spin"}):t.jsx(je,{className:"h-4 w-4"})})]}),t.jsx("div",{className:"max-h-60 space-y-2 overflow-y-auto",children:c.map(a=>t.jsxs("div",{onClick:()=>ae(a),className:"flex cursor-pointer items-center justify-between rounded-xl border border-slate-100 bg-white p-4 transition-colors hover:border-cyan-200 hover:bg-cyan-50",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"font-bold text-slate-900",children:[a.first_name," ",a.last_name]}),t.jsx("p",{className:"text-xs text-slate-500",children:a.phone})]}),t.jsx(W,{className:"h-4 w-4 text-cyan-600"})]},a.id))}),t.jsx(I,{variant:"ghost",onClick:()=>u(!1),className:"w-full text-slate-500 hover:text-red-500",children:"Annuler"})]})}),l&&!_&&t.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4 pt-6",children:[t.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-white/30 bg-white/10 px-6 py-4 shadow-xl backdrop-blur-xl",children:[t.jsx("span",{className:"text-sm font-bold text-slate-600",children:"Numéro à enregistrer"}),t.jsx("span",{className:"font-mono text-xl font-black text-cyan-600",children:s.phone})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(M,{className:"ml-2 font-bold text-slate-800",children:"Prénom"}),t.jsx(P,{placeholder:"Jean",value:s.first_name,onChange:a=>g({...s,first_name:a.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(M,{className:"ml-2 font-bold text-slate-800",children:"Nom"}),t.jsx(P,{placeholder:"Lozé",value:s.last_name,onChange:a=>g({...s,last_name:a.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(M,{className:"ml-2 font-bold text-slate-800",children:"Email (Optionnel)"}),t.jsx(P,{placeholder:"jean.loze@example.com",type:"email",value:s.email,onChange:a=>g({...s,email:a.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(M,{className:"ml-2 font-bold text-slate-800",children:"Adresse (Optionnelle)"}),t.jsx(P,{placeholder:"Gombe, Kinshasa",value:s.address,onChange:a=>g({...s,address:a.target.value}),className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs(I,{variant:"ghost",onClick:()=>{o(!1),g({...s,phone:""})},className:"h-14 w-full rounded-2xl font-bold text-slate-500 transition-colors hover:bg-slate-100",children:[t.jsx(Y,{className:"mr-2 h-5 w-5"})," ","Retour"]}),t.jsx(I,{variant:"outline",onClick:()=>u(!0),className:"h-14 w-full rounded-2xl border-2 border-dashed border-cyan-200 bg-cyan-50 font-bold text-cyan-700 hover:bg-cyan-100",children:"Déjà client ? Lier ce numéro"})]})]})]});case 2:return t.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-12",children:[t.jsxs("div",{className:"space-y-2 text-center",children:[t.jsx(y.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-2 inline-block rounded-full bg-blue-50 px-4 py-1 text-xs font-black tracking-widest text-blue-600 uppercase",children:"Étape 2 • Opération"}),t.jsxs("h2",{className:"text-4xl font-black tracking-tight text-slate-900",children:["Bonjour"," ",t.jsx("span",{className:"text-blue-600",children:n?.first_name||s.first_name}),",",t.jsx("p",{className:"text-lg font-medium text-slate-600",children:"Que souhaitez-vous faire aujourd'hui ?"})]})]}),n&&t.jsxs(y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"rounded-[24px] border border-slate-200 bg-slate-50/50 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-blue-100 text-blue-600",children:t.jsx(G,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-black tracking-widest text-slate-500 uppercase",children:"Numéro Actif"}),t.jsx("p",{className:"font-mono text-xl font-bold text-slate-900",children:s.phone})]})]}),t.jsxs(I,{variant:"ghost",onClick:()=>$(!z),className:"font-bold text-slate-600 hover:text-slate-800",children:[t.jsx(Y,{className:z?"mr-2 h-4 w-4 -rotate-90 transition-transform":"mr-2 h-4 w-4 transition-transform"}),"Changer"]})]}),t.jsx(q,{children:z&&t.jsx(y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden bg-white/50 pt-4",children:t.jsx(Se,{phones:n.phones||[],selectedPhone:s.phone,onSelect:a=>{g({...s,phone:a}),$(!1)},onAdd:async a=>{await V.mutateAsync(a)},isAdding:V.isPending})})})]}),t.jsxs("div",{className:"grid gap-10",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"text-center md:text-left",children:t.jsx("h3",{className:"text-2xl font-black text-slate-800",children:"Opérations disponibles"})}),t.jsx(Pe,{selectedOperation:s.operation_type,onSelect:a=>g({...s,operation_type:a,institution_id:void 0})})]}),t.jsxs(q,{children:[s.operation_type&&s.operation_type!=="change"&&t.jsxs(y.div,{initial:{opacity:0,height:0,y:20},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:20},className:"space-y-4 overflow-hidden",children:[t.jsx(M,{className:"ml-4 block text-sm font-black tracking-widest text-slate-400 uppercase",children:"Partenaire Bancaire / Mobile"}),t.jsx(Re,{institutions:L,selectedId:s.institution_id,onSelect:a=>g({...s,institution_id:a})})]}),t.jsx(q,{children:s.operation_type==="depot"&&s.institution_id&&t.jsx(y.div,{initial:{opacity:0,height:0,y:20},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:20},className:"space-y-4 pt-4",children:(()=>{const a=L.find(b=>b.id===s.institution_id),R=a?.settings?.required_fields,F=b=>R?R.includes(b):a?.type==="bank"?["account_number","beneficiary","reason"].includes(b):["beneficiary_number","beneficiary","reason"].includes(b);return t.jsxs("div",{className:"grid gap-6",children:[F("account_number")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(M,{className:"ml-2 font-bold text-slate-800",children:"Numéro de compte"}),t.jsx(P,{value:s.account_number,onChange:b=>g({...s,account_number:b.target.value}),placeholder:"Compte bancaire...",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),F("beneficiary_number")&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(M,{className:"ml-2 font-bold text-slate-800",children:"Numéro du bénéficiaire"}),t.jsx("button",{type:"button",onClick:()=>g({...s,beneficiary_number:s.phone}),className:"text-xs font-bold text-cyan-800 transition-colors hover:text-cyan-900",children:"Utiliser le mien"})]}),t.jsx(P,{value:s.beneficiary_number,onChange:b=>g({...s,beneficiary_number:b.target.value}),placeholder:"08...",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(M,{className:"ml-2 font-bold text-slate-800",children:"Montant"}),t.jsxs("div",{className:"relative",children:[t.jsx(P,{type:"number",value:s.amount,onChange:b=>g({...s,amount:b.target.value}),placeholder:"0.00",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 pr-24 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"}),t.jsx("div",{className:"absolute top-1 right-1 bottom-1 flex rounded-xl bg-slate-100 p-1",children:["USD","CDF"].map(b=>t.jsx("button",{onClick:()=>g({...s,currency:b}),className:`relative z-10 w-12 rounded-lg text-sm font-black transition-all ${s.currency===b?"bg-white text-slate-900 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:b},b))})]})]}),F("beneficiary")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(M,{className:"ml-2 font-bold text-slate-800",children:"Bénéficiaire"}),t.jsx(P,{value:s.beneficiary,onChange:b=>g({...s,beneficiary:b.target.value}),placeholder:"Nom du bénéficiaire",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]})]}),F("reason")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(M,{className:"ml-2 font-bold text-slate-800",children:"Motif / Raison"}),t.jsx(P,{value:s.reason,onChange:b=>g({...s,reason:b.target.value}),placeholder:"Raison du dépôt...",className:"h-14 rounded-2xl border-2 border-white/30 bg-white/40 text-slate-900 shadow-xl backdrop-blur-xl placeholder:text-slate-400 focus:border-white/60 focus:bg-white/60 focus:ring-4 focus:ring-cyan-400/30"})]})]})})()})})]})]})]});case 3:return t.jsx(Ie,{ticketNumber:d,onNewTicket:J});default:return null}};return t.jsx(ve,{currentPageName:"Client",children:t.jsxs("div",{className:"relative min-h-screen overflow-hidden",children:[t.jsxs("div",{className:"fixed inset-0 z-0",children:[t.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(/images/background1.png)"}}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-900/40 via-slate-900/20 to-slate-900/40"})]}),t.jsxs("div",{className:"relative z-10 mx-auto max-w-5xl px-4 py-12",children:[t.jsx("div",{className:"mb-12 text-center",children:t.jsxs(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col items-center",children:[t.jsxs("div",{className:"group relative mb-12",children:[t.jsx("div",{className:"absolute -inset-12 rounded-full bg-gradient-to-tr from-cyan-400/30 via-purple-500/30 to-pink-500/30 opacity-60 blur-3xl transition-all duration-700 group-hover:scale-110 group-hover:opacity-100"}),t.jsxs("div",{className:"relative flex h-40 w-40 items-center justify-center rounded-[48px] border border-white/30 bg-white/10 p-8 shadow-2xl shadow-purple-500/20 backdrop-blur-2xl transition-all duration-500 group-hover:scale-110 group-hover:rotate-3 group-hover:border-white/50 group-hover:bg-white/20",children:[t.jsx("img",{src:"/logo.png",alt:"Havifin",className:"h-full w-full object-contain drop-shadow-2xl"}),t.jsx("div",{className:"absolute inset-0 rounded-[48px] bg-gradient-to-tr from-cyan-400/10 via-purple-500/10 to-pink-500/10 opacity-0 transition-opacity group-hover:opacity-100"})]})]}),t.jsxs("h1",{className:"mb-2 text-5xl font-black tracking-tight drop-shadow-lg",children:[t.jsx("span",{className:"bg-gradient-to-r from-cyan-300 via-blue-300 to-purple-300 bg-clip-text text-transparent",children:"Havifin"}),t.jsx("span",{className:"mx-2 text-white/40",children:"|"}),t.jsx("span",{className:"text-white/90",children:"Smart Ticket"})]}),t.jsx("p",{className:"text-lg font-bold tracking-widest text-white/60 uppercase",children:"Bureau de Change & Services"})]})}),t.jsxs("div",{className:"rounded-[40px] border border-white/20 bg-white/60 p-8 shadow-2xl shadow-purple-500/20 backdrop-blur-2xl md:p-12",children:[t.jsx(q,{mode:"wait",children:le()}),e<3&&t.jsxs("div",{className:"mt-12 flex justify-center gap-4",children:[e===2&&t.jsx(I,{variant:"ghost",onClick:J,size:"lg",className:"h-16 rounded-3xl border border-white/30 bg-white/20 px-16 text-xl font-bold text-slate-600 shadow-xl backdrop-blur-xl transition-all hover:bg-white/40 hover:text-red-500",children:"Annuler"}),t.jsx(I,{onClick:ie,disabled:!re()||H.isPending||B.isPending||p,size:"lg",className:"h-16 rounded-3xl border border-white/30 bg-gradient-to-r from-cyan-500 via-blue-600 to-purple-600 px-16 text-xl font-bold text-white shadow-2xl shadow-cyan-500/30 backdrop-blur-xl transition-all hover:scale-[1.02] hover:border-white/50 hover:shadow-cyan-500/50 active:scale-[0.98]",children:H.isPending||B.isPending?t.jsxs(t.Fragment,{children:[t.jsx(U,{className:"mr-3 h-6 w-6 animate-spin"}),"Traitement..."]}):t.jsxs(t.Fragment,{children:[e===1&&"Continuer",e===2&&"Confirmer",t.jsx(W,{className:"ml-3 h-6 w-6"})]})})]})]}),e<3&&t.jsx("div",{className:"mt-12 flex justify-center gap-4",children:[1,2].map(a=>t.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${e===a?"w-12 bg-blue-600":"w-2 bg-slate-200"}`},a))})]})]})})}export{We as default};
