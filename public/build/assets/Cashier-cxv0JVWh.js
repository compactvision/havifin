import{c as H,j as s,R as nt,r as m,u as pt}from"./app-Cl1Srwpv.js";import{L as Ft,S as Lt,A as We,b as Ne,u as qe}from"./base44Client-DFr8a4ah.js";import{c as Ut,S as Wt,B as ve,u as Be,a as qt,I as ze,L as Ae}from"./label-B4e2dEWo.js";import{c as ke,a as le,m as st}from"./createLucideIcon-D-eif_I3.js";import{h as dt,U as zt}from"./moment-B0nOeA0c.js";import{C as xt,R as ht,X as Vt,u as Ve,A as Ht,L as Bt,a as Kt,b as Gt}from"./app-main-CE2T8fHo.js";import{A as at,P as Qt,C as gt,a as Zt,b as Xt,c as Yt}from"./phone-BPanCywN.js";import{u as ut,a as Jt,b as Ze,P as en,h as tn,c as Ie,d as nn,F as sn,D as an,R as rn,S as Xe,e as Ye,f as Je,g as et,i as je,j as ln}from"./select-sIAJ6N5x.js";import{t as Te}from"./index-DLNwE5_S.js";import{C as on}from"./circle-alert-BXBVgS13.js";/* empty css            */const cn=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],dn=ke("Calculator",cn);const un=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],mn=ke("CircleCheckBig",un);const fn=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],pn=ke("CircleUser",fn);const xn=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v2",key:"stiyo7"}],["path",{d:"M12 13h.01",key:"y0uutt"}]],hn=ke("MessageSquareWarning",xn);const gn=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]],mt=ke("PhoneCall",gn);const bn=[["polyline",{points:"18 2 22 6 18 10",key:"6vjanh"}],["line",{x1:"14",x2:"22",y1:"6",y2:"6",key:"1jsywh"}],["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],vn=ke("PhoneForwarded",bn);const yn=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],_n=ke("Send",yn);const jn=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Nn=ke("TriangleAlert",jn),wn=Ut("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Cn(t){const e=H.c(12);let n,a,r,o;e[0]!==t?({className:n,variant:o,asChild:r,...a}=t,e[0]=t,e[1]=n,e[2]=a,e[3]=r,e[4]=o):(n=e[1],a=e[2],r=e[3],o=e[4]);const c=(r===void 0?!1:r)?Wt:"span";let i;e[5]!==n||e[6]!==o?(i=le(wn({variant:o}),n),e[5]=n,e[6]=o,e[7]=i):i=e[7];let d;return e[8]!==c||e[9]!==a||e[10]!==i?(d=s.jsx(c,{"data-slot":"badge",className:i,...a}),e[8]=c,e[9]=a,e[10]=i,e[11]=d):d=e[11],d}function rt(t){const e=H.c(71),{client:n,onCall:a,onRecall:r,onProcess:o,onHelp:u,isProcessing:c}=t,[i,d]=nt.useState(!1),l=n.status==="called",f=n.status==="completed",p=n.status==="waiting";let x,b;e[0]!==l?(x=()=>{l&&d(!0)},b=[l],e[0]=l,e[1]=x,e[2]=b):(x=e[1],b=e[2]),nt.useEffect(x,b);let h,v,y;e[3]===Symbol.for("react.memo_cache_sentinel")?(h={opacity:0,scale:.98,y:5},v={opacity:1,scale:1,y:0},y={opacity:0,scale:.95,y:-5},e[3]=h,e[4]=v,e[5]=y):(h=e[3],v=e[4],y=e[5]);let j;e[6]!==l||e[7]!==i?(j=()=>!l&&d(!i),e[6]=l,e[7]=i,e[8]=j):j=e[8];const N=l?"rounded-[2rem] border-blue-500/30 bg-white p-5 shadow-xl ring-1 shadow-blue-500/5 ring-blue-50":f?"rounded-2xl border-slate-100 bg-slate-50/50 p-3 opacity-60 hover:opacity-100":"rounded-2xl border-slate-200 bg-white p-3 shadow-sm hover:border-blue-300 hover:shadow-md";let w;e[9]!==N?(w=le("group relative cursor-pointer overflow-hidden transition-all duration-300",N),e[9]=N,e[10]=w):w=e[10];const D=l?"h-14 w-14 rounded-2xl bg-blue-600 text-xl text-white shadow-lg shadow-blue-500/20":"h-10 w-10 rounded-xl bg-slate-900 text-sm text-white";let C;e[11]!==D?(C=le("flex flex-shrink-0 items-center justify-center font-black tracking-tighter transition-all",D),e[11]=D,e[12]=C):C=e[12];let S;e[13]!==n.ticket_number||e[14]!==C?(S=s.jsx("div",{className:C,children:n.ticket_number}),e[13]=n.ticket_number,e[14]=C,e[15]=S):S=e[15];const T=l?"text-lg":"text-sm";let F;e[16]!==T?(F=le("truncate leading-tight font-black tracking-tight text-slate-800",T),e[16]=T,e[17]=F):F=e[17];const L=n.first_name?`${n.first_name} ${n.last_name||""}`:n.phone;let O;e[18]!==F||e[19]!==L?(O=s.jsx("h4",{className:F,children:L}),e[18]=F,e[19]=L,e[20]=O):O=e[20];let $;e[21]!==n.created_date||e[22]!==n.service||e[23]!==l||e[24]!==i?($=!l&&!i&&s.jsxs("p",{className:"truncate text-[10px] font-bold tracking-wider text-slate-400 uppercase",children:[n.service," •"," ",dt(n.created_date).fromNow()]}),e[21]=n.created_date,e[22]=n.service,e[23]=l,e[24]=i,e[25]=$):$=e[25];let E;e[26]!==O||e[27]!==$?(E=s.jsxs("div",{className:"overflow-hidden",children:[O,$]}),e[26]=O,e[27]=$,e[28]=E):E=e[28];let B;e[29]!==S||e[30]!==E?(B=s.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[S,E]}),e[29]=S,e[30]=E,e[31]=B):B=e[31];let _;e[32]!==n||e[33]!==i||e[34]!==c||e[35]!==p||e[36]!==a?(_=p&&!i&&s.jsx(ve,{size:"icon",variant:"secondary",onClick:q=>{q.stopPropagation(),a?.(n)},disabled:c,className:"h-10 w-10 rounded-xl bg-blue-50 text-blue-600 shadow-sm transition-all hover:bg-blue-600 hover:text-white",children:c?s.jsx(ht,{className:"h-4 w-4 animate-spin"}):s.jsx(Qt,{className:"h-4 w-4"})}),e[32]=n,e[33]=i,e[34]=c,e[35]=p,e[36]=a,e[37]=_):_=e[37];let U;e[38]!==n||e[39]!==l||e[40]!==u||e[41]!==r?(U=l&&s.jsxs("div",{className:"flex gap-1.5",onClick:Sn,children:[s.jsx(ve,{variant:"ghost",size:"icon",onClick:()=>u?.(n),className:"h-9 w-9 rounded-xl border border-amber-100/50 bg-amber-50 text-amber-600 hover:bg-amber-100",children:s.jsx(hn,{className:"h-4 w-4"})}),s.jsx(ve,{variant:"ghost",size:"icon",onClick:()=>r?.(n),className:"h-9 w-9 rounded-xl border border-blue-100/50 bg-blue-50 text-blue-600 hover:bg-blue-100",children:s.jsx(vn,{className:"h-4 w-4"})})]}),e[38]=n,e[39]=l,e[40]=u,e[41]=r,e[42]=U):U=e[42];let I;e[43]!==_||e[44]!==U?(I=s.jsxs("div",{className:"flex items-center gap-2",children:[_,U]}),e[43]=_,e[44]=U,e[45]=I):I=e[45];let W;e[46]!==B||e[47]!==I?(W=s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[B,I]}),e[46]=B,e[47]=I,e[48]=W):W=e[48];let P;e[49]!==n||e[50]!==l||e[51]!==i||e[52]!==c||e[53]!==p||e[54]!==a||e[55]!==o?(P=i&&s.jsx(st.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:s.jsxs("div",{className:le("mt-4 space-y-3",l?"":"border-t border-slate-100 pt-3"),children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2 font-bold text-slate-500",children:[s.jsx(xt,{className:"h-3.5 w-3.5"}),dt(n.created_date).format("HH:mm")]}),s.jsx(Cn,{variant:"outline",className:"h-5 py-0 text-[9px] font-black tracking-tighter uppercase",children:n.operation_type})]}),s.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-100/50 bg-slate-50 p-3",children:[s.jsx("div",{className:"rounded-lg bg-white p-1.5 shadow-sm",children:n.operation_type==="change"?s.jsx(Ft,{className:"h-3.5 w-3.5 text-indigo-500"}):s.jsx(Lt,{className:"h-3.5 w-3.5 text-amber-500"})}),s.jsx("span",{className:"text-[10px] font-black tracking-widest text-slate-600 uppercase",children:n.service})]}),n.amount&&s.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-blue-100/20 bg-blue-50/50 p-3",children:[s.jsx("span",{className:"text-[9px] font-black tracking-widest text-blue-600/60 uppercase",children:"Estimation"}),s.jsxs("span",{className:"font-mono text-sm font-black text-blue-700",children:[n.amount?.toLocaleString()," ",n.currency_to]})]}),s.jsxs("div",{className:"pt-2",children:[p&&s.jsxs(ve,{onClick:q=>{q.stopPropagation(),a?.(n)},disabled:c,className:"h-11 w-full rounded-xl bg-blue-600 text-sm font-black text-white shadow-lg shadow-blue-600/20",children:["Appeler Ticket",s.jsx(at,{className:"ml-2 h-4 w-4"})]}),l&&s.jsxs(ve,{onClick:q=>{q.stopPropagation(),o?.(n)},className:"h-12 w-full rounded-xl bg-slate-900 text-sm font-black text-white shadow-xl shadow-slate-900/10",children:["Démarrer le service",s.jsx(at,{className:"ml-2 h-4 w-4 text-[#00e2f6]"})]})]})]})}),e[49]=n,e[50]=l,e[51]=i,e[52]=c,e[53]=p,e[54]=a,e[55]=o,e[56]=P):P=e[56];let M;e[57]!==P?(M=s.jsx(We,{children:P}),e[57]=P,e[58]=M):M=e[58];let R;e[59]!==f||e[60]!==i?(R=f&&!i&&s.jsxs("div",{className:"mt-2 flex items-center justify-center gap-1 text-[9px] font-black tracking-widest text-emerald-600 uppercase",children:[s.jsx(gt,{className:"h-3 w-3"}),"Terminé"]}),e[59]=f,e[60]=i,e[61]=R):R=e[61];let A;e[62]!==l?(A=l&&s.jsx("div",{className:"absolute -right-6 -bottom-6 h-16 w-16 rounded-full bg-blue-500/5 blur-2xl"}),e[62]=l,e[63]=A):A=e[63];let K;return e[64]!==W||e[65]!==M||e[66]!==R||e[67]!==A||e[68]!==j||e[69]!==w?(K=s.jsxs(st.div,{layout:!0,initial:h,animate:v,exit:y,onClick:j,className:w,children:[W,M,R,A]}),e[64]=W,e[65]=M,e[66]=R,e[67]=A,e[68]=j,e[69]=w,e[70]=K):K=e[70],K}function Sn(t){return t.stopPropagation()}function kn(t,e){const n=m.createContext(e),a=o=>{const{children:u,...c}=o,i=m.useMemo(()=>c,Object.values(c));return s.jsx(n.Provider,{value:i,children:u})};a.displayName=t+"Provider";function r(o){const u=m.useContext(n);if(u)return u;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[a,r]}function Dn(t,e=[]){let n=[];function a(o,u){const c=m.createContext(u),i=n.length;n=[...n,u];const d=f=>{const{scope:p,children:x,...b}=f,h=p?.[t]?.[i]||c,v=m.useMemo(()=>b,Object.values(b));return s.jsx(h.Provider,{value:v,children:x})};d.displayName=o+"Provider";function l(f,p){const x=p?.[t]?.[i]||c,b=m.useContext(x);if(b)return b;if(u!==void 0)return u;throw new Error(`\`${f}\` must be used within \`${o}\``)}return[d,l]}const r=()=>{const o=n.map(u=>m.createContext(u));return function(c){const i=c?.[t]||o;return m.useMemo(()=>({[`__scope${t}`]:{...c,[t]:i}}),[c,i])}};return r.scopeName=t,[a,Pn(r,...e)]}function Pn(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const a=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(o){const u=a.reduce((c,{useScope:i,scopeName:d})=>{const f=i(o)[`__scope${d}`];return{...c,...f}},{});return m.useMemo(()=>({[`__scope${e.scopeName}`]:u}),[u])}};return n.scopeName=e.scopeName,n}function Rn(t,e){return m.useReducer((n,a)=>e[n][a]??n,t)}var Ke=t=>{const{present:e,children:n}=t,a=En(e),r=typeof n=="function"?n({present:a.isPresent}):m.Children.only(n),o=Be(a.ref,Mn(r));return typeof n=="function"||a.isPresent?m.cloneElement(r,{ref:o}):null};Ke.displayName="Presence";function En(t){const[e,n]=m.useState(),a=m.useRef(null),r=m.useRef(t),o=m.useRef("none"),u=t?"mounted":"unmounted",[c,i]=Rn(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const d=Ue(a.current);o.current=c==="mounted"?d:"none"},[c]),ut(()=>{const d=a.current,l=r.current;if(l!==t){const p=o.current,x=Ue(d);t?i("MOUNT"):x==="none"||d?.display==="none"?i("UNMOUNT"):i(l&&p!==x?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,i]),ut(()=>{if(e){let d;const l=e.ownerDocument.defaultView??window,f=x=>{const h=Ue(a.current).includes(CSS.escape(x.animationName));if(x.target===e&&h&&(i("ANIMATION_END"),!r.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",d=l.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},p=x=>{x.target===e&&(o.current=Ue(a.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{l.clearTimeout(d),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else i("ANIMATION_END")},[e,i]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:m.useCallback(d=>{a.current=d?getComputedStyle(d):null,n(d)},[])}}function Ue(t){return t?.animationName||"none"}function Mn(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function bt(t){const e=An(t),n=m.forwardRef((a,r)=>{const{children:o,...u}=a,c=m.Children.toArray(o),i=c.find(In);if(i){const d=i.props.children,l=c.map(f=>f===i?m.Children.count(d)>1?m.Children.only(null):m.isValidElement(d)?d.props.children:null:f);return s.jsx(e,{...u,ref:r,children:m.isValidElement(d)?m.cloneElement(d,void 0,l):null})}return s.jsx(e,{...u,ref:r,children:o})});return n.displayName=`${t}.Slot`,n}function An(t){const e=m.forwardRef((n,a)=>{const{children:r,...o}=n;if(m.isValidElement(r)){const u=$n(r),c=Tn(o,r.props);return r.type!==m.Fragment&&(c.ref=a?qt(a,u):u),m.cloneElement(r,c)}return m.Children.count(r)>1?m.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var On=Symbol("radix.slottable");function In(t){return m.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===On}function Tn(t,e){const n={...e};for(const a in e){const r=t[a],o=e[a];/^on[A-Z]/.test(a)?r&&o?n[a]=(...c)=>{const i=o(...c);return r(...c),i}:r&&(n[a]=r):a==="style"?n[a]={...r,...o}:a==="className"&&(n[a]=[r,o].filter(Boolean).join(" "))}return{...t,...n}}function $n(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Fn=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$e=Fn.reduce((t,e)=>{const n=bt(`Primitive.${e}`),a=m.forwardRef((r,o)=>{const{asChild:u,...c}=r,i=u?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(i,{...c,ref:o})});return a.displayName=`Primitive.${e}`,{...t,[e]:a}},{}),Ge="Dialog",[vt]=Dn(Ge),[Ln,pe]=vt(Ge),yt=t=>{const{__scopeDialog:e,children:n,open:a,defaultOpen:r,onOpenChange:o,modal:u=!0}=t,c=m.useRef(null),i=m.useRef(null),[d,l]=Jt({prop:a,defaultProp:r??!1,onChange:o,caller:Ge});return s.jsx(Ln,{scope:e,triggerRef:c,contentRef:i,contentId:Ze(),titleId:Ze(),descriptionId:Ze(),open:d,onOpenChange:l,onOpenToggle:m.useCallback(()=>l(f=>!f),[l]),modal:u,children:n})};yt.displayName=Ge;var _t="DialogTrigger",Un=m.forwardRef((t,e)=>{const{__scopeDialog:n,...a}=t,r=pe(_t,n),o=Be(e,r.triggerRef);return s.jsx($e.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":it(r.open),...a,ref:o,onClick:Ie(t.onClick,r.onOpenToggle)})});Un.displayName=_t;var lt="DialogPortal",[Wn,jt]=vt(lt,{forceMount:void 0}),Nt=t=>{const{__scopeDialog:e,forceMount:n,children:a,container:r}=t,o=pe(lt,e);return s.jsx(Wn,{scope:e,forceMount:n,children:m.Children.map(a,u=>s.jsx(Ke,{present:n||o.open,children:s.jsx(en,{asChild:!0,container:r,children:u})}))})};Nt.displayName=lt;var He="DialogOverlay",wt=m.forwardRef((t,e)=>{const n=jt(He,t.__scopeDialog),{forceMount:a=n.forceMount,...r}=t,o=pe(He,t.__scopeDialog);return o.modal?s.jsx(Ke,{present:a||o.open,children:s.jsx(zn,{...r,ref:e})}):null});wt.displayName=He;var qn=bt("DialogOverlay.RemoveScroll"),zn=m.forwardRef((t,e)=>{const{__scopeDialog:n,...a}=t,r=pe(He,n);return s.jsx(rn,{as:qn,allowPinchZoom:!0,shards:[r.contentRef],children:s.jsx($e.div,{"data-state":it(r.open),...a,ref:e,style:{pointerEvents:"auto",...a.style}})})}),De="DialogContent",Ct=m.forwardRef((t,e)=>{const n=jt(De,t.__scopeDialog),{forceMount:a=n.forceMount,...r}=t,o=pe(De,t.__scopeDialog);return s.jsx(Ke,{present:a||o.open,children:o.modal?s.jsx(Vn,{...r,ref:e}):s.jsx(Hn,{...r,ref:e})})});Ct.displayName=De;var Vn=m.forwardRef((t,e)=>{const n=pe(De,t.__scopeDialog),a=m.useRef(null),r=Be(e,n.contentRef,a);return m.useEffect(()=>{const o=a.current;if(o)return tn(o)},[]),s.jsx(St,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ie(t.onCloseAutoFocus,o=>{o.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:Ie(t.onPointerDownOutside,o=>{const u=o.detail.originalEvent,c=u.button===0&&u.ctrlKey===!0;(u.button===2||c)&&o.preventDefault()}),onFocusOutside:Ie(t.onFocusOutside,o=>o.preventDefault())})}),Hn=m.forwardRef((t,e)=>{const n=pe(De,t.__scopeDialog),a=m.useRef(!1),r=m.useRef(!1);return s.jsx(St,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{t.onCloseAutoFocus?.(o),o.defaultPrevented||(a.current||n.triggerRef.current?.focus(),o.preventDefault()),a.current=!1,r.current=!1},onInteractOutside:o=>{t.onInteractOutside?.(o),o.defaultPrevented||(a.current=!0,o.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const u=o.target;n.triggerRef.current?.contains(u)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&r.current&&o.preventDefault()}})}),St=m.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:a,onOpenAutoFocus:r,onCloseAutoFocus:o,...u}=t,c=pe(De,n),i=m.useRef(null),d=Be(e,i);return nn(),s.jsxs(s.Fragment,{children:[s.jsx(sn,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:r,onUnmountAutoFocus:o,children:s.jsx(an,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":it(c.open),...u,ref:d,onDismiss:()=>c.onOpenChange(!1)})}),s.jsxs(s.Fragment,{children:[s.jsx(Bn,{titleId:c.titleId}),s.jsx(Gn,{contentRef:i,descriptionId:c.descriptionId})]})]})}),ot="DialogTitle",kt=m.forwardRef((t,e)=>{const{__scopeDialog:n,...a}=t,r=pe(ot,n);return s.jsx($e.h2,{id:r.titleId,...a,ref:e})});kt.displayName=ot;var Dt="DialogDescription",Pt=m.forwardRef((t,e)=>{const{__scopeDialog:n,...a}=t,r=pe(Dt,n);return s.jsx($e.p,{id:r.descriptionId,...a,ref:e})});Pt.displayName=Dt;var Rt="DialogClose",Et=m.forwardRef((t,e)=>{const{__scopeDialog:n,...a}=t,r=pe(Rt,n);return s.jsx($e.button,{type:"button",...a,ref:e,onClick:Ie(t.onClick,()=>r.onOpenChange(!1))})});Et.displayName=Rt;function it(t){return t?"open":"closed"}var Mt="DialogTitleWarning",[Ds,At]=kn(Mt,{contentName:De,titleName:ot,docsSlug:"dialog"}),Bn=({titleId:t})=>{const e=At(Mt),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return m.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},Kn="DialogDescriptionWarning",Gn=({contentRef:t,descriptionId:e})=>{const a=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${At(Kn).contentName}}.`;return m.useEffect(()=>{const r=t.current?.getAttribute("aria-describedby");e&&r&&(document.getElementById(e)||console.warn(a))},[a,t,e]),null},Qn=yt,Zn=Nt,Xn=wt,Yn=Ct,Jn=kt,es=Pt,ts=Et;function Ot(t){const e=H.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let a;return e[2]!==n?(a=s.jsx(Qn,{"data-slot":"dialog",...n}),e[2]=n,e[3]=a):a=e[3],a}function ns(t){const e=H.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let a;return e[2]!==n?(a=s.jsx(Zn,{"data-slot":"dialog-portal",...n}),e[2]=n,e[3]=a):a=e[3],a}function ss(t){const e=H.c(8);let n,a;e[0]!==t?({className:n,...a}=t,e[0]=t,e[1]=n,e[2]=a):(n=e[1],a=e[2]);let r;e[3]!==n?(r=le("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",n),e[3]=n,e[4]=r):r=e[4];let o;return e[5]!==a||e[6]!==r?(o=s.jsx(Xn,{"data-slot":"dialog-overlay",className:r,...a}),e[5]=a,e[6]=r,e[7]=o):o=e[7],o}function It(t){const e=H.c(12);let n,a,r;e[0]!==t?({className:a,children:n,...r}=t,e[0]=t,e[1]=n,e[2]=a,e[3]=r):(n=e[1],a=e[2],r=e[3]);let o;e[4]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx(ss,{}),e[4]=o):o=e[4];let u;e[5]!==a?(u=le("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),e[5]=a,e[6]=u):u=e[6];let c;e[7]===Symbol.for("react.memo_cache_sentinel")?(c=s.jsxs(ts,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[s.jsx(Vt,{}),s.jsx("span",{className:"sr-only",children:"Close"})]}),e[7]=c):c=e[7];let i;return e[8]!==n||e[9]!==r||e[10]!==u?(i=s.jsxs(ns,{"data-slot":"dialog-portal",children:[o,s.jsxs(Yn,{"data-slot":"dialog-content",className:u,...r,children:[n,c]})]}),e[8]=n,e[9]=r,e[10]=u,e[11]=i):i=e[11],i}function Tt(t){const e=H.c(8);let n,a;e[0]!==t?({className:n,...a}=t,e[0]=t,e[1]=n,e[2]=a):(n=e[1],a=e[2]);let r;e[3]!==n?(r=le("flex flex-col gap-2 text-center sm:text-left",n),e[3]=n,e[4]=r):r=e[4];let o;return e[5]!==a||e[6]!==r?(o=s.jsx("div",{"data-slot":"dialog-header",className:r,...a}),e[5]=a,e[6]=r,e[7]=o):o=e[7],o}function $t(t){const e=H.c(8);let n,a;e[0]!==t?({className:n,...a}=t,e[0]=t,e[1]=n,e[2]=a):(n=e[1],a=e[2]);let r;e[3]!==n?(r=le("text-lg leading-none font-semibold",n),e[3]=n,e[4]=r):r=e[4];let o;return e[5]!==a||e[6]!==r?(o=s.jsx(Jn,{"data-slot":"dialog-title",className:r,...a}),e[5]=a,e[6]=r,e[7]=o):o=e[7],o}function as(t){const e=H.c(8);let n,a;e[0]!==t?({className:n,...a}=t,e[0]=t,e[1]=n,e[2]=a):(n=e[1],a=e[2]);let r;e[3]!==n?(r=le("text-muted-foreground text-sm",n),e[3]=n,e[4]=r):r=e[4];let o;return e[5]!==a||e[6]!==r?(o=s.jsx(es,{"data-slot":"dialog-description",className:r,...a}),e[5]=a,e[6]=r,e[7]=o):o=e[7],o}const ct=m.forwardRef((t,e)=>{const n=H.c(9);let a,r;n[0]!==t?({className:a,...r}=t,n[0]=t,n[1]=a,n[2]=r):(a=n[1],r=n[2]);let o;n[3]!==a?(o=le("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),n[3]=a,n[4]=o):o=n[4];let u;return n[5]!==r||n[6]!==e||n[7]!==o?(u=s.jsx("textarea",{className:o,ref:e,...r}),n[5]=r,n[6]=e,n[7]=o,n[8]=u):u=n[8],u});ct.displayName="Textarea";function rs(t){const e=H.c(36),{isOpen:n,onClose:a,clientPhone:r}=t,[o,u]=nt.useState("");let c;e[0]!==a?(c={mutationFn:os,onSuccess:()=>{Te.success("Demande d'aide envoyée au manager"),u(""),a()},onError:ls},e[0]=a,e[1]=c):c=e[1];const i=Ve(c);let d;e[2]!==r||e[3]!==o||e[4]!==i?(d=T=>{T.preventDefault(),o.trim()&&i.mutate({client_phone:r||"N/A",description:o})},e[2]=r,e[3]=o,e[4]=i,e[5]=d):d=e[5];const l=d;let f;e[6]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-1/2 -translate-y-1/2 bg-amber-500/10 blur-3xl"}),e[6]=f):f=e[6];let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsxs(Tt,{className:"mb-6",children:[s.jsx("div",{className:"mb-4 flex h-14 w-14 items-center justify-center rounded-2xl border border-amber-500/30 bg-amber-500/20",children:s.jsx(Nn,{className:"h-8 w-8 text-amber-500"})}),s.jsx($t,{className:"text-3xl font-black tracking-tight",children:"Besoin d'aide ?"}),s.jsx(as,{className:"text-lg font-medium text-slate-400",children:"Expliquez brièvement le problème au manager."})]}),e[7]=p):p=e[7];let x;e[8]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx("label",{className:"ml-1 text-xs font-black tracking-widest text-slate-500 uppercase",children:"Message d'urgence"}),e[8]=x):x=e[8];let b;e[9]===Symbol.for("react.memo_cache_sentinel")?(b=T=>u(T.target.value),e[9]=b):b=e[9];let h;e[10]!==o?(h=s.jsxs("div",{className:"space-y-2",children:[x,s.jsx(ct,{value:o,onChange:b,placeholder:"Ex: Problème de validation M-Pesa, client impatient...",className:"min-h-[120px] resize-none rounded-2xl border-white/10 bg-white/5 p-4 text-lg text-white placeholder:text-slate-600 focus:border-amber-500 focus:ring-amber-500"})]}),e[10]=o,e[11]=h):h=e[11];let v;e[12]!==r?(v=r&&s.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border border-white/5 bg-white/5 p-4",children:[s.jsx(on,{className:"h-5 w-5 text-slate-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[10px] font-black tracking-wider text-slate-500 uppercase",children:"Client associé"}),s.jsx("div",{className:"text-sm font-bold",children:r})]})]}),e[12]=r,e[13]=v):v=e[13];let y;e[14]!==a?(y=s.jsx(ve,{type:"button",variant:"ghost",onClick:a,className:"h-14 flex-1 rounded-2xl border border-white/5 font-bold text-slate-400 hover:bg-white/5",children:"Annuler"}),e[14]=a,e[15]=y):y=e[15];let j;e[16]!==o||e[17]!==i.isPending?(j=i.isPending||!o.trim(),e[16]=o,e[17]=i.isPending,e[18]=j):j=e[18];let N;e[19]!==i.isPending?(N=i.isPending?s.jsx(st.div,{animate:{rotate:360},transition:{repeat:1/0,duration:1,ease:"linear"},children:s.jsx(RefreshCw,{className:"h-6 w-6"})}):s.jsxs(s.Fragment,{children:["Envoyer Alerte",s.jsx(_n,{className:"ml-2 h-5 w-5"})]}),e[19]=i.isPending,e[20]=N):N=e[20];let w;e[21]!==j||e[22]!==N?(w=s.jsx(ve,{type:"submit",disabled:j,className:"h-14 flex-[2] rounded-2xl bg-amber-500 text-lg font-black text-black shadow-lg shadow-amber-500/20 hover:bg-amber-600",children:N}),e[21]=j,e[22]=N,e[23]=w):w=e[23];let D;e[24]!==w||e[25]!==y?(D=s.jsxs("div",{className:"flex gap-4 pt-2",children:[y,w]}),e[24]=w,e[25]=y,e[26]=D):D=e[26];let C;e[27]!==l||e[28]!==D||e[29]!==h||e[30]!==v?(C=s.jsx(It,{className:"overflow-hidden rounded-[32px] border-none bg-slate-900 p-0 text-white sm:max-w-[500px]",children:s.jsxs("div",{className:"relative p-8",children:[f,p,s.jsxs("form",{onSubmit:l,className:"space-y-6",children:[h,v,D]})]})}),e[27]=l,e[28]=D,e[29]=h,e[30]=v,e[31]=C):C=e[31];let S;return e[32]!==n||e[33]!==a||e[34]!==C?(S=s.jsx(Ot,{open:n,onOpenChange:a,children:C}),e[32]=n,e[33]=a,e[34]=C,e[35]=S):S=e[35],S}function ls(){Te.error("Erreur lors de l'envoi de la demande")}async function os(t){return Ne.entities.HelpRequest.create(t)}function tt(t){const e=H.c(28),{title:n,icon:a,count:r,color:o,children:u}=t;let c;e[0]!==o?(c=le("rounded-2xl border p-2.5 shadow-sm",o),e[0]=o,e[1]=c):c=e[1];let i;e[2]!==a?(i=s.jsx(a,{className:"h-5 w-5"}),e[2]=a,e[3]=i):i=e[3];let d;e[4]!==c||e[5]!==i?(d=s.jsx("div",{className:c,children:i}),e[4]=c,e[5]=i,e[6]=d):d=e[6];let l;e[7]!==n?(l=s.jsx("h3",{className:"text-xl leading-none font-black tracking-tight text-slate-800",children:n}),e[7]=n,e[8]=l):l=e[8];const f=r>1?"Clients":"Client";let p;e[9]!==r||e[10]!==f?(p=s.jsxs("p",{className:"mt-1.5 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[r," ",f]}),e[9]=r,e[10]=f,e[11]=p):p=e[11];let x;e[12]!==l||e[13]!==p?(x=s.jsxs("div",{children:[l,p]}),e[12]=l,e[13]=p,e[14]=x):x=e[14];let b;e[15]!==d||e[16]!==x?(b=s.jsxs("div",{className:"flex items-center gap-3",children:[d,x]}),e[15]=d,e[16]=x,e[17]=b):b=e[17];let h;e[18]!==r?(h=s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl border border-slate-200 bg-slate-100 text-sm font-black text-slate-400 shadow-inner",children:r}),e[18]=r,e[19]=h):h=e[19];let v;e[20]!==b||e[21]!==h?(v=s.jsxs("div",{className:"mb-6 flex items-center justify-between px-1",children:[b,h]}),e[20]=b,e[21]=h,e[22]=v):v=e[22];let y;e[23]!==u?(y=s.jsx("div",{className:"scrollbar-none custom-kanban-scroll flex-1 overflow-y-auto pr-2",children:s.jsx("div",{className:"space-y-4 pb-12",children:u})}),e[23]=u,e[24]=y):y=e[24];let j;return e[25]!==v||e[26]!==y?(j=s.jsxs("div",{className:"flex h-full max-w-[450px] min-w-[320px] flex-1 flex-col",children:[v,y]}),e[25]=v,e[26]=y,e[27]=j):j=e[27],j}const ft={depot:{label:"Dépôt",icon:Yt,color:"text-green-500",action:"Déposer"},retrait:{label:"Retrait",icon:Xt,color:"text-blue-500",action:"Retirer"},change:{label:"Change",icon:Ht,color:"text-amber-500",action:"Changer"},transfert:{label:"Transfert",icon:at,color:"text-purple-500",action:"Transférer"},paiement:{label:"Paiement",icon:Zt,color:"text-pink-500",action:"Payer"}};function is(t){const e=H.c(133),{client:n,open:a,onClose:r}=t,o=pt(),u=n?.amount?String(n.amount):"",c=n?.currency_from||"USD",i=n?.currency_to||"CDF";let d;e[0]!==u||e[1]!==c||e[2]!==i?(d={amount_from:u,amount_given:"",currency_from:c,currency_to:i,exchange_rate:"",commission:"0",notes:""},e[0]=u,e[1]=c,e[2]=i,e[3]=d):d=e[3];const[l,f]=m.useState(d),[p,x]=m.useState(0);let b;e[4]===Symbol.for("react.memo_cache_sentinel")?(b={queryKey:["rates"],queryFn:cs},e[4]=b):b=e[4];const{data:h}=qe(b);let v;e[5]!==h?(v=h===void 0?[]:h,e[5]=h,e[6]=v):v=e[6];const y=v;let j,N;e[7]!==n?(j=()=>{n&&f(k=>({...k,amount_from:n.amount?String(n.amount):"",currency_from:n.currency_from||"USD",currency_to:n.currency_to||"CDF",amount_given:"",exchange_rate:"",commission:"0"}))},N=[n],e[7]=n,e[8]=j,e[9]=N):(j=e[8],N=e[9]),m.useEffect(j,N);let w;e[10]!==n?.operation_type||e[11]!==l.currency_from||e[12]!==l.currency_to||e[13]!==y?(w=()=>{if(n?.operation_type==="change"){const k=`${l.currency_from}_${l.currency_to}`,re=y.find(V=>V.currency_pair===k||V.currency_from===l.currency_from&&V.currency_to===l.currency_to);re&&f(V=>({...V,exchange_rate:String(re.buy_rate||re.rate)}))}},e[10]=n?.operation_type,e[11]=l.currency_from,e[12]=l.currency_to,e[13]=y,e[14]=w):w=e[14];const D=n?.operation_type;let C;e[15]!==l.currency_from||e[16]!==l.currency_to||e[17]!==y||e[18]!==D?(C=[l.currency_from,l.currency_to,y,D],e[15]=l.currency_from,e[16]=l.currency_to,e[17]=y,e[18]=D,e[19]=C):C=e[19],m.useEffect(w,C);let S;e[20]!==n?.operation_type||e[21]!==l.amount_from||e[22]!==l.amount_given||e[23]!==l.commission||e[24]!==l.exchange_rate?(S=()=>{if(!l.amount_from)return;const k=parseFloat(l.amount_from),re=parseFloat(l.amount_given)||0,V=parseFloat(l.exchange_rate)||1,_e=parseFloat(l.commission)||0;n?.operation_type==="change"?x(k*V-_e):["depot","transfert"].includes(n?.operation_type||"")&&re>0?x(re-k-_e):x(0)},e[20]=n?.operation_type,e[21]=l.amount_from,e[22]=l.amount_given,e[23]=l.commission,e[24]=l.exchange_rate,e[25]=S):S=e[25];const T=n?.operation_type;let F;e[26]!==l.amount_from||e[27]!==l.amount_given||e[28]!==l.commission||e[29]!==l.exchange_rate||e[30]!==T?(F=[l.amount_from,l.amount_given,l.exchange_rate,l.commission,T],e[26]=l.amount_from,e[27]=l.amount_given,e[28]=l.commission,e[29]=l.exchange_rate,e[30]=T,e[31]=F):F=e[31],m.useEffect(S,F);let L;e[32]!==p||e[33]!==n||e[34]!==l.amount_from||e[35]!==l.commission||e[36]!==l.currency_from||e[37]!==l.currency_to||e[38]!==l.exchange_rate||e[39]!==l.notes?(L=async()=>{n&&(await Ne.entities.Transaction.create({client_id:n.id,ticket_number:n.ticket_number,operation_type:n.operation_type,service:n.service,currency_from:l.currency_from,currency_to:n.operation_type==="change"?l.currency_to:l.currency_from,amount_from:parseFloat(l.amount_from),amount_to:n.operation_type==="change"?p:parseFloat(l.amount_from),exchange_rate:n.operation_type==="change"?parseFloat(l.exchange_rate):1,commission:parseFloat(l.commission)||0,client_phone:n.phone}),await Ne.entities.Client.update(n.id,{status:"completed",completed_at:new Date().toISOString(),notes:l.notes}))},e[32]=p,e[33]=n,e[34]=l.amount_from,e[35]=l.commission,e[36]=l.currency_from,e[37]=l.currency_to,e[38]=l.exchange_rate,e[39]=l.notes,e[40]=L):L=e[40];let O;e[41]!==r||e[42]!==o?(O=()=>{o.invalidateQueries({queryKey:["clients"]}),o.invalidateQueries({queryKey:["transactions"]}),r()},e[41]=r,e[42]=o,e[43]=O):O=e[43];let $;e[44]!==L||e[45]!==O?($={mutationFn:L,onSuccess:O},e[44]=L,e[45]=O,e[46]=$):$=e[46];const E=Ve($);if(!n)return null;const B=n.operation_type,_=ft[B]||ft.depot,U=_.icon;let I;e[47]!==n.ticket_number?(I=s.jsx("span",{className:"text-2xl font-black text-slate-800",children:n.ticket_number}),e[47]=n.ticket_number,e[48]=I):I=e[48];const W=`flex items-center gap-1 rounded-md bg-slate-100 px-2 py-1 text-sm font-medium ${_.color}`;let P;e[49]!==U?(P=s.jsx(U,{className:"h-4 w-4"}),e[49]=U,e[50]=P):P=e[50];let M;e[51]!==_.label||e[52]!==W||e[53]!==P?(M=s.jsxs("span",{className:W,children:[P,_.label]}),e[51]=_.label,e[52]=W,e[53]=P,e[54]=M):M=e[54];let R;e[55]!==I||e[56]!==M?(R=s.jsxs("div",{className:"flex items-center gap-3",children:[I,M]}),e[55]=I,e[56]=M,e[57]=R):R=e[57];let A;e[58]!==n.phone?(A=s.jsx("span",{className:"text-sm font-normal text-slate-500",children:n.phone}),e[58]=n.phone,e[59]=A):A=e[59];let K;e[60]!==R||e[61]!==A?(K=s.jsx(Tt,{children:s.jsxs($t,{className:"flex items-center justify-between",children:[R,A]})}),e[60]=R,e[61]=A,e[62]=K):K=e[62];let q;e[63]===Symbol.for("react.memo_cache_sentinel")?(q=s.jsx("div",{className:"text-xs font-semibold tracking-wider text-slate-500 uppercase",children:"Service"}),e[63]=q):q=e[63];const Oe=n.service==="bureau"?"Bureau de Change":n.service;let oe;e[64]!==Oe?(oe=s.jsxs("div",{children:[q,s.jsx("div",{className:"text-lg font-bold text-slate-800",children:Oe})]}),e[64]=Oe,e[65]=oe):oe=e[65];let xe;e[66]!==n.operation_type||e[67]!==l.currency_from?(xe=["depot","transfert","retrait"].includes(n.operation_type)&&s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xs font-semibold tracking-wider text-slate-500 uppercase",children:"Devise"}),s.jsx("div",{className:"text-lg font-bold text-slate-800",children:l.currency_from})]}),e[66]=n.operation_type,e[67]=l.currency_from,e[68]=xe):xe=e[68];let ie;e[69]!==oe||e[70]!==xe?(ie=s.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-slate-50 p-4",children:[oe,xe]}),e[69]=oe,e[70]=xe,e[71]=ie):ie=e[71];const we=n.operation_type==="retrait"?"Montant à retirer":"Montant de l'opération";let ce;e[72]!==we?(ce=s.jsx(Ae,{children:we}),e[72]=we,e[73]=ce):ce=e[73];let de;e[74]!==l?(de=k=>f({...l,amount_from:k.target.value}),e[74]=l,e[75]=de):de=e[75];let ue;e[76]!==l.amount_from||e[77]!==de?(ue=s.jsx(ze,{type:"number",value:l.amount_from,onChange:de,className:"text-lg font-bold"}),e[76]=l.amount_from,e[77]=de,e[78]=ue):ue=e[78];let G;e[79]!==n.operation_type||e[80]!==l?(G=["depot","transfert","retrait"].includes(n.operation_type)&&s.jsxs(Xe,{value:l.currency_from,onValueChange:k=>f({...l,currency_from:k}),children:[s.jsx(Ye,{className:"w-24",children:s.jsx(Je,{})}),s.jsxs(et,{children:[s.jsx(je,{value:"USD",children:"USD"}),s.jsx(je,{value:"CDF",children:"CDF"}),s.jsx(je,{value:"EUR",children:"EUR"})]})]}),e[79]=n.operation_type,e[80]=l,e[81]=G):G=e[81];let he;e[82]!==ue||e[83]!==G?(he=s.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[ue,G]}),e[82]=ue,e[83]=G,e[84]=he):he=e[84];let Q;e[85]!==ce||e[86]!==he?(Q=s.jsxs("div",{children:[ce,he]}),e[85]=ce,e[86]=he,e[87]=Q):Q=e[87];let Z;e[88]!==p||e[89]!==n.operation_type||e[90]!==l?(Z=["depot","transfert"].includes(n.operation_type)&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx(Ae,{children:"Montant reçu du client"}),s.jsx(ze,{type:"number",value:l.amount_given,onChange:k=>f({...l,amount_given:k.target.value}),className:"mt-1",placeholder:"Combien le client a donné ?"})]}),p>0&&s.jsxs("div",{className:"rounded-xl border border-yellow-200 bg-yellow-50 p-4",children:[s.jsxs("div",{className:"mb-1 flex items-center gap-2 text-yellow-700",children:[s.jsx(dn,{className:"h-4 w-4"}),s.jsx("span",{className:"font-bold",children:"A rendre au client"})]}),s.jsxs("div",{className:"text-2xl font-black text-yellow-600",children:[p.toLocaleString()," ",l.currency_from]})]})]}),e[88]=p,e[89]=n.operation_type,e[90]=l,e[91]=Z):Z=e[91];let X;e[92]!==p||e[93]!==n.operation_type||e[94]!==l?(X=n.operation_type==="change"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Ae,{children:"Devise Source"}),s.jsxs(Xe,{value:l.currency_from,onValueChange:k=>f({...l,currency_from:k}),children:[s.jsx(Ye,{className:"mt-1",children:s.jsx(Je,{})}),s.jsxs(et,{children:[s.jsx(je,{value:"USD",children:"USD"}),s.jsx(je,{value:"CDF",children:"CDF"}),s.jsx(je,{value:"EUR",children:"EUR"})]})]})]}),s.jsxs("div",{children:[s.jsx(Ae,{children:"Devise Cible"}),s.jsxs(Xe,{value:l.currency_to,onValueChange:k=>f({...l,currency_to:k}),children:[s.jsx(Ye,{className:"mt-1",children:s.jsx(Je,{})}),s.jsxs(et,{children:[s.jsx(je,{value:"USD",children:"USD"}),s.jsx(je,{value:"CDF",children:"CDF"}),s.jsx(je,{value:"EUR",children:"EUR"})]})]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(Ae,{children:"Taux de change"}),s.jsx(ze,{type:"number",value:l.exchange_rate,onChange:k=>f({...l,exchange_rate:k.target.value}),className:"mt-1"})]}),s.jsxs("div",{className:"col-span-2 rounded-xl border border-amber-200 bg-amber-50 p-4",children:[s.jsx("div",{className:"mb-1 font-bold text-amber-700",children:"Montant à remettre"}),s.jsxs("div",{className:"text-3xl font-black text-amber-600",children:[p.toLocaleString()," ",l.currency_to]})]})]}),e[92]=p,e[93]=n.operation_type,e[94]=l,e[95]=X):X=e[95];let me;e[96]!==Q||e[97]!==Z||e[98]!==X?(me=s.jsxs("div",{className:"space-y-4",children:[Q,Z,X]}),e[96]=Q,e[97]=Z,e[98]=X,e[99]=me):me=e[99];let ye;e[100]===Symbol.for("react.memo_cache_sentinel")?(ye=s.jsx(Ae,{children:"Notes (optionnel)"}),e[100]=ye):ye=e[100];let Y;e[101]!==l?(Y=k=>f({...l,notes:k.target.value}),e[101]=l,e[102]=Y):Y=e[102];let J;e[103]!==l.notes||e[104]!==Y?(J=s.jsxs("div",{children:[ye,s.jsx(ct,{value:l.notes,onChange:Y,className:"mt-1",placeholder:"Remarques..."})]}),e[103]=l.notes,e[104]=Y,e[105]=J):J=e[105];let Ce;e[106]!==r?(Ce=s.jsx(ve,{variant:"outline",onClick:r,className:"flex-1",children:"Annuler"}),e[106]=r,e[107]=Ce):Ce=e[107];let ee;e[108]!==E?(ee=()=>E.mutate(),e[108]=E,e[109]=ee):ee=e[109];const ge=E.isPending||!l.amount_from,be=`flex-1 text-white ${n.operation_type==="depot"||n.operation_type==="transfert"?"bg-green-600 hover:bg-green-700":n.operation_type==="retrait"?"bg-blue-600 hover:bg-blue-700":"bg-amber-500 hover:bg-amber-600"}`;let te;e[110]!==E.isPending?(te=E.isPending?s.jsx(Bt,{className:"mr-2 h-4 w-4 animate-spin"}):s.jsx(mn,{className:"mr-2 h-4 w-4"}),e[110]=E.isPending,e[111]=te):te=e[111];let Se;e[112]!==_.label||e[113]!==ee||e[114]!==ge||e[115]!==be||e[116]!==te?(Se=s.jsxs(ve,{onClick:ee,disabled:ge,className:be,children:[te,"Valider ",_.label]}),e[112]=_.label,e[113]=ee,e[114]=ge,e[115]=be,e[116]=te,e[117]=Se):Se=e[117];let ne;e[118]!==Ce||e[119]!==Se?(ne=s.jsxs("div",{className:"flex gap-3 pt-4",children:[Ce,Se]}),e[118]=Ce,e[119]=Se,e[120]=ne):ne=e[120];let se;e[121]!==ie||e[122]!==me||e[123]!==J||e[124]!==ne?(se=s.jsxs("div",{className:"space-y-6 py-4",children:[ie,me,J,ne]}),e[121]=ie,e[122]=me,e[123]=J,e[124]=ne,e[125]=se):se=e[125];let ae;e[126]!==K||e[127]!==se?(ae=s.jsxs(It,{className:"max-w-lg",children:[K,se]}),e[126]=K,e[127]=se,e[128]=ae):ae=e[128];let fe;return e[129]!==r||e[130]!==a||e[131]!==ae?(fe=s.jsx(Ot,{open:a,onOpenChange:r,children:ae}),e[129]=r,e[130]=a,e[131]=ae,e[132]=fe):fe=e[132],fe}function cs(){return Ne.entities.ExchangeRate.filter({is_active:!0})}function Ps(){const t=H.c(112),[e,n]=m.useState(null),[a,r]=m.useState(!1),[o,u]=m.useState(!1),[c,i]=m.useState(null),[d,l]=m.useState(""),f=pt();let p;t[0]===Symbol.for("react.memo_cache_sentinel")?(p={queryKey:["clients","waiting"],queryFn:hs,refetchInterval:5e3},t[0]=p):p=t[0];const{data:x}=qe(p);let b;t[1]!==x?(b=x===void 0?[]:x,t[1]=x,t[2]=b):b=t[2];const h=b;let v;t[3]===Symbol.for("react.memo_cache_sentinel")?(v={queryKey:["clients","called"],queryFn:xs,refetchInterval:5e3},t[3]=v):v=t[3];const{data:y}=qe(v);let j;t[4]!==y?(j=y===void 0?[]:y,t[4]=y,t[5]=j):j=t[5];const N=j;let w;t[6]===Symbol.for("react.memo_cache_sentinel")?(w={queryKey:["clients","completed"],queryFn:ps,refetchInterval:1e4},t[6]=w):w=t[6];const{data:D}=qe(w);let C;t[7]!==D?(C=D===void 0?[]:D,t[7]=D,t[8]=C):C=t[8];const S=C;let T;if(t[9]!==d||t[10]!==h){let g;t[12]!==d?(g=z=>z.ticket_number.toLowerCase().includes(d.toLowerCase())||z.phone.includes(d),t[12]=d,t[13]=g):g=t[13],T=h.filter(g),t[9]=d,t[10]=h,t[11]=T}else T=t[11];const F=T;let L;if(t[14]!==N||t[15]!==d){let g;t[17]!==d?(g=z=>z.ticket_number.toLowerCase().includes(d.toLowerCase())||z.phone.includes(d),t[17]=d,t[18]=g):g=t[18],L=N.filter(g),t[14]=N,t[15]=d,t[16]=L}else L=t[16];const O=L;let $;if(t[19]!==S||t[20]!==d){let g;t[22]!==d?(g=z=>z.ticket_number.toLowerCase().includes(d.toLowerCase())||z.phone.includes(d),t[22]=d,t[23]=g):g=t[23],$=S.filter(g),t[19]=S,t[20]=d,t[21]=$}else $=t[21];const E=$;let B;t[24]!==f?(B={mutationFn:fs,onSuccess:g=>{f.invalidateQueries({queryKey:["clients"]}),Te.success(`Client ${g.ticket_number} appelé`)}},t[24]=f,t[25]=B):B=t[25];const _=Ve(B);let U;t[26]===Symbol.for("react.memo_cache_sentinel")?(U={mutationFn:ms,onSuccess:us},t[26]=U):U=t[26];const I=Ve(U);let W;t[27]!==_?(W=g=>_.mutate(g),t[27]=_,t[28]=W):W=t[28];const P=W;let M;t[29]!==I?(M=g=>I.mutate(g),t[29]=I,t[30]=M):M=t[30];const R=M;let A;t[31]===Symbol.for("react.memo_cache_sentinel")?(A=g=>{n(g),r(!0)},t[31]=A):A=t[31];const K=A;let q;t[32]===Symbol.for("react.memo_cache_sentinel")?(q=g=>{i(g),u(!0)},t[32]=q):q=t[32];const Oe=q;let oe;t[33]!==f?(oe=()=>{f.invalidateQueries({queryKey:["clients"]}),Te.info("Données actualisées")},t[33]=f,t[34]=oe):oe=t[34];const xe=oe;let ie,we;t[35]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx("div",{className:"rounded-2xl bg-blue-600 p-3 shadow-lg shadow-blue-500/20",children:s.jsx(Kt,{className:"h-6 w-6 text-white"})}),we=s.jsx("h1",{className:"text-2xl leading-none font-black tracking-tight text-slate-900",children:"Gestion"}),t[35]=ie,t[36]=we):(ie=t[35],we=t[36]);let ce;t[37]===Symbol.for("react.memo_cache_sentinel")?(ce=s.jsxs("div",{className:"flex items-center gap-4",children:[ie,s.jsxs("div",{children:[we,s.jsx("p",{className:"mt-1.5 flex items-center gap-1.5 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:s.jsx("span",{className:"pulse-soft h-2 w-2 rounded-full bg-emerald-500"})})]})]}),t[37]=ce):ce=t[37];let de;t[38]===Symbol.for("react.memo_cache_sentinel")?(de=s.jsx(ln,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-slate-400 transition-colors group-focus-within:text-blue-500"}),t[38]=de):de=t[38];let ue;t[39]===Symbol.for("react.memo_cache_sentinel")?(ue=g=>l(g.target.value),t[39]=ue):ue=t[39];let G;t[40]!==d?(G=s.jsx("div",{className:"mx-10 max-w-sm flex-1",children:s.jsxs("div",{className:"group relative",children:[de,s.jsx(ze,{placeholder:"Rechercher ticket...",value:d,onChange:ue,className:"h-11 w-full rounded-2xl border-transparent bg-slate-50 pl-11 font-medium text-slate-700 transition-all focus:border-blue-500 focus:bg-white"})]})}),t[40]=d,t[41]=G):G=t[41];const he=_.isPending&&"animate-spin";let Q;t[42]!==he?(Q=le("mr-2 h-4 w-4",he),t[42]=he,t[43]=Q):Q=t[43];let Z;t[44]!==Q?(Z=s.jsx(ht,{className:Q}),t[44]=Q,t[45]=Z):Z=t[45];let X;t[46]!==xe||t[47]!==Z?(X=s.jsxs(ve,{variant:"outline",onClick:xe,className:"h-12 rounded-2xl border-slate-200 bg-white px-6 font-bold shadow-sm transition-all hover:border-blue-500 hover:text-blue-600",children:[Z,"Actualiser"]}),t[46]=xe,t[47]=Z,t[48]=X):X=t[48];let me;t[49]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx("div",{className:"h-10 w-[1px] bg-slate-200"}),t[49]=me):me=t[49];let ye;t[50]===Symbol.for("react.memo_cache_sentinel")?(ye=s.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border border-slate-200 bg-slate-100 p-1.5 pr-4 shadow-inner",children:[s.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-100 bg-white text-slate-600 shadow-sm",children:s.jsx(pn,{className:"h-6 w-6"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[10px] font-black tracking-wider text-slate-400 uppercase",children:"Caissier"}),s.jsx("div",{className:"text-xs font-bold text-slate-700",children:"Havifin Team"})]})]}),t[50]=ye):ye=t[50];let Y;t[51]!==X?(Y=s.jsxs("div",{className:"flex items-center gap-4",children:[X,me,ye]}),t[51]=X,t[52]=Y):Y=t[52];let J;t[53]!==G||t[54]!==Y?(J=s.jsxs("header",{className:"z-20 flex h-20 flex-shrink-0 items-center justify-between border-b border-slate-200 bg-white px-10 shadow-[0_1px_3px_rgba(0,0,0,0.02)]",children:[ce,G,Y]}),t[53]=G,t[54]=Y,t[55]=J):J=t[55];const Ce=h.length;let ee;if(t[56]!==_.isPending||t[57]!==_.variables?.id||t[58]!==F||t[59]!==P){let g;t[61]!==_.isPending||t[62]!==_.variables?.id||t[63]!==P?(g=z=>s.jsx(rt,{client:z,onCall:P,isProcessing:_.isPending&&_.variables?.id===z.id},z.id),t[61]=_.isPending,t[62]=_.variables?.id,t[63]=P,t[64]=g):g=t[64],ee=F.map(g),t[56]=_.isPending,t[57]=_.variables?.id,t[58]=F,t[59]=P,t[60]=ee}else ee=t[60];let ge;t[65]!==ee?(ge=s.jsx(We,{mode:"popLayout",children:ee}),t[65]=ee,t[66]=ge):ge=t[66];let be;t[67]!==h.length?(be=h.length===0&&s.jsxs("div",{className:"mt-12 text-center opacity-30",children:[s.jsx(zt,{className:"mx-auto mb-4 h-16 w-16"}),s.jsx("p",{className:"text-sm font-bold tracking-widest uppercase",children:"Aucun client"})]}),t[67]=h.length,t[68]=be):be=t[68];let te;t[69]!==ge||t[70]!==be||t[71]!==h.length?(te=s.jsxs(tt,{title:"Clients en Attente",icon:xt,count:Ce,color:"bg-slate-900 text-white border-slate-900",children:[ge,be]}),t[69]=ge,t[70]=be,t[71]=h.length,t[72]=te):te=t[72];const Se=N.length;let ne;if(t[73]!==O||t[74]!==R){let g;t[76]!==R?(g=z=>s.jsx(rt,{client:z,onRecall:R,onProcess:K,onHelp:Oe},z.id),t[76]=R,t[77]=g):g=t[77],ne=O.map(g),t[73]=O,t[74]=R,t[75]=ne}else ne=t[75];let se;t[78]!==ne?(se=s.jsx(We,{mode:"popLayout",children:ne}),t[78]=ne,t[79]=se):se=t[79];let ae;t[80]!==N.length?(ae=N.length===0&&s.jsxs("div",{className:"mt-12 text-center opacity-20",children:[s.jsx(mt,{className:"mx-auto mb-4 h-16 w-16"}),s.jsx("p",{className:"text-sm font-bold tracking-widest uppercase",children:"Prenez un ticket"})]}),t[80]=N.length,t[81]=ae):ae=t[81];let fe;t[82]!==N.length||t[83]!==se||t[84]!==ae?(fe=s.jsxs(tt,{title:"En Cours de Service",icon:mt,count:Se,color:"bg-blue-600 text-white border-blue-600",children:[se,ae]}),t[82]=N.length,t[83]=se,t[84]=ae,t[85]=fe):fe=t[85];const k=S.length;let re;t[86]!==E?(re=E.map(ds),t[86]=E,t[87]=re):re=t[87];let V;t[88]!==re?(V=s.jsx(We,{mode:"popLayout",children:re}),t[88]=re,t[89]=V):V=t[89];let _e;t[90]!==S.length||t[91]!==V?(_e=s.jsx(tt,{title:"Derniers Traités",icon:gt,count:k,color:"bg-emerald-500 text-white border-emerald-500 shadow-lg shadow-emerald-500/20",children:V}),t[90]=S.length,t[91]=V,t[92]=_e):_e=t[92];let Pe;t[93]!==te||t[94]!==fe||t[95]!==_e?(Pe=s.jsx("main",{className:"flex-1 overflow-x-auto overflow-y-hidden bg-[url('/grid.svg')] bg-[length:40px_40px] bg-fixed px-10 py-8",children:s.jsxs("div",{className:"flex h-full min-w-max gap-10 pb-4",children:[te,fe,_e]})}),t[93]=te,t[94]=fe,t[95]=_e,t[96]=Pe):Pe=t[96];let Re;t[97]!==f?(Re=()=>{r(!1),n(null),f.invalidateQueries({queryKey:["clients"]})},t[97]=f,t[98]=Re):Re=t[98];let Ee;t[99]!==a||t[100]!==e||t[101]!==Re?(Ee=s.jsx(is,{client:e,open:a,onClose:Re}),t[99]=a,t[100]=e,t[101]=Re,t[102]=Ee):Ee=t[102];let Fe;t[103]===Symbol.for("react.memo_cache_sentinel")?(Fe=()=>{u(!1),i(null)},t[103]=Fe):Fe=t[103];const Qe=c?.phone;let Me;t[104]!==o||t[105]!==Qe?(Me=s.jsx(rs,{isOpen:o,onClose:Fe,clientPhone:Qe}),t[104]=o,t[105]=Qe,t[106]=Me):Me=t[106];let Le;return t[107]!==J||t[108]!==Pe||t[109]!==Ee||t[110]!==Me?(Le=s.jsx(Gt,{currentPageName:"Tableau de Bord Caissier",children:s.jsxs("div",{className:"flex h-[calc(100vh-64px)] flex-col overflow-hidden bg-slate-50",children:[J,Pe,Ee,Me]})}),t[107]=J,t[108]=Pe,t[109]=Ee,t[110]=Me,t[111]=Le):Le=t[111],Le}function ds(t){return s.jsx(rt,{client:t},t.id)}function us(){Te.info("Rappel envoyé à l'affichage")}async function ms(t){await Ne.entities.Client.update(t.id,{called_at:new Date().toISOString()})}async function fs(t){return await Ne.entities.Client.update(t.id,{status:"called",called_at:new Date().toISOString(),counter_number:1}),t}function ps(){return Ne.entities.Client.filter({status:"completed"},"-completed_at",20)}function xs(){return Ne.entities.Client.filter({status:"called"},"-called_at")}function hs(){return Ne.entities.Client.filter({status:"waiting"},"created_date")}export{Ps as default};
