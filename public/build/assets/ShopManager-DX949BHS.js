import{c as Ee,r as oe,u as Oe,j as t,L as Pe}from"./app-Cxt9o3Ni.js";import{b as L}from"./base44Client-DmNi4SLu.js";import{B as Se}from"./badge-CR7ZYRZw.js";import{B as M,t as U}from"./index-DuH3KfOy.js";import{C as Ce,U as Te,M as De}from"./ManagerModal-KovaTqbU.js";import{b as Ae,c as Le,a as Ue,D as Ie}from"./dialog-jwl-8dtj.js";import{I as Ne,L as B}from"./label-Crfn3rDI.js";import{T as de,a as i,b as Ke,c as A,d as $e,e as ze}from"./table-DNhAI4A8.js";import{u as qe,U as Me}from"./users-N9kzuMsT.js";import{u as ye}from"./useMutation-Cv3eKr3X.js";import{S as Qe}from"./app-main-BA-8pEG-.js";import{c as Ge}from"./createLucideIcon-DKGtSlCQ.js";import{T as He}from"./trash-2-CX7kCfQc.js";import{P as Re}from"./plus-Caj-40gV.js";const Ve=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Je=Ge("SquarePen",Ve);function ft(){const e=Ee.c(91),[F,l]=oe.useState(!1),[me,ke]=oe.useState(!1),[E,ue]=oe.useState(null),O=Oe();let I;e[0]===Symbol.for("react.memo_cache_sentinel")?(I=[],e[0]=I):I=e[0];let K;e[1]===Symbol.for("react.memo_cache_sentinel")?(K={name:"",address:"",counter_count:1,is_active:!0,user_ids:I},e[1]=K):K=e[1];const[a,r]=oe.useState(K);let $;e[2]===Symbol.for("react.memo_cache_sentinel")?($={queryKey:["shops"],queryFn:L.entities.Shop.list},e[2]=$):$=e[2];const{data:z,isLoading:xe}=qe($);let Q;e[3]===Symbol.for("react.memo_cache_sentinel")?(Q={queryKey:["users"],queryFn:L.entities.User.list},e[3]=Q):Q=e[3];const{data:he}=qe(Q),P=ye({mutationFn:L.entities.Shop.create,onSuccess:()=>{O.invalidateQueries({queryKey:["shops"]}),l(!1),D(),U.success("Boutique créée avec succès")},onError:tt}),T=ye({mutationFn:et,onSuccess:()=>{O.invalidateQueries({queryKey:["shops"]}),ue(null),l(!1),D(),U.success("Boutique mise à jour avec succès")},onError:Ze});let G;e[4]!==O?(G={mutationFn:L.entities.Shop.delete,onSuccess:()=>{O.invalidateQueries({queryKey:["shops"]}),U.success("Boutique supprimée avec succès")}},e[4]=O,e[5]=G):G=e[5];const pe=ye(G),D=()=>{r({name:"",address:"",counter_count:1,is_active:!0,user_ids:[]})};let H;e[6]!==P||e[7]!==E||e[8]!==a||e[9]!==T?(H=s=>{s.preventDefault(),E?T.mutate({id:E.id,data:a}):P.mutate(a)},e[6]=P,e[7]=E,e[8]=a,e[9]=T,e[10]=H):H=e[10];const fe=H;let R;e[11]===Symbol.for("react.memo_cache_sentinel")?(R=s=>{ue(s),r({name:s.name,address:s.address||"",counter_count:s.counter_count,is_active:s.is_active,user_ids:s.users?.map(Ye)||[]}),l(!0)},e[11]=R):R=e[11];const Be=R;let V;e[12]!==pe?(V=s=>{confirm("Supprimer cette boutique ?")&&pe.mutate(s)},e[12]=pe,e[13]=V):V=e[13];const ge=V;let J;e[14]===Symbol.for("react.memo_cache_sentinel")?(J=s=>{r(_e=>{const ce=[..._e.user_ids],we=ce.indexOf(s);return we>-1?ce.splice(we,1):ce.push(s),{..._e,user_ids:ce}})},e[14]=J):J=e[14];const Fe=J;let W;e[15]===Symbol.for("react.memo_cache_sentinel")?(W=t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-900",children:"Gestion des Boutiques"}),t.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Configurez vos points de vente et assignez le personnel"})]}),e[15]=W):W=e[15];let X;e[16]===Symbol.for("react.memo_cache_sentinel")?(X=()=>ke(!0),e[16]=X):X=e[16];let Y;e[17]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsxs(M,{onClick:X,variant:"outline",className:"h-11 rounded-xl border-slate-200 bg-white px-6 text-xs font-black tracking-widest text-slate-600 uppercase shadow-sm transition-all hover:bg-slate-50 active:scale-95",children:[t.jsx(Te,{className:"mr-2 h-4 w-4"}),"Nouveau Manager"]}),e[17]=Y):Y=e[17];let n;e[18]!==D?(n=()=>{ue(null),D(),l(!0)},e[18]=D,e[19]=n):n=e[19];let Z;e[20]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsx(Re,{className:"mr-2 h-4 w-4"}),e[20]=Z):Z=e[20];let c;e[21]!==n?(c=t.jsxs("div",{className:"flex items-center justify-between",children:[W,t.jsxs("div",{className:"flex items-center gap-3",children:[Y,t.jsxs(M,{onClick:n,className:"h-11 rounded-xl bg-indigo-600 px-6 text-xs font-black tracking-widest text-white uppercase shadow-lg shadow-indigo-600/20 transition-all hover:bg-indigo-700 active:scale-95",children:[Z,"Nouvelle Boutique"]})]})]}),e[21]=n,e[22]=c):c=e[22];let o;e[23]!==me?(o=t.jsx(De,{isOpen:me,onOpenChange:ke}),e[23]=me,e[24]=o):o=e[24];let ee;e[25]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx(Ke,{className:"bg-slate-50/50",children:t.jsxs(de,{className:"border-slate-100 hover:bg-transparent",children:[t.jsx(A,{className:"py-5 pl-8 text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Boutique"}),t.jsx(A,{className:"text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Guichets"}),t.jsx(A,{className:"text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Personnel"}),t.jsx(A,{className:"text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Statut"}),t.jsx(A,{className:"pr-8 text-right text-[11px] font-black tracking-widest text-slate-400 uppercase",children:"Actions"})]})}),e[25]=ee):ee=e[25];let d;e[26]!==ge||e[27]!==xe||e[28]!==z?(d=xe?t.jsx(de,{children:t.jsx(i,{colSpan:5,className:"h-40 text-center font-medium text-slate-400",children:"Chargement des boutiques..."})}):z?.length===0?t.jsx(de,{children:t.jsxs(i,{colSpan:5,className:"h-40 text-center text-slate-400",children:[t.jsx(Qe,{className:"mx-auto mb-4 h-12 w-12 opacity-10"}),"Aucune boutique configurée"]})}):z?.map(s=>t.jsxs(de,{className:"group border-slate-50 transition-colors hover:bg-slate-50/50",children:[t.jsx(i,{className:"py-6 pl-8",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-black text-slate-900",children:s.name}),t.jsx("div",{className:"text-[10px] font-bold tracking-wider text-slate-400 uppercase",children:s.address||"Sans adresse"})]})}),t.jsx(i,{children:t.jsxs(Se,{variant:"outline",className:"rounded-lg border-slate-200 bg-white px-2 py-1 text-[10px] font-black tracking-widest text-slate-600 uppercase",children:[s.counter_count," Guichet(s)"]})}),t.jsx(i,{children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex -space-x-2",children:s.users&&s.users.length>0?s.users.slice(0,3).map(Xe):t.jsx("span",{className:"text-[10px] font-bold text-slate-300 uppercase italic",children:"Vide"})}),s.users&&s.users.length>3&&t.jsxs("span",{className:"text-[10px] font-black text-slate-400",children:["+",s.users.length-3]})]})}),t.jsx(i,{children:t.jsx(Se,{className:`rounded-full px-3 py-1 text-[9px] font-black tracking-widest uppercase ${s.is_active?"border-none bg-emerald-100 text-emerald-600":"border-none bg-slate-100 text-slate-400"}`,children:s.is_active?"Ouvert":"Fermé"})}),t.jsx(i,{className:"pr-8 text-right",children:t.jsxs("div",{className:"flex justify-end gap-2 opacity-0 transition-opacity group-hover:opacity-100",children:[t.jsx(Pe,{href:`/admin/shops/${s.id}`,className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-100 bg-white text-slate-400 transition-all hover:border-blue-500 hover:text-blue-600 hover:shadow-lg",children:t.jsx(Me,{className:"h-4 w-4"})}),t.jsx(M,{variant:"ghost",size:"icon",onClick:()=>Be(s),className:"sm-indigo-500/10 h-9 w-9 rounded-xl border border-slate-100 bg-white text-slate-400 transition-all hover:border-indigo-500 hover:text-indigo-600 hover:shadow-lg",children:t.jsx(Je,{className:"h-4 w-4"})}),t.jsx(M,{variant:"ghost",size:"icon",onClick:()=>ge(s.id),className:"sm-red-500/10 h-9 w-9 rounded-xl border border-slate-100 bg-white text-slate-400 transition-all hover:border-red-500 hover:text-red-600 hover:shadow-lg",children:t.jsx(He,{className:"h-4 w-4"})})]})})]},s.id)),e[26]=ge,e[27]=xe,e[28]=z,e[29]=d):d=e[29];let m;e[30]!==d?(m=t.jsx("div",{className:"overflow-hidden rounded-[2rem] border border-slate-100 bg-white/50 shadow-sm backdrop-blur-xl transition-all",children:t.jsxs($e,{children:[ee,t.jsx(ze,{children:d})]})}),e[30]=d,e[31]=m):m=e[31];const be=E?"Modifier Boutique":"Nouvelle Boutique";let u;e[32]!==be?(u=t.jsx("div",{className:"border-b border-slate-100 bg-slate-50/50 p-8",children:t.jsx(Ae,{children:t.jsx(Le,{className:"text-2xl font-black tracking-tight text-slate-900",children:be})})}),e[32]=be,e[33]=u):u=e[33];let te;e[34]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx(B,{htmlFor:"name",className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Nom de la Boutique"}),e[34]=te):te=e[34];let x;e[35]!==a?(x=s=>r({...a,name:s.target.value}),e[35]=a,e[36]=x):x=e[36];let h;e[37]!==a.name||e[38]!==x?(h=t.jsxs("div",{className:"space-y-3",children:[te,t.jsx(Ne,{id:"name",placeholder:"ex: Shop Central",className:"h-12 rounded-xl border-slate-200 font-bold focus:border-indigo-500 focus:ring-indigo-500",value:a.name,onChange:x,required:!0})]}),e[37]=a.name,e[38]=x,e[39]=h):h=e[39];let se;e[40]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsx(B,{htmlFor:"counter_count",className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Nombre de Guichets"}),e[40]=se):se=e[40];let p;e[41]!==a?(p=s=>r({...a,counter_count:parseInt(s.target.value)}),e[41]=a,e[42]=p):p=e[42];let f;e[43]!==a.counter_count||e[44]!==p?(f=t.jsxs("div",{className:"space-y-3",children:[se,t.jsx(Ne,{id:"counter_count",type:"number",min:"1",className:"h-12 rounded-xl border-slate-200 font-bold focus:border-indigo-500 focus:ring-indigo-500",value:a.counter_count,onChange:p,required:!0})]}),e[43]=a.counter_count,e[44]=p,e[45]=f):f=e[45];let g;e[46]!==h||e[47]!==f?(g=t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[h,f]}),e[46]=h,e[47]=f,e[48]=g):g=e[48];let ae;e[49]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx(B,{htmlFor:"address",className:"text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:"Adresse / Localisation"}),e[49]=ae):ae=e[49];let b;e[50]!==a?(b=s=>r({...a,address:s.target.value}),e[50]=a,e[51]=b):b=e[51];let j;e[52]!==a.address||e[53]!==b?(j=t.jsxs("div",{className:"space-y-3",children:[ae,t.jsx(Ne,{id:"address",placeholder:"ex: Av. du Commerce, Kinshasa",className:"h-12 rounded-xl border-slate-200 font-bold focus:border-indigo-500 focus:ring-indigo-500",value:a.address,onChange:b})]}),e[52]=a.address,e[53]=b,e[54]=j):j=e[54];let le;e[55]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsxs(B,{className:"flex items-center gap-2 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[t.jsx(Me,{className:"h-3 w-3"})," Managers Assignés"]}),e[55]=le):le=e[55];let v;e[56]!==a.user_ids||e[57]!==he?(v=he?.filter(We).map(s=>t.jsxs("div",{className:`flex items-center gap-3 rounded-xl border p-3 transition-all ${a.user_ids.includes(s.id)?"border-indigo-200 bg-indigo-50/50":"border-slate-100 bg-white hover:border-slate-200"}`,children:[t.jsx(Ce,{id:`user-${s.id}`,checked:a.user_ids.includes(s.id),onCheckedChange:()=>Fe(s.id)}),t.jsxs(B,{htmlFor:`user-${s.id}`,className:"flex flex-1 cursor-pointer flex-col",children:[t.jsx("span",{className:"text-xs font-bold text-slate-700",children:s.name}),t.jsx("span",{className:"text-[9px] font-black tracking-wider text-slate-400 uppercase",children:s.role})]})]},s.id)),e[56]=a.user_ids,e[57]=he,e[58]=v):v=e[58];let N;e[59]!==v?(N=t.jsxs("div",{className:"space-y-4",children:[le,t.jsx("div",{className:"custom-scrollbar grid max-h-40 grid-cols-2 gap-3 overflow-y-auto pr-2",children:v})]}),e[59]=v,e[60]=N):N=e[60];let y;e[61]!==a?(y=s=>r({...a,is_active:s}),e[61]=a,e[62]=y):y=e[62];let k;e[63]!==a.is_active||e[64]!==y?(k=t.jsx(Ce,{id:"is_active",checked:a.is_active,onCheckedChange:y}),e[63]=a.is_active,e[64]=y,e[65]=k):k=e[65];let re;e[66]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx(B,{htmlFor:"is_active",className:"cursor-pointer text-xs font-bold text-slate-600",children:"Boutique Active / Ouverte"}),e[66]=re):re=e[66];let _;e[67]!==k?(_=t.jsxs("div",{className:"flex items-center gap-3",children:[k,re]}),e[67]=k,e[68]=_):_=e[68];let ie;e[69]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx(M,{type:"button",variant:"outline",onClick:()=>l(!1),className:"h-12 rounded-xl border-slate-200 px-8 text-xs font-black tracking-widest uppercase hover:bg-slate-50",children:"Annuler"}),e[69]=ie):ie=e[69];const je=P.isPending||T.isPending,ve=P.isPending||T.isPending?"Chargement...":"Enregistrer";let w;e[70]!==je||e[71]!==ve?(w=t.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[ie,t.jsx(M,{type:"submit",className:"h-12 rounded-xl bg-slate-900 px-8 text-xs font-black tracking-widest text-white uppercase shadow-xl transition-all hover:bg-black",disabled:je,children:ve})]}),e[70]=je,e[71]=ve,e[72]=w):w=e[72];let S;e[73]!==fe||e[74]!==g||e[75]!==j||e[76]!==N||e[77]!==_||e[78]!==w?(S=t.jsxs("form",{onSubmit:fe,className:"space-y-8 p-8",children:[g,j,N,_,w]}),e[73]=fe,e[74]=g,e[75]=j,e[76]=N,e[77]=_,e[78]=w,e[79]=S):S=e[79];let C;e[80]!==u||e[81]!==S?(C=t.jsxs(Ue,{className:"max-w-2xl overflow-hidden rounded-[2.5rem] border-slate-100 p-0",children:[u,S]}),e[80]=u,e[81]=S,e[82]=C):C=e[82];let q;e[83]!==F||e[84]!==C?(q=t.jsx(Ie,{open:F,onOpenChange:l,children:C}),e[83]=F,e[84]=C,e[85]=q):q=e[85];let ne;return e[86]!==c||e[87]!==o||e[88]!==m||e[89]!==q?(ne=t.jsxs("div",{className:"space-y-6",children:[c,o,m,q]}),e[86]=c,e[87]=o,e[88]=m,e[89]=q,e[90]=ne):ne=e[90],ne}function We(e){return e.role==="manager"}function Xe(e){return t.jsx("div",{title:e.name,className:"flex h-8 w-8 items-center justify-center rounded-full border-2 border-white bg-indigo-100 text-[10px] font-black text-indigo-600 shadow-sm",children:e.name.charAt(0).toUpperCase()},e.id)}function Ye(e){return e.id}function Ze(e){U.error(e.response?.data?.message||"Erreur lors de la mise à jour")}function et(e){const{id:F,data:l}=e;return L.entities.Shop.update(F,l)}function tt(e){U.error(e.response?.data?.message||"Erreur lors de la création")}export{Je as S,ft as a};
