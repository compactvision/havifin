import{c as Ue,R as Ze,j as s,r as de,u as rt,a as ft}from"./app-DkFnKQqu.js";import{A as He,b as _e,u as Oe}from"./base44Client-DAffFGfU.js";import{B as pt}from"./badge-ClbS0mgP.js";import{B as pe,t as Te}from"./index-DgHTDt3N.js";import{c as Ce,b as ke,m as Be}from"./createLucideIcon-CI6QMrH4.js";import{h as lt,L as bt}from"./moment-ByqU4UZs.js";import{C as it,R as ot,a as ct,A as gt}from"./refresh-cw-B1VdfBTQ.js";import{S as yt}from"./smartphone-BNoicElp.js";import{A as et}from"./arrow-right-C1U89hv0.js";import{P as _t,C as jt,a as vt,b as wt}from"./phone-B7r7W3pN.js";import{D as dt,a as mt,b as Nt,c as ut,d as ht}from"./index-BCYbKlc0.js";import{u as Qe}from"./check-LQOZXpZ8.js";import{C as Ct}from"./circle-alert-C92WPWAJ.js";import{I as Ke,L as Le}from"./label-_YbXeZt4.js";import{S as We,a as Ge,b as Je,c as Xe,d as ye}from"./select-DjJYDB6t.js";import{L as kt}from"./loader-circle-D3PApFWE.js";import{A as St}from"./app-main-CFwQ4KEa.js";import{U as Pt}from"./users-D1gVHlYe.js";import{S as Dt}from"./search-DcRWAGcZ.js";/* empty css            */const Mt=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],At=Ce("Calculator",Mt);const Ft=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Rt=Ce("CircleCheckBig",Ft);const $t=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],Et=Ce("CircleUser",$t);const qt=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v2",key:"stiyo7"}],["path",{d:"M12 13h.01",key:"y0uutt"}]],Lt=Ce("MessageSquareWarning",qt);const Ut=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]],at=Ce("PhoneCall",Ut);const Tt=[["polyline",{points:"18 2 22 6 18 10",key:"6vjanh"}],["line",{x1:"14",x2:"22",y1:"6",y2:"6",key:"1jsywh"}],["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],zt=Ce("PhoneForwarded",Tt);const It=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Ht=Ce("Send",It);const Ot=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Kt=Ce("TriangleAlert",Ot);function tt(t){const e=Ue.c(71),{client:a,onCall:c,onRecall:n,onProcess:d,onHelp:v,isProcessing:b}=t,[i,N]=Ze.useState(!1),l=a.status==="called",_=a.status==="completed",r=a.status==="waiting";let g,y;e[0]!==l?(g=()=>{l&&N(!0)},y=[l],e[0]=l,e[1]=g,e[2]=y):(g=e[1],y=e[2]),Ze.useEffect(g,y);let x,m,u;e[3]===Symbol.for("react.memo_cache_sentinel")?(x={opacity:0,scale:.98,y:5},m={opacity:1,scale:1,y:0},u={opacity:0,scale:.95,y:-5},e[3]=x,e[4]=m,e[5]=u):(x=e[3],m=e[4],u=e[5]);let f;e[6]!==l||e[7]!==i?(f=()=>!l&&N(!i),e[6]=l,e[7]=i,e[8]=f):f=e[8];const k=l?"rounded-[2rem] border-blue-500/30 bg-white p-5 shadow-xl ring-1 shadow-blue-500/5 ring-blue-50":_?"rounded-2xl border-slate-100 bg-slate-50/50 p-3 opacity-60 hover:opacity-100":"rounded-2xl border-slate-200 bg-white p-3 shadow-sm hover:border-blue-300 hover:shadow-md";let p;e[9]!==k?(p=ke("group relative cursor-pointer overflow-hidden transition-all duration-300",k),e[9]=k,e[10]=p):p=e[10];const P=l?"h-14 w-14 rounded-2xl bg-blue-600 text-xl text-white shadow-lg shadow-blue-500/20":"h-10 w-10 rounded-xl bg-slate-900 text-sm text-white";let w;e[11]!==P?(w=ke("flex flex-shrink-0 items-center justify-center font-black tracking-tighter transition-all",P),e[11]=P,e[12]=w):w=e[12];let C;e[13]!==a.ticket_number||e[14]!==w?(C=s.jsx("div",{className:w,children:a.ticket_number}),e[13]=a.ticket_number,e[14]=w,e[15]=C):C=e[15];const F=l?"text-lg":"text-sm";let U;e[16]!==F?(U=ke("truncate leading-tight font-black tracking-tight text-slate-800",F),e[16]=F,e[17]=U):U=e[17];const H=a.first_name?`${a.first_name} ${a.last_name||""}`:a.phone;let R;e[18]!==U||e[19]!==H?(R=s.jsx("h4",{className:U,children:H}),e[18]=U,e[19]=H,e[20]=R):R=e[20];let z;e[21]!==a.created_date||e[22]!==a.service||e[23]!==l||e[24]!==i?(z=!l&&!i&&s.jsxs("p",{className:"truncate text-[10px] font-bold tracking-wider text-slate-400 uppercase",children:[a.service," •"," ",lt(a.created_date).fromNow()]}),e[21]=a.created_date,e[22]=a.service,e[23]=l,e[24]=i,e[25]=z):z=e[25];let D;e[26]!==R||e[27]!==z?(D=s.jsxs("div",{className:"overflow-hidden",children:[R,z]}),e[26]=R,e[27]=z,e[28]=D):D=e[28];let Y;e[29]!==C||e[30]!==D?(Y=s.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[C,D]}),e[29]=C,e[30]=D,e[31]=Y):Y=e[31];let S;e[32]!==a||e[33]!==i||e[34]!==b||e[35]!==r||e[36]!==c?(S=r&&!i&&s.jsx(pe,{size:"icon",variant:"secondary",onClick:Z=>{Z.stopPropagation(),c?.(a)},disabled:b,className:"h-10 w-10 rounded-xl bg-blue-50 text-blue-600 shadow-sm transition-all hover:bg-blue-600 hover:text-white",children:b?s.jsx(ot,{className:"h-4 w-4 animate-spin"}):s.jsx(_t,{className:"h-4 w-4"})}),e[32]=a,e[33]=i,e[34]=b,e[35]=r,e[36]=c,e[37]=S):S=e[37];let j;e[38]!==a||e[39]!==l||e[40]!==v||e[41]!==n?(j=l&&s.jsxs("div",{className:"flex gap-1.5",onClick:Bt,children:[s.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>v?.(a),className:"h-9 w-9 rounded-xl border border-amber-100/50 bg-amber-50 text-amber-600 hover:bg-amber-100",children:s.jsx(Lt,{className:"h-4 w-4"})}),s.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>n?.(a),className:"h-9 w-9 rounded-xl border border-blue-100/50 bg-blue-50 text-blue-600 hover:bg-blue-100",children:s.jsx(zt,{className:"h-4 w-4"})})]}),e[38]=a,e[39]=l,e[40]=v,e[41]=n,e[42]=j):j=e[42];let $;e[43]!==S||e[44]!==j?($=s.jsxs("div",{className:"flex items-center gap-2",children:[S,j]}),e[43]=S,e[44]=j,e[45]=$):$=e[45];let O;e[46]!==Y||e[47]!==$?(O=s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[Y,$]}),e[46]=Y,e[47]=$,e[48]=O):O=e[48];let E;e[49]!==a||e[50]!==l||e[51]!==i||e[52]!==b||e[53]!==r||e[54]!==c||e[55]!==d?(E=i&&s.jsx(Be.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:s.jsxs("div",{className:ke("mt-4 space-y-3",l?"":"border-t border-slate-100 pt-3"),children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2 font-bold text-slate-500",children:[s.jsx(it,{className:"h-3.5 w-3.5"}),lt(a.created_date).format("HH:mm")]}),s.jsx(pt,{variant:"outline",className:"h-5 py-0 text-[9px] font-black tracking-tighter uppercase",children:a.operation_type})]}),s.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-slate-100/50 bg-slate-50 p-3",children:[s.jsx("div",{className:"rounded-lg bg-white p-1.5 shadow-sm",children:a.operation_type==="change"?s.jsx(bt,{className:"h-3.5 w-3.5 text-indigo-500"}):s.jsx(yt,{className:"h-3.5 w-3.5 text-amber-500"})}),s.jsx("span",{className:"text-[10px] font-black tracking-widest text-slate-600 uppercase",children:a.service})]}),a.amount&&s.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-blue-100/20 bg-blue-50/50 p-3",children:[s.jsx("span",{className:"text-[9px] font-black tracking-widest text-blue-600/60 uppercase",children:"Estimation"}),s.jsxs("span",{className:"font-mono text-sm font-black text-blue-700",children:[a.amount?.toLocaleString()," ",a.currency_to]})]}),s.jsxs("div",{className:"pt-2",children:[r&&s.jsxs(pe,{onClick:Z=>{Z.stopPropagation(),c?.(a)},disabled:b,className:"h-11 w-full rounded-xl bg-blue-600 text-sm font-black text-white shadow-lg shadow-blue-600/20",children:["Appeler Ticket",s.jsx(et,{className:"ml-2 h-4 w-4"})]}),l&&s.jsxs(pe,{onClick:Z=>{Z.stopPropagation(),d?.(a)},className:"h-12 w-full rounded-xl bg-slate-900 text-sm font-black text-white shadow-xl shadow-slate-900/10",children:["Démarrer le service",s.jsx(et,{className:"ml-2 h-4 w-4 text-[#00e2f6]"})]})]})]})}),e[49]=a,e[50]=l,e[51]=i,e[52]=b,e[53]=r,e[54]=c,e[55]=d,e[56]=E):E=e[56];let M;e[57]!==E?(M=s.jsx(He,{children:E}),e[57]=E,e[58]=M):M=e[58];let q;e[59]!==_||e[60]!==i?(q=_&&!i&&s.jsxs("div",{className:"mt-2 flex items-center justify-center gap-1 text-[9px] font-black tracking-widest text-emerald-600 uppercase",children:[s.jsx(ct,{className:"h-3 w-3"}),"Terminé"]}),e[59]=_,e[60]=i,e[61]=q):q=e[61];let A;e[62]!==l?(A=l&&s.jsx("div",{className:"absolute -right-6 -bottom-6 h-16 w-16 rounded-full bg-blue-500/5 blur-2xl"}),e[62]=l,e[63]=A):A=e[63];let T;return e[64]!==O||e[65]!==M||e[66]!==q||e[67]!==A||e[68]!==f||e[69]!==p?(T=s.jsxs(Be.div,{layout:!0,initial:x,animate:m,exit:u,onClick:f,className:p,children:[O,M,q,A]}),e[64]=O,e[65]=M,e[66]=q,e[67]=A,e[68]=f,e[69]=p,e[70]=T):T=e[70],T}function Bt(t){return t.stopPropagation()}const st=de.forwardRef((t,e)=>{const a=Ue.c(9);let c,n;a[0]!==t?({className:c,...n}=t,a[0]=t,a[1]=c,a[2]=n):(c=a[1],n=a[2]);let d;a[3]!==c?(d=ke("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",c),a[3]=c,a[4]=d):d=a[4];let v;return a[5]!==n||a[6]!==e||a[7]!==d?(v=s.jsx("textarea",{className:d,ref:e,...n}),a[5]=n,a[6]=e,a[7]=d,a[8]=v):v=a[8],v});st.displayName="Textarea";function Qt(t){const e=Ue.c(36),{isOpen:a,onClose:c,clientPhone:n}=t,[d,v]=Ze.useState("");let b;e[0]!==c?(b={mutationFn:Wt,onSuccess:()=>{Te.success("Demande d'aide envoyée au manager"),v(""),c()},onError:Vt},e[0]=c,e[1]=b):b=e[1];const i=Qe(b);let N;e[2]!==n||e[3]!==d||e[4]!==i?(N=F=>{F.preventDefault(),d.trim()&&i.mutate({client_phone:n||"N/A",description:d})},e[2]=n,e[3]=d,e[4]=i,e[5]=N):N=e[5];const l=N;let _;e[6]===Symbol.for("react.memo_cache_sentinel")?(_=s.jsx("div",{className:"absolute top-0 right-0 h-32 w-32 translate-x-1/2 -translate-y-1/2 bg-amber-500/10 blur-3xl"}),e[6]=_):_=e[6];let r;e[7]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsxs(dt,{className:"mb-6",children:[s.jsx("div",{className:"mb-4 flex h-14 w-14 items-center justify-center rounded-2xl border border-amber-500/30 bg-amber-500/20",children:s.jsx(Kt,{className:"h-8 w-8 text-amber-500"})}),s.jsx(mt,{className:"text-3xl font-black tracking-tight",children:"Besoin d'aide ?"}),s.jsx(Nt,{className:"text-lg font-medium text-slate-400",children:"Expliquez brièvement le problème au manager."})]}),e[7]=r):r=e[7];let g;e[8]===Symbol.for("react.memo_cache_sentinel")?(g=s.jsx("label",{className:"ml-1 text-xs font-black tracking-widest text-slate-500 uppercase",children:"Message d'urgence"}),e[8]=g):g=e[8];let y;e[9]===Symbol.for("react.memo_cache_sentinel")?(y=F=>v(F.target.value),e[9]=y):y=e[9];let x;e[10]!==d?(x=s.jsxs("div",{className:"space-y-2",children:[g,s.jsx(st,{value:d,onChange:y,placeholder:"Ex: Problème de validation M-Pesa, client impatient...",className:"min-h-[120px] resize-none rounded-2xl border-white/10 bg-white/5 p-4 text-lg text-white placeholder:text-slate-600 focus:border-amber-500 focus:ring-amber-500"})]}),e[10]=d,e[11]=x):x=e[11];let m;e[12]!==n?(m=n&&s.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border border-white/5 bg-white/5 p-4",children:[s.jsx(Ct,{className:"h-5 w-5 text-slate-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-[10px] font-black tracking-wider text-slate-500 uppercase",children:"Client associé"}),s.jsx("div",{className:"text-sm font-bold",children:n})]})]}),e[12]=n,e[13]=m):m=e[13];let u;e[14]!==c?(u=s.jsx(pe,{type:"button",variant:"ghost",onClick:c,className:"h-14 flex-1 rounded-2xl border border-white/5 font-bold text-slate-400 hover:bg-white/5",children:"Annuler"}),e[14]=c,e[15]=u):u=e[15];let f;e[16]!==d||e[17]!==i.isPending?(f=i.isPending||!d.trim(),e[16]=d,e[17]=i.isPending,e[18]=f):f=e[18];let k;e[19]!==i.isPending?(k=i.isPending?s.jsx(Be.div,{animate:{rotate:360},transition:{repeat:1/0,duration:1,ease:"linear"},children:s.jsx(RefreshCw,{className:"h-6 w-6"})}):s.jsxs(s.Fragment,{children:["Envoyer Alerte",s.jsx(Ht,{className:"ml-2 h-5 w-5"})]}),e[19]=i.isPending,e[20]=k):k=e[20];let p;e[21]!==f||e[22]!==k?(p=s.jsx(pe,{type:"submit",disabled:f,className:"h-14 flex-[2] rounded-2xl bg-amber-500 text-lg font-black text-black shadow-lg shadow-amber-500/20 hover:bg-amber-600",children:k}),e[21]=f,e[22]=k,e[23]=p):p=e[23];let P;e[24]!==p||e[25]!==u?(P=s.jsxs("div",{className:"flex gap-4 pt-2",children:[u,p]}),e[24]=p,e[25]=u,e[26]=P):P=e[26];let w;e[27]!==l||e[28]!==P||e[29]!==x||e[30]!==m?(w=s.jsx(ut,{className:"overflow-hidden rounded-[32px] border-none bg-slate-900 p-0 text-white sm:max-w-[500px]",children:s.jsxs("div",{className:"relative p-8",children:[_,r,s.jsxs("form",{onSubmit:l,className:"space-y-6",children:[x,m,P]})]})}),e[27]=l,e[28]=P,e[29]=x,e[30]=m,e[31]=w):w=e[31];let C;return e[32]!==a||e[33]!==c||e[34]!==w?(C=s.jsx(ht,{open:a,onOpenChange:c,children:w}),e[32]=a,e[33]=c,e[34]=w,e[35]=C):C=e[35],C}function Vt(){Te.error("Erreur lors de l'envoi de la demande")}async function Wt(t){return _e.entities.HelpRequest.create(t)}function Ye(t){const e=Ue.c(28),{title:a,icon:c,count:n,color:d,children:v}=t;let b;e[0]!==d?(b=ke("rounded-2xl border p-2.5 shadow-sm",d),e[0]=d,e[1]=b):b=e[1];let i;e[2]!==c?(i=s.jsx(c,{className:"h-5 w-5"}),e[2]=c,e[3]=i):i=e[3];let N;e[4]!==b||e[5]!==i?(N=s.jsx("div",{className:b,children:i}),e[4]=b,e[5]=i,e[6]=N):N=e[6];let l;e[7]!==a?(l=s.jsx("h3",{className:"text-xl leading-none font-black tracking-tight text-slate-800",children:a}),e[7]=a,e[8]=l):l=e[8];const _=n>1?"Clients":"Client";let r;e[9]!==n||e[10]!==_?(r=s.jsxs("p",{className:"mt-1.5 text-[10px] font-black tracking-[0.2em] text-slate-400 uppercase",children:[n," ",_]}),e[9]=n,e[10]=_,e[11]=r):r=e[11];let g;e[12]!==l||e[13]!==r?(g=s.jsxs("div",{children:[l,r]}),e[12]=l,e[13]=r,e[14]=g):g=e[14];let y;e[15]!==N||e[16]!==g?(y=s.jsxs("div",{className:"flex items-center gap-3",children:[N,g]}),e[15]=N,e[16]=g,e[17]=y):y=e[17];let x;e[18]!==n?(x=s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl border border-slate-200 bg-slate-100 text-sm font-black text-slate-400 shadow-inner",children:n}),e[18]=n,e[19]=x):x=e[19];let m;e[20]!==y||e[21]!==x?(m=s.jsxs("div",{className:"mb-6 flex items-center justify-between px-1",children:[y,x]}),e[20]=y,e[21]=x,e[22]=m):m=e[22];let u;e[23]!==v?(u=s.jsx("div",{className:"scrollbar-none custom-kanban-scroll flex-1 overflow-y-auto pr-2",children:s.jsx("div",{className:"space-y-4 pb-12",children:v})}),e[23]=v,e[24]=u):u=e[24];let f;return e[25]!==m||e[26]!==u?(f=s.jsxs("div",{className:"flex h-full max-w-[450px] min-w-[320px] flex-1 flex-col",children:[m,u]}),e[25]=m,e[26]=u,e[27]=f):f=e[27],f}const nt={depot:{label:"Dépôt",icon:wt,color:"text-green-500",action:"Déposer"},retrait:{label:"Retrait",icon:vt,color:"text-blue-500",action:"Retirer"},change:{label:"Change",icon:gt,color:"text-amber-500",action:"Changer"},transfert:{label:"Transfert",icon:et,color:"text-purple-500",action:"Transférer"},paiement:{label:"Paiement",icon:jt,color:"text-pink-500",action:"Payer"}};function Gt(t){const e=Ue.c(133),{client:a,open:c,onClose:n}=t,d=rt(),v=a?.amount?String(a.amount):"",b=a?.currency_from||"USD",i=a?.currency_to||"CDF";let N;e[0]!==v||e[1]!==b||e[2]!==i?(N={amount_from:v,amount_given:"",currency_from:b,currency_to:i,exchange_rate:"",commission:"0",notes:""},e[0]=v,e[1]=b,e[2]=i,e[3]=N):N=e[3];const[l,_]=de.useState(N),[r,g]=de.useState(0);let y;e[4]===Symbol.for("react.memo_cache_sentinel")?(y={queryKey:["rates"],queryFn:Jt},e[4]=y):y=e[4];const{data:x}=Oe(y);let m;e[5]!==x?(m=x===void 0?[]:x,e[5]=x,e[6]=m):m=e[6];const u=m;let f,k;e[7]!==a?(f=()=>{a&&_(h=>({...h,amount_from:a.amount?String(a.amount):"",currency_from:a.currency_from||"USD",currency_to:a.currency_to||"CDF",amount_given:"",exchange_rate:"",commission:"0"}))},k=[a],e[7]=a,e[8]=f,e[9]=k):(f=e[8],k=e[9]),de.useEffect(f,k);let p;e[10]!==a?.operation_type||e[11]!==l.currency_from||e[12]!==l.currency_to||e[13]!==u?(p=()=>{if(a?.operation_type==="change"){const h=`${l.currency_from}_${l.currency_to}`,L=u.find(be=>be.currency_pair===h||be.currency_from===l.currency_from&&be.currency_to===l.currency_to);L&&_(be=>({...be,exchange_rate:String(L.buy_rate||L.rate)}))}},e[10]=a?.operation_type,e[11]=l.currency_from,e[12]=l.currency_to,e[13]=u,e[14]=p):p=e[14];const P=a?.operation_type;let w;e[15]!==l.currency_from||e[16]!==l.currency_to||e[17]!==u||e[18]!==P?(w=[l.currency_from,l.currency_to,u,P],e[15]=l.currency_from,e[16]=l.currency_to,e[17]=u,e[18]=P,e[19]=w):w=e[19],de.useEffect(p,w);let C;e[20]!==a?.operation_type||e[21]!==l.amount_from||e[22]!==l.amount_given||e[23]!==l.commission||e[24]!==l.exchange_rate?(C=()=>{if(!l.amount_from)return;const h=parseFloat(l.amount_from),L=parseFloat(l.amount_given)||0,be=parseFloat(l.exchange_rate)||1,ge=parseFloat(l.commission)||0;a?.operation_type==="change"?g(h*be-ge):["depot","transfert"].includes(a?.operation_type||"")&&L>0?g(L-h-ge):g(0)},e[20]=a?.operation_type,e[21]=l.amount_from,e[22]=l.amount_given,e[23]=l.commission,e[24]=l.exchange_rate,e[25]=C):C=e[25];const F=a?.operation_type;let U;e[26]!==l.amount_from||e[27]!==l.amount_given||e[28]!==l.commission||e[29]!==l.exchange_rate||e[30]!==F?(U=[l.amount_from,l.amount_given,l.exchange_rate,l.commission,F],e[26]=l.amount_from,e[27]=l.amount_given,e[28]=l.commission,e[29]=l.exchange_rate,e[30]=F,e[31]=U):U=e[31],de.useEffect(C,U);let H;e[32]!==r||e[33]!==a||e[34]!==l.amount_from||e[35]!==l.commission||e[36]!==l.currency_from||e[37]!==l.currency_to||e[38]!==l.exchange_rate||e[39]!==l.notes?(H=async()=>{if(!a)return;const h=isNaN(r)?0:r,L=a.operation_type==="change"?parseFloat(l.exchange_rate)||0:1;if(isNaN(L)||a.operation_type==="change"&&L===0)throw new Error("Taux de change invalide");await _e.entities.Transaction.create({client_id:a.id,ticket_number:a.ticket_number,operation_type:a.operation_type,service:a.service,currency_from:l.currency_from,currency_to:a.operation_type==="change"?l.currency_to:l.currency_from,amount_from:parseFloat(l.amount_from)||0,amount_to:a.operation_type==="change"?h:parseFloat(l.amount_from)||0,exchange_rate:L,commission:parseFloat(l.commission)||0,client_phone:a.phone}),await _e.entities.Client.update(a.id,{status:"completed",completed_at:new Date().toISOString(),notes:l.notes})},e[32]=r,e[33]=a,e[34]=l.amount_from,e[35]=l.commission,e[36]=l.currency_from,e[37]=l.currency_to,e[38]=l.exchange_rate,e[39]=l.notes,e[40]=H):H=e[40];let R;e[41]!==n||e[42]!==d?(R=()=>{d.invalidateQueries({queryKey:["clients"]}),d.invalidateQueries({queryKey:["transactions"]}),n()},e[41]=n,e[42]=d,e[43]=R):R=e[43];let z;e[44]!==H||e[45]!==R?(z={mutationFn:H,onSuccess:R},e[44]=H,e[45]=R,e[46]=z):z=e[46];const D=Qe(z);if(!a)return null;const Y=a.operation_type,S=nt[Y]||nt.depot,j=S.icon;let $;e[47]!==a.ticket_number?($=s.jsx("span",{className:"text-2xl font-black text-slate-800",children:a.ticket_number}),e[47]=a.ticket_number,e[48]=$):$=e[48];const O=`flex items-center gap-1 rounded-md bg-slate-100 px-2 py-1 text-sm font-medium ${S.color}`;let E;e[49]!==j?(E=s.jsx(j,{className:"h-4 w-4"}),e[49]=j,e[50]=E):E=e[50];let M;e[51]!==S.label||e[52]!==O||e[53]!==E?(M=s.jsxs("span",{className:O,children:[E,S.label]}),e[51]=S.label,e[52]=O,e[53]=E,e[54]=M):M=e[54];let q;e[55]!==$||e[56]!==M?(q=s.jsxs("div",{className:"flex items-center gap-3",children:[$,M]}),e[55]=$,e[56]=M,e[57]=q):q=e[57];let A;e[58]!==a.phone?(A=s.jsx("span",{className:"text-sm font-normal text-slate-500",children:a.phone}),e[58]=a.phone,e[59]=A):A=e[59];let T;e[60]!==q||e[61]!==A?(T=s.jsx(dt,{children:s.jsxs(mt,{className:"flex items-center justify-between",children:[q,A]})}),e[60]=q,e[61]=A,e[62]=T):T=e[62];let Z;e[63]===Symbol.for("react.memo_cache_sentinel")?(Z=s.jsx("div",{className:"text-xs font-semibold tracking-wider text-slate-500 uppercase",children:"Service"}),e[63]=Z):Z=e[63];const je=a.service==="bureau"?"Bureau de Change":a.service;let ve;e[64]!==je?(ve=s.jsxs("div",{children:[Z,s.jsx("div",{className:"text-lg font-bold text-slate-800",children:je})]}),e[64]=je,e[65]=ve):ve=e[65];let ee;e[66]!==a.operation_type||e[67]!==l.currency_from?(ee=["depot","transfert","retrait"].includes(a.operation_type)&&s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xs font-semibold tracking-wider text-slate-500 uppercase",children:"Devise"}),s.jsx("div",{className:"text-lg font-bold text-slate-800",children:l.currency_from})]}),e[66]=a.operation_type,e[67]=l.currency_from,e[68]=ee):ee=e[68];let me;e[69]!==ve||e[70]!==ee?(me=s.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-slate-50 p-4",children:[ve,ee]}),e[69]=ve,e[70]=ee,e[71]=me):me=e[71];const we=a.operation_type==="retrait"?"Montant à retirer":"Montant de l'opération";let te;e[72]!==we?(te=s.jsx(Le,{children:we}),e[72]=we,e[73]=te):te=e[73];let se;e[74]!==l?(se=h=>_({...l,amount_from:h.target.value}),e[74]=l,e[75]=se):se=e[75];let le;e[76]!==l.amount_from||e[77]!==se?(le=s.jsx(Ke,{type:"number",value:l.amount_from,onChange:se,className:"text-lg font-bold"}),e[76]=l.amount_from,e[77]=se,e[78]=le):le=e[78];let ae;e[79]!==a.operation_type||e[80]!==l?(ae=["depot","transfert","retrait"].includes(a.operation_type)&&s.jsxs(We,{value:l.currency_from,onValueChange:h=>_({...l,currency_from:h}),children:[s.jsx(Ge,{className:"w-24",children:s.jsx(Je,{})}),s.jsxs(Xe,{children:[s.jsx(ye,{value:"USD",children:"USD"}),s.jsx(ye,{value:"CDF",children:"CDF"}),s.jsx(ye,{value:"EUR",children:"EUR"})]})]}),e[79]=a.operation_type,e[80]=l,e[81]=ae):ae=e[81];let ne;e[82]!==le||e[83]!==ae?(ne=s.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[le,ae]}),e[82]=le,e[83]=ae,e[84]=ne):ne=e[84];let K;e[85]!==te||e[86]!==ne?(K=s.jsxs("div",{children:[te,ne]}),e[85]=te,e[86]=ne,e[87]=K):K=e[87];let ue;e[88]!==r||e[89]!==a.operation_type||e[90]!==l?(ue=["depot","transfert"].includes(a.operation_type)&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx(Le,{children:"Montant reçu du client"}),s.jsx(Ke,{type:"number",value:l.amount_given,onChange:h=>_({...l,amount_given:h.target.value}),className:"mt-1",placeholder:"Combien le client a donné ?"})]}),r>0&&s.jsxs("div",{className:"rounded-xl border border-yellow-200 bg-yellow-50 p-4",children:[s.jsxs("div",{className:"mb-1 flex items-center gap-2 text-yellow-700",children:[s.jsx(At,{className:"h-4 w-4"}),s.jsx("span",{className:"font-bold",children:"A rendre au client"})]}),s.jsxs("div",{className:"text-2xl font-black text-yellow-600",children:[r.toLocaleString()," ",l.currency_from]})]})]}),e[88]=r,e[89]=a.operation_type,e[90]=l,e[91]=ue):ue=e[91];let B;e[92]!==r||e[93]!==a.operation_type||e[94]!==l?(B=a.operation_type==="change"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Le,{children:"Devise Source"}),s.jsxs(We,{value:l.currency_from,onValueChange:h=>_({...l,currency_from:h}),children:[s.jsx(Ge,{className:"mt-1",children:s.jsx(Je,{})}),s.jsxs(Xe,{children:[s.jsx(ye,{value:"USD",children:"USD"}),s.jsx(ye,{value:"CDF",children:"CDF"}),s.jsx(ye,{value:"EUR",children:"EUR"})]})]})]}),s.jsxs("div",{children:[s.jsx(Le,{children:"Devise Cible"}),s.jsxs(We,{value:l.currency_to,onValueChange:h=>_({...l,currency_to:h}),children:[s.jsx(Ge,{className:"mt-1",children:s.jsx(Je,{})}),s.jsxs(Xe,{children:[s.jsx(ye,{value:"USD",children:"USD"}),s.jsx(ye,{value:"CDF",children:"CDF"}),s.jsx(ye,{value:"EUR",children:"EUR"})]})]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(Le,{children:"Taux de change"}),s.jsx(Ke,{type:"number",value:l.exchange_rate,onChange:h=>_({...l,exchange_rate:h.target.value}),className:"mt-1"})]}),s.jsxs("div",{className:"col-span-2 rounded-xl border border-amber-200 bg-amber-50 p-4",children:[s.jsx("div",{className:"mb-1 font-bold text-amber-700",children:"Montant à remettre"}),s.jsxs("div",{className:"text-3xl font-black text-amber-600",children:[r.toLocaleString()," ",l.currency_to]})]})]}),e[92]=r,e[93]=a.operation_type,e[94]=l,e[95]=B):B=e[95];let Q;e[96]!==K||e[97]!==ue||e[98]!==B?(Q=s.jsxs("div",{className:"space-y-4",children:[K,ue,B]}),e[96]=K,e[97]=ue,e[98]=B,e[99]=Q):Q=e[99];let re;e[100]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsx(Le,{children:"Notes (optionnel)"}),e[100]=re):re=e[100];let ie;e[101]!==l?(ie=h=>_({...l,notes:h.target.value}),e[101]=l,e[102]=ie):ie=e[102];let oe;e[103]!==l.notes||e[104]!==ie?(oe=s.jsxs("div",{children:[re,s.jsx(st,{value:l.notes,onChange:ie,className:"mt-1",placeholder:"Remarques..."})]}),e[103]=l.notes,e[104]=ie,e[105]=oe):oe=e[105];let he;e[106]!==n?(he=s.jsx(pe,{variant:"outline",onClick:n,className:"flex-1",children:"Annuler"}),e[106]=n,e[107]=he):he=e[107];let V;e[108]!==D?(V=()=>D.mutate(),e[108]=D,e[109]=V):V=e[109];const xe=D.isPending||!l.amount_from,fe=`flex-1 text-white ${a.operation_type==="depot"||a.operation_type==="transfert"?"bg-green-600 hover:bg-green-700":a.operation_type==="retrait"?"bg-blue-600 hover:bg-blue-700":"bg-amber-500 hover:bg-amber-600"}`;let W;e[110]!==D.isPending?(W=D.isPending?s.jsx(kt,{className:"mr-2 h-4 w-4 animate-spin"}):s.jsx(Rt,{className:"mr-2 h-4 w-4"}),e[110]=D.isPending,e[111]=W):W=e[111];let G;e[112]!==S.label||e[113]!==V||e[114]!==xe||e[115]!==fe||e[116]!==W?(G=s.jsxs(pe,{onClick:V,disabled:xe,className:fe,children:[W,"Valider ",S.label]}),e[112]=S.label,e[113]=V,e[114]=xe,e[115]=fe,e[116]=W,e[117]=G):G=e[117];let J;e[118]!==he||e[119]!==G?(J=s.jsxs("div",{className:"flex gap-3 pt-4",children:[he,G]}),e[118]=he,e[119]=G,e[120]=J):J=e[120];let Ne;e[121]!==me||e[122]!==Q||e[123]!==oe||e[124]!==J?(Ne=s.jsxs("div",{className:"space-y-6 py-4",children:[me,Q,oe,J]}),e[121]=me,e[122]=Q,e[123]=oe,e[124]=J,e[125]=Ne):Ne=e[125];let X;e[126]!==T||e[127]!==Ne?(X=s.jsxs(ut,{className:"max-w-lg",children:[T,Ne]}),e[126]=T,e[127]=Ne,e[128]=X):X=e[128];let ce;return e[129]!==n||e[130]!==c||e[131]!==X?(ce=s.jsx(ht,{open:c,onOpenChange:n,children:X}),e[129]=n,e[130]=c,e[131]=X,e[132]=ce):ce=e[132],ce}function Jt(){return _e.entities.ExchangeRate.filter({is_active:!0})}function Ns(){const t=Ue.c(125),{auth:e}=ft().props,[a,c]=de.useState(null),[n,d]=de.useState(!1),[v,b]=de.useState(!1),[i,N]=de.useState(null),[l,_]=de.useState(""),r=rt();let g;t[0]===Symbol.for("react.memo_cache_sentinel")?(g={queryKey:["clients","waiting"],queryFn:ls,refetchInterval:5e3},t[0]=g):g=t[0];const{data:y}=Oe(g);let x;t[1]!==y?(x=y===void 0?[]:y,t[1]=y,t[2]=x):x=t[2];const m=x;let u;t[3]===Symbol.for("react.memo_cache_sentinel")?(u={queryKey:["clients","called"],queryFn:ss,refetchInterval:5e3},t[3]=u):u=t[3];const{data:f}=Oe(u);let k;t[4]!==f?(k=f===void 0?[]:f,t[4]=f,t[5]=k):k=t[5];const p=k;let P;t[6]===Symbol.for("react.memo_cache_sentinel")?(P={queryKey:["clients","completed"],queryFn:ts,refetchInterval:1e4},t[6]=P):P=t[6];const{data:w}=Oe(P);let C;t[7]!==w?(C=w===void 0?[]:w,t[7]=w,t[8]=C):C=t[8];const F=C;let U;if(t[9]!==l||t[10]!==m){let o;t[12]!==l?(o=I=>I.ticket_number?.toLowerCase().includes(l.toLowerCase())||I.phone?.includes(l),t[12]=l,t[13]=o):o=t[13],U=m.filter(o),t[9]=l,t[10]=m,t[11]=U}else U=t[11];const H=U;let R;if(t[14]!==p||t[15]!==l){let o;t[17]!==l?(o=I=>I.ticket_number?.toLowerCase().includes(l.toLowerCase())||I.phone?.includes(l),t[17]=l,t[18]=o):o=t[18],R=p.filter(o),t[14]=p,t[15]=l,t[16]=R}else R=t[16];const z=R;let D;if(t[19]!==F||t[20]!==l){let o;t[22]!==l?(o=I=>I.ticket_number.toLowerCase().includes(l.toLowerCase())||I.phone.includes(l),t[22]=l,t[23]=o):o=t[23],D=F.filter(o),t[19]=F,t[20]=l,t[21]=D}else D=t[21];const Y=D;let S;t[24]!==r?(S={mutationFn:es,onSuccess:o=>{r.invalidateQueries({queryKey:["clients"]}),Te.success(`Client ${o.ticket_number} appelé`)}},t[24]=r,t[25]=S):S=t[25];const j=Qe(S);let $;t[26]===Symbol.for("react.memo_cache_sentinel")?($={mutationFn:Zt,onSuccess:Yt},t[26]=$):$=t[26];const O=Qe($);let E;t[27]!==j?(E=o=>j.mutate(o),t[27]=j,t[28]=E):E=t[28];const M=E;let q;t[29]!==O?(q=o=>O.mutate(o),t[29]=O,t[30]=q):q=t[30];const A=q;let T;t[31]===Symbol.for("react.memo_cache_sentinel")?(T=o=>{c(o),d(!0)},t[31]=T):T=t[31];const Z=T;let je;t[32]===Symbol.for("react.memo_cache_sentinel")?(je=o=>{N(o),b(!0)},t[32]=je):je=t[32];const ve=je;let ee;t[33]!==r?(ee=()=>{r.invalidateQueries({queryKey:["clients"]}),Te.info("Données actualisées")},t[33]=r,t[34]=ee):ee=t[34];const me=ee;let we;t[35]===Symbol.for("react.memo_cache_sentinel")?(we={scale:1.02},t[35]=we):we=t[35];let te,se;t[36]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx(Be.div,{whileHover:we,className:"relative flex h-16 w-36 items-center justify-center px-4",children:s.jsx("img",{src:"/logo-color.png",alt:"Havifin",className:"h-full w-full object-contain"})}),se=s.jsx("div",{className:"h-10 w-[1px] bg-slate-100"}),t[36]=te,t[37]=se):(te=t[36],se=t[37]);let le;t[38]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsxs("div",{className:"flex items-center gap-6",children:[te,se,s.jsx("div",{className:"hidden md:block",children:s.jsxs("h1",{className:"text-lg font-black tracking-tighter text-slate-800 uppercase",children:["Terminal"," ",s.jsx("span",{className:"text-blue-600",children:"Caisse"})]})})]}),t[38]=le):le=t[38];let ae;t[39]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx(Dt,{className:"absolute top-1/2 left-4 h-4 w-4 -translate-y-1/2 text-slate-400 transition-colors group-focus-within:text-blue-500"}),t[39]=ae):ae=t[39];let ne;t[40]===Symbol.for("react.memo_cache_sentinel")?(ne=o=>_(o.target.value),t[40]=ne):ne=t[40];let K;t[41]!==l?(K=s.jsx("div",{className:"mx-10 max-w-sm flex-1",children:s.jsxs("div",{className:"group relative",children:[ae,s.jsx(Ke,{placeholder:"Rechercher ticket...",value:l,onChange:ne,className:"h-11 w-full rounded-2xl border-transparent bg-slate-50 pl-11 font-medium text-slate-700 transition-all focus:border-blue-500 focus:bg-white"})]})}),t[41]=l,t[42]=K):K=t[42];const ue=j.isPending&&"animate-spin";let B;t[43]!==ue?(B=ke("mr-2 h-4 w-4",ue),t[43]=ue,t[44]=B):B=t[44];let Q;t[45]!==B?(Q=s.jsx(ot,{className:B}),t[45]=B,t[46]=Q):Q=t[46];let re;t[47]!==me||t[48]!==Q?(re=s.jsxs(pe,{variant:"outline",onClick:me,className:"h-12 rounded-2xl border-slate-200 bg-white px-6 font-bold shadow-sm transition-all hover:border-blue-500 hover:text-blue-600",children:[Q,"Actualiser"]}),t[47]=me,t[48]=Q,t[49]=re):re=t[49];let ie;t[50]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx("div",{className:"h-10 w-[1px] bg-slate-200"}),t[50]=ie):ie=t[50];let oe;t[51]===Symbol.for("react.memo_cache_sentinel")?(oe=s.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl border border-slate-100 bg-white text-slate-600 shadow-sm",children:s.jsx(Et,{className:"h-6 w-6"})}),t[51]=oe):oe=t[51];const he=e.user.shop?`• ${e.user.shop}`:"";let V;t[52]!==e.user.role||t[53]!==he?(V=s.jsxs("div",{className:"text-[10px] font-black tracking-wider text-slate-400 uppercase",children:[e.user.role," ",he]}),t[52]=e.user.role,t[53]=he,t[54]=V):V=t[54];let xe;t[55]!==e.user.name?(xe=s.jsx("div",{className:"text-xs font-bold text-slate-700",children:e.user.name}),t[55]=e.user.name,t[56]=xe):xe=t[56];let fe;t[57]!==V||t[58]!==xe?(fe=s.jsxs("div",{className:"flex items-center gap-3 rounded-2xl border border-slate-200 bg-slate-100 p-1.5 pr-4 shadow-inner",children:[oe,s.jsxs("div",{children:[V,xe]})]}),t[57]=V,t[58]=xe,t[59]=fe):fe=t[59];let W;t[60]!==e.user.counter?(W=e.user.counter&&s.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-blue-100 bg-blue-50 px-4 py-2 font-bold text-blue-600",children:[s.jsx("span",{className:"text-[10px] tracking-widest uppercase",children:"Guichet"}),s.jsx("span",{className:"text-sm",children:e.user.counter})]}),t[60]=e.user.counter,t[61]=W):W=t[61];let G;t[62]!==re||t[63]!==fe||t[64]!==W?(G=s.jsxs("div",{className:"flex items-center gap-4",children:[re,ie,fe,W]}),t[62]=re,t[63]=fe,t[64]=W,t[65]=G):G=t[65];let J;t[66]!==K||t[67]!==G?(J=s.jsxs("header",{className:"z-20 flex h-20 flex-shrink-0 items-center justify-between border-b border-slate-200 bg-white px-10 shadow-[0_1px_3px_rgba(0,0,0,0.02)]",children:[le,K,G]}),t[66]=K,t[67]=G,t[68]=J):J=t[68];const Ne=m.length;let X;if(t[69]!==j.isPending||t[70]!==j.variables?.id||t[71]!==H||t[72]!==M){let o;t[74]!==j.isPending||t[75]!==j.variables?.id||t[76]!==M?(o=I=>s.jsx(tt,{client:I,onCall:M,isProcessing:j.isPending&&j.variables?.id===I.id},I.id),t[74]=j.isPending,t[75]=j.variables?.id,t[76]=M,t[77]=o):o=t[77],X=H.map(o),t[69]=j.isPending,t[70]=j.variables?.id,t[71]=H,t[72]=M,t[73]=X}else X=t[73];let ce;t[78]!==X?(ce=s.jsx(He,{mode:"popLayout",children:X}),t[78]=X,t[79]=ce):ce=t[79];let h;t[80]!==m.length?(h=m.length===0&&s.jsxs("div",{className:"mt-12 text-center opacity-30",children:[s.jsx(Pt,{className:"mx-auto mb-4 h-16 w-16"}),s.jsx("p",{className:"text-sm font-bold tracking-widest uppercase",children:"Aucun client"})]}),t[80]=m.length,t[81]=h):h=t[81];let L;t[82]!==ce||t[83]!==h||t[84]!==m.length?(L=s.jsxs(Ye,{title:"Clients en Attente",icon:it,count:Ne,color:"bg-slate-900 text-white border-slate-900",children:[ce,h]}),t[82]=ce,t[83]=h,t[84]=m.length,t[85]=L):L=t[85];const be=p.length;let ge;if(t[86]!==z||t[87]!==A){let o;t[89]!==A?(o=I=>s.jsx(tt,{client:I,onRecall:A,onProcess:Z,onHelp:ve},I.id),t[89]=A,t[90]=o):o=t[90],ge=z.map(o),t[86]=z,t[87]=A,t[88]=ge}else ge=t[88];let Se;t[91]!==ge?(Se=s.jsx(He,{mode:"popLayout",children:ge}),t[91]=ge,t[92]=Se):Se=t[92];let Pe;t[93]!==p.length?(Pe=p.length===0&&s.jsxs("div",{className:"mt-12 text-center opacity-20",children:[s.jsx(at,{className:"mx-auto mb-4 h-16 w-16"}),s.jsx("p",{className:"text-sm font-bold tracking-widest uppercase",children:"Prenez un ticket"})]}),t[93]=p.length,t[94]=Pe):Pe=t[94];let De;t[95]!==p.length||t[96]!==Se||t[97]!==Pe?(De=s.jsxs(Ye,{title:"En Cours de Service",icon:at,count:be,color:"bg-blue-600 text-white border-blue-600",children:[Se,Pe]}),t[95]=p.length,t[96]=Se,t[97]=Pe,t[98]=De):De=t[98];const xt=F.length;let Me;t[99]!==Y?(Me=Y.map(Xt),t[99]=Y,t[100]=Me):Me=t[100];let Ae;t[101]!==Me?(Ae=s.jsx(He,{mode:"popLayout",children:Me}),t[101]=Me,t[102]=Ae):Ae=t[102];let Fe;t[103]!==F.length||t[104]!==Ae?(Fe=s.jsx(Ye,{title:"Derniers Traités",icon:ct,count:xt,color:"bg-emerald-500 text-white border-emerald-500 shadow-lg shadow-emerald-500/20",children:Ae}),t[103]=F.length,t[104]=Ae,t[105]=Fe):Fe=t[105];let Re;t[106]!==L||t[107]!==De||t[108]!==Fe?(Re=s.jsx("main",{className:"flex-1 overflow-x-auto overflow-y-hidden bg-[url('/grid.svg')] bg-[length:40px_40px] bg-fixed px-10 py-8",children:s.jsxs("div",{className:"flex h-full min-w-max gap-10 pb-4",children:[L,De,Fe]})}),t[106]=L,t[107]=De,t[108]=Fe,t[109]=Re):Re=t[109];let $e;t[110]!==r?($e=()=>{d(!1),c(null),r.invalidateQueries({queryKey:["clients"]})},t[110]=r,t[111]=$e):$e=t[111];let Ee;t[112]!==n||t[113]!==a||t[114]!==$e?(Ee=s.jsx(Gt,{client:a,open:n,onClose:$e}),t[112]=n,t[113]=a,t[114]=$e,t[115]=Ee):Ee=t[115];let ze;t[116]===Symbol.for("react.memo_cache_sentinel")?(ze=()=>{b(!1),N(null)},t[116]=ze):ze=t[116];const Ve=i?.phone;let qe;t[117]!==v||t[118]!==Ve?(qe=s.jsx(Qt,{isOpen:v,onClose:ze,clientPhone:Ve}),t[117]=v,t[118]=Ve,t[119]=qe):qe=t[119];let Ie;return t[120]!==J||t[121]!==Re||t[122]!==Ee||t[123]!==qe?(Ie=s.jsx(St,{currentPageName:"Tableau de Bord Caissier",children:s.jsxs("div",{className:"flex flex-col overflow-hidden bg-slate-50",children:[J,Re,Ee,qe]})}),t[120]=J,t[121]=Re,t[122]=Ee,t[123]=qe,t[124]=Ie):Ie=t[124],Ie}function Xt(t){return s.jsx(tt,{client:t},t.id)}function Yt(){Te.info("Rappel envoyé à l'affichage")}async function Zt(t){await _e.entities.Client.update(t.id,{called_at:new Date().toISOString()})}async function es(t){return await _e.entities.Client.update(t.id,{status:"called",called_at:new Date().toISOString(),counter_number:1}),t}function ts(){return _e.entities.Client.filter({status:"completed"},"-completed_at",20)}function ss(){return _e.entities.Client.filter({status:"called"},"-called_at")}function ls(){return _e.entities.Client.filter({status:"waiting"},"created_date")}export{Ns as default};
